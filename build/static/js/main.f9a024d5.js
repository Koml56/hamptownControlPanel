/*! For license information please see main.f9a024d5.js.LICENSE.txt */
(()=>{var e={22:(e,t,n)=>{var r=n(635),s=n(581),a=n(336),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?s(e):a(e)}},49:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function x(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=v.prototype;var b=y.prototype=new x;b.constructor=y,p(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,N=Object.prototype.hasOwnProperty,k={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var s,a={},i=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)N.call(t,s)&&!_.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===a[s]&&(a[s]=l[s]);return{$$typeof:n,type:e,key:i,ref:o,props:a,_owner:k.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function j(e,t,s,a,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+E(l,0):a,w(i)?(s="",null!=e&&(s=e.replace(C,"$&/")+"/"),j(i,t,s,"",(function(e){return e}))):null!=i&&(T(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var d=a+E(o=e[c],c);l+=j(o,t,s,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=j(o=o.value,t,s,d=a+E(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],s=0;return j(e,r,"","",(function(e){return t.call(n,e,s++)})),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},P={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:k};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=i,t.PureComponent=y,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=p({},e.props),a=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)N.call(t,c)&&!_.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},51:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(526);function s(e,t,n){return(t=(0,r.A)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},119:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},170:(e,t,n)=>{"use strict";n.d(t,{cY:()=>x,FA:()=>D,g:()=>I,gz:()=>Y,vA:()=>s,Hk:()=>a,K3:()=>o,u:()=>u,KA:()=>c,Uj:()=>d,gR:()=>U,Fy:()=>w,A4:()=>h,bD:()=>H,dI:()=>K,T9:()=>v,yU:()=>g,Ku:()=>X,qc:()=>F,zJ:()=>y,Im:()=>z,zW:()=>j,jZ:()=>T,$g:()=>E,lV:()=>C,Cv:()=>L,$L:()=>P,kH:()=>B,gE:()=>b,Am:()=>q,yw:()=>W,OE:()=>$,kj:()=>G,As:()=>O,P1:()=>_,eX:()=>A});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},s=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],a=s+1<e.length,i=a?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,c=t>>2,d=(3&t)<<4|i>>4;let u=(15&i)<<2|l>>6,h=63&l;o||(h=64,a||(u=64)),r.push(n[c],n[d],n[u],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&a)}else if(s>239&&s<365){const a=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&a)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const i=s<e.length?n[e.charAt(s)]:64;++s;const o=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==a||null==i||null==o)throw new l;const c=t<<2|a>>4;if(r.push(c),64!==i){const e=a<<4&240|i>>2;if(r.push(e),64!==o){const e=i<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){const t=i(e);return o.encodeByteArray(t,!0)},d=function(e){return c(e).replace(/\./g,"")},u=function(e){try{return o.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(e){return f(void 0,e)}function f(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=f(e[n],t[n]));return e}const m=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,p=()=>{try{return m()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},g=e=>{const t=(e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},v=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config};class x{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(e){return e.endsWith(".cloudworkstations.dev")}async function b(e){return(await fetch(e,{credentials:"include"})).ok}function w(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(a)),""].join(".")}const N={};let k=!1;function _(e,t){if("undefined"===typeof window||"undefined"===typeof document||!y(window.location.host)||N[e]===t||N[e]||k)return;function n(e){return"__firebase__banner__".concat(e)}N[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(N))N[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function a(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{k=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),i=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=a();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,i,l,n),document.body.appendChild(t)}s?(i.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function S(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function T(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(S())}function C(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function E(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function j(){try{return"object"===typeof indexedDB}catch(e){return!1}}function A(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class I extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],s=r?function(e,t){return e.replace(R,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(s," (").concat(n,").");return new I(n,a,t)}}const R=/\{\$([^}]+)}/g;function P(e){return JSON.parse(e)}function O(e){return JSON.stringify(e)}const M=function(e){let t={},n={},r={},s="";try{const a=e.split(".");t=P(u(a[0])||""),n=P(u(a[1])||""),s=a[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:s}},L=function(e){const t=M(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},F=function(e){const t=M(e).claims;return"object"===typeof t&&!0===t.admin};function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function z(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function B(e,t,n){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=t.call(n,e[s],s,e));return r}function H(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],a=t[s];if(V(n)&&V(a)){if(!H(n,a))return!1}else if(n!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function V(e){return null!==e&&"object"===typeof e}function q(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class Y{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let d=0;d<16;d++)n[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)n[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const e=n[d-3]^n[d-8]^n[d-14]^n[d-16];n[d]=4294967295&(e<<1|e>>>31)}let r,s,a=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(r=l^i&(o^l),s=1518500249):(r=i^o^l,s=1859775393):d<60?(r=i&o|l&(i|o),s=2400959708):(r=i^o^l,s=3395469782);const e=(a<<5|a>>>27)+r+c+s+n[d]&4294967295;c=l,l=o,o=4294967295&(i<<30|i>>>2),i=a,a=e}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const s=this.buf_;let a=this.inbuf_;for(;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(s[a]=e.charCodeAt(r),++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}else for(;r<t;)if(s[a]=e[r],++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}function K(e,t){return"".concat(e," failed: ").concat(t," argument ")}const G=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);if(a>=55296&&a<=56319){const t=a-55296;r++,s(r<e.length,"Surrogate pair missing trail surrogate.");a=65536+(t<<10)+(e.charCodeAt(r)-56320)}a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):a<65536?(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},$=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function X(e){return e&&e._delegate?e._delegate:e}},184:(e,t,n)=>{var r=n(22),s=n(248);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==r(e)}},248:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},253:(e,t,n)=>{"use strict";n.d(t,{h1:()=>o,uA:()=>s});var r=n(170);class s{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const a="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===a?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.component?this.component.multipleInstances?e:a:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},277:(e,t,n)=>{"use strict";n.d(t,{f:()=>l});var r=n(51),s=n(607),a=n(291),i=n(815),o=n(578);class l{constructor(){this.baseUrl=s.Nd.databaseURL,this.saveQueue=new Set,this.isCurrentlySaving=!1,this.app=(0,i.Wp)(s.Nd),this.db=(0,o.C3)(this.app),this.pendingSaves=new Map,this.lastSaveTimestamps=new Map,this.saveAttempts=new Map}async getLastTaskResetDate(){try{const e=await fetch("".concat(this.baseUrl,"/meta/lastTaskResetDate.json"));if(!e.ok)throw new Error("Failed to fetch lastTaskResetDate");const t=await e.json();return"string"===typeof t?t:null}catch(e){return console.error("\u274c Error fetching lastTaskResetDate:",e),null}}async setLastTaskResetDate(e){try{if(!(await fetch("".concat(this.baseUrl,"/meta/lastTaskResetDate.json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Failed to set lastTaskResetDate");return!0}catch(t){return console.error("\u274c Error setting lastTaskResetDate:",t),!1}}async acquireResetLock(e,t,n){try{const r=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(r.ok){const e=await r.json();if(e&&e.expiry>Date.now())return e.deviceId===t}const s={deviceId:t,expiry:n,timestamp:Date.now()};if(!(await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Failed to acquire lock");const a=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(!a.ok)return!1;const i=await a.json();return i&&i.deviceId===t&&i.expiry===n}catch(r){return console.error("\u274c Error acquiring reset lock:",r),!1}}async releaseResetLock(e,t){try{const n=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(n.ok){const e=await n.json();if(e&&e.deviceId!==t)return console.warn("\u26a0\ufe0f Attempted to release lock owned by another device"),!1}return(await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"),{method:"DELETE"})).ok}catch(n){return console.error("\u274c Error releasing reset lock:",n),!1}}async quickSave(e,t){const n=Date.now()-(this.lastSaveTimestamps.get(e)||0);if(n<2e3){console.log("\u23f3 Debouncing rapid save for ".concat(e," (").concat(n,"ms since last save)"));const r=this.pendingSaves.get(e);r&&clearTimeout(r);const s=setTimeout((()=>{this.executeSave(e,t),this.pendingSaves.delete(e)}),1500);return this.pendingSaves.set(e,s),!0}return this.executeSave(e,t)}async executeSave(e,t){console.log("\ud83d\udd25 QuickSave: ".concat(e)),console.log("\ud83d\udd0d Saving ".concat(e," to Firebase:"),this.getDataSummary(e,t));const n=this.saveAttempts.get(e)||0;if(this.saveAttempts.set(e,n+1),n>5)return console.warn("\u26a0\ufe0f Too many save attempts for ".concat(e,", throttling...")),this.saveAttempts.set(e,0),!1;try{const n=await fetch("".concat(this.baseUrl,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Firebase save failed: ".concat(n.status," ").concat(n.statusText));console.log("\ud83d\udd12 Critical save - waiting for confirmation: ".concat(e));if("completedTasks"===e||"taskAssignments"===e){const t=await fetch("".concat(this.baseUrl,"/").concat(e,".json")),n=await t.json();console.log("\ud83d\udd0d Verified data in Firebase after save:",this.getDataSummary(e,n))}return console.log("\u2705 Critical QuickSave completed: ".concat(e)),console.log("\ud83d\udd12 [CRITICAL-SAVE] ".concat(e.charAt(0).toUpperCase()+e.slice(1)," QuickSave confirmed by Firebase.")),this.lastSaveTimestamps.set(e,Date.now()),this.saveAttempts.set(e,0),!0}catch(r){return console.error("\u274c QuickSave failed for ".concat(e,":"),r),!1}}async batchSave(e,t){if(this.isCurrentlySaving)return console.log("\u23f3 Save already in progress, queueing fields:",e),e.forEach((e=>this.saveQueue.add(e))),!0;this.isCurrentlySaving=!0,console.log("\ud83d\udd04 Batch syncing fields:",e);try{const n=e.map((async e=>{const n=this.getFieldData(e,t);return this.quickSave(e,n)})),r=(await Promise.all(n)).every((e=>!0===e));if(r){if(console.log("\u2705 Batch sync completed"),this.saveQueue.size>0){const e=Array.from(this.saveQueue);this.saveQueue.clear(),console.log("\ud83d\udce4 Processing sync queue:",e),setTimeout((()=>{this.batchSave(e,t)}),100)}}else console.error("\u274c Some batch saves failed");return r}catch(n){return console.error("\u274c Batch save failed:",n),!1}finally{this.isCurrentlySaving=!1}}getFieldData(e,t){switch(e){case"employees":return t.employees;case"tasks":return t.tasks;case"dailyData":return t.dailyData;case"completedTasks":return Array.from(t.completedTasks);case"taskAssignments":return t.taskAssignments;case"customRoles":return t.customRoles;case"prepItems":return t.prepItems;case"scheduledPreps":return t.scheduledPreps;case"prepSelections":return t.prepSelections;case"storeItems":return t.storeItems;case"inventoryDailyItems":return t.inventoryDailyItems;case"inventoryWeeklyItems":return t.inventoryWeeklyItems;case"inventoryMonthlyItems":return t.inventoryMonthlyItems;case"inventoryDatabaseItems":return t.inventoryDatabaseItems;case"inventoryActivityLog":return t.inventoryActivityLog;default:return console.warn("Unknown field: ".concat(e)),null}}getDataSummary(e,t){var n,r,s,a;switch(e){case"employees":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,sampleEmployee:(null===t||void 0===t||null===(n=t[0])||void 0===n?void 0:n.name)||"none"};case"tasks":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,sampleTask:(null===t||void 0===t||null===(r=t[0])||void 0===r?void 0:r.task)||"none"};case"dailyData":return{totalDates:Object.keys(t||{}).length,latestDate:Object.keys(t||{}).sort().pop()||"none"};case"completedTasks":return{completedCount:Array.isArray(t)?t.length:(null===t||void 0===t?void 0:t.size)||0};case"taskAssignments":return{totalAssignments:Object.keys(t||{}).length};case"customRoles":return{rolesCount:(null===t||void 0===t?void 0:t.length)||0,roles:t||[]};case"prepItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,samplePrep:(null===t||void 0===t||null===(s=t[0])||void 0===s?void 0:s.name)||"none"};case"scheduledPreps":const e=(new Date).toISOString().split("T")[0],i=(t||[]).filter((t=>t.scheduledDate===e));return{totalCount:(t||[]).length,todayCount:i.length,todayCompletedCount:i.filter((e=>e.completed)).length,sampleTodayPreps:i.slice(0,3).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate})))};case"prepSelections":return{totalSelections:Object.keys(t||{}).length,sampleKeys:Object.keys(t||{}).slice(0,3)};case"storeItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,availableCount:(t||[]).filter((e=>e.available)).length};case"inventoryDailyItems":case"inventoryWeeklyItems":case"inventoryMonthlyItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,criticalCount:(t||[]).filter((e=>e.currentStock<=.5*e.minLevel)).length};case"inventoryDatabaseItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,assignedCount:(t||[]).filter((e=>e.isAssigned)).length};case"inventoryActivityLog":return{totalEntries:(null===t||void 0===t?void 0:t.length)||0,latestEntry:(null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.timestamp)||"none"};default:return t}}async loadData(){console.log("\ud83d\udd25 Loading data from Firebase...");try{const[e,t,n,s,i,o,l,c,d,u,h,f,m,p,g]=await Promise.all([fetch("".concat(this.baseUrl,"/employees.json")),fetch("".concat(this.baseUrl,"/tasks.json")),fetch("".concat(this.baseUrl,"/dailyData.json")),fetch("".concat(this.baseUrl,"/completedTasks.json")),fetch("".concat(this.baseUrl,"/taskAssignments.json")),fetch("".concat(this.baseUrl,"/customRoles.json")),fetch("".concat(this.baseUrl,"/prepItems.json")),fetch("".concat(this.baseUrl,"/scheduledPreps.json")),fetch("".concat(this.baseUrl,"/prepSelections.json")),fetch("".concat(this.baseUrl,"/storeItems.json")),fetch("".concat(this.baseUrl,"/inventoryDailyItems.json")),fetch("".concat(this.baseUrl,"/inventoryWeeklyItems.json")),fetch("".concat(this.baseUrl,"/inventoryMonthlyItems.json")),fetch("".concat(this.baseUrl,"/inventoryDatabaseItems.json")),fetch("".concat(this.baseUrl,"/inventoryActivityLog.json"))]),v=await e.json(),x=await t.json(),y=await n.json(),b=await s.json(),w=await i.json(),N=await o.json(),k=await l.json(),_=await c.json(),S=await d.json(),T=await u.json(),C=await h.json(),E=await f.json(),j=await m.json(),A=await p.json(),I=await g.json(),D=v?v.map((e=>(0,r.A)((0,r.A)({},e),{},{points:void 0!==e.points?e.points:0}))):(0,a.PR)(),R=x?x.map((e=>(0,r.A)((0,r.A)({},e),{},{points:void 0!==e.points?e.points:this.getDefaultTaskPoints(e.priority)}))):(0,a.w4)(),P=y?this.migrateDailyData(y):(0,a.tU)();return console.log("\u2705 Firebase: Data loaded and migrated successfully"),console.log("\ud83d\udc65 Employees with points:",D),_&&console.log("\ud83d\udccb Loaded scheduledPreps:",this.getDataSummary("scheduledPreps",_)),{employees:D,tasks:R,dailyData:P,completedTasks:new Set(b||[]),taskAssignments:w||{},customRoles:N||["Cleaner","Manager","Supervisor"],prepItems:k||[],scheduledPreps:_||[],prepSelections:S||{},storeItems:T||[],inventoryDailyItems:C||[],inventoryWeeklyItems:E||[],inventoryMonthlyItems:j||[],inventoryDatabaseItems:A||[],inventoryActivityLog:I||[]}}catch(e){throw console.error("\u274c Firebase connection failed:",e),e}}getDefaultTaskPoints(e){switch(e){case"high":return 10;case"medium":default:return 5;case"low":return 3}}migrateDailyData(e){const t={};return Object.keys(e).forEach((n=>{const r=e[n];t[n]={completedTasks:r.completedTasks||[],employeeMoods:r.employeeMoods||[],purchases:r.purchases||[],totalTasks:r.totalTasks||22,completionRate:r.completionRate||0,totalPointsEarned:r.totalPointsEarned||0,totalPointsSpent:r.totalPointsSpent||0}})),t}async saveData(e){console.log("\ud83d\udd25 Saving all data to Firebase...");if(!await this.batchSave(["employees","tasks","dailyData","completedTasks","taskAssignments","customRoles","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"],e))throw console.error("\u274c Firebase: Some data failed to save"),new Error("Firebase save failed");console.log("\u2705 Firebase: All data saved successfully")}async saveImmediate(e,t,n){console.log("\ud83d\udd25 Immediate save triggered by ".concat(e," change"));const r=await this.quickSave(e,t);return r&&n&&"scheduledPreps"!==e&&setTimeout((()=>{console.log("\ud83d\udd04 Background sync of related fields");const t=this.getRelatedFields(e);t.length>0&&this.batchSave(t,n)}),1e3),r}getRelatedFields(e){switch(e){case"completedTasks":return["employees","dailyData","taskAssignments"];case"employees":return["dailyData"];case"taskAssignments":return["completedTasks"];case"scheduledPreps":return["prepSelections"];case"inventoryDailyItems":case"inventoryWeeklyItems":case"inventoryMonthlyItems":return["inventoryActivityLog"];case"inventoryDatabaseItems":return["inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems"];default:return[]}}onCompletedTasksChange(e){const t=(0,o.KR)(this.db,"completedTasks"),n=(0,o.Zy)(t,(t=>{const n=t.val()||[];e(n)}));return()=>(0,o.AU)(t,"value",n)}onTaskAssignmentsChange(e){const t=(0,o.KR)(this.db,"taskAssignments"),n=(0,o.Zy)(t,(t=>{const n=t.val()||{};e(n)}));return()=>(0,o.AU)(t,"value",n)}}},291:(e,t,n)=>{"use strict";n.d(t,{PR:()=>s,h3:()=>i,tU:()=>o,w4:()=>a});var r=n(867);const s=()=>[{id:1,name:"Luka",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:2,name:"Safi",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:3,name:"Ehsan",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:4,name:"Oleksii",mood:3,lastUpdated:"Not updated",role:"Manager",lastMoodDate:null,points:0}],a=()=>[{id:1,task:"Water all plants",location:"Dining Area",priority:"medium",estimatedTime:"10 min",points:5},{id:2,task:"Refill toilet paper",location:"Restroom",priority:"high",estimatedTime:"5 min",points:8},{id:3,task:"Sweep the floor",location:"Kitchen",priority:"high",estimatedTime:"15 min",points:10},{id:4,task:"Wipe refrigerator surfaces",location:"Kitchen",priority:"medium",estimatedTime:"10 min",points:7},{id:5,task:"Light glass wipe",location:"Kitchen (kylm\xe4vitrini)",priority:"low",estimatedTime:"5 min",points:3},{id:6,task:"Refill takeaway & snack boxes",location:"Kitchen",priority:"medium",estimatedTime:"10 min",points:6},{id:7,task:"Stock napkins",location:"Kitchen",priority:"medium",estimatedTime:"5 min",points:4},{id:8,task:"Wipe and disinfect tables",location:"Dining Area",priority:"high",estimatedTime:"20 min",points:12},{id:9,task:"Clean table legs",location:"Dining Area",priority:"low",estimatedTime:"15 min",points:8},{id:10,task:"Vacuum the floor",location:"Dining Area",priority:"high",estimatedTime:"20 min",points:15},{id:11,task:"Clean sink and mirror",location:"Restroom",priority:"high",estimatedTime:"10 min",points:9},{id:12,task:"Clean inside the toilet",location:"Restroom",priority:"high",estimatedTime:"15 min",points:12},{id:13,task:"Replace towel roll",location:"Restroom",priority:"medium",estimatedTime:"5 min",points:4},{id:14,task:"Final disinfection (POS, Foodora, Wolt)",location:"POS / Front",priority:"high",estimatedTime:"10 min",points:10},{id:15,task:"Sweep the floor",location:"Kitchen (Floor)",priority:"high",estimatedTime:"15 min",points:10},{id:16,task:"Mop the floor (every 2 days)",location:"Kitchen (Floor)",priority:"high",estimatedTime:"20 min",points:15},{id:17,task:"Full grill cleaning",location:"Kitchen",priority:"high",estimatedTime:"45 min",points:25},{id:18,task:"Sanitize all surfaces",location:"Kitchen",priority:"high",estimatedTime:"25 min",points:18},{id:19,task:"Wipe dishwasher surface",location:"Apu-Kitchen",priority:"medium",estimatedTime:"10 min",points:6},{id:20,task:"Replace hood filter (every 3 days)",location:"Kitchen",priority:"medium",estimatedTime:"15 min",points:8},{id:21,task:"Cover all food containers",location:"Storage",priority:"high",estimatedTime:"10 min",points:7},{id:22,task:"Organize containers",location:"Apu-Kitchen",priority:"low",estimatedTime:"15 min",points:5}],i=()=>[{id:1,name:"Free Coffee",description:"Get a free coffee from the kitchen",cost:10,category:"food",icon:"\u2615",available:!0},{id:2,name:"Free Lunch",description:"Get a free meal from the restaurant",cost:50,category:"food",icon:"\ud83c\udf7d\ufe0f",available:!0},{id:3,name:"Free Meal for Friend",description:"Bring a friend for a free meal",cost:80,category:"social",icon:"\ud83d\udc65",available:!0},{id:4,name:"30min Break Extension",description:"Extend your break by 30 minutes",cost:25,category:"break",icon:"\u23f0",available:!0},{id:5,name:"Early Leave (1 hour)",description:"Leave work 1 hour early",cost:60,category:"break",icon:"\ud83d\udeaa",available:!0},{id:6,name:"Free Snack",description:"Get any snack from the kitchen",cost:15,category:"food",icon:"\ud83c\udf7f",available:!0},{id:7,name:"Choose Next Week Schedule",description:"Pick your preferred shifts next week",cost:100,category:"reward",icon:"\ud83d\udcc5",available:!0},{id:8,name:"Team Building Activity",description:"Organize a fun team activity",cost:150,category:"social",icon:"\ud83c\udf89",available:!0},{id:9,name:"Free Dessert",description:"Get any dessert from the menu",cost:20,category:"food",icon:"\ud83c\udf70",available:!0},{id:10,name:"Reserved Parking Spot",description:"Get the best parking spot for a week",cost:40,category:"reward",icon:"\ud83d\ude97",available:!0}],o=()=>{const e=Array.from({length:30},((e,t)=>{const n=new Date;return n.setDate(n.getDate()-t),(0,r.po)(n)})),t={};return e.forEach((e=>{t[e]={completedTasks:[],employeeMoods:[],purchases:[],totalTasks:22,completionRate:0,totalPointsEarned:0,totalPointsSpent:0}})),t}},336:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},340:(e,t,n)=>{"use strict";e.exports=n(761)},345:(e,t,n)=>{"use strict";var r=n(950),s=n(340);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,n,r,s,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function y(e,t,n,r){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!u.call(m,e)||!u.call(f,e)&&(h.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),N=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),C=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function W(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),a=r.stack.split("\n"),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(1!==i||1!==o)do{if(i--,0>--o||s[i]!==a[o]){var l="\n"+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=W(e.type,!1);case 11:return e=W(e.type.render,!1);case 1:return e=W(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case N:return"Portal";case S:return"Profiler";case _:return"StrictMode";case j:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ae(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(fe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ne=null,ke=null,_e=null;function Se(e){if(e=ys(e)){if("function"!==typeof Ne)throw Error(a(280));var t=e.stateNode;t&&(t=ws(t),Ne(e.stateNode,e.type,t))}}function Te(e){ke?_e?_e.push(e):_e=[e]:ke=e}function Ce(){if(ke){var e=ke,t=_e;if(_e=ke=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function je(){}var Ae=!1;function Ie(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ee(e,t,n)}finally{Ae=!1,(null!==ke||null!==_e)&&(je(),Ce())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Re=!1;if(d)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(de){Re=!1}function Oe(e,t,n,r,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Me=!1,Le=null,Fe=!1,Ue=null,We={onError:function(e){Me=!0,Le=e}};function ze(e,t,n,r,s,a,i,o,l){Me=!1,Le=null,Oe.apply(We,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Be(e)!==e)throw Error(a(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(r=s.return)){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Ve(s),e;if(i===r)return Ve(s),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Ke=s.unstable_scheduleCallback,Ge=s.unstable_cancelCallback,$e=s.unstable_shouldYield,Xe=s.unstable_requestPaint,Qe=s.unstable_now,Je=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~s;0!==o?r=ut(o):0!==(a&=i)&&(r=ut(a))}else 0!==(i=n&~s)?r=ut(i):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(a=t&-t)||16===s&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-it(t)),r|=e[n],t&=~s;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function xt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Nt,kt,_t,St,Tt=!1,Ct=[],Et=null,jt=null,At=null,It=new Map,Dt=new Map,Rt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":jt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,n,r,s,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},null!==t&&(null!==(t=ys(t))&&Nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Lt(e){var t=xs(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void St(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ys(n))&&Nt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Wt(){Tt=!1,null!==Et&&Ft(Et)&&(Et=null),null!==jt&&Ft(jt)&&(jt=null),null!==At&&Ft(At)&&(At=null),It.forEach(Ut),Dt.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Wt)))}function Bt(e){function t(t){return zt(t,e)}if(0<Ct.length){zt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&zt(Et,e),null!==jt&&zt(jt,e),null!==At&&zt(At,e),It.forEach(t),Dt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Rt.shift()}var Ht=b.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var s=yt,a=Ht.transition;Ht.transition=null;try{yt=1,Kt(e,t,n,r)}finally{yt=s,Ht.transition=a}}function Yt(e,t,n,r){var s=yt,a=Ht.transition;Ht.transition=null;try{yt=4,Kt(e,t,n,r)}finally{yt=s,Ht.transition=a}}function Kt(e,t,n,r){if(Vt){var s=$t(e,t,n,r);if(null===s)Vr(e,t,r,Gt,n),Ot(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return Et=Mt(Et,e,t,n,r,s),!0;case"dragenter":return jt=Mt(jt,e,t,n,r,s),!0;case"mouseover":return At=Mt(At,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return It.set(a,Mt(It.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Dt.set(a,Mt(Dt.get(a)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==s;){var a=ys(s);if(null!==a&&wt(a),null===(a=$t(e,t,n,r))&&Vr(e,t,r,Gt,n),a===s)break;s=a}null!==s&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Gt=null;function $t(e,t,n,r){if(Gt=null,null!==(e=xs(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,s="value"in Qt?Qt.value:Qt.textContent,a=s.length;for(e=0;e<r&&n[e]===s[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===s[a-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(cn),un=L({},cn,{view:0,detail:0}),hn=sn(un),fn=L({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=sn(fn),pn=sn(L({},fn,{dataTransfer:0})),gn=sn(L({},un,{relatedTarget:0})),vn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(xn),bn=sn(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function Sn(){return _n}var Tn=L({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=sn(Tn),En=sn(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),jn=sn(L({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),An=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(In),Rn=[9,13,27,32],Pn=d&&"CompositionEvent"in window,On=null;d&&"documentMode"in document&&(On=document.documentMode);var Mn=d&&"TextEvent"in window&&!On,Ln=d&&(!Pn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Wn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function qn(e,t,n,r){Te(r),0<(t=Yr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Kn=null;function Gn(e){Fr(e,0)}function $n(e){if(K(bs(e)))return e}function Xn(e,t){if("change"===e)return t}var Qn=!1;if(d){var Jn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Yn&&(Yn.detachEvent("onpropertychange",nr),Kn=Yn=null)}function nr(e){if("value"===e.propertyName&&$n(Kn)){var t=[];qn(t,Kn,e,we(e)),Ie(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Yn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Kn)}function ar(e,t){if("click"===e)return $n(t)}function ir(e,t){if("input"===e||"change"===e)return $n(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!u.call(t,s)||!or(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=void 0===r.end?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=dr(n,a);var i=dr(n,r);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,xr=null,yr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&lr(xr,r)||(xr=r,0<(r=Yr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},kr={},_r={};function Sr(e){if(kr[e])return kr[e];if(!Nr[e])return e;var t,n=Nr[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return kr[e]=n[t];return e}d&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);var Tr=Sr("animationend"),Cr=Sr("animationiteration"),Er=Sr("animationstart"),jr=Sr("transitionend"),Ar=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),l(t,[e])}for(var Rr=0;Rr<Ir.length;Rr++){var Pr=Ir[Rr];Dr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Dr(Tr,"onAnimationEnd"),Dr(Cr,"onAnimationIteration"),Dr(Er,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(jr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,i,o,l,c){if(ze.apply(this,arguments),Me){if(!Me)throw Error(a(198));var d=Le;Me=!1,Le=null,Fe||(Fe=!0,Ue=d)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Lr(s,o,c),a=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Lr(s,o,c),a=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[ps];void 0===n&&(n=t[ps]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Wr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,i.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Wr(t,!1,e),Wr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Wr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Xt(t)){case 1:var s=qt;break;case 4:s=Yt;break;default:s=Kt}n=s.bind(null,t,n,e),s=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,s){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;i=i.return}for(;null!==o;){if(null===(i=xs(o)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}o=o.parentNode}}r=r.return}Ie((function(){var r=a,s=we(n),i=[];e:{var o=Ar.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=jn;break;case Tr:case Cr:case Er:l=vn;break;case jr:l=An;break;case"scroll":l=hn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var f,m=r;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==h&&(null!=(p=De(m,h))&&d.push(qr(m,p,f)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,s),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!xs(c)&&!c[ms])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?xs(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=mn,p="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,p="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:bs(l),f=null==c?o:bs(c),(o=new d(p,m+"leave",l,n,s)).target=u,o.relatedTarget=f,p=null,xs(s)===r&&((d=new d(h,m+"enter",c,n,s)).target=f,d.relatedTarget=u,p=d),u=p,l&&c)e:{for(h=c,m=0,f=d=l;f;f=Kr(f))m++;for(f=0,p=h;p;p=Kr(p))f++;for(;0<m-f;)d=Kr(d),m--;for(;0<f-m;)h=Kr(h),f--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Kr(d),h=Kr(h)}d=null}else d=null;null!==l&&Gr(i,o,l,d,!1),null!==c&&null!==u&&Gr(i,u,c,d,!0)}if("select"===(l=(o=r?bs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xn;else if(Vn(o))if(Qn)g=ir;else{g=sr;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ar);switch(g&&(g=g(e,r))?qn(i,g,n,s):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?bs(r):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,xr=null);break;case"focusout":xr=vr=gr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,br(i,n,s);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":br(i,n,s)}var x;if(Pn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Bn?Wn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Ln&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Bn&&(x=en()):(Jt="value"in(Qt=s)?Qt.value:Qt.textContent,Bn=!0)),0<(v=Yr(r,y)).length&&(y=new bn(y,e,null,n,s),i.push({event:y,listeners:v}),x?y.data=x:null!==(x=zn(n))&&(y.data=x))),(x=Mn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Pn&&Wn(e,t)?(e=en(),Zt=Jt=Qt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Yr(r,"onBeforeInput")).length&&(s=new bn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:r}),s.data=x))}Fr(i,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,a=s.stateNode;5===s.tag&&null!==a&&(s=a,null!=(a=De(e,n))&&r.unshift(qr(e,a,s)),null!=(a=De(e,t))&&r.push(qr(e,a,s))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,s){for(var a=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=De(n,a))&&i.unshift(qr(n,l,o)):s||null!=(l=De(n,a))&&i.push(qr(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var $r=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Xr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(a(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,as="function"===typeof Promise?Promise:void 0,is="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof as?function(e){return as.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout((function(){throw e}))}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Bt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ds(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var us=Math.random().toString(36).slice(2),hs="__reactFiber$"+us,fs="__reactProps$"+us,ms="__reactContainer$"+us,ps="__reactEvents$"+us,gs="__reactListeners$"+us,vs="__reactHandles$"+us;function xs(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ms]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ds(e);null!==e;){if(n=e[hs])return n;e=ds(e)}return t}n=(e=n).parentNode}return null}function ys(e){return!(e=e[hs]||e[ms])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ws(e){return e[fs]||null}var Ns=[],ks=-1;function _s(e){return{current:e}}function Ss(e){0>ks||(e.current=Ns[ks],Ns[ks]=null,ks--)}function Ts(e,t){ks++,Ns[ks]=e.current,e.current=t}var Cs={},Es=_s(Cs),js=_s(!1),As=Cs;function Is(e,t){var n=e.type.contextTypes;if(!n)return Cs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in n)a[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ds(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rs(){Ss(js),Ss(Es)}function Ps(e,t,n){if(Es.current!==Cs)throw Error(a(168));Ts(Es,t),Ts(js,n)}function Os(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(a(108,H(e)||"Unknown",s));return L({},n,r)}function Ms(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cs,As=Es.current,Ts(Es,e),Ts(js,js.current),!0}function Ls(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Os(e,t,As),r.__reactInternalMemoizedMergedChildContext=e,Ss(js),Ss(Es),Ts(Es,e)):Ss(js),Ts(js,n)}var Fs=null,Us=!1,Ws=!1;function zs(e){null===Fs?Fs=[e]:Fs.push(e)}function Bs(){if(!Ws&&null!==Fs){Ws=!0;var e=0,t=yt;try{var n=Fs;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fs=null,Us=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),Ke(Ze,Bs),s}finally{yt=t,Ws=!1}}return null}var Hs=[],Vs=0,qs=null,Ys=0,Ks=[],Gs=0,$s=null,Xs=1,Qs="";function Js(e,t){Hs[Vs++]=Ys,Hs[Vs++]=qs,qs=e,Ys=t}function Zs(e,t,n){Ks[Gs++]=Xs,Ks[Gs++]=Qs,Ks[Gs++]=$s,$s=e;var r=Xs;e=Qs;var s=32-it(r)-1;r&=~(1<<s),n+=1;var a=32-it(t)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Xs=1<<32-it(t)+s|n<<s|r,Qs=a+e}else Xs=1<<a|n<<s|r,Qs=e}function ea(e){null!==e.return&&(Js(e,1),Zs(e,1,0))}function ta(e){for(;e===qs;)qs=Hs[--Vs],Hs[Vs]=null,Ys=Hs[--Vs],Hs[Vs]=null;for(;e===$s;)$s=Ks[--Gs],Ks[Gs]=null,Qs=Ks[--Gs],Ks[Gs]=null,Xs=Ks[--Gs],Ks[Gs]=null}var na=null,ra=null,sa=!1,aa=null;function ia(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$s?{id:Xs,overflow:Qs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(sa){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cs(n.nextSibling);var r=na;t&&oa(e,t)?ia(r,n):(e.flags=-4097&e.flags|2,sa=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,sa=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!sa)return da(e),sa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)ia(e,t),t=cs(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?cs(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=cs(e.nextSibling)}function fa(){ra=na=null,sa=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var pa=b.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var s=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function va(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xa(e){return(0,e._init)(e._payload)}function ya(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===k?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&xa(a)===t.type)?((r=s(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Pc(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function u(e,t,n,r,a){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,a)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case N:return(t=Fc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;va(e,t)}return null}function f(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case N:return n.key===s?d(e,t,n,r):null;case D:return f(e,t,(s=n._init)(n._payload),r)}if(te(n)||O(n))return null!==s?null:u(e,t,n,r,null);va(e,n)}return null}function m(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case N:return d(t,e=e.get(null===r.key?n:r.key)||null,r,s);case D:return m(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||O(r))return u(t,e=e.get(n)||null,r,s,null);va(t,r)}return null}function p(s,a,o,l){for(var c=null,d=null,u=a,p=a=0,g=null;null!==u&&p<o.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var v=f(s,u,o[p],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(s,u),a=i(v,a,p),null===d?c=v:d.sibling=v,d=v,u=g}if(p===o.length)return n(s,u),sa&&Js(s,p),c;if(null===u){for(;p<o.length;p++)null!==(u=h(s,o[p],l))&&(a=i(u,a,p),null===d?c=u:d.sibling=u,d=u);return sa&&Js(s,p),c}for(u=r(s,u);p<o.length;p++)null!==(g=m(u,s,p,o[p],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),a=i(g,a,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(s,e)})),sa&&Js(s,p),c}function g(s,o,l,c){var d=O(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,p=o,g=o=0,v=null,x=l.next();null!==p&&!x.done;g++,x=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var y=f(s,p,x.value,c);if(null===y){null===p&&(p=v);break}e&&p&&null===y.alternate&&t(s,p),o=i(y,o,g),null===u?d=y:u.sibling=y,u=y,p=v}if(x.done)return n(s,p),sa&&Js(s,g),d;if(null===p){for(;!x.done;g++,x=l.next())null!==(x=h(s,x.value,c))&&(o=i(x,o,g),null===u?d=x:u.sibling=x,u=x);return sa&&Js(s,g),d}for(p=r(s,p);!x.done;g++,x=l.next())null!==(x=m(p,s,g,x.value,c))&&(e&&null!==x.alternate&&p.delete(null===x.key?g:x.key),o=i(x,o,g),null===u?d=x:u.sibling=x,u=x);return e&&p.forEach((function(e){return t(s,e)})),sa&&Js(s,g),d}return function e(r,a,i,l){if("object"===typeof i&&null!==i&&i.type===k&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=a;null!==d;){if(d.key===c){if((c=i.type)===k){if(7===d.tag){n(r,d.sibling),(a=s(d,i.props.children)).return=r,r=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&xa(c)===d.type){n(r,d.sibling),(a=s(d,i.props)).ref=ga(r,d,i),a.return=r,r=a;break e}n(r,d);break}t(r,d),d=d.sibling}i.type===k?((a=Oc(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=Pc(i.type,i.key,i.props,null,r.mode,l)).ref=ga(r,a,i),l.return=r,r=l)}return o(r);case N:e:{for(d=i.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=s(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Fc(i,r.mode,l)).return=r,r=a}return o(r);case D:return e(r,a,(d=i._init)(i._payload),l)}if(te(i))return p(r,a,i,l);if(O(i))return g(r,a,i,l);va(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=s(a,i)).return=r,r=a):(n(r,a),(a=Lc(i,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var ba=ya(!0),wa=ya(!1),Na=_s(null),ka=null,_a=null,Sa=null;function Ta(){Sa=_a=ka=null}function Ca(e){var t=Na.current;Ss(Na),e._currentValue=t}function Ea(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ja(e,t){ka=e,Sa=_a=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Aa(e){var t=e._currentValue;if(Sa!==e)if(e={context:e,memoizedValue:t,next:null},null===_a){if(null===ka)throw Error(a(308));_a=e,ka.dependencies={lanes:0,firstContext:e}}else _a=_a.next=e;return t}var Ia=null;function Da(e){null===Ia?Ia=[e]:Ia.push(e)}function Ra(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Da(t)):(n.next=s.next,s.next=n),t.interleaved=n,Pa(e,r)}function Pa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oa=!1;function Ma(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Pa(e,n)}return null===(s=r.interleaved)?(t.next=t,Da(r)):(t.next=s.next,s.next=t),r.interleaved=t,Pa(e,n)}function Wa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}function za(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?s=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?s=a=t:a=a.next=t}else s=a=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ba(e,t,n,r){var s=e.updateQueue;Oa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=s.baseState;for(i=0,d=c=l=null,o=a;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,f=n,p.tag){case 1:if("function"===typeof(m=p.payload)){u=m.call(f,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=p.payload)?m.call(f,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Oa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=f,l=u):d=d.next=f,i|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===d&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===a&&(s.shared.lanes=0);Ml|=i,e.lanes=i,e.memoizedState=u}}function Ha(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(a(191,s));s.call(r)}}}var Va={},qa=_s(Va),Ya=_s(Va),Ka=_s(Va);function Ga(e){if(e===Va)throw Error(a(174));return e}function $a(e,t){switch(Ts(Ka,t),Ts(Ya,e),Ts(qa,Va),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ss(qa),Ts(qa,t)}function Xa(){Ss(qa),Ss(Ya),Ss(Ka)}function Qa(e){Ga(Ka.current);var t=Ga(qa.current),n=le(t,e.type);t!==n&&(Ts(Ya,e),Ts(qa,n))}function Ja(e){Ya.current===e&&(Ss(qa),Ss(Ya))}var Za=_s(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ri=b.ReactCurrentDispatcher,si=b.ReactCurrentBatchConfig,ai=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function fi(){throw Error(a(321))}function mi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function pi(e,t,n,r,s,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Ji:Zi,e=n(r,s),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(a(301));i+=1,li=oi=null,t.updateQueue=null,ri.current=eo,e=n(r,s)}while(di)}if(ri.current=Qi,t=null!==oi&&null!==oi.next,ai=0,li=oi=ii=null,ci=!1,t)throw Error(a(300));return e}function gi(){var e=0!==ui;return ui=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function xi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function yi(e,t){return"function"===typeof t?t(e):t}function bi(e){var t=xi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=oi,s=r.baseQueue,i=n.pending;if(null!==i){if(null!==s){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((ai&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ii.lanes|=u,Ml|=u}d=d.next}while(null!==d&&d!==i);null===c?o=r:c.next=l,or(r,t.memoizedState)||(yo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ii.lanes|=i,Ml|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=xi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{i=e(i,o.action),o=o.next}while(o!==s);or(i,t.memoizedState)||(yo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ni(){}function ki(e,t){var n=ii,r=xi(),s=t(),i=!or(r.memoizedState,s);if(i&&(r.memoizedState=s,yo=!0),r=r.queue,Oi(Ti.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ai(9,Si.bind(null,n,r,s,t),void 0,null),null===jl)throw Error(a(349));0!==(30&ai)||_i(n,t,s)}return s}function _i(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Si(e,t,n,r){t.value=n,t.getSnapshot=r,Ci(t)&&Ei(e)}function Ti(e,t,n){return n((function(){Ci(t)&&Ei(e)}))}function Ci(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ei(e){var t=Pa(e,1);null!==t&&nc(t,e,1,-1)}function ji(e){var t=vi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[t.memoizedState,e]}function Ai(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ii(){return xi().memoizedState}function Di(e,t,n,r){var s=vi();ii.flags|=e,s.memoizedState=Ai(1|t,n,void 0,void 0===r?null:r)}function Ri(e,t,n,r){var s=xi();r=void 0===r?null:r;var a=void 0;if(null!==oi){var i=oi.memoizedState;if(a=i.destroy,null!==r&&mi(r,i.deps))return void(s.memoizedState=Ai(t,n,a,r))}ii.flags|=e,s.memoizedState=Ai(1|t,n,a,r)}function Pi(e,t){return Di(8390656,8,e,t)}function Oi(e,t){return Ri(2048,8,e,t)}function Mi(e,t){return Ri(4,2,e,t)}function Li(e,t){return Ri(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ri(4,4,Fi.bind(null,t,e),n)}function Wi(){}function zi(e,t){var n=xi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bi(e,t){var n=xi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hi(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=n):(or(n,t)||(n=pt(),ii.lanes|=n,Ml|=n,e.baseState=!0),t)}function Vi(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=si.transition;si.transition={};try{e(!1),t()}finally{yt=n,si.transition=r}}function qi(){return xi().memoizedState}function Yi(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Gi(e))$i(t,n);else if(null!==(n=Ra(e,t,n,r))){nc(n,e,r,ec()),Xi(n,t,r)}}function Ki(e,t,n){var r=tc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gi(e))$i(t,s);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=a(i,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,i)){var l=t.interleaved;return null===l?(s.next=s,Da(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Ra(e,t,s,r))&&(nc(n,e,r,s=ec()),Xi(n,t,r))}}function Gi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function $i(e,t){di=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xi(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}var Qi={readContext:Aa,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Ji={readContext:Aa,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Aa,useEffect:Pi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Di(4194308,4,Fi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=vi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Yi.bind(null,ii,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:ji,useDebugValue:Wi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=ji(!1),t=e[0];return e=Vi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ii,s=vi();if(sa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===jl)throw Error(a(349));0!==(30&ai)||_i(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Pi(Ti.bind(null,r,i,e),[e]),r.flags|=2048,Ai(9,Si.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=vi(),t=jl.identifierPrefix;if(sa){var n=Qs;t=":"+t+"R"+(n=(Xs&~(1<<32-it(Xs)-1)).toString(32)+n),0<(n=ui++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Aa,useCallback:zi,useContext:Aa,useEffect:Oi,useImperativeHandle:Ui,useInsertionEffect:Mi,useLayoutEffect:Li,useMemo:Bi,useReducer:bi,useRef:Ii,useState:function(){return bi(yi)},useDebugValue:Wi,useDeferredValue:function(e){return Hi(xi(),oi.memoizedState,e)},useTransition:function(){return[bi(yi)[0],xi().memoizedState]},useMutableSource:Ni,useSyncExternalStore:ki,useId:qi,unstable_isNewReconciler:!1},eo={readContext:Aa,useCallback:zi,useContext:Aa,useEffect:Oi,useImperativeHandle:Ui,useInsertionEffect:Mi,useLayoutEffect:Li,useMemo:Bi,useReducer:wi,useRef:Ii,useState:function(){return wi(yi)},useDebugValue:Wi,useDeferredValue:function(e){var t=xi();return null===oi?t.memoizedState=e:Hi(t,oi.memoizedState,e)},useTransition:function(){return[wi(yi)[0],xi().memoizedState]},useMutableSource:Ni,useSyncExternalStore:ki,useId:qi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,s))&&(nc(t,e,s,r),Wa(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,s))&&(nc(t,e,s,r),Wa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),s=Fa(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Ua(e,s,r))&&(nc(t,e,r,n),Wa(t,e,r))}};function so(e,t,n,r,s,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,a))}function ao(e,t,n){var r=!1,s=Cs,a=t.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(s=Ds(t)?As:Es.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Is(e,s):Cs),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ma(e);var a=t.contextType;"object"===typeof a&&null!==a?s.context=Aa(a):(a=Ds(t)?As:Es.current,s.context=Is(e,a)),s.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&ro.enqueueReplaceState(s,s.state,null),Ba(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var s=n}catch(a){s="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:s,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,ql=r),uo(0,t)},n}function mo(e,t,n){(n=Fa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Yl?Yl=new Set([this]):Yl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function po(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var xo=b.ReactCurrentOwner,yo=!1;function bo(e,t,n,r){t.child=null===e?wa(t,null,n,r):ba(t,e.child,n,r)}function wo(e,t,n,r,s){n=n.render;var a=t.ref;return ja(t,s),r=pi(e,t,n,r,a,s),n=gi(),null===e||yo?(sa&&n&&ea(t),t.flags|=1,bo(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Vo(e,t,s))}function No(e,t,n,r,s){if(null===e){var a=n.type;return"function"!==typeof a||Dc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ko(e,t,a,r,s))}if(a=e.child,0===(e.lanes&s)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return Vo(e,t,s)}return t.flags|=1,(e=Rc(a,r)).ref=t.ref,e.return=t,t.child=e}function ko(e,t,n,r,s){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(yo=!1,t.pendingProps=r=a,0===(e.lanes&s))return t.lanes=e.lanes,Vo(e,t,s);0!==(131072&e.flags)&&(yo=!0)}}return To(e,t,n,r,s)}function _o(e,t,n){var r=t.pendingProps,s=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ts(Rl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ts(Rl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ts(Rl,Dl),Dl|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ts(Rl,Dl),Dl|=r;return bo(e,t,s,n),t.child}function So(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function To(e,t,n,r,s){var a=Ds(n)?As:Es.current;return a=Is(t,a),ja(t,s),n=pi(e,t,n,r,a,s),r=gi(),null===e||yo?(sa&&r&&ea(t),t.flags|=1,bo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Vo(e,t,s))}function Co(e,t,n,r,s){if(Ds(n)){var a=!0;Ms(t)}else a=!1;if(ja(t,s),null===t.stateNode)Ho(e,t),ao(t,n,r),oo(t,n,r,s),r=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Aa(c):c=Is(t,c=Ds(n)?As:Es.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==r||l!==c)&&io(t,i,r,c),Oa=!1;var h=t.memoizedState;i.state=h,Ba(t,r,i,s),l=t.memoizedState,o!==r||h!==l||js.current||Oa?("function"===typeof d&&(no(t,n,d,r),l=t.memoizedState),(o=Oa||so(t,n,o,r,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,La(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Aa(l):l=Is(t,l=Ds(n)?As:Es.current);var f=n.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,r,l),Oa=!1,h=t.memoizedState,i.state=h,Ba(t,r,i,s);var m=t.memoizedState;o!==u||h!==m||js.current||Oa?("function"===typeof f&&(no(t,n,f,r),m=t.memoizedState),(c=Oa||so(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),i.props=r,i.state=m,i.context=l,r=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Eo(e,t,n,r,a,s)}function Eo(e,t,n,r,s,a){So(e,t);var i=0!==(128&t.flags);if(!r&&!i)return s&&Ls(t,n,!1),Vo(e,t,a);r=t.stateNode,xo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=ba(t,e.child,null,a),t.child=ba(t,null,o,a)):bo(e,t,o,a),t.memoizedState=r.state,s&&Ls(t,n,!0),t.child}function jo(e){var t=e.stateNode;t.pendingContext?Ps(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ps(0,t.context,!1),$a(e,t.containerInfo)}function Ao(e,t,n,r,s){return fa(),ma(s),t.flags|=256,bo(e,t,n,r),t.child}var Io,Do,Ro,Po,Oo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,s=t.pendingProps,i=Za.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ts(Za,1&i),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,s,0,null),e=Oc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Oo,e):Fo(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,s,i,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Mc({mode:"visible",children:r.children},s,0,null),(i=Oc(i,s,o,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&ba(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Oo,i);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=co(i=Error(a(419)),r,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(r=jl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Pa(e,s),nc(r,e,s,-1))}return pc(),Uo(e,t,o,r=co(Error(a(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ra=cs(s.nextSibling),na=t,sa=!0,aa=null,null!==e&&(Ks[Gs++]=Xs,Ks[Gs++]=Qs,Ks[Gs++]=$s,Xs=e.id,Qs=e.overflow,$s=t),t=Fo(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,i,n);if(o){o=s.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Rc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==r?o=Rc(r,o):(o=Oc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Oo,s}return e=(o=e.child).sibling,s=Rc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Fo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&ma(r),ba(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Wo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ea(e.return,t,n)}function zo(e,t,n,r,s){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Bo(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=Za.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Wo(e,n,t);else if(19===e.tag)Wo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ts(Za,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),zo(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ei(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}zo(t,!0,n,null,a);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qo(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Yo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(t),null;case 1:case 17:return Ds(t.type)&&Rs(),Yo(t),null;case 3:return r=t.stateNode,Xa(),Ss(js),Ss(Es),ni(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ic(aa),aa=null))),Do(e,t),Yo(t),null;case 5:Ja(t);var s=Ga(Ka.current);if(n=t.type,null!==e&&null!=t.stateNode)Ro(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Yo(t),null}if(e=Ga(qa.current),ua(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[hs]=t,r[fs]=i,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(s=0;s<Or.length;s++)Ur(Or[s],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":X(r,i),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ur("invalid",r);break;case"textarea":se(r,i),Ur("invalid",r)}for(var l in xe(n,i),s=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":Y(r),Z(r,i,!0);break;case"textarea":Y(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[fs]=r,Io(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),s=r;break;case"iframe":case"object":case"embed":Ur("load",e),s=r;break;case"video":case"audio":for(s=0;s<Or.length;s++)Ur(Or[s],e);s=r;break;case"source":Ur("error",e),s=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),s=r;break;case"details":Ur("toggle",e),s=r;break;case"input":X(e,r),s=$(e,r),Ur("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=L({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Ur("invalid",e)}for(i in xe(n,s),c=s)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Ur("scroll",e):null!=d&&y(e,i,d,l))}switch(n){case"input":Y(e),Z(e,r,!1);break;case"textarea":Y(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yo(t),null;case 6:if(e&&null!=t.stateNode)Po(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ga(Ka.current),Ga(qa.current),ua(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(i=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Yo(t),null;case 13:if(Ss(Za),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sa&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),fa(),t.flags|=98560,i=!1;else if(i=ua(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[hs]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yo(t),i=!1}else null!==aa&&(ic(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Pl&&(Pl=3):pc())),null!==t.updateQueue&&(t.flags|=4),Yo(t),null);case 4:return Xa(),Do(e,t),null===e&&Br(t.stateNode.containerInfo),Yo(t),null;case 10:return Ca(t.type._context),Yo(t),null;case 19:if(Ss(Za),null===(i=t.memoizedState))return Yo(t),null;if(r=0!==(128&t.flags),null===(l=i.rendering))if(r)qo(i,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,qo(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ts(Za,1&Za.current|2),t.child}e=e.sibling}null!==i.tail&&Qe()>Bl&&(t.flags|=128,r=!0,qo(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ei(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!sa)return Yo(t),null}else 2*Qe()-i.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,qo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=Za.current,Ts(Za,r?1&n|2:1&n),t):(Yo(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Yo(t),6&t.subtreeFlags&&(t.flags|=8192)):Yo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Go(e,t){switch(ta(t),t.tag){case 1:return Ds(t.type)&&Rs(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xa(),Ss(js),Ss(Es),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Ss(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ss(Za),null;case 4:return Xa(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Ro=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ga(qa.current);var a,i=null;switch(n){case"input":s=$(e,s),r=$(e,r),i=[];break;case"select":s=L({},s,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":s=re(e,s),r=re(e,r),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in xe(n,r),n=null,s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&null!=s[d])if("style"===d){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=s?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ur("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Po=function(e,t,n,r){n!==r&&(t.flags|=4)};var $o=!1,Xo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_c(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){_c(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,void 0!==a&&el(t,n,a)}s=s.next}while(s!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[fs],delete t[ps],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Xo||Zo(n,t);case 6:var r=dl,s=ul;dl=null,hl(e,t,n),ul=s,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Bt(e)):ls(dl,n.stateNode));break;case 4:r=dl,s=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=s;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&el(n,t,i),s=s.next}while(s!==r)}hl(e,t,n);break;case 1:if(!Xo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){_c(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Xo=(r=Xo)||null!==n.memoizedState,hl(e,t,n),Xo=r):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach((function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(a(160));fl(i,o,s),dl=null,ul=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(d){_c(s,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){_c(e,e.return,g)}try{nl(5,e,e.return)}catch(g){_c(e,e.return,g)}}break;case 1:pl(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(pl(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){_c(e,e.return,g)}}if(4&r&&null!=(s=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Q(s,i),ye(l,o);var d=ye(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(s,h):"dangerouslySetInnerHTML"===u?ue(s,h):"children"===u?he(s,h):y(s,u,h,d)}switch(l){case"input":J(s,i);break;case"textarea":ae(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?ne(s,!!i.multiple,m,!1):f!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[fs]=i}catch(g){_c(e,e.return,g)}}break;case 6:if(pl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(a(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){_c(e,e.return,g)}}break;case 3:if(pl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){_c(e,e.return,g)}break;case 4:default:pl(t,e),vl(e);break;case 13:pl(t,e),vl(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(zl=Qe())),4&r&&ml(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Xo=(d=Xo)||u,pl(t,e),Xo=d):pl(t,e),vl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Jo=e,u=e.child;null!==u;){for(h=Jo=u;null!==Jo;){switch(m=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){_c(r,n,g)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wl(h);continue}}null!==m?(m.return=f,Jo=m):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{s=h.stateNode,d?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(g){_c(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){_c(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),vl(e),4&r&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),cl(e,ol(e),s);break;case 3:case 4:var i=r.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(a(161))}}catch(o){_c(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){Jo=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==Jo;){var s=Jo,a=s.child;if(22===s.tag&&r){var i=null!==s.memoizedState||$o;if(!i){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=$o;var c=Xo;if($o=i,(Xo=l)&&!c)for(Jo=s;null!==Jo;)l=(i=Jo).child,22===i.tag&&null!==i.memoizedState?Nl(s):null!==l?(l.return=i,Jo=l):Nl(s);for(;null!==a;)Jo=a,yl(a,t,n),a=a.sibling;Jo=s,$o=o,Xo=c}bl(e)}else 0!==(8772&s.subtreeFlags)&&null!==a?(a.return=s,Jo=a):bl(e)}}function bl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xo)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ha(t,i,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ha(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(a(163))}Xo||512&t.flags&&sl(t)}catch(f){_c(t,t.return,f)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function Nl(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){_c(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(l){_c(t,s,l)}}var a=t.return;try{sl(t)}catch(l){_c(t,a,l)}break;case 5:var i=t.return;try{sl(t)}catch(l){_c(t,i,l)}}}catch(l){_c(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var kl,_l=Math.ceil,Sl=b.ReactCurrentDispatcher,Tl=b.ReactCurrentOwner,Cl=b.ReactCurrentBatchConfig,El=0,jl=null,Al=null,Il=0,Dl=0,Rl=_s(0),Pl=0,Ol=null,Ml=0,Ll=0,Fl=0,Ul=null,Wl=null,zl=0,Bl=1/0,Hl=null,Vl=!1,ql=null,Yl=null,Kl=!1,Gl=null,$l=0,Xl=0,Ql=null,Jl=-1,Zl=0;function ec(){return 0!==(6&El)?Qe():-1!==Jl?Jl:Jl=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Il?Il&-Il:null!==pa.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,n,r){if(50<Xl)throw Xl=0,Ql=null,Error(a(185));vt(e,n,r),0!==(2&El)&&e===jl||(e===jl&&(0===(2&El)&&(Ll|=n),4===Pl&&oc(e,Il)),rc(e,r),1===n&&0===El&&0===(1&t.mode)&&(Bl=Qe()+500,Us&&Bs()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),o=1<<i,l=s[i];-1===l?0!==(o&n)&&0===(o&r)||(s[i]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===jl?Il:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Us=!0,zs(e)}(lc.bind(null,e)):zs(lc.bind(null,e)),is((function(){0===(6&El)&&Bs()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=jc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Jl=-1,Zl=0,0!==(6&El))throw Error(a(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=ht(e,e===jl?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var s=El;El|=2;var i=mc();for(jl===e&&Il===t||(Hl=null,Bl=Qe()+500,hc(e,t));;)try{xc();break}catch(l){fc(e,l)}Ta(),Sl.current=i,El=s,null!==Al?t=0:(jl=null,Il=0,t=Pl)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(r=s,t=ac(e,s))),1===t)throw n=Ol,hc(e,0),oc(e,r),rc(e,Qe()),n;if(6===t)oc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!or(a(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,r))&&(0!==(i=mt(e))&&(r=i,t=ac(e,i))),1===t))throw n=Ol,hc(e,0),oc(e,r),rc(e,Qe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Wl,Hl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=zl+500-Qe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(wc.bind(null,e,Wl,Hl),t);break}wc(e,Wl,Hl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-it(r);i=1<<o,(o=t[o])>s&&(s=o),r&=~i}if(r=s,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_l(r/1960))-r)){e.timeoutHandle=rs(wc.bind(null,e,Wl,Hl),r);break}wc(e,Wl,Hl);break;default:throw Error(a(329))}}}return rc(e,Qe()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Wl,Wl=n,null!==t&&ic(t)),e}function ic(e){null===Wl?Wl=e:Wl.push.apply(Wl,e)}function oc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&El))throw Error(a(327));Nc();var t=ht(e,0);if(0===(1&t))return rc(e,Qe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ol,hc(e,0),oc(e,t),rc(e,Qe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Wl,Hl),rc(e,Qe()),null}function cc(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(Bl=Qe()+500,Us&&Bs())}}function dc(e){null!==Gl&&0===Gl.tag&&0===(6&El)&&Nc();var t=El;El|=1;var n=Cl.transition,r=yt;try{if(Cl.transition=null,yt=1,e)return e()}finally{yt=r,Cl.transition=n,0===(6&(El=t))&&Bs()}}function uc(){Dl=Rl.current,Ss(Rl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Rs();break;case 3:Xa(),Ss(js),Ss(Es),ni();break;case 5:Ja(r);break;case 4:Xa();break;case 13:case 19:Ss(Za);break;case 10:Ca(r.type._context);break;case 22:case 23:uc()}n=n.return}if(jl=e,Al=e=Rc(e.current,null),Il=Dl=t,Pl=0,Ol=null,Fl=Ll=Ml=0,Wl=Ul=null,null!==Ia){for(t=0;t<Ia.length;t++)if(null!==(r=(n=Ia[t]).interleaved)){n.interleaved=null;var s=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=s,r.next=i}n.pending=r}Ia=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Ta(),ri.current=Qi,ci){for(var r=ii.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ci=!1}if(ai=0,li=oi=ii=null,di=!1,ui=0,Tl.current=null,null===n||null===n.return){Pl=1,Ol=t,Al=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&po(i,d,t),c=d;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){po(i,d,t),pc();break e}c=Error(a(426))}else if(sa&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),ma(lo(c,l));break e}}i=c=lo(c,l),4!==Pl&&(Pl=2),null===Ul?Ul=[i]:Ul.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,za(i,fo(0,c,t));break e;case 1:l=c;var x=i.type,y=i.stateNode;if(0===(128&i.flags)&&("function"===typeof x.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Yl||!Yl.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,za(i,mo(i,l,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(b){t=b,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=Qi,null===e?Qi:e}function pc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===jl||0===(268435455&Ml)&&0===(268435455&Ll)||oc(jl,Il)}function gc(e,t){var n=El;El|=2;var r=mc();for(jl===e&&Il===t||(Hl=null,hc(e,t));;)try{vc();break}catch(s){fc(e,s)}if(Ta(),El=n,Sl.current=r,null!==Al)throw Error(a(261));return jl=null,Il=0,Pl}function vc(){for(;null!==Al;)yc(Al)}function xc(){for(;null!==Al&&!$e();)yc(Al)}function yc(e){var t=kl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bc(e):Al=t,Tl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Dl)))return void(Al=n)}else{if(null!==(n=Go(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Pl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Pl&&(Pl=5)}function wc(e,t,n){var r=yt,s=Cl.transition;try{Cl.transition=null,yt=1,function(e,t,n,r){do{Nc()}while(null!==Gl);if(0!==(6&El))throw Error(a(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}(e,i),e===jl&&(Al=jl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,jc(tt,(function(){return Nc(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Cl.transition,Cl.transition=null;var o=yt;yt=1;var l=El;El|=4,Tl.current=null,function(e,t){if(es=Vt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==i||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++d===s&&(l=o),f===i&&++u===r&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Vt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(w){_c(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}p=tl,tl=!1}(e,n),gl(n,e),mr(ts),Vt=!!es,ts=es=null,e.current=n,xl(n,e,s),Xe(),El=l,yt=o,Cl.transition=i}else e.current=n;if(Kl&&(Kl=!1,Gl=e,$l=s),i=e.pendingLanes,0===i&&(Yl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Vl)throw Vl=!1,e=ql,ql=null,e;0!==(1&$l)&&0!==e.tag&&Nc(),i=e.pendingLanes,0!==(1&i)?e===Ql?Xl++:(Xl=0,Ql=e):Xl=0,Bs()}(e,t,n,r)}finally{Cl.transition=s,yt=r}return null}function Nc(){if(null!==Gl){var e=bt($l),t=Cl.transition,n=yt;try{if(Cl.transition=null,yt=16>e?16:e,null===Gl)var r=!1;else{if(e=Gl,Gl=null,$l=0,0!==(6&El))throw Error(a(331));var s=El;for(El|=4,Jo=e.current;null!==Jo;){var i=Jo,o=i.child;if(0!==(16&Jo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Jo=d;null!==Jo;){var u=Jo;switch(u.tag){case 0:case 11:case 15:nl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Jo=h;else for(;null!==Jo;){var f=(u=Jo).sibling,m=u.return;if(al(u),u===d){Jo=null;break}if(null!==f){f.return=m,Jo=f;break}Jo=m}}}var p=i.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(i=Jo).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var x=i.sibling;if(null!==x){x.return=i.return,Jo=x;break e}Jo=i.return}}var y=e.current;for(Jo=y;null!==Jo;){var b=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Jo=b;else e:for(o=y;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(N){_c(l,l.return,N)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(El=s,Bs(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(st,e)}catch(N){}r=!0}return r}finally{yt=n,Cl.transition=t}}return!1}function kc(e,t,n){e=Ua(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function _c(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yl||!Yl.has(r))){t=Ua(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,jl===e&&(Il&n)===n&&(4===Pl||3===Pl&&(130023424&Il)===Il&&500>Qe()-zl?hc(e,0):Fl|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Pa(e,t))&&(vt(e,t,n),rc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Tc(e,n)}function jc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,r,s,i){var o=2;if(r=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case k:return Oc(n.children,s,i,t);case _:o=8,s|=8;break;case S:return(e=Ic(12,n,t,2|s)).elementType=S,e.lanes=i,e;case j:return(e=Ic(13,n,t,s)).elementType=j,e.lanes=i,e;case A:return(e=Ic(19,n,t,s)).elementType=A,e.lanes=i,e;case R:return Mc(n,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case C:o=9;break e;case E:o=11;break e;case I:o=14;break e;case D:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ic(o,n,t,s)).elementType=e,t.type=r,t.lanes=i,t}function Oc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wc(e,t,n,r,s,a,i,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ic(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(a),e}function zc(e){if(!e)return Cs;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ds(n))return Os(e,n,t)}return t}function Bc(e,t,n,r,s,a,i,o,l){return(e=Wc(n,r,!0,e,0,a,0,o,l)).context=zc(null),n=e.current,(a=Fa(r=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,s),e.current.lanes=s,vt(e,s,r),rc(e,r),e}function Hc(e,t,n,r){var s=t.current,a=ec(),i=tc(s);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(s,t,i))&&(nc(e,s,i,a),Wa(e,s,i)),i}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||js.current)yo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yo=!1,function(e,t,n){switch(t.tag){case 3:jo(t),fa();break;case 5:Qa(t);break;case 1:Ds(t.type)&&Ms(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ts(Na,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ts(Za,1&Za.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Ts(Za,1&Za.current),null!==(e=Vo(e,t,n))?e.sibling:null);Ts(Za,1&Za.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ts(Za,Za.current),r)break;return null;case 22:case 23:return t.lanes=0,_o(e,t,n)}return Vo(e,t,n)}(e,t,n);yo=0!==(131072&e.flags)}else yo=!1,sa&&0!==(1048576&t.flags)&&Zs(t,Ys,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var s=Is(t,Es.current);ja(t,n),s=pi(null,t,r,e,s,n);var i=gi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ds(r)?(i=!0,Ms(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Ma(t),s.updater=ro,t.stateNode=s,s._reactInternals=t,oo(t,r,e,n),t=Eo(null,t,r,!0,i,n)):(t.tag=0,sa&&i&&ea(t),bo(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===I)return 14}return 2}(r),e=to(r,e),s){case 0:t=To(null,t,r,e,n);break e;case 1:t=Co(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=No(null,t,r,to(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,To(e,t,r,s=t.elementType===r?s:to(r,s),n);case 1:return r=t.type,s=t.pendingProps,Co(e,t,r,s=t.elementType===r?s:to(r,s),n);case 3:e:{if(jo(t),null===e)throw Error(a(387));r=t.pendingProps,s=(i=t.memoizedState).element,La(e,t),Ba(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ao(e,t,r,n,s=lo(Error(a(423)),t));break e}if(r!==s){t=Ao(e,t,r,n,s=lo(Error(a(424)),t));break e}for(ra=cs(t.stateNode.containerInfo.firstChild),na=t,sa=!0,aa=null,n=wa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===s){t=Vo(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return Qa(t),null===e&&ca(t),r=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==i&&ns(r,i)&&(t.flags|=32),So(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Lo(e,t,n);case 4:return $a(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ba(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,wo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ts(Na,r._currentValue),r._currentValue=o,null!==i)if(or(i.value,o)){if(i.children===s.children&&!js.current){t=Vo(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Fa(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ea(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ea(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}bo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ja(t,n),r=r(s=Aa(s)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return s=to(r=t.type,t.pendingProps),No(e,t,r,s=to(r.type,s),n);case 15:return ko(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:to(r,s),Ho(e,t),t.tag=1,Ds(r)?(e=!0,Ms(t)):e=!1,ja(t,n),ao(t,r,s),oo(t,r,s,n),Eo(null,t,r,!0,e,n);case 19:return Bo(e,t,n);case 22:return _o(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof s){var o=s;s=function(){var e=Vc(i);o.call(e)}}Hc(t,i,e,s)}else i=function(e,t,n,r,s){if(s){if("function"===typeof r){var a=r;r=function(){var e=Vc(i);a.call(e)}}var i=Bc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=i,e[ms]=i.current,Br(8===e.nodeType?e.parentNode:e),dc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Vc(l);o.call(e)}}var l=Wc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[ms]=l.current,Br(8===e.nodeType?e.parentNode:e),dc((function(){Hc(t,l,n,r)})),l}(n,t,e,s,r);return Vc(i)}$c.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Hc(e,t,null,null)},$c.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Hc(null,e,null,null)})),t[ms]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(xt(t,1|n),rc(t,Qe()),0===(6&El)&&(Bl=Qe()+500,Bs()))}break;case 13:dc((function(){var t=Pa(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Yc(e,1)}},Nt=function(e){if(13===e.tag){var t=Pa(e,134217728);if(null!==t)nc(t,e,134217728,ec());Yc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),n=Pa(e,t);if(null!==n)nc(n,e,t,ec());Yc(e,t)}},_t=function(){return yt},St=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Ne=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(a(90));K(r),J(r,s)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,je=dc;var ed={usingClientEntryPoint:!1,Events:[ys,bs,ws,Te,Ce,cc]},td={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{st=rd.inject(nd),at=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:N,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var n=!1,r="",s=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Wc(e,1,!1,null,0,n,0,r,s),e[ms]=t.current,Br(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,s=!1,i="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,s,0,i,o),e[ms]=t.current,Br(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new $c(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[ms]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{"use strict";var r=n(119);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},378:(e,t,n)=>{var r=n(759);e.exports=function(){return r.Date.now()}},414:(e,t,n)=>{"use strict";e.exports=n(654)},491:(e,t,n)=>{var r=n(567),s=n(378),a=n(588),i=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,d,u,h,f,m=0,p=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function x(t){var n=l,r=c;return l=c=void 0,m=t,u=e.apply(r,n)}function y(e){var n=e-f;return void 0===f||n>=t||n<0||g&&e-m>=d}function b(){var e=s();if(y(e))return w(e);h=setTimeout(b,function(e){var n=t-(e-f);return g?o(n,d-(e-m)):n}(e))}function w(e){return h=void 0,v&&l?x(e):(l=c=void 0,u)}function N(){var e=s(),n=y(e);if(l=arguments,c=this,f=e,n){if(void 0===h)return function(e){return m=e,h=setTimeout(b,t),p?x(e):u}(f);if(g)return clearTimeout(h),h=setTimeout(b,t),x(f)}return void 0===h&&(h=setTimeout(b,t)),u}return t=a(t)||0,r(n)&&(p=!!n.leading,d=(g="maxWait"in n)?i(a(n.maxWait)||0,t):d,v="trailing"in n?!!n.trailing:v),N.cancel=function(){void 0!==h&&clearTimeout(h),m=0,l=f=c=h=void 0},N.flush=function(){return void 0===h?u:w(s())},N}},526:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.d(t,{A:()=>s})},567:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},578:(e,t,n)=>{"use strict";n.d(t,{C3:()=>Ts,AU:()=>ws,Zy:()=>bs,KR:()=>ps});var r=n(913),s=n(253),a=n(170),i=n(624);const o="@firebase/database",l="1.0.19";let c="";function d(e){c=e}class u{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,a.As)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,a.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class h{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,a.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const f=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new u(t)}}catch(t){}return new h},m=f("localStorage"),p=f("sessionStorage"),g=new i.Vy("@firebase/database"),v=function(){let e=1;return function(){return e++}}(),x=function(e){const t=(0,a.kj)(e),n=new a.gz;n.update(t);const r=n.digest();return a.K3.encodeByteArray(r)},y=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=y.apply(null,n):e+="object"===typeof n?(0,a.As)(n):n,e+=" "}return e};let b=null,w=!0;const N=function(e,t){(0,a.vA)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(g.logLevel=i.$b.VERBOSE,b=g.log.bind(g),t&&p.set("logging_enabled",!0)):"function"===typeof e?b=e:(b=null,p.remove("logging_enabled"))},k=function(){if(!0===w&&(w=!1,null===b&&!0===p.get("logging_enabled")&&N(!0)),b){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=y.apply(null,t);b(r)}},_=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];k(e,...n)}},S=function(){const e="FIREBASE INTERNAL ERROR: "+y(...arguments);g.error(e)},T=function(){const e="FIREBASE FATAL ERROR: ".concat(y(...arguments));throw g.error(e),new Error(e)},C=function(){const e="FIREBASE WARNING: "+y(...arguments);g.warn(e)},E=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},j="[MIN_NAME]",A="[MAX_NAME]",I=function(e,t){if(e===t)return 0;if(e===j||t===A)return-1;if(t===j||e===A)return 1;{const n=U(e),r=U(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},D=function(e,t){return e===t?0:e<t?-1:1},R=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,a.As)(t))},P=function(e){if("object"!==typeof e||null===e)return(0,a.As)(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=(0,a.As)(t[r]),n+=":",n+=P(e[t[r]]);return n+="}",n},O=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let s=0;s<n;s+=t)s+t>n?r.push(e.substring(s,n)):r.push(e.substring(s,s+t));return r};function M(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const L=function(e){(0,a.vA)(!E(e),"Invalid JSON number");const t=1023;let n,r,s,i,o;0===e?(r=0,s=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=i+t,s=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,s=Math.round(e/Math.pow(2,-1074))));const l=[];for(o=52;o;o-=1)l.push(s%2?1:0),s=Math.floor(s/2);for(o=11;o;o-=1)l.push(r%2?1:0),r=Math.floor(r/2);l.push(n?1:0),l.reverse();const c=l.join("");let d="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),d+=e}return d.toLowerCase()};const F=new RegExp("^-?(0*)\\d{1,10}$"),U=function(e){if(F.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},W=function(e){try{e()}catch(t){setTimeout((()=>{const e=t.stack||"";throw C("Exception was thrown by user callback.",e),t}),Math.floor(0))}},z=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class B{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,(0,r.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){C('Provided AppCheck credentials for the app named "'.concat(this.appName,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class H{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(k("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(e)}}class V{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}V.OWNER="owner";const q="5",Y=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,K="ac",G="websocket",$="long_polling";class X{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=i,this.isUsingEmulator=o,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=m.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&m.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function Q(e,t,n){let r;if((0,a.vA)("string"===typeof t,"typeof type must == string"),(0,a.vA)("object"===typeof n,"typeof params must == object"),t===G)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==$)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const s=[];return M(n,((e,t)=>{s.push(e+"="+t)})),r+s.join("&")}class J{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,a.A4)(this.counters_)}}const Z={},ee={};function te(e){const t=e.toString();return Z[t]||(Z[t]=new J),Z[t]}class ne{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&W((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const re="start";class se{constructor(e,t,n,r,s,a,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.transportSessionId=a,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=_(e),this.stats_=te(t),this.urlFn=e=>(this.appCheckToken&&(e[K]=this.appCheckToken),Q(t,$,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ne(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if((0,a.$g)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ae((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[s,a,i,o,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,s===re)n.id=a,n.password=i;else{if("close"!==s)throw new Error("Unrecognized command received: "+s);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[s,a]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(s,a)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[re]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=q,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[K]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Y.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){se.forceAllow_=!0}static forceDisallow(){se.forceDisallow_=!0}static isAvailable(){return!(0,a.$g)()&&(!!se.forceAllow_||!se.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,a.KA)(t),r=O(n,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,a.$g)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,a.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ae{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,a.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ae.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(s){k("frame writing exception"),s.stack&&k(s.stack),k(s)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||k("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){(0,a.$g)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{k("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let ie=null;"undefined"!==typeof MozWebSocket?ie=MozWebSocket:"undefined"!==typeof WebSocket&&(ie=WebSocket);class oe{constructor(e,t,n,r,s,a,i){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=_(this.connId),this.stats_=te(t),this.connURL=oe.connectionURL_(t,a,i,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,s){const i={};return i.v=q,!(0,a.$g)()&&"undefined"!==typeof location&&location.hostname&&Y.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i[K]=r),s&&(i.p=s),Q(e,G,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,m.set("previous_websocket_failure",!0);try{let e;if((0,a.$g)()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(q,"/").concat(c,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new ie(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){oe.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ie&&!oe.forceDisallow_}static previouslyFailed(){return m.isInMemoryStorage||!0===m.get("previous_websocket_failure")}markConnectionHealthy(){m.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,a.$L)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,a.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=O(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}oe.responsesRequiredToBeHealthy=2,oe.healthyTimeout=3e4;class le{static get ALL_TRANSPORTS(){return[se,oe]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=oe&&oe.isAvailable();let n=t&&!oe.previouslyFailed();if(e.webSocketOnly&&(t||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[oe];else{const e=this.transports_=[];for(const t of le.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);le.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}le.globalTransportInitialized_=!1;class ce{constructor(e,t,n,r,s,a,i,o,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=a,this.onReady_=i,this.onDisconnect_=o,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=_("c:"+this.id+":"),this.transportManager_=new le(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=z((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=R("t",e),n=R("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=R("t",e),n=R("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=R("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?S("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),q!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),z((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):z((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(m.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class de{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class ue{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,a.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<s.length;e++)s[e].callback.apply(s[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!n||n===r[s].context))return void r.splice(s,1)}validateEventType_(e){(0,a.vA)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class he extends ue{static getInstance(){return new he}constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,a.jZ)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}getInitialEvent(e){return(0,a.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class fe{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function me(){return new fe("")}function pe(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ge(e){return e.pieces_.length-e.pieceNum_}function ve(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new fe(e.pieces_,t)}function xe(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function be(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new fe(t,0)}function we(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof fe)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new fe(n,0)}function Ne(e){return e.pieceNum_>=e.pieces_.length}function ke(e,t){const n=pe(e),r=pe(t);if(null===n)return t;if(n===r)return ke(ve(e),ve(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function _e(e,t){if(ge(e)!==ge(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Se(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(ge(e)>ge(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Te{constructor(e,t){this.errorPrefix_=t,this.parts_=ye(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,a.OE)(this.parts_[n]);Ce(this)}}function Ce(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ee(e))}function Ee(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class je extends ue{static getInstance(){return new je}constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}getInitialEvent(e){return(0,a.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ae=1e3;class Ie extends de{constructor(e,t,n,r,s,i,o,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=i,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=Ie.nextPersistentConnectionId_++,this.log_=_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ae,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,a.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");je.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&he.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,s={r:r,a:e,b:t};this.log_((0,a.As)(s)),(0,a.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new a.cY,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const s=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+s),this.listens.has(i)||this.listens.set(i,new Map),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,a.vA)(!this.listens.get(i).has(s),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(i).set(s,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const s={p:n};e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,(s=>{const a=s.d,i=s.s;Ie.warnOnListenWarnings_(a,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",s),"ok"!==i&&this.removeListen_(n,r),e.onComplete&&e.onComplete(i,a))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&(0,a.gR)(e,"w")){const n=(0,a.yw)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();C("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,a.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,a.Cv)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const s={p:e};r&&(s.q=n,s.t=r),this.sendRequest("n",s)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const s={p:t,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,s){this.initConnection_();const a={p:t,d:n};void 0!==s&&(a.h=s),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;const i=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(i):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,a.As)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):S("Unrecognized action received from server: "+(0,a.As)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,a.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ae,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ae,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ae),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Ie.nextConnectionId_++,s=this.lastSessionId;let i=!1,o=null;const l=function(){o?o.close():(i=!0,n())},c=function(e){(0,a.vA)(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:l,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);i?k("getToken() completed but was canceled"):(k("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new ce(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{C(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),s))}catch(S){this.log_("Failed to get token: "+S),i||(this.repoInfo_.nodeAdmin&&C(S),l())}}}interrupt(e){k("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){k("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,a.Im)(this.interruptReasons_)&&(this.reconnectDelay_=Ae,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>P(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new fe(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){k("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){k("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,a.$g)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+c.replace(/\./g,"-")]=1,(0,a.jZ)()?e["framework.cordova"]=1:(0,a.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=he.getInstance().currentlyOnline();return(0,a.Im)(this.interruptReasons_)&&e}}Ie.nextPersistentConnectionId_=0,Ie.nextConnectionId_=0;class De{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new De(e,t)}}class Re{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new De(j,e),r=new De(j,t);return 0!==this.compare(n,r)}minPost(){return De.MIN}}let Pe;class Oe extends Re{static get __EMPTY_NODE(){return Pe}static set __EMPTY_NODE(e){Pe=e}compare(e,t){return I(e.name,t.name)}isDefinedOn(e){throw(0,a.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return De.MIN}maxPost(){return new De(A,Pe)}makePost(e,t){return(0,a.vA)("string"===typeof e,"KeyIndex indexValue must always be a string."),new De(e,Pe)}toString(){return".key"}}const Me=new Oe;class Le{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,r&&(a*=-1),a<0)e=this.isReverse_?e.left:e.right;else{if(0===a){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Fe{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:Fe.RED,this.left=null!=r?r:Ue.EMPTY_NODE,this.right=null!=s?s:Ue.EMPTY_NODE}copy(e,t,n,r,s){return new Fe(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ue.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Ue.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Fe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Fe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Fe.RED=!0,Fe.BLACK=!1;class Ue{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Ue(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Fe.BLACK,null,null))}remove(e){return new Ue(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fe.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Le(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Le(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Le(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Le(this.root_,null,this.comparator_,!0,e)}}function We(e,t){return I(e.name,t.name)}function ze(e,t){return I(e,t)}let Be;Ue.EMPTY_NODE=new class{copy(e,t,n,r,s){return this}insert(e,t,n){return new Fe(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const He=function(e){return"number"===typeof e?"number:"+L(e):"string:"+e},Ve=function(e){if(e.isLeafNode()){const t=e.val();(0,a.vA)("string"===typeof t||"number"===typeof t||"object"===typeof t&&(0,a.gR)(t,".sv"),"Priority must be a string or number.")}else(0,a.vA)(e===Be||e.isEmpty(),"priority of unexpected type.");(0,a.vA)(e===Be||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let qe,Ye,Ke;class Ge{static set __childrenNodeConstructor(e){qe=e}static get __childrenNodeConstructor(){return qe}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ge.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,a.vA)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ve(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ge(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Ge.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ne(e)?this:".priority"===pe(e)?this.priorityNode_:Ge.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Ge.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=pe(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,a.vA)(".priority"!==n||1===ge(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Ge.__childrenNodeConstructor.EMPTY_NODE.updateChild(ve(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+He(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?L(this.value_):this.value_,this.lazyHash_=x(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ge.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ge.__childrenNodeConstructor?-1:((0,a.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Ge.VALUE_TYPE_ORDER.indexOf(t),s=Ge.VALUE_TYPE_ORDER.indexOf(n);return(0,a.vA)(r>=0,"Unknown leaf type: "+t),(0,a.vA)(s>=0,"Unknown leaf type: "+n),r===s?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Ge.VALUE_TYPE_ORDER=["object","boolean","number","string"];const $e=new class extends Re{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),s=n.compareTo(r);return 0===s?I(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return De.MIN}maxPost(){return new De(A,new Ge("[PRIORITY-POST]",Ke))}makePost(e,t){const n=Ye(e);return new De(t,new Ge("[PRIORITY-POST]",n))}toString(){return".priority"}},Xe=Math.log(2);class Qe{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Xe,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Je=function(e,t,n,r){e.sort(t);const s=function(t,r){const a=r-t;let i,o;if(0===a)return null;if(1===a)return i=e[t],o=n?n(i):i,new Fe(o,i.node,Fe.BLACK,null,null);{const l=parseInt(a/2,10)+t,c=s(t,l),d=s(l+1,r);return i=e[l],o=n?n(i):i,new Fe(o,i.node,Fe.BLACK,c,d)}},a=function(t){let r=null,a=null,i=e.length;const o=function(t,r){const a=i-t,o=i;i-=t;const c=s(a+1,o),d=e[a],u=n?n(d):d;l(new Fe(u,d.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(a=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?o(r,Fe.BLACK):(o(r,Fe.BLACK),o(r,Fe.RED))}return a}(new Qe(e.length));return new Ue(r||t,a)};let Ze;const et={};class tt{static get Default(){return(0,a.vA)(et&&$e,"ChildrenNode.ts has not been loaded"),Ze=Ze||new tt({".priority":et},{".priority":$e}),Ze}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=(0,a.yw)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ue?t:null}hasIndex(e){return(0,a.gR)(this.indexSet_,e.toString())}addIndex(e,t){(0,a.vA)(e!==Me,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const s=t.getIterator(De.Wrap);let i,o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=s.getNext();i=r?Je(n,e.getCompare()):et;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const d=Object.assign({},this.indexes_);return d[l]=i,new tt(d,c)}addToIndexes(e,t){const n=(0,a.kH)(this.indexes_,((n,r)=>{const s=(0,a.yw)(this.indexSet_,r);if((0,a.vA)(s,"Missing index implementation for "+r),n===et){if(s.isDefinedOn(e.node)){const n=[],r=t.getIterator(De.Wrap);let a=r.getNext();for(;a;)a.name!==e.name&&n.push(a),a=r.getNext();return n.push(e),Je(n,s.getCompare())}return et}{const r=t.get(e.name);let s=n;return r&&(s=s.remove(new De(e.name,r))),s.insert(e,e.node)}}));return new tt(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,a.kH)(this.indexes_,(n=>{if(n===et)return n;{const r=t.get(e.name);return r?n.remove(new De(e.name,r)):n}}));return new tt(n,this.indexSet_)}}let nt;class rt{static get EMPTY_NODE(){return nt||(nt=new rt(new Ue(ze),null,tt.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ve(this.priorityNode_),this.children_.isEmpty()&&(0,a.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||nt}updatePriority(e){return this.children_.isEmpty()?this:new rt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?nt:t}}getChild(e){const t=pe(e);return null===t?this:this.getImmediateChild(t).getChild(ve(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,a.vA)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new De(e,t);let r,s;t.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(n,this.children_));const a=r.isEmpty()?nt:this.priorityNode_;return new rt(r,a,s)}}updateChild(e,t){const n=pe(e);if(null===n)return t;{(0,a.vA)(".priority"!==pe(e)||1===ge(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(ve(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,s=!0;if(this.forEachChild($e,((a,i)=>{t[a]=i.val(e),n++,s&&rt.INTEGER_REGEXP_.test(a)?r=Math.max(r,Number(a)):s=!1})),!e&&s&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+He(this.getPriority().val())+":"),this.forEachChild($e,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":x(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new De(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new De(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new De(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,De.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,De.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===st?-1:0}withIndex(e){if(e===Me||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new rt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Me||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator($e),n=t.getIterator($e);let r=e.getNext(),s=n.getNext();for(;r&&s;){if(r.name!==s.name||!r.node.equals(s.node))return!1;r=e.getNext(),s=n.getNext()}return null===r&&null===s}return!1}return!1}}resolveIndex_(e){return e===Me?null:this.indexMap_.get(e.toString())}}rt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const st=new class extends rt{constructor(){super(new Ue(ze),rt.EMPTY_NODE,tt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return rt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(De,{MIN:{value:new De(j,rt.EMPTY_NODE)},MAX:{value:new De(A,st)}}),Oe.__EMPTY_NODE=rt.EMPTY_NODE,Ge.__childrenNodeConstructor=rt,Be=st,function(e){Ke=e}(st);function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return rt.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),(0,a.vA)(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Ge(e,at(t))}if(e instanceof Array){let n=rt.EMPTY_NODE;return M(e,((t,r)=>{if((0,a.gR)(e,t)&&"."!==t.substring(0,1)){const e=at(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(at(t))}{const n=[];let r=!1;if(M(e,((e,t)=>{if("."!==e.substring(0,1)){const s=at(t);s.isEmpty()||(r=r||!s.getPriority().isEmpty(),n.push(new De(e,s)))}})),0===n.length)return rt.EMPTY_NODE;const s=Je(n,We,(e=>e.name),ze);if(r){const e=Je(n,$e.getCompare());return new rt(s,at(t),new tt({".priority":e},{".priority":$e}))}return new rt(s,at(t),tt.Default)}}!function(e){Ye=e}(at);class it extends Re{constructor(e){super(),this.indexPath_=e,(0,a.vA)(!Ne(e)&&".priority"!==pe(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),s=n.compareTo(r);return 0===s?I(e.name,t.name):s}makePost(e,t){const n=at(e),r=rt.EMPTY_NODE.updateChild(this.indexPath_,n);return new De(t,r)}maxPost(){const e=rt.EMPTY_NODE.updateChild(this.indexPath_,st);return new De(A,e)}toString(){return ye(this.indexPath_,0).join("/")}}const ot=new class extends Re{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?I(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return De.MIN}maxPost(){return De.MAX}makePost(e,t){const n=at(e);return new De(t,n)}toString(){return".value"}};function lt(e){return{type:"value",snapshotNode:e}}function ct(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ut(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class ht{constructor(e){this.index_=e}updateChild(e,t,n,r,s,i){(0,a.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=i&&(n.isEmpty()?e.hasChild(t)?i.trackChildChange(dt(t,o)):(0,a.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?i.trackChildChange(ct(t,n)):i.trackChildChange(ut(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild($e,((e,r)=>{t.hasChild(e)||n.trackChildChange(dt(e,r))})),t.isLeafNode()||t.forEachChild($e,((t,r)=>{if(e.hasChild(t)){const s=e.getImmediateChild(t);s.equals(r)||n.trackChildChange(ut(t,r,s))}else n.trackChildChange(ct(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?rt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class ft{constructor(e){this.indexedFilter_=new ht(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ft.getStartPost_(e),this.endPost_=ft.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,s,a){return this.matches(new De(t,n))||(n=rt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,s,a)}updateFullNode(e,t,n){t.isLeafNode()&&(t=rt.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(rt.EMPTY_NODE);const s=this;return t.forEachChild($e,((e,t)=>{s.matches(new De(e,t))||(r=r.updateImmediateChild(e,rt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class mt{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new ft(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,s,a){return this.rangedFilter_.matches(new De(t,n))||(n=rt.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,s,a):this.fullLimitUpdateChild_(e,t,n,s,a)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=rt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=rt.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(rt.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,rt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,s){let i;if(this.reverse_){const e=this.index_.getCompare();i=(t,n)=>e(n,t)}else i=this.index_.getCompare();const o=e;(0,a.vA)(o.numChildren()===this.limit_,"");const l=new De(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(o.hasChild(t)){const e=o.getImmediateChild(t);let a=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=a&&(a.name===t||o.hasChild(a.name));)a=r.getChildAfterChild(this.index_,a,this.reverse_);const u=null==a?1:i(a,l);if(d&&!n.isEmpty()&&u>=0)return null!=s&&s.trackChildChange(ut(t,n,e)),o.updateImmediateChild(t,n);{null!=s&&s.trackChildChange(dt(t,e));const n=o.updateImmediateChild(t,rt.EMPTY_NODE);return null!=a&&this.rangedFilter_.matches(a)?(null!=s&&s.trackChildChange(ct(a.name,a.node)),n.updateImmediateChild(a.name,a.node)):n}}return n.isEmpty()?e:d&&i(c,l)>=0?(null!=s&&(s.trackChildChange(dt(c.name,c.node)),s.trackChildChange(ct(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,rt.EMPTY_NODE)):e}}class pt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:j}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,a.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new pt;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function gt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===$e?n="$priority":e.index_===ot?n="$value":e.index_===Me?n="$key":((0,a.vA)(e.index_ instanceof it,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,a.As)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=(0,a.As)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+(0,a.As)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=(0,a.As)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+(0,a.As)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function vt(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==$e&&(t.i=e.index_.toString()),t}class xt extends de{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,a.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=_("p:rest:"),this.listens_={}}listen(e,t,n,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const i=xt.getListenId_(e,n),o={};this.listens_[i]=o;const l=gt(e._queryParams);this.restRequest_(s+".json",l,((e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(s,l,!1,n),(0,a.yw)(this.listens_,i)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=xt.getListenId_(e,t);delete this.listens_[n]}get(e){const t=gt(e._queryParams),n=e._path.toString(),r=new a.cY;return this.restRequest_(n+".json",t,((e,t)=>{let s=t;404===e&&(s=null,e=null),null===e?(this.onDataUpdate_(n,s,!1,null),r.resolve(s)):r.reject(new Error(s))})),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((r=>{let[s,i]=r;s&&s.accessToken&&(t.auth=s.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,a.Am)(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(n&&4===l.readyState){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let t=null;if(l.status>=200&&l.status<300){try{t=(0,a.$L)(l.responseText)}catch(e){C("Failed to parse JSON response for "+o+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&C("Got unsuccessful REST response for "+o+" Status: "+l.status),n(l.status);n=null}},l.open("GET",o,!0),l.send()}))}}class yt{constructor(){this.rootNode_=rt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function bt(){return{value:null,children:new Map}}function wt(e,t,n){if(Ne(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=pe(t);e.children.has(r)||e.children.set(r,bt());wt(e.children.get(r),t=ve(t),n)}}function Nt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{Nt(r,new fe(t.toString()+"/"+e),n)}))}class kt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&M(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class _t{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new kt(e);const n=1e4+2e4*Math.random();z(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;M(e,((e,r)=>{r>0&&(0,a.gR)(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),z(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var St;function Tt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(St||(St={}));class Ct{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=St.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ne(this.path)){if(null!=this.affectedTree.value)return(0,a.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new fe(e));return new Ct(me(),t,this.revert)}}return(0,a.vA)(pe(this.path)===e,"operationForChild called for unrelated child."),new Ct(ve(this.path),this.affectedTree,this.revert)}}class Et{constructor(e,t){this.source=e,this.path=t,this.type=St.LISTEN_COMPLETE}operationForChild(e){return Ne(this.path)?new Et(this.source,me()):new Et(this.source,ve(this.path))}}class jt{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=St.OVERWRITE}operationForChild(e){return Ne(this.path)?new jt(this.source,me(),this.snap.getImmediateChild(e)):new jt(this.source,ve(this.path),this.snap)}}class At{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=St.MERGE}operationForChild(e){if(Ne(this.path)){const t=this.children.subtree(new fe(e));return t.isEmpty()?null:t.value?new jt(this.source,me(),t.value):new At(this.source,me(),t)}return(0,a.vA)(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new At(this.source,ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class It{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ne(e))return this.isFullyInitialized()&&!this.filtered_;const t=pe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Dt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Rt(e,t,n,r,s,i){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw(0,a.Hk)("Should only compare child_ events.");const r=new De(t.childName,t.snapshotNode),s=new De(n.childName,n.snapshotNode);return e.index_.compare(r,s)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,i);s.forEach((s=>{s.respondsTo(n.type)&&t.push(s.createEvent(r,e.query_))}))}))}function Pt(e,t){return{eventCache:e,serverCache:t}}function Ot(e,t,n,r){return Pt(new It(t,n,r),e.serverCache)}function Mt(e,t,n,r){return Pt(e.eventCache,new It(t,n,r))}function Lt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ft(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Ut;class Wt{static fromObject(e){let t=new Wt(null);return M(e,((e,n)=>{t=t.set(new fe(e),n)})),t}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Ut||(Ut=new Ue(D)),Ut);this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:me(),value:this.value};if(Ne(e))return null;{const n=pe(e),r=this.children.get(n);if(null!==r){const s=r.findRootMostMatchingPathAndValue(ve(e),t);if(null!=s){return{path:we(new fe(n),s.path),value:s.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ne(e))return this;{const t=pe(e),n=this.children.get(t);return null!==n?n.subtree(ve(e)):new Wt(null)}}set(e,t){if(Ne(e))return new Wt(t,this.children);{const n=pe(e),r=(this.children.get(n)||new Wt(null)).set(ve(e),t),s=this.children.insert(n,r);return new Wt(this.value,s)}}remove(e){if(Ne(e))return this.children.isEmpty()?new Wt(null):new Wt(null,this.children);{const t=pe(e),n=this.children.get(t);if(n){const r=n.remove(ve(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new Wt(null):new Wt(this.value,s)}return this}}get(e){if(Ne(e))return this.value;{const t=pe(e),n=this.children.get(t);return n?n.get(ve(e)):null}}setTree(e,t){if(Ne(e))return t;{const n=pe(e),r=(this.children.get(n)||new Wt(null)).setTree(ve(e),t);let s;return s=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Wt(this.value,s)}}fold(e){return this.fold_(me(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,s)=>{n[r]=s.fold_(we(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,me(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Ne(e))return null;{const r=pe(e),s=this.children.get(r);return s?s.findOnPath_(ve(e),we(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,me(),t)}foreachOnPath_(e,t,n){if(Ne(e))return this;{this.value&&n(t,this.value);const r=pe(e),s=this.children.get(r);return s?s.foreachOnPath_(ve(e),we(t,r),n):new Wt(null)}}foreach(e){this.foreach_(me(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(we(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class zt{constructor(e){this.writeTree_=e}static empty(){return new zt(new Wt(null))}}function Bt(e,t,n){if(Ne(t))return new zt(new Wt(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const s=r.path;let a=r.value;const i=ke(s,t);return a=a.updateChild(i,n),new zt(e.writeTree_.set(s,a))}{const r=new Wt(n),s=e.writeTree_.setTree(t,r);return new zt(s)}}}function Ht(e,t,n){let r=e;return M(n,((e,n)=>{r=Bt(r,we(t,e),n)})),r}function Vt(e,t){if(Ne(t))return zt.empty();{const n=e.writeTree_.setTree(t,new Wt(null));return new zt(n)}}function qt(e,t){return null!=Yt(e,t)}function Yt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ke(n.path,t)):null}function Kt(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild($e,((e,n)=>{t.push(new De(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new De(e,n.value))})),t}function Gt(e,t){if(Ne(t))return e;{const n=Yt(e,t);return new zt(null!=n?new Wt(n):e.writeTree_.subtree(t))}}function $t(e){return e.writeTree_.isEmpty()}function Xt(e,t){return Qt(me(),e.writeTree_,t)}function Qt(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,s)=>{".priority"===t?((0,a.vA)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=Qt(we(e,t),s,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(we(e,".priority"),r)),n}}function Jt(e,t){return hn(t,e)}function Zt(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));(0,a.vA)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let s=r.visible,i=!1,o=e.allWrites.length-1;for(;s&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&en(t,r.path)?s=!1:Se(r.path,t.path)&&(i=!0)),o--}if(s){if(i)return function(e){e.visibleWrites=nn(e.allWrites,tn,me()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Vt(e.visibleWrites,r.path);else{M(r.children,(t=>{e.visibleWrites=Vt(e.visibleWrites,we(r.path,t))}))}return!0}return!1}function en(e,t){if(e.snap)return Se(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Se(we(e.path,n),t))return!0;return!1}function tn(e){return e.visible}function nn(e,t,n){let r=zt.empty();for(let s=0;s<e.length;++s){const i=e[s];if(t(i)){const e=i.path;let t;if(i.snap)Se(n,e)?(t=ke(n,e),r=Bt(r,t,i.snap)):Se(e,n)&&(t=ke(e,n),r=Bt(r,me(),i.snap.getChild(t)));else{if(!i.children)throw(0,a.Hk)("WriteRecord should have .snap or .children");if(Se(n,e))t=ke(n,e),r=Ht(r,t,i.children);else if(Se(e,n))if(t=ke(e,n),Ne(t))r=Ht(r,me(),i.children);else{const e=(0,a.yw)(i.children,pe(t));if(e){const n=e.getChild(ve(t));r=Bt(r,me(),n)}}}}}return r}function rn(e,t,n,r,s){if(r||s){const a=Gt(e.visibleWrites,t);if(!s&&$t(a))return n;if(s||null!=n||qt(a,me())){const a=function(e){return(e.visible||s)&&(!r||!~r.indexOf(e.writeId))&&(Se(e.path,t)||Se(t,e.path))};return Xt(nn(e.allWrites,a,t),n||rt.EMPTY_NODE)}return null}{const r=Yt(e.visibleWrites,t);if(null!=r)return r;{const r=Gt(e.visibleWrites,t);if($t(r))return n;if(null!=n||qt(r,me())){return Xt(r,n||rt.EMPTY_NODE)}return null}}}function sn(e,t,n,r){return rn(e.writeTree,e.treePath,t,n,r)}function an(e,t){return function(e,t,n){let r=rt.EMPTY_NODE;const s=Yt(e.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild($e,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const s=Gt(e.visibleWrites,t);return n.forEachChild($e,((e,t)=>{const n=Xt(Gt(s,new fe(e)),t);r=r.updateImmediateChild(e,n)})),Kt(s).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Kt(Gt(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function on(e,t,n,r){return function(e,t,n,r,s){(0,a.vA)(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=we(t,n);if(qt(e.visibleWrites,i))return null;{const t=Gt(e.visibleWrites,i);return $t(t)?s.getChild(n):Xt(t,s.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function ln(e,t){return function(e,t){return Yt(e.visibleWrites,t)}(e.writeTree,we(e.treePath,t))}function cn(e,t,n,r,s,a){return function(e,t,n,r,s,a,i){let o;const l=Gt(e.visibleWrites,t),c=Yt(l,me());if(null!=c)o=c;else{if(null==n)return[];o=Xt(l,n)}if(o=o.withIndex(i),o.isEmpty()||o.isLeafNode())return[];{const e=[],t=i.getCompare(),n=a?o.getReverseIteratorFrom(r,i):o.getIteratorFrom(r,i);let l=n.getNext();for(;l&&e.length<s;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,s,a)}function dn(e,t,n){return function(e,t,n,r){const s=we(t,n),a=Yt(e.visibleWrites,s);if(null!=a)return a;if(r.isCompleteForChild(n))return Xt(Gt(e.visibleWrites,s),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function un(e,t){return hn(we(e.treePath,t),e.writeTree)}function hn(e,t){return{treePath:e,writeTree:t}}class fn{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,a.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,a.vA)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(n,ut(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(n,dt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(n,ct(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,a.Hk)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ut(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const mn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class pn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new It(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ft(this.viewCache_),s=cn(this.writes_,r,t,1,n,e);return 0===s.length?null:s[0]}}function gn(e,t,n,r,s){const i=new fn;let o,l;if(n.type===St.OVERWRITE){const c=n;c.source.fromUser?o=yn(e,t,c.path,c.snap,r,s,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered()&&!Ne(c.path),o=xn(e,t,c.path,c.snap,r,s,l,i))}else if(n.type===St.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,s,a,i){let o=t;return r.foreach(((r,l)=>{const c=we(n,r);bn(t,pe(c))&&(o=yn(e,o,c,l,s,a,i))})),r.foreach(((r,l)=>{const c=we(n,r);bn(t,pe(c))||(o=yn(e,o,c,l,s,a,i))})),o}(e,t,c.path,c.children,r,s,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered(),o=Nn(e,t,c.path,c.children,r,s,l,i))}else if(n.type===St.ACK_USER_WRITE){const l=n;o=l.revert?function(e,t,n,r,s,i){let o;if(null!=ln(r,n))return t;{const l=new pn(r,t,s),c=t.eventCache.getNode();let d;if(Ne(n)||".priority"===pe(n)){let n;if(t.serverCache.isFullyInitialized())n=sn(r,Ft(t));else{const e=t.serverCache.getNode();(0,a.vA)(e instanceof rt,"serverChildren would be complete if leaf node"),n=an(r,e)}d=e.filter.updateFullNode(c,n,i)}else{const s=pe(n);let a=dn(r,s,t.serverCache);null==a&&t.serverCache.isCompleteForChild(s)&&(a=c.getImmediateChild(s)),d=null!=a?e.filter.updateChild(c,s,a,ve(n),l,i):t.eventCache.getNode().hasChild(s)?e.filter.updateChild(c,s,rt.EMPTY_NODE,ve(n),l,i):c,d.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=sn(r,Ft(t)),o.isLeafNode()&&(d=e.filter.updateFullNode(d,o,i)))}return o=t.serverCache.isFullyInitialized()||null!=ln(r,me()),Ot(t,d,o,e.filter.filtersNodes())}}(e,t,l.path,r,s,i):function(e,t,n,r,s,a,i){if(null!=ln(s,n))return t;const o=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(Ne(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return xn(e,t,n,l.getNode().getChild(n),s,a,o,i);if(Ne(n)){let r=new Wt(null);return l.getNode().forEachChild(Me,((e,t)=>{r=r.set(new fe(e),t)})),Nn(e,t,n,r,s,a,o,i)}return t}{let c=new Wt(null);return r.foreach(((e,t)=>{const r=we(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),Nn(e,t,n,c,s,a,o,i)}}(e,t,l.path,l.affectedTree,r,s,i)}else{if(n.type!==St.LISTEN_COMPLETE)throw(0,a.Hk)("Unknown operation type: "+n.type);o=function(e,t,n,r,s){const a=t.serverCache,i=Mt(t,a.getNode(),a.isFullyInitialized()||Ne(n),a.isFiltered());return vn(e,i,n,r,mn,s)}(e,t,n.path,r,i)}const c=i.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Lt(e);(n.length>0||!e.eventCache.isFullyInitialized()||s&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(lt(Lt(t)))}}(t,o,c),{viewCache:o,changes:c}}function vn(e,t,n,r,s,i){const o=t.eventCache;if(null!=ln(r,n))return t;{let l,c;if(Ne(n))if((0,a.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ft(t),s=an(r,n instanceof rt?n:rt.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),s,i)}else{const n=sn(r,Ft(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,i)}else{const d=pe(n);if(".priority"===d){(0,a.vA)(1===ge(n),"Can't have a priority with additional path components");const s=o.getNode();c=t.serverCache.getNode();const i=on(r,n,s,c);l=null!=i?e.filter.updatePriority(s,i):o.getNode()}else{const a=ve(n);let u;if(o.isCompleteForChild(d)){c=t.serverCache.getNode();const e=on(r,n,o.getNode(),c);u=null!=e?o.getNode().getImmediateChild(d).updateChild(a,e):o.getNode().getImmediateChild(d)}else u=dn(r,d,t.serverCache);l=null!=u?e.filter.updateChild(o.getNode(),d,u,a,s,i):o.getNode()}}return Ot(t,l,o.isFullyInitialized()||Ne(n),e.filter.filtersNodes())}}function xn(e,t,n,r,s,a,i,o){const l=t.serverCache;let c;const d=i?e.filter:e.filter.getIndexedFilter();if(Ne(n))c=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=d.updateFullNode(l.getNode(),e,null)}else{const e=pe(n);if(!l.isCompleteForPath(n)&&ge(n)>1)return t;const s=ve(n),a=l.getNode().getImmediateChild(e).updateChild(s,r);c=".priority"===e?d.updatePriority(l.getNode(),a):d.updateChild(l.getNode(),e,a,s,mn,null)}const u=Mt(t,c,l.isFullyInitialized()||Ne(n),d.filtersNodes());return vn(e,u,n,s,new pn(s,u,a),o)}function yn(e,t,n,r,s,a,i){const o=t.eventCache;let l,c;const d=new pn(s,t,a);if(Ne(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,i),l=Ot(t,c,!0,e.filter.filtersNodes());else{const s=pe(n);if(".priority"===s)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Ot(t,c,o.isFullyInitialized(),o.isFiltered());else{const a=ve(n),c=o.getNode().getImmediateChild(s);let u;if(Ne(a))u=r;else{const e=d.getCompleteChild(s);u=null!=e?".priority"===xe(a)&&e.getChild(be(a)).isEmpty()?e:e.updateChild(a,r):rt.EMPTY_NODE}if(c.equals(u))l=t;else{l=Ot(t,e.filter.updateChild(o.getNode(),s,u,a,d,i),o.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function bn(e,t){return e.eventCache.isCompleteForChild(t)}function wn(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Nn(e,t,n,r,s,a,i,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Ne(n)?r:new Wt(null).setTree(n,r);const d=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(d.hasChild(n)){const l=wn(0,t.serverCache.getNode().getImmediateChild(n),r);c=xn(e,c,new fe(n),l,s,a,i,o)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!d.hasChild(n)&&!l){const l=wn(0,t.serverCache.getNode().getImmediateChild(n),r);c=xn(e,c,new fe(n),l,s,a,i,o)}})),c}class kn{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new ht(n.getIndex()),s=(a=n).loadsAllData()?new ht(a.getIndex()):a.hasLimit()?new mt(a):new ft(a);var a;this.processor_=function(e){return{filter:e}}(s);const i=t.serverCache,o=t.eventCache,l=r.updateFullNode(rt.EMPTY_NODE,i.getNode(),null),c=s.updateFullNode(rt.EMPTY_NODE,o.getNode(),null),d=new It(l,i.isFullyInitialized(),r.filtersNodes()),u=new It(c,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=Pt(u,d),this.eventGenerator_=new Dt(this.query_)}get query(){return this.query_}}function _n(e,t){const n=Ft(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ne(t)&&!n.getImmediateChild(pe(t)).isEmpty())?n.getChild(t):null}function Sn(e){return 0===e.eventRegistrations_.length}function Tn(e,t,n){const r=[];if(n){(0,a.vA)(null==t,"A cancel should cancel all event registrations.");const s=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,s);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const s=e.eventRegistrations_[r];if(s.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(s)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Cn(e,t,n,r){t.type===St.MERGE&&null!==t.source.queryId&&((0,a.vA)(Ft(e.viewCache_),"We should always have a full cache before handling merges"),(0,a.vA)(Lt(e.viewCache_),"Missing event cache, even though we have a server cache"));const s=e.viewCache_,i=gn(e.processor_,s,t,n,r);var o,l;return o=e.processor_,l=i.viewCache,(0,a.vA)(l.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),(0,a.vA)(l.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),(0,a.vA)(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=i.viewCache,En(e,i.changes,i.viewCache.eventCache.getNode(),null)}function En(e,t,n,r){const s=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const s=[],a=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Rt(e,s,"child_removed",t,r,n),Rt(e,s,"child_added",t,r,n),Rt(e,s,"child_moved",a,r,n),Rt(e,s,"child_changed",t,r,n),Rt(e,s,"value",t,r,n),s}(e.eventGenerator_,t,n,s)}let jn,An;class In{constructor(){this.views=new Map}}function Dn(e,t,n,r){const s=t.source.queryId;if(null!==s){const i=e.views.get(s);return(0,a.vA)(null!=i,"SyncTree gave us an op for an invalid query."),Cn(i,t,n,r)}{let s=[];for(const a of e.views.values())s=s.concat(Cn(a,t,n,r));return s}}function Rn(e,t,n,r,s){const a=t._queryIdentifier,i=e.views.get(a);if(!i){let e=sn(n,s?r:null),a=!1;e?a=!0:r instanceof rt?(e=an(n,r),a=!1):(e=rt.EMPTY_NODE,a=!1);const i=Pt(new It(e,a,!1),new It(r,s,!1));return new kn(t,i)}return i}function Pn(e,t,n,r,s,a){const i=Rn(e,t,r,s,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,i),function(e,t){e.eventRegistrations_.push(t)}(i,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild($e,((e,t)=>{r.push(ct(e,t))}));return n.isFullyInitialized()&&r.push(lt(n.getNode())),En(e,r,n.getNode(),t)}(i,n)}function On(e,t,n,r){const s=t._queryIdentifier,i=[];let o=[];const l=Wn(e);if("default"===s)for(const[a,c]of e.views.entries())o=o.concat(Tn(c,n,r)),Sn(c)&&(e.views.delete(a),c.query._queryParams.loadsAllData()||i.push(c.query));else{const t=e.views.get(s);t&&(o=o.concat(Tn(t,n,r)),Sn(t)&&(e.views.delete(s),t.query._queryParams.loadsAllData()||i.push(t.query)))}return l&&!Wn(e)&&i.push(new((0,a.vA)(jn,"Reference.ts has not been loaded"),jn)(t._repo,t._path)),{removed:i,events:o}}function Mn(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ln(e,t){let n=null;for(const r of e.views.values())n=n||_n(r,t);return n}function Fn(e,t){if(t._queryParams.loadsAllData())return zn(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Un(e,t){return null!=Fn(e,t)}function Wn(e){return null!=zn(e)}function zn(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Bn=1;class Hn{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Wt(null),this.pendingWriteTree_={visibleWrites:zt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Vn(e,t,n,r,s){return function(e,t,n,r,s){(0,a.vA)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:s}),s&&(e.visibleWrites=Bt(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,s),s?Qn(e,new jt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function qn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Zt(e.pendingWriteTree_,t)){let t=new Wt(null);return null!=r.snap?t=t.set(me(),!0):M(r.children,(e=>{t=t.set(new fe(e),!0)})),Qn(e,new Ct(r.path,t,n))}return[]}function Yn(e,t,n){return Qn(e,new jt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Kn(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=t._path,i=e.syncPointTree_.get(a);let o=[];if(i&&("default"===t._queryIdentifier||Un(i,t))){const l=On(i,t,n,r);0===i.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(a));const c=l.removed;if(o=l.events,!s){const n=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),s=e.syncPointTree_.findOnPath(a,((e,t)=>Wn(t)));if(n&&!s){const t=e.syncPointTree_.subtree(a);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Wn(t)){return[zn(t)]}{let e=[];return t&&(e=Mn(t)),M(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],s=r.query,a=er(e,r);e.listenProvider_.startListening(ir(s),tr(e,s),a.hashFn,a.onComplete)}}}if(!s&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(ir(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(nr(t));e.listenProvider_.stopListening(ir(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=nr(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function Gn(e,t,n,r){const s=rr(e,r);if(null!=s){const r=sr(s),a=r.path,i=r.queryId,o=ke(a,t);return ar(e,a,new jt(Tt(i),o,n))}return[]}function $n(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=t._path;let i=null,o=!1;e.syncPointTree_.foreachOnPath(s,((e,t)=>{const n=ke(e,s);i=i||Ln(t,n),o=o||Wn(t)}));let l,c=e.syncPointTree_.get(s);if(c?(o=o||Wn(c),i=i||Ln(c,me())):(c=new In,e.syncPointTree_=e.syncPointTree_.set(s,c)),null!=i)l=!0;else{l=!1,i=rt.EMPTY_NODE;e.syncPointTree_.subtree(s).foreachChild(((e,t)=>{const n=Ln(t,me());n&&(i=i.updateImmediateChild(e,n))}))}const d=Un(c,t);if(!d&&!t._queryParams.loadsAllData()){const n=nr(t);(0,a.vA)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Bn++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=Pn(c,t,n,Jt(e.pendingWriteTree_,s),i,l);if(!d&&!o&&!r){const n=Fn(c,t);u=u.concat(function(e,t,n){const r=t._path,s=tr(e,t),i=er(e,n),o=e.listenProvider_.startListening(ir(t),s,i.hashFn,i.onComplete),l=e.syncPointTree_.subtree(r);if(s)(0,a.vA)(!Wn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold(((e,t,n)=>{if(!Ne(e)&&t&&Wn(t))return[zn(t).query];{let e=[];return t&&(e=e.concat(Mn(t).map((e=>e.query)))),M(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(ir(r),tr(e,r))}}return o}(e,t,n))}return u}function Xn(e,t,n){const r=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=Ln(n,ke(e,t));if(r)return r}));return rn(r,t,s,n,!0)}function Qn(e,t){return Jn(t,e.syncPointTree_,null,Jt(e.pendingWriteTree_,me()))}function Jn(e,t,n,r){if(Ne(e.path))return Zn(e,t,n,r);{const s=t.get(me());null==n&&null!=s&&(n=Ln(s,me()));let a=[];const i=pe(e.path),o=e.operationForChild(i),l=t.children.get(i);if(l&&o){const e=n?n.getImmediateChild(i):null,t=un(r,i);a=a.concat(Jn(o,l,e,t))}return s&&(a=a.concat(Dn(s,e,r,n))),a}}function Zn(e,t,n,r){const s=t.get(me());null==n&&null!=s&&(n=Ln(s,me()));let a=[];return t.children.inorderTraversal(((t,s)=>{const i=n?n.getImmediateChild(t):null,o=un(r,t),l=e.operationForChild(t);l&&(a=a.concat(Zn(l,s,i,o)))})),s&&(a=a.concat(Dn(s,e,r,n))),a}function er(e,t){const n=t.query,r=tr(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||rt.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=rr(e,n);if(r){const n=sr(r),s=n.path,a=n.queryId,i=ke(s,t);return ar(e,s,new Et(Tt(a),i))}return[]}(e,n._path,r):function(e,t){return Qn(e,new Et({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Kn(e,n,null,r)}}}}function tr(e,t){const n=nr(t);return e.queryToTagMap.get(n)}function nr(e){return e._path.toString()+"$"+e._queryIdentifier}function rr(e,t){return e.tagToQueryMap.get(t)}function sr(e){const t=e.indexOf("$");return(0,a.vA)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new fe(e.substr(0,t))}}function ar(e,t,n){const r=e.syncPointTree_.get(t);(0,a.vA)(r,"Missing sync point for query tag that we're tracking");return Dn(r,n,Jt(e.pendingWriteTree_,t),null)}function ir(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,a.vA)(An,"Reference.ts has not been loaded"),An)(e._repo,e._path):e}class or{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new or(t)}node(){return this.node_}}class lr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=we(this.path_,e);return new lr(this.syncTree_,t)}node(){return Xn(this.syncTree_,this.path_)}}const cr=function(e,t,n){return e&&"object"===typeof e?((0,a.vA)(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?dr(e[".sv"],t,n):"object"===typeof e[".sv"]?ur(e[".sv"],t):void(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},dr=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,a.vA)(!1,"Unexpected server value: "+e)},ur=function(e,t,n){e.hasOwnProperty("increment")||(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&(0,a.vA)(!1,"Unexpected increment value: "+r);const s=t.node();if((0,a.vA)(null!==s&&"undefined"!==typeof s,"Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const i=s.getValue();return"number"!==typeof i?r:i+r},hr=function(e,t,n,r){return mr(t,new lr(n,e),r)},fr=function(e,t,n){return mr(e,new or(t),n)};function mr(e,t,n){const r=e.getPriority().val(),s=cr(r,t.getImmediateChild(".priority"),n);let a;if(e.isLeafNode()){const r=e,a=cr(r.getValue(),t,n);return a!==r.getValue()||s!==r.getPriority().val()?new Ge(a,at(s)):e}{const r=e;return a=r,s!==r.getPriority().val()&&(a=a.updatePriority(new Ge(s))),r.forEachChild($e,((e,r)=>{const s=mr(r,t.getImmediateChild(e),n);s!==r&&(a=a.updateImmediateChild(e,s))})),a}}class pr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function gr(e,t){let n=t instanceof fe?t:new fe(t),r=e,s=pe(n);for(;null!==s;){const e=(0,a.yw)(r.node.children,s)||{children:{},childCount:0};r=new pr(s,r,e),n=ve(n),s=pe(n)}return r}function vr(e){return e.node.value}function xr(e,t){e.node.value=t,kr(e)}function yr(e){return e.node.childCount>0}function br(e,t){M(e.node.children,((n,r)=>{t(new pr(n,e,r))}))}function wr(e,t,n,r){n&&!r&&t(e),br(e,(e=>{wr(e,t,!0,r)})),n&&r&&t(e)}function Nr(e){return new fe(null===e.parent?e.name:Nr(e.parent)+"/"+e.name)}function kr(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===vr(e)&&!yr(e)}(n),s=(0,a.gR)(e.node.children,t);r&&s?(delete e.node.children[t],e.node.childCount--,kr(e)):r||s||(e.node.children[t]=n.node,e.node.childCount++,kr(e))}(e.parent,e.name,e)}const _r=/[\[\].#$\/\u0000-\u001F\u007F]/,Sr=/[\[\].#$\u0000-\u001F\u007F]/,Tr=10485760,Cr=function(e){return"string"===typeof e&&0!==e.length&&!_r.test(e)},Er=function(e){return"string"===typeof e&&0!==e.length&&!Sr.test(e)},jr=function(e,t,n){const r=n instanceof fe?new Te(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ee(r));if("function"===typeof t)throw new Error(e+"contains a function "+Ee(r)+" with contents = "+t.toString());if(E(t))throw new Error(e+"contains "+t.toString()+" "+Ee(r));if("string"===typeof t&&t.length>Tr/3&&(0,a.OE)(t)>Tr)throw new Error(e+"contains a string greater than "+Tr+" utf8 bytes "+Ee(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,s=!1;if(M(t,((t,i)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(s=!0,!Cr(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ee(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,a.OE)(t),Ce(e)}(r,t),jr(e,i,r),function(e){const t=e.parts_.pop();e.byteLength_-=(0,a.OE)(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&s)throw new Error(e+' contains ".value" child '+Ee(r)+" in addition to actual children.")}},Ar=function(e,t,n,r){if((!r||void 0!==n)&&!Er(n))throw new Error((0,a.dI)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ir=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ar(e,t,n,r)},Dr=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Cr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Er(e)}(n))throw new Error((0,a.dI)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Rr{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Pr(e,t){let n=null;for(let r=0;r<t.length;r++){const s=t[r],a=s.getPath();null===n||_e(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(s)}n&&e.eventLists_.push(n)}function Or(e,t,n){Pr(e,n),Lr(e,(e=>_e(e,t)))}function Mr(e,t,n){Pr(e,n),Lr(e,(e=>Se(e,t)||Se(t,e)))}function Lr(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const s=e.eventLists_[r];if(s){t(s.path)?(Fr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Fr(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();b&&k("event: "+n.toString()),W(r)}}}const Ur="repo_interrupt";class Wr{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Rr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=bt(),this.transactionQueueTree_=new pr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function zr(e,t,n){if(e.stats_=te(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new xt(e.repoInfo_,((t,n,r,s)=>{Vr(e,t,n,r,s)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>qr(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,a.As)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Ie(e.repoInfo_,t,((t,n,r,s)=>{Vr(e,t,n,r,s)}),(t=>{qr(e,t)}),(t=>{!function(e,t){M(t,((t,n)=>{Yr(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return ee[n]||(ee[n]=t()),ee[n]}(e.repoInfo_,(()=>new _t(e.stats_,e.server_))),e.infoData_=new yt,e.infoSyncTree_=new Hn({startListening:(t,n,r,s)=>{let a=[];const i=e.infoData_.getNode(t._path);return i.isEmpty()||(a=Yn(e.infoSyncTree_,t._path,i),setTimeout((()=>{s("ok")}),0)),a},stopListening:()=>{}}),Yr(e,"connected",!1),e.serverSyncTree_=new Hn({startListening:(t,n,r,s)=>(e.server_.listen(t,r,n,((n,r)=>{const a=s(n,r);Mr(e.eventQueue_,t._path,a)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Br(e){const t=e.infoData_.getNode(new fe(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Hr(e){return(t=(t={timestamp:Br(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Vr(e,t,n,r,s){e.dataUpdateCount++;const i=new fe(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(s)if(r){const t=(0,a.kH)(n,(e=>at(e)));o=function(e,t,n,r){const s=rr(e,r);if(s){const r=sr(s),a=r.path,i=r.queryId,o=ke(a,t),l=Wt.fromObject(n);return ar(e,a,new At(Tt(i),o,l))}return[]}(e.serverSyncTree_,i,t,s)}else{const t=at(n);o=Gn(e.serverSyncTree_,i,t,s)}else if(r){const t=(0,a.kH)(n,(e=>at(e)));o=function(e,t,n){const r=Wt.fromObject(n);return Qn(e,new At({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,i,t)}else{const t=at(n);o=Yn(e.serverSyncTree_,i,t)}let l=i;o.length>0&&(l=Zr(e,i)),Mr(e.eventQueue_,l,o)}function qr(e,t){Yr(e,"connected",t),!1===t&&function(e){Xr(e,"onDisconnectEvents");const t=Hr(e),n=bt();Nt(e.onDisconnect_,me(),((r,s)=>{const a=hr(r,s,e.serverSyncTree_,t);wt(n,r,a)}));let r=[];Nt(n,me(),((t,n)=>{r=r.concat(Yn(e.serverSyncTree_,t,n));const s=ss(e,t);Zr(e,s)})),e.onDisconnect_=bt(),Mr(e.eventQueue_,me(),r)}(e)}function Yr(e,t,n){const r=new fe("/.info/"+t),s=at(n);e.infoData_.updateSnapshot(r,s);const a=Yn(e.infoSyncTree_,r,s);Mr(e.eventQueue_,r,a)}function Kr(e){return e.nextWriteId_++}function Gr(e,t,n){let r;r=".info"===pe(t._path)?Kn(e.infoSyncTree_,t,n):Kn(e.serverSyncTree_,t,n),Or(e.eventQueue_,t._path,r)}function $r(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Ur)}function Xr(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];k(t,...r)}function Qr(e,t,n){return Xn(e.serverSyncTree_,t,n)||rt.EMPTY_NODE}function Jr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||rs(e,t),vr(t)){const n=ts(e,t);(0,a.vA)(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),s=Qr(e,t,r);let i=s;const o=s.hash();for(let d=0;d<n.length;d++){const e=n[d];(0,a.vA)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=ke(t,e.path);i=i.updateChild(r,e.currentOutputSnapshotRaw)}const l=i.val(!0),c=t;e.server_.put(c.toString(),l,(r=>{Xr(e,"transaction put response",{path:c.toString(),status:r});let s=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,s=s.concat(qn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();rs(e,gr(e.transactionQueueTree_,t)),Jr(e,e.transactionQueueTree_),Mr(e.eventQueue_,t,s);for(let e=0;e<r.length;e++)W(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{C("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}Zr(e,t)}}),o)}(e,Nr(t),n)}else yr(t)&&br(t,(t=>{Jr(e,t)}))}function Zr(e,t){const n=es(e,t),r=Nr(n);return function(e,t,n){if(0===t.length)return;const r=[];let s=[];const i=t.filter((e=>0===e.status)),o=i.map((e=>e.currentWriteId));for(let c=0;c<t.length;c++){const i=t[c],d=ke(n,i.path);let u,h=!1;if((0,a.vA)(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===i.status)h=!0,u=i.abortReason,s=s.concat(qn(e.serverSyncTree_,i.currentWriteId,!0));else if(0===i.status)if(i.retryCount>=25)h=!0,u="maxretry",s=s.concat(qn(e.serverSyncTree_,i.currentWriteId,!0));else{const n=Qr(e,i.path,o);i.currentInputSnapshot=n;const r=t[c].update(n.val());if(void 0!==r){jr("transaction failed: Data returned ",r,i.path);let t=at(r);"object"===typeof r&&null!=r&&(0,a.gR)(r,".priority")||(t=t.updatePriority(n.getPriority()));const l=i.currentWriteId,c=Hr(e),d=fr(t,n,c);i.currentOutputSnapshotRaw=t,i.currentOutputSnapshotResolved=d,i.currentWriteId=Kr(e),o.splice(o.indexOf(l),1),s=s.concat(Vn(e.serverSyncTree_,i.path,d,i.currentWriteId,i.applyLocally)),s=s.concat(qn(e.serverSyncTree_,l,!0))}else h=!0,u="nodata",s=s.concat(qn(e.serverSyncTree_,i.currentWriteId,!0))}Mr(e.eventQueue_,n,s),s=[],h&&(t[c].status=2,l=t[c].unwatcher,setTimeout(l,Math.floor(0)),t[c].onComplete&&("nodata"===u?r.push((()=>t[c].onComplete(null,!1,t[c].currentInputSnapshot))):r.push((()=>t[c].onComplete(new Error(u),!1,null)))))}var l;rs(e,e.transactionQueueTree_);for(let a=0;a<r.length;a++)W(r[a]);Jr(e,e.transactionQueueTree_)}(e,ts(e,n),r),r}function es(e,t){let n,r=e.transactionQueueTree_;for(n=pe(t);null!==n&&void 0===vr(r);)r=gr(r,n),n=pe(t=ve(t));return r}function ts(e,t){const n=[];return ns(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function ns(e,t,n){const r=vr(t);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);br(t,(t=>{ns(e,t,n)}))}function rs(e,t){const n=vr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,xr(t,n.length>0?n:void 0)}br(t,(t=>{rs(e,t)}))}function ss(e,t){const n=Nr(es(e,t)),r=gr(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{as(e,t)})),as(e,r),wr(r,(t=>{as(e,t)})),n}function as(e,t){const n=vr(t);if(n){const r=[];let s=[],i=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,a.vA)(i===t-1,"All SENT items should be at beginning of queue."),i=t,n[t].status=3,n[t].abortReason="set"):((0,a.vA)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),s=s.concat(qn(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===i?xr(t,void 0):n.length=i+1,Mr(e.eventQueue_,Nr(t),s);for(let e=0;e<r.length;e++)W(r[e])}}const is=function(e,t){const n=os(e),r=n.namespace;"firebase.com"===n.domain&&T(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new X(n.host,n.secure,r,s,t,"",r!==n.subdomain),path:new fe(n.pathString)}},os=function(e){let t="",n="",r="",s="",a="",i=!0,o="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let d=e.indexOf("/");-1===d&&(d=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(d,u)),d<u&&(s=function(e){let t="";const n=e.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let e=n[s];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(r){}t+="/"+e}return t}(e.substring(d,u)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):C("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,u)));c=t.indexOf(":"),c>=0?(i="https"===o||"wss"===o,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),a=r}"ns"in h&&(a=h.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:i,scheme:o,pathString:s,namespace:a}},ls="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class cs{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,a.As)(this.snapshot.exportVal())}}class ds{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class us{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,a.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class hs{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Ne(this._path)?null:xe(this._path)}get ref(){return new fs(this._repo,this._path)}get _queryIdentifier(){const e=vt(this._queryParams),t=P(e);return"{}"===t?"default":t}get _queryObject(){return vt(this._queryParams)}isEqual(e){if(!((e=(0,a.Ku)(e))instanceof hs))return!1;const t=this._repo===e._repo,n=_e(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class fs extends hs{constructor(e,t){super(e,t,new pt,!1)}get parent(){const e=be(this._path);return null===e?null:new fs(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class ms{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new fe(e),n=gs(this.ref,e);return new ms(this._node.getChild(t),n,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new ms(n,gs(this.ref,t),$e))))}hasChild(e){const t=new fe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ps(e,t){return(e=(0,a.Ku)(e))._checkNotDeleted("ref"),void 0!==t?gs(e._root,t):e._root}function gs(e,t){return null===pe((e=(0,a.Ku)(e))._path)?Ir("child","path",t,!1):Ar("child","path",t,!1),new fs(e._repo,we(e._path,t))}class vs{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new cs("value",this,new ms(e.snapshotNode,new fs(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ds(this,e,t):null}matches(e){return e instanceof vs&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class xs{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ds(this,e,t):null}createEvent(e,t){(0,a.vA)(null!=e.childName,"Child events should have a childName.");const n=gs(new fs(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new cs(e.type,this,new ms(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof xs&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function ys(e,t,n,r,s){let a;if("object"===typeof r&&(a=void 0,s=r),"function"===typeof r&&(a=r),s&&s.onlyOnce){const t=n,r=(n,r)=>{Gr(e._repo,e,o),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const i=new us(n,a||void 0),o="value"===t?new vs(i):new xs(t,i);return function(e,t,n){let r;r=".info"===pe(t._path)?$n(e.infoSyncTree_,t,n):$n(e.serverSyncTree_,t,n),Or(e.eventQueue_,t._path,r)}(e._repo,e,o),()=>Gr(e._repo,e,o)}function bs(e,t,n,r){return ys(e,"value",t,n,r)}function ws(e,t,n){let r=null;const s=n?new us(n):null;"value"===t?r=new vs(s):t&&(r=new xs(t,s)),Gr(e._repo,e,r)}!function(e){(0,a.vA)(!jn,"__referenceConstructor has already been defined"),jn=e}(fs),function(e){(0,a.vA)(!An,"__referenceConstructor has already been defined"),An=e}(fs);const Ns={};let ks=!1;function _s(e,t,n,r,s){let a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||T("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),k("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let i,o,l=is(a,s),c=l.repoInfo;"undefined"!==typeof process&&(o={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),o?(i=!0,a="http://".concat(o,"?ns=").concat(c.namespace),l=is(a,s),c=l.repoInfo):i=!l.repoInfo.secure;const d=s&&i?new V(V.OWNER):new H(e.name,e.options,t);Dr("Invalid Firebase Database URL",l),Ne(l.path)||T("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(e,t,n,r){let s=Ns[t.name];s||(s={},Ns[t.name]=s);let a=s[e.toURLString()];a&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new Wr(e,ks,n,r),s[e.toURLString()]=a,a}(c,e,d,new B(e,n));return new Ss(u,e)}class Ss{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(zr(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fs(this._repo,me())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Ns[t];n&&n[e.key]===e||T("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),$r(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&T("Cannot call "+e+" on a deleted database.")}}function Ts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1?arguments[1]:void 0;const n=(0,r.j6)(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(0,a.yU)("database");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=(0,a.Ku)(e),e._checkNotDeleted("useEmulator");const s="".concat(t,":").concat(n),i=e._repoInternal;if(e._instanceStarted){if(s===e._repoInternal.repoInfo_.host&&(0,a.bD)(r,i.repoInfo_.emulatorOptions))return;T("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&T('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new V(V.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:(0,a.Fy)(r.mockUserToken,e.app.options.projectId);o=new V(t)}(0,a.zJ)(t)&&((0,a.gE)(t),(0,a.P1)("Database",!0));!function(e,t,n,r){const s=t.lastIndexOf(":"),i=t.substring(0,s),o=(0,a.zJ)(i);e.repoInfo_=new X(t,o,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}(i,s,r,o)}(n,...e)}return n}Ie.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ie.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Cs;d(r.MF),(0,r.om)(new s.uA("database",((e,t)=>{let{instanceIdentifier:n}=t;return _s(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(o,l,Cs),(0,r.KO)(o,l,"esm2017")},581:(e,t,n)=>{var r=n(635),s=Object.prototype,a=s.hasOwnProperty,i=s.toString,o=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch(l){}var s=i.call(e);return r&&(t?e[o]=n:delete e[o]),s}},588:(e,t,n)=>{var r=n(914),s=n(567),a=n(184),i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=o.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):i.test(e)?NaN:+e}},607:(e,t,n)=>{"use strict";n.d(t,{DQ:()=>l,Nd:()=>r,Sh:()=>o,Ur:()=>a,_M:()=>i,qw:()=>s});const r={apiKey:"AIzaSyBBWLn8mFblzOqtbfaGS52aDhFWixSEn0Y",authDomain:"hamptown-panel.firebaseapp.com",databaseURL:"https://hamptown-panel-default-rtdb.firebaseio.com",projectId:"hamptown-panel",storageBucket:"hamptown-panel.firebasestorage.app",messagingSenderId:"937251959184",appId:"1:937251959184:web:b1afb3ed1eecd52fdcc315",measurementId:"G-50NK2PWM7E"},s="6969",a=["\ud83d\ude2b","\ud83d\ude14","\ud83d\ude10","\ud83d\ude0a","\ud83e\udd29"],i=["Terrible","Poor","Okay","Good","Excellent"],o={high:"border-red-400",medium:"border-yellow-400",low:"border-green-400"},l=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500"]},624:(e,t,n)=>{"use strict";n.d(t,{$b:()=>s,Vy:()=>c});const r=[];var s;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));const a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},i=s.INFO,o={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i];console[r]("[".concat(n,"]  ").concat(e.name,":"),...a)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}},635:(e,t,n)=>{var r=n(759).Symbol;e.exports=r},654:(e,t,n)=>{"use strict";var r=n(950),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},658:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},670:(e,t,n)=>{"use strict";n.d(t,{Lz:()=>l,V0:()=>s,c8:()=>o,ch:()=>c,cw:()=>a,ex:()=>i});var r=n(51);const s=(e,t)=>{if(0===t)return"unknown";const n=e/t*100;return 0===e?"out":n<=20?"critical":n<=50?"low":"ok"},a=function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3;if(!r||0===r)return Math.max(0,n-e);const a=(n||2*t)-e+r*s;return Math.max(0,Math.ceil(a))},i=(e,t)=>{if(e.length<2)return 0;const n={daily:7,weekly:28,monthly:90,database:30,outofstock:30}[t],r=new Date;r.setDate(r.getDate()-n);const s=e.filter((e=>e.date>r));if(0===s.length)return 0;return s.reduce(((e,t)=>e+t.consumed),0)/Math.ceil(((new Date).getTime()-s[0].date.getTime())/864e5)},o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s={itemId:e.id.toString(),date:new Date,previousStock:e.currentStock,currentStock:t,consumed:Math.max(0,e.currentStock-t+n),received:n},a=[...e.consumptionHistory||[],s];a.length>100&&a.splice(0,a.length-100);return{updatedItem:(0,r.A)((0,r.A)({},e),{},{currentStock:t,lastUsed:(new Date).toISOString(),consumptionHistory:a,optimalLevel:e.optimalLevel||2*e.minLevel}),consumptionEntry:s}},l=(e,t,n)=>e.map((e=>{const s=t.indexOf(e.id.toString());return-1===s?e:(0,r.A)((0,r.A)({},e),{},{orderedStatus:{isOrdered:!0,orderedDate:new Date,orderedQuantity:n[s],expectedDelivery:new Date(Date.now()+2592e5)}})})),c=(e,t)=>t<=0||e<=0?0:Math.floor(e/t)},759:(e,t,n)=>{var r=n(658),s="object"==typeof self&&self&&self.Object===Object&&self,a=r||s||Function("return this")();e.exports=a},761:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<a(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,i=s>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<s&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<s&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(g=!1,b(e),!p)if(null!==r(c))p=!0,R(N);else{var t=r(d);null!==t&&P(w,t.startTime-e)}}function N(e,n){p=!1,g&&(g=!1,x(T),T=-1),m=!0;var a=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!j());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&s(c),b(n)}else s(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&P(w,u.startTime-n),l=!1}return l}finally{h=null,f=a,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,_=!1,S=null,T=-1,C=5,E=-1;function j(){return!(t.unstable_now()-E<C)}function A(){if(null!==S){var e=t.unstable_now();E=e;var n=!0;try{n=S(!0,e)}finally{n?k():(_=!1,S=null)}}else _=!1}if("function"===typeof y)k=function(){y(A)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,D=I.port2;I.port1.onmessage=A,k=function(){D.postMessage(null)}}else k=function(){v(A,0)};function R(e){S=e,_||(_=!0,k())}function P(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,R(N))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,s,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>i?(e.sortIndex=a,n(d,e),null===r(c)&&e===r(d)&&(g?(x(T),T=-1):g=!0,P(w,a-i))):(e.sortIndex=o,n(c,e),p||m||(p=!0,R(N))),e},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},798:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},815:(e,t,n)=>{"use strict";n.d(t,{Wp:()=>r.Wp});var r=n(913);(0,r.KO)("firebase","11.9.1","app")},867:(e,t,n)=>{"use strict";n.d(t,{eX:()=>i,po:()=>s,zQ:()=>a});var r=n(607);const s=e=>"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),a=e=>r.DQ[e-1]||"bg-gray-500",i=e=>r.Sh[e]},913:(e,t,n)=>{"use strict";n.d(t,{MF:()=>ue,j6:()=>ie,xZ:()=>oe,om:()=>ae,Sx:()=>fe,Wp:()=>he,KO:()=>me});var r=n(253),s=n(624),a=n(170),i=n(51);let o,l;const c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,f=new WeakMap;let m={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(x(this),n),v(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(e.apply(x(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const a=e.call(x(this),t,...r);return u.set(a,t.sort?t.sort():[t]),v(a)}}function g(e){return"function"===typeof e?p(e):(e instanceof IDBTransaction&&function(e){if(d.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)}));d.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,m):e);var t}function v(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(v(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&c.set(t,e)})).catch((()=>{})),f.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),f.set(t,e)),t}const x=e=>f.get(e);const y=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function N(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!y.includes(n))return;const a=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),s&&t.done]))[0]};return w.set(t,a),a}m=(e=>(0,i.A)((0,i.A)({},e),{},{get:(t,n,r)=>N(t,n)||e.get(t,n,r),has:(t,n)=>!!N(t,n)||e.has(t,n)}))(m);class k{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const _="@firebase/app",S="0.13.1",T=new s.Vy("@firebase/app"),C="@firebase/app-compat",E="@firebase/analytics-compat",j="@firebase/analytics",A="@firebase/app-check-compat",I="@firebase/app-check",D="@firebase/auth",R="@firebase/auth-compat",P="@firebase/database",O="@firebase/data-connect",M="@firebase/database-compat",L="@firebase/functions",F="@firebase/functions-compat",U="@firebase/installations",W="@firebase/installations-compat",z="@firebase/messaging",B="@firebase/messaging-compat",H="@firebase/performance",V="@firebase/performance-compat",q="@firebase/remote-config",Y="@firebase/remote-config-compat",K="@firebase/storage",G="@firebase/storage-compat",$="@firebase/firestore",X="@firebase/ai",Q="@firebase/firestore-compat",J="firebase",Z="[DEFAULT]",ee={[_]:"fire-core",[C]:"fire-core-compat",[j]:"fire-analytics",[E]:"fire-analytics-compat",[I]:"fire-app-check",[A]:"fire-app-check-compat",[D]:"fire-auth",[R]:"fire-auth-compat",[P]:"fire-rtdb",[O]:"fire-data-connect",[M]:"fire-rtdb-compat",[L]:"fire-fn",[F]:"fire-fn-compat",[U]:"fire-iid",[W]:"fire-iid-compat",[z]:"fire-fcm",[B]:"fire-fcm-compat",[H]:"fire-perf",[V]:"fire-perf-compat",[q]:"fire-rc",[Y]:"fire-rc-compat",[K]:"fire-gcs",[G]:"fire-gcs-compat",[$]:"fire-fst",[Q]:"fire-fst-compat",[X]:"fire-vertex","fire-js":"fire-js",[J]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function se(e,t){try{e.container.addComponent(t)}catch(n){T.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ae(e){const t=e.name;if(re.has(t))return T.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())se(n,e);for(const n of ne.values())se(n,e);return!0}function ie(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return null!==e&&void 0!==e&&void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new a.FA("app","Firebase",le);class de{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const ue="11.9.0";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const s=Object.assign({name:Z,automaticDataCollectionEnabled:!0},t),i=s.name;if("string"!==typeof i||!i)throw ce.create("bad-app-name",{appName:String(i)});if(n||(n=(0,a.T9)()),!n)throw ce.create("no-options");const o=te.get(i);if(o){if((0,a.bD)(n,o.options)&&(0,a.bD)(s,o.config))return o;throw ce.create("duplicate-app",{appName:i})}const l=new r.h1(i);for(const r of re.values())l.addComponent(r);const c=new de(n,s,l);return te.set(i,c),c}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;const t=te.get(e);if(!t&&e===Z&&(0,a.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function me(e,t,n){var s;let a=null!==(s=ee[e])&&void 0!==s?s:e;n&&(a+="-".concat(n));const i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void T.warn(e.join(" "))}ae(new r.uA("".concat(a,"-version"),(()=>({library:a,version:t})),"VERSION"))}const pe="firebase-heartbeat-store";let ge=null;function ve(){return ge||(ge=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=v(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(v(i.result),e.oldVersion,e.newVersion,v(i.transaction),e)})),n&&i.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(pe)}catch(n){console.warn(n)}}}).catch((e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})}))),ge}async function xe(e,t){try{const n=(await ve()).transaction(pe,"readwrite"),r=n.objectStore(pe);await r.put(t,ye(e)),await n.done}catch(n){if(n instanceof a.g)T.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});T.warn(e.message)}}}function ye(e){return"".concat(e.name,"!").concat(e.options.appId)}class be{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ne(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=we();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){T.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),ke(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ke(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=(0,a.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return T.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class Ne{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ve()).transaction(pe),n=await t.objectStore(pe).get(ye(e));return await t.done,n}catch(t){if(t instanceof a.g)T.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});T.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ke(e){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var _e;_e="",ae(new r.uA("platform-logger",(e=>new k(e)),"PRIVATE")),ae(new r.uA("heartbeat",(e=>new be(e)),"PRIVATE")),me(_,S,_e),me(_,S,"esm2017"),me("fire-js","")},914:(e,t,n)=>{var r=n(798),s=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(s,""):e}},950:(e,t,n)=>{"use strict";e.exports=n(49)}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(950),t=n(352),r=n(51);function s(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const i=["color","size","strokeWidth","absoluteStrokeWidth","className","children"],o=(t,n)=>{const o=(0,e.forwardRef)(((o,l)=>{let{color:c="currentColor",size:d=24,strokeWidth:u=2,absoluteStrokeWidth:h,className:f="",children:m}=o,p=s(o,i);return(0,e.createElement)("svg",(0,r.A)((0,r.A)({ref:l},a),{},{width:d,height:d,stroke:c,strokeWidth:h?24*Number(u)/Number(d):u,className:["lucide","lucide-".concat((g=t,g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim())),f].join(" ")},p),[...n.map((t=>{let[n,r]=t;return(0,e.createElement)(n,r)})),...Array.isArray(m)?m:[m]]);var g}));return o.displayName="".concat(t),o},l=o("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=o("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),d=o("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),u=o("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),h=o("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),f=o("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),m=o("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),p=o("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]),g=o("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),v=o("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),x=o("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),y=o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),b=o("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var w=n(607),N=n(867);var k=n(414);const _=e=>{let{currentUser:t,employees:n,userMood:s,setUserMood:a,setEmployees:i,setDailyData:o}=e;const l=(e=>(e.reduce(((e,t)=>e+t.mood),0)/e.length).toFixed(1))(n),c=((e,t)=>{const n=new Date,r=(0,N.po)(n),s=t.find((t=>t.id===e));return!s||s.lastMoodDate!==r})(t.id,n),d=((e,t)=>{const n=t.find((t=>t.id===e));if(!n||!n.lastMoodDate)return"";const r=new Date,s=(0,N.po)(r);return n.lastMoodDate===s?"You can update your mood again tomorrow!":""})(t.id,n),u=e=>{const s=((e,t,n,s,a)=>{const i=new Date,o=(0,N.po)(i),l=n.find((e=>e.id===t));if(l&&l.lastMoodDate===o)return alert("You have already updated your mood today! Come back tomorrow \ud83d\ude0a"),!1;s((n=>n.map((n=>n.id===t?(0,r.A)((0,r.A)({},n),{},{mood:e,lastUpdated:"Just now",lastMoodDate:o}):n))));const c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"});return a((n=>{const s=n[o]||{completedTasks:[],employeeMoods:[],totalTasks:22,completionRate:0},a=Array.isArray(s.employeeMoods)?s.employeeMoods:[],i={employeeId:t,mood:e,updatedAt:c};return(0,r.A)((0,r.A)({},n),{},{[o]:(0,r.A)((0,r.A)({},s),{},{employeeMoods:[...a.filter((e=>e.employeeId!==t)),i]})})})),!0})(e,t.id,n,i,o);s&&a(e)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,k.jsxs)("div",{className:"text-center mb-6",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:l}),(0,k.jsx)("div",{className:"text-lg text-gray-600 mb-4",children:"Team Average Mood"}),(0,k.jsx)("div",{className:"flex justify-center space-x-2",children:[1,2,3,4,5].map((e=>(0,k.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e<=Math.round(Number(l))?"bg-blue-500":"bg-gray-200")},e)))})]})}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:"How are you feeling today?"}),c?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4,5].map((e=>(0,k.jsxs)("button",{onClick:()=>u(e),className:"flex flex-col items-center p-3 rounded-xl transition-all hover:scale-105 ".concat(s===e?"bg-blue-100 scale-110":"hover:bg-gray-50"),children:[(0,k.jsx)("div",{className:"text-2xl mb-1",children:w.Ur[e-1]}),(0,k.jsx)("div",{className:"text-xs text-gray-600",children:w._M[e-1]})]},e)))}),(0,k.jsx)("div",{className:"text-center text-sm text-gray-500",children:"Select how you're feeling today"})]}):(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"text-6xl mb-4",children:w.Ur[s-1]}),(0,k.jsxs)("div",{className:"text-lg font-medium text-gray-700 mb-2",children:["Today's Mood: ",w._M[s-1]]}),(0,k.jsx)("div",{className:"text-sm text-gray-500 mb-4",children:d}),(0,k.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,k.jsx)("div",{className:"text-sm text-blue-700",children:"\u2728 You've already shared your mood today! Your well-being matters to us."})})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)(b,{className:"w-5 h-5 mr-2"}),"Team Mood"]}),(0,k.jsx)("div",{className:"space-y-3",children:n.map((e=>(0,k.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat((0,N.zQ)(e.mood))}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:[e.lastUpdated,e.lastMoodDate===(0,N.po)(new Date)&&(0,k.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs",children:"Today"})]})]})]}),(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),(0,k.jsxs)("span",{className:"text-sm text-gray-600",children:[e.mood,"/5"]})]})]},e.id)))})]})]})},S=o("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),T=new Map,C=new Map,E=e=>{const t=T.get(e);t&&(clearTimeout(t),T.delete(e))},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const n=C.get(e)||0,r=Date.now();return r-n<t?(console.warn("\u26a0\ufe0f Task operation debounced for task ".concat(e," - too rapid")),!1):(C.set(e,r),!0)},A=(e,t,n,s,a,i)=>{const o=new Date,l=(0,N.po)(o),c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),d={taskId:e,employeeId:t,completedAt:c,taskName:n,date:l,pointsEarned:s};i((t=>{const n=t[l]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:a.length,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},s=[...(Array.isArray(n.completedTasks)?n.completedTasks:[]).filter((t=>t.taskId!==e)),d],i=Math.round(s.length/a.length*100),o=s.reduce(((e,t)=>e+(t.pointsEarned||0)),0);return(0,r.A)((0,r.A)({},t),{},{[l]:(0,r.A)((0,r.A)({},n),{},{completedTasks:s,totalTasks:a.length,completionRate:i,totalPointsEarned:o})})})),console.log("\ud83d\udcca Task completion logged (replacing any previous completion):",d)},I=(e,t,n)=>{n((n=>n.map((n=>n.id===e?(0,r.A)((0,r.A)({},n),{},{points:n.points+t}):n))))},D=(e,t,n)=>{const r=t[e];return n.find((e=>e.id===r))},R=(e,t,n,s,a,i,o,l,c,d,u,h)=>{if(!j(e,1e3))return;E(e);const f=s.has(e),m=new Set(s),p=i.find((t=>t.id===e)),g=D(e,a,o);if(p){if(f)console.log("\ud83d\udd04 Uncompleting task: ".concat(p.task)),m.delete(e),c((t=>{const n=(0,r.A)({},t);return delete n[e],n})),g&&(((e,t,n)=>{n((n=>n.map((n=>n.id===e?(0,r.A)((0,r.A)({},n),{},{points:Math.max(0,n.points-t)}):n))))})(g.id,p.points,u),console.log("\ud83d\udcc9 Deducted ".concat(p.points," points from ").concat(g.name," for uncompleting task"))),((e,t,n)=>{const s=new Date,a=(0,N.po)(s);n((n=>{const s=n[a]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:t.length,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},i=(Array.isArray(s.completedTasks)?s.completedTasks:[]).filter((t=>t.taskId!==e)),o=Math.round(i.length/t.length*100),l=i.reduce(((e,t)=>e+(t.pointsEarned||0)),0);return(0,r.A)((0,r.A)({},n),{},{[a]:(0,r.A)((0,r.A)({},s),{},{completedTasks:i,totalTasks:t.length,completionRate:o,totalPointsEarned:l})})})),console.log("\ud83d\uddd1\ufe0f Task completion removed from daily data:",e)})(e,i,d);else{console.log("\u2705 Completing task: ".concat(p.task));const s=t||(null===g||void 0===g?void 0:g.id)||n;t?c((n=>(0,r.A)((0,r.A)({},n),{},{[e]:t}))):g||c((t=>(0,r.A)((0,r.A)({},t),{},{[e]:n}))),m.add(e),I(s,p.points,u),A(e,s,p.task,p.points,i,d),console.log("\ud83d\udcc8 Awarded ".concat(p.points," points to employee ").concat(s," for completing task"))}if(l(m),h){console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save taskAssignments:",a),console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save completedTasks:",Array.from(m)),E(e);const t=setTimeout((()=>{console.log("\u23f0 Executing debounced save for task:",e),h(),T.delete(e)}),500);T.set(e,t)}}else console.error("Task not found:",e)},P=(e,t,n,s,a,i,o,l,c,d)=>{if(!j(e,800))return;const u=a.find((t=>t.id===e)),h=D(e,s,i),f=i.find((e=>e.id===t));if(u&&f)if(n.has(e)&&(null===h||void 0===h?void 0:h.id)!==t){if(console.log("\ud83d\udd04 Reassigning completed task from ".concat((null===h||void 0===h?void 0:h.name)||"unassigned"," to ").concat(f.name)),h?((e,t,n,s)=>{s((s=>s.map((s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{points:Math.max(0,s.points-n)}):s.id===t?(0,r.A)((0,r.A)({},s),{},{points:s.points+n}):s)))),console.log("\ud83d\udcb0 Transferred ".concat(n," points from employee ").concat(e," to ").concat(t))})(h.id,t,u.points,c):I(t,u.points,c),o((n=>(0,r.A)((0,r.A)({},n),{},{[e]:t}))),A(e,t,u.task,u.points,a,l),d){console.log("\ud83d\udd25 Debounced save triggered by task reassignment"),E(e);const t=setTimeout((()=>{console.log("\u23f0 Executing debounced reassignment save for task:",e),d(),T.delete(e)}),600);T.set(e,t)}}else o((n=>(0,r.A)((0,r.A)({},n),{},{[e]:t})));else console.error("Task or new employee not found")},O=t=>{var n,s;let{currentUser:a,tasks:i,employees:o,completedTasks:l,taskAssignments:c,dailyData:d,setCompletedTasks:h,setTaskAssignments:m,setDailyData:p,setEmployees:g,saveToFirebase:v}=t;(0,e.useEffect)((()=>{console.log("\ud83d\udccb TaskManager - completedTasks updated:",{size:l.size,tasks:Array.from(l),timestamp:(new Date).toLocaleTimeString()})}),[l]);const x=(e,t)=>{l.has(e)?P(e,t,l,c,i,o,m,p,g,v):((e,t,n)=>{n((n=>(0,r.A)((0,r.A)({},n),{},{[e]:t})))})(e,t,m)},y=o.find((e=>e.id===a.id)),w=d[(0,N.po)(new Date)],_=(null===w||void 0===w||null===(n=w.completedTasks)||void 0===n||null===(s=n.filter((e=>e.employeeId===a.id)))||void 0===s?void 0:s.reduce(((e,t)=>e+(t.pointsEarned||0)),0))||0;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 text-center border border-green-200",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-1",children:l.size}),(0,k.jsx)("div",{className:"text-sm font-medium text-green-700",children:"Completed"})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4 text-center border border-orange-200",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:i.length-l.size}),(0,k.jsx)("div",{className:"text-sm font-medium text-orange-700",children:"Pending"})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 text-center border border-purple-200",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:(null===y||void 0===y?void 0:y.points)||0}),(0,k.jsx)("div",{className:"text-sm font-medium text-purple-700",children:"Your Points"})]})]}),(0,k.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-4 mb-6 text-white",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold",children:"Today's Points"}),(0,k.jsxs)("div",{className:"text-2xl font-bold",children:[_," pts earned"]})]}),(0,k.jsx)(S,{className:"w-8 h-8 opacity-80"})]})}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)(f,{className:"w-5 h-5 mr-2"}),"Cleaning Tasks"]}),(0,k.jsx)("div",{className:"space-y-4",children:i.map((e=>{const t=D(e.id,c,o),n=l.has(e.id);return(0,k.jsxs)("div",{className:"border rounded-lg p-4 ".concat((0,N.eX)(e.priority)," ").concat(n?"bg-green-50":"bg-white"),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("div",{className:"font-medium ".concat(n?"line-through text-gray-500":"text-gray-800"),children:e.task}),(0,k.jsxs)("div",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-sm font-medium",children:[(0,k.jsx)(S,{className:"w-3 h-3 mr-1"}),e.points," pts"]})]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["\ud83d\udccd ",e.location]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,k.jsxs)("div",{className:"text-xs px-2 py-1 rounded-full inline-block ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.priority," priority"]}),(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:["\u23f1\ufe0f ",e.estimatedTime]})]})]}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void R(t,n,a.id,l,c,i,o,h,m,p,g,v);var t,n},className:"ml-3 p-2 rounded-full ".concat(n?"bg-green-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"),children:(0,k.jsx)(u,{className:"w-4 h-4"})})]}),(0,k.jsxs)("div",{className:"mt-3",children:[t&&(0,k.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[(0,k.jsx)(b,{className:"w-4 h-4 mr-1"}),"Assigned to: ",(0,k.jsx)("span",{className:"font-medium ml-1",children:t.name}),n&&(0,k.jsxs)("span",{className:"ml-2 text-green-600 font-medium",children:["(+",e.points," pts earned!)"]})]}),!t&&(0,k.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:n?"Reassign to:":"Assign to:"}),(0,k.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map((r=>(0,k.jsxs)("button",{onClick:()=>x(e.id,r.id),className:"text-xs px-3 py-1 rounded-full transition-colors ".concat((null===t||void 0===t?void 0:t.id)===r.id?"bg-blue-500 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"),title:n&&(null===t||void 0===t?void 0:t.id)!==r.id?"Transfer ".concat(e.points," points from ").concat((null===t||void 0===t?void 0:t.name)||"unassigned"," to ").concat(r.name):"Assign task to ".concat(r.name),children:[r.name,(0,k.jsxs)("span",{className:"ml-1 text-purple-600 font-medium",children:["(",r.points,"pts)"]}),n&&(null===t||void 0===t?void 0:t.id)!==r.id&&(0,k.jsx)("span",{className:"ml-1",children:"\ud83d\udd04"})]},r.id)))}),n&&(0,k.jsxs)("div",{className:"mt-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["\ud83d\udca1 Tip: Click another employee's name to transfer the ",e.points," points to them"]})]})]},e.id)}))})]})]})},M=o("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),L=o("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),F=o("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),U=o("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),W=o("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),z=o("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),B=(e,t)=>e.points>=t.cost&&t.available,H=t=>{var n;let{currentUser:s,employees:a,storeItems:i,dailyData:o,setEmployees:l,setDailyData:c,saveToFirebase:d}=t;const[u,h]=(0,e.useState)("all"),[f,m]=(0,e.useState)(!1),p=a.find((e=>e.id===s.id)),g=((e,t)=>{const n=t.find((t=>t.id===e));return(null===n||void 0===n?void 0:n.points)||0})(s.id,a),v=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;const r=[],s=new Date;for(let a=0;a<n;a++){const n=new Date(s);n.setDate(n.getDate()-a);const i=t[(0,N.po)(n)];if(null!==i&&void 0!==i&&i.purchases){const t=i.purchases.filter((t=>t.employeeId===e));r.push(...t)}}return r.sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))}(s.id,o),x=(e=>[...e].sort(((e,t)=>t.points-e.points)).slice(0,10))(a),y=[{id:"all",name:"All Items",icon:"\ud83d\udecd\ufe0f"},{id:"food",name:"Food & Drinks",icon:"\ud83c\udf7d\ufe0f"},{id:"break",name:"Time Off",icon:"\u23f0"},{id:"reward",name:"Rewards",icon:"\ud83c\udf81"},{id:"social",name:"Social",icon:"\ud83d\udc65"}],w="all"===u?i:i.filter((e=>e.category===u)),_=e=>{if(!p)return;const t=((e,t,n,s,a)=>{const i=n.find((t=>t.id===e));if(!i)return alert("Employee with id ".concat(e," not found")),!1;if(!B(i,t))return alert("Insufficient points! You need ".concat(t.cost," points but only have ").concat(i.points,".")),!1;const o=new Date,l=(0,N.po)(o),c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"});s((n=>n.map((n=>n.id===e?(0,r.A)((0,r.A)({},n),{},{points:n.points-t.cost}):n))));const d={id:Date.now(),employeeId:e,itemId:t.id,itemName:t.name,cost:t.cost,purchasedAt:c,date:l,status:"pending"};return a((e=>{const n=e[l]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:22,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},s=Array.isArray(n.purchases)?[...n.purchases,d]:[d],a=(n.totalPointsSpent||0)+t.cost;return(0,r.A)((0,r.A)({},e),{},{[l]:(0,r.A)((0,r.A)({},n),{},{purchases:s,totalPointsSpent:a})})})),console.log("\ud83d\uded2 Purchase logged:",d),!0})(s.id,e,a,l,c);t&&alert("\ud83c\udf89 Successfully purchased: ".concat(e.name,"! Check with your manager to redeem."))};e.useEffect((()=>{o&&Object.keys(o).length>0&&d()}),[o,d]);const T=e=>{switch(e){case"food":return(0,k.jsx)(M,{className:"w-4 h-4"});case"break":return(0,k.jsx)(L,{className:"w-4 h-4"});case"reward":return(0,k.jsx)(F,{className:"w-4 h-4"});case"social":return(0,k.jsx)(b,{className:"w-4 h-4"});default:return(0,k.jsx)(S,{className:"w-4 h-4"})}};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-sm p-6 text-white",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-2xl font-bold",children:"Your Points"}),(0,k.jsx)("div",{className:"text-4xl font-bold mt-2",children:g}),(0,k.jsx)("div",{className:"text-purple-100 text-sm",children:"Available to spend"})]}),(0,k.jsx)("div",{className:"text-6xl opacity-50",children:"\ud83d\udc8e"})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-purple-400",children:[(0,k.jsxs)("button",{onClick:()=>m(!f),className:"flex items-center bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors",children:[(0,k.jsx)(U,{className:"w-4 h-4 mr-2"}),"Purchase History"]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{className:"text-sm text-purple-100",children:"Your Rank"}),(0,k.jsxs)("div",{className:"font-bold",children:["#",x.findIndex((e=>e.id===s.id))+1||"Unranked"]})]})]})]}),f&&(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recent Purchases"}),v.length>0?(0,k.jsx)("div",{className:"space-y-3",children:v.slice(0,10).map((e=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"text-lg mr-3",children:"\ud83d\uded2"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.itemName}),(0,k.jsxs)("div",{className:"text-sm text-gray-500",children:[e.date," at ",e.purchasedAt]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"font-bold text-purple-600",children:["-",e.cost," pts"]}),(0,k.jsx)("div",{className:"text-xs px-2 py-1 rounded-full ".concat("pending"===e.status?"bg-yellow-100 text-yellow-700":"approved"===e.status?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:e.status})]})]},e.id)))}):(0,k.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No purchases yet. Start earning points by completing tasks!"})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Store Categories"}),(0,k.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map((e=>(0,k.jsxs)("button",{onClick:()=>h(e.id),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(u===e.id?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,k.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)(W,{className:"w-5 h-5 mr-2"}),"all"===u?"All Items":null===(n=y.find((e=>e.id===u)))||void 0===n?void 0:n.name]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((e=>{const t=!!p&&B(p,e);return(0,k.jsxs)("div",{className:"border rounded-lg p-4 transition-all ".concat(t?"border-green-200 hover:border-green-300 hover:shadow-md":"border-gray-200 opacity-60"),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,k.jsx)("div",{className:"text-3xl",children:e.icon}),(0,k.jsx)("div",{className:"flex items-center",children:T(e.category)})]}),(0,k.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:e.name}),(0,k.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"text-lg font-bold text-purple-600",children:[e.cost," pts"]}),(0,k.jsx)("button",{onClick:()=>_(e),disabled:!t||!e.available,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(t&&e.available?"bg-purple-500 text-white hover:bg-purple-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:e.available?t?"Purchase":"Need more points":"Unavailable"})]}),!t&&e.available&&(0,k.jsxs)("div",{className:"mt-2 text-xs text-red-500",children:["Need ",e.cost-g," more points"]})]},e.id)}))}),0===w.length&&(0,k.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No items available in this category"})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)(z,{className:"w-5 h-5 mr-2"}),"Points Leaderboard"]}),(0,k.jsx)("div",{className:"space-y-3",children:x.map(((e,t)=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg ".concat(e.id===s.id?"bg-purple-50 border border-purple-200":"bg-gray-50"),children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-3 ".concat(0===t?"bg-yellow-400 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 text-gray-600"),children:t+1}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"font-medium text-gray-800",children:[e.name,e.id===s.id&&(0,k.jsx)("span",{className:"ml-2 text-purple-600 text-sm",children:"(You)"})]}),(0,k.jsx)("div",{className:"text-sm text-gray-500",children:e.role})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"font-bold text-purple-600",children:[e.points," pts"]}),0===t&&(0,k.jsx)("div",{className:"text-xs text-yellow-600",children:"\ud83d\udc51 Top Performer"})]})]},e.id)))})]})]})};var V=n(526);const q=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Y=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),K=o("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),G=o("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),X=o("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Q=o("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);class J{constructor(e){this.clock={},e&&(this.clock=(0,r.A)({},e))}increment(e){this.clock[e]||(this.clock[e]=0),this.clock[e]++}update(e){for(const[t,n]of Object.entries(e))(!this.clock[t]||this.clock[t]<n)&&(this.clock[t]=n)}compare(e){let t=!1,n=!1,r=!0;const s=new Set([...Object.keys(this.clock),...Object.keys(e)]);for(const o of s){const s=this.clock[o]||0,a=e[o]||0;s<a?(t=!0,r=!1):s>a&&(n=!0,r=!1)}if(r)return"concurrent";if(t&&!n)return"before";if(!t&&n)return"after";const a=Object.values(this.clock).reduce(((e,t)=>e+t),0),i=Object.values(e).reduce(((e,t)=>e+t),0);return a>i?"after":a<i?"before":"concurrent"}merge(e){const t=(0,r.A)({},this.clock);for(const[n,r]of Object.entries(e))t[n]=Math.max(t[n]||0,r);return t}getClock(){return(0,r.A)({},this.clock)}}class Z{constructor(e,t){this.deviceId=void 0,this.vectorClock=void 0,this.deviceId=e,this.vectorClock=new J(t)}createOperation(e,t,n){this.vectorClock.increment(this.deviceId);return{id:"".concat(this.deviceId,"-").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8)),type:e,payload:t,timestamp:Date.now(),deviceId:this.deviceId,vectorClock:this.vectorClock.getClock(),targetField:n,version:this.vectorClock.getClock()[this.deviceId]||0}}applyOperation(e,t){if("tasks"===e.targetField)switch(e.type){case"ADD_TASK":return(0,r.A)((0,r.A)({},t),{},{tasks:[...t.tasks,e.payload]});case"COMPLETE_TASK":return(0,r.A)((0,r.A)({},t),{},{tasks:t.tasks.map((t=>t.id===e.payload.id?(0,r.A)((0,r.A)({},t),{},{completed:!0}):t))});case"DELETE_ITEM":return(0,r.A)((0,r.A)({},t),{},{tasks:t.tasks.filter((t=>t.id!==e.payload.id))});default:return t}if("employees"===e.targetField)switch(e.type){case"UPDATE_EMPLOYEE":return(0,r.A)((0,r.A)({},t),{},{employees:t.employees.map((t=>t.id===e.payload.id?(0,r.A)((0,r.A)({},t),e.payload):t))});case"DELETE_ITEM":return(0,r.A)((0,r.A)({},t),{},{employees:t.employees.filter((t=>t.id!==e.payload.id))});default:return t}return t}resolveConflicts(e){const t=new Map;for(const n of e){const e="".concat(n.targetField,":").concat(n.payload.id||n.id);if(t.has(e)){const r=t.get(e),s=new J(r.vectorClock).compare(n.vectorClock);("before"===s||"concurrent"===s&&n.timestamp>r.timestamp)&&t.set(e,n)}else t.set(e,n)}return Array.from(t.values())}rollbackOperations(e,t){let n=(0,r.A)({},t);for(const s of e)if("tasks"===s.targetField)switch(s.type){case"ADD_TASK":n.tasks=n.tasks.filter((e=>e.id!==s.payload.id));break;case"COMPLETE_TASK":n.tasks=n.tasks.map((e=>e.id===s.payload.id?(0,r.A)((0,r.A)({},e),{},{completed:!1}):e));break;case"DELETE_ITEM":n.tasks=[...n.tasks,s.payload]}return n}}const ee=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})()),te=new class{constructor(){this.queue=[],this.db=null,this.dbName="SyncOfflineQueue",this.storeName="operations",this._lastLogTime=null,this.initDB()}initDB(){const e=indexedDB.open(this.dbName,1);e.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:"id"})},e.onsuccess=()=>{this.db=e.result,this.loadQueueFromDB()},e.onerror=()=>{console.error("OfflineQueue: Failed to open IndexedDB")}}loadQueueFromDB(){if(!this.db)return;const e=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).getAll();e.onsuccess=()=>{this.queue=e.result||[]}}enqueue(e){this.queue.push(e),this.saveOperationToDB(e)}saveOperationToDB(e){if(!this.db)return;this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).put(e)}saveQueueToDB(){if(!this.db)return;const e=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName);e.clear().onsuccess=()=>{for(const t of this.queue)e.put(t)}}compactOperationLog(){const e=new Map;for(const t of this.queue){const n="".concat(t.targetField,":").concat(t.payload.id||t.id);e.set(n,t)}this.queue=Array.from(e.values()),this.saveQueueToDB()}cleanExpiredOperations(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6048e5;const t=Date.now();this.queue=this.queue.filter((n=>t-n.timestamp<e)),this.saveQueueToDB()}async processQueue(e){this.compactOperationLog(),this.cleanExpiredOperations();const t=this.queue.filter((e=>"COMPLETE_TASK"===e.type)),n=this.queue.filter((e=>"ADD_TASK"===e.type||"UPDATE_EMPLOYEE"===e.type)),r=this.queue.filter((e=>"DELETE_ITEM"===e.type));for(const s of t)await e(s),this.removeOperationFromDB(s.id);n.length&&await Promise.all(n.map((async t=>{await e(t),this.removeOperationFromDB(t.id)}))),r.forEach(((t,n)=>{setTimeout((async()=>{await e(t),this.removeOperationFromDB(t.id)}),1e3*n)})),this.loadQueueFromDB()}removeAppliedOperations(e){this.queue=this.queue.filter((t=>!e.includes(t.id))),this.saveQueueToDB()}removeOperationFromDB(e){if(!this.db)return;this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(e),this.queue=this.queue.filter((t=>t.id!==e))}prioritizeOperations(){return[...this.queue.filter((e=>"COMPLETE_TASK"===e.type)),...this.queue.filter((e=>"ADD_TASK"===e.type||"UPDATE_EMPLOYEE"===e.type)),...this.queue.filter((e=>"DELETE_ITEM"===e.type))]}resolveQueueConflicts(){}logThrottled(e){(!this._lastLogTime||Date.now()-this._lastLogTime>2e3)&&(console.log("[OfflineQueue]",e),this._lastLogTime=Date.now())}monitorPerformance(e,t){const n=performance.now();t();const r=performance.now()-n;r>100&&this.logThrottled("\u26a0\ufe0f ".concat(e," took ").concat(Math.round(r),"ms"))}};function ne(e,t){return ee.applyOperation(t,{tasks:e}).tasks}const re=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());function se(e,t){return re.applyOperation(t,{employees:e}).employees}new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());const ae=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());function ie(e,t){return ae.applyOperation(t,{storeItems:e}).storeItems}new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());const oe=(e,t,n,r,s,a)=>{if(e.trim()){const o={id:Math.max(...n.map((e=>e.id)),0)+1,name:e.trim(),mood:3,lastUpdated:"Just added",role:t,lastMoodDate:null,points:0},l=(i=o,re.createOperation("UPDATE_EMPLOYEE",i,"employees"));r((e=>se(e,l))),s(""),a("Cleaner")}var i},le=(e,t)=>{window.confirm("Are you sure you want to remove this employee?")&&t((t=>{const n=function(e,t){const n=e.find((e=>e.id===t));if(!n)throw new Error("Employee not found");return re.createOperation("DELETE_ITEM",n,"employees")}(t,e);return se(t,n)}))},ce=(e,t,n,s)=>{s((s=>{const a=function(e,t,n,s){const a=e.find((e=>e.id===t));if(!a)throw new Error("Employee not found");const i=(0,r.A)((0,r.A)({},a),{},{[n]:s});return re.createOperation("UPDATE_EMPLOYEE",i,"employees")}(s,e,t,n);return se(s,a)}))},de=(e,t,n,s)=>{s((s=>{const a=function(e,t,n,s){const a=e.find((e=>e.id===t));if(!a)throw new Error("Task not found");const i=(0,r.A)((0,r.A)({},a),{},{[n]:s});return ee.createOperation("ADD_TASK",i,"tasks")}(s,e,t,n);return ne(s,a)}))},ue=(e,t)=>{window.confirm("Are you sure you want to remove this task?")&&t((t=>{const n=function(e,t){const n=e.find((e=>e.id===t));if(!n)throw new Error("Task not found");return ee.createOperation("DELETE_ITEM",n,"tasks")}(t,e);return ne(t,n)}))};var he=n(491),fe=n.n(he);const me=t=>{let{employees:n,tasks:a,customRoles:i,storeItems:o,prepItems:l,setEmployees:c,setTasks:u,setCustomRoles:h,setStoreItems:p,setPrepItems:v,quickSave:x}=t;const[y,w]=(0,e.useState)(!1),[_,T]=(0,e.useState)(!1),[C,E]=(0,e.useState)(!1),[j,A]=(0,e.useState)(""),[I,D]=(0,e.useState)("Cleaner"),[R,P]=(0,e.useState)(""),[O,M]=(0,e.useState)(null),[F,U]=(0,e.useState)(null),[W,z]=(0,e.useState)(null),[B,H]=(0,e.useState)(null),[$,J]=(0,e.useState)(null),[Z,ee]=(0,e.useState)(""),[ne,re]=(0,e.useState)(""),[se,he]=(0,e.useState)(""),[me,pe]=(0,e.useState)("food"),[ge,ve]=(0,e.useState)("\ud83c\udf81"),[xe,ye]=(0,e.useState)(""),[be,we]=(0,e.useState)("majoneesit"),[Ne,ke]=(0,e.useState)(""),[_e,Se]=(0,e.useState)(""),[Te,Ce]=(0,e.useState)(!1),[Ee,je]=(0,e.useState)({ingredients:"",instructions:""}),Ae=[{id:"majoneesit",name:"Majoneesit",icon:"\ud83e\udd44"},{id:"proteiinit",name:"Proteiinit",icon:"\ud83e\udd69"},{id:"kasvikset",name:"Kasvikset",icon:"\ud83e\udd57"},{id:"marinointi",name:"Marinointi & pikkel\xf6inti",icon:"\ud83e\udd52"},{id:"kastikkeet",name:"Kastikkeet",icon:"\ud83e\uddc2"},{id:"muut",name:"Muut",icon:"\ud83d\udd27"}],[Ie,De]=(0,e.useState)([]),Re=()=>{((e,t,n,r)=>{e.trim()&&!t.includes(e.trim())&&(n((t=>[...t,e.trim()])),r(""))})(R,i,h,P)},Pe=(e,t,n)=>{!function(e,t,n,s,a){const i=e.find((e=>e.id===t));if(!i)throw new Error("StoreItem not found");const o=(0,r.A)((0,r.A)({},i),{},{[n]:s}),l=ae.createOperation("ADD_TASK",o,"storeItems");te.enqueue(l),a((e=>ie(e,l)))}(o,e,t,n,p)},Oe=e=>{!function(e,t,n){const r=e.find((e=>e.id===t));if(!r)throw new Error("StoreItem not found");const s=ae.createOperation("DELETE_ITEM",r,"storeItems");te.enqueue(s),n((e=>ie(e,s)))}(o,e,p)},Me=(e,t,n)=>{v((s=>s.map((s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{[t]:n}):s))))},Le=(e,t,n)=>{v((s=>s.map((s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{recipe:s.recipe?(0,r.A)((0,r.A)({},s.recipe),{},{[t]:n}):{ingredients:"",instructions:"",[t]:n}}):s))))},Fe=(e,t,n)=>{const r=l.find((t=>t.id===e));if(null===r||void 0===r||!r.recipe)return;const s=document.getElementById("".concat(t,"-").concat(e));if(!s)return;const a=s.selectionStart,i=s.selectionEnd,o=r.recipe[t],c=o.substring(0,a),d=o.substring(a,i),u=o.substring(i);let h="";switch(n){case"bold":h=c+"**"+d+"**"+u;break;case"italic":h=c+"*"+d+"*"+u;break;case"bullet":h=c+"\n\u2022 "+u;break;case"number":h=c+"\n1. "+u;break;default:return}Le(e,t,h)},[Ue,We]=(0,e.useState)({}),ze=e.useCallback(fe()(((e,t,n)=>{de(e,t,n,u),We((t=>{const{[e]:n}=t;return s(t,[e].map(V.A))}))}),800),[u]),Be=(e,t,n)=>{We((s=>(0,r.A)((0,r.A)({},s),{},{[e]:(0,r.A)((0,r.A)({},s[e]),{},{[t]:n})}))),ze(e,t,n)},He=(e,t)=>{var n,r;return null!==(n=null===(r=Ue[e.id])||void 0===r?void 0:r[t])&&void 0!==n?n:e[t]},Ve=(e,t,n)=>{De((s=>s.map((s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{[t]:n}):s))))};return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(y?"p-6":"p-2"),children:[(0,k.jsxs)("button",{onClick:()=>w(!y),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(y?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(d,{className:"mr-2 ".concat(y?"w-5 h-5":"w-4 h-4")}),"Role Management"]}),(0,k.jsx)("span",{className:"transition-transform ".concat(y?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),y&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Role"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("input",{type:"text",placeholder:"Role name",value:R,onChange:e=>P(e.target.value),onKeyPress:e=>"Enter"===e.key&&Re(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,k.jsx)("button",{onClick:Re,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center",children:(0,k.jsx)(q,{className:"w-4 h-4"})})]})]}),(0,k.jsx)("div",{className:"space-y-2",children:i.map((e=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,k.jsx)("span",{className:"font-medium text-gray-700",children:e}),(0,k.jsx)("button",{onClick:()=>((e,t,n)=>{const r=t.filter((t=>t.role===e));r.length>0?alert('Cannot remove role "'.concat(e,'" - ').concat(r.length," employee(s) are using it.")):window.confirm('Are you sure you want to remove the role "'.concat(e,'"?'))&&n((t=>t.filter((t=>t!==e))))})(e,n,h),className:"p-1 text-red-600 hover:text-red-800",title:"Remove role",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]},e)))})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(_?"p-6":"p-2"),children:[(0,k.jsxs)("button",{onClick:()=>T(!_),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(_?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(g,{className:"mr-2 ".concat(_?"w-5 h-5":"w-4 h-4")}),"Store Management"]}),(0,k.jsx)("span",{className:"transition-transform ".concat(_?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),_&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Store Item"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),(0,k.jsx)("input",{type:"text",placeholder:"e.g., Free Coffee",value:Z,onChange:e=>ee(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost (Points)"}),(0,k.jsx)("input",{type:"number",min:"1",placeholder:"10",value:se,onChange:e=>he(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,k.jsxs)("select",{value:me,onChange:e=>pe(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,k.jsx)("option",{value:"food",children:"Food & Drinks"}),(0,k.jsx)("option",{value:"break",children:"Time Off"}),(0,k.jsx)("option",{value:"reward",children:"Rewards"}),(0,k.jsx)("option",{value:"social",children:"Social"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icon"}),(0,k.jsx)("input",{type:"text",placeholder:"\ud83c\udf81",value:ge,onChange:e=>ve(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{className:"md:col-span-2",children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,k.jsx)("input",{type:"text",placeholder:"e.g., Get a free coffee from the kitchen",value:ne,onChange:e=>re(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsx)("div",{className:"md:col-span-2",children:(0,k.jsxs)("button",{onClick:()=>{if(Z.trim()&&ne.trim()&&se.trim()){const e={id:Math.max(...o.map((e=>e.id)),0)+1,name:Z.trim(),description:ne.trim(),cost:parseInt(se)||10,category:me,icon:ge,available:!0};!function(e,t,n){const r=ae.createOperation("ADD_TASK",n,"storeItems");te.enqueue(r),t((e=>ie(e,r)))}(0,p,e),ee(""),re(""),he(""),pe("food"),ve("\ud83c\udf81")}},className:"w-full bg-purple-500 text-white py-2 px-4 rounded-lg hover:bg-purple-600 flex items-center justify-center",children:[(0,k.jsx)(K,{className:"w-4 h-4 mr-2"}),"Add Store Item"]})})]})]}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700",children:"Current Store Items"}),o.map((e=>(0,k.jsxs)("div",{className:"border rounded-lg p-4 bg-white",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Name"}),W===e.id?(0,k.jsx)("input",{type:"text",value:e.name,onChange:t=>Pe(e.id,"name",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsxs)("div",{className:"font-medium text-gray-800 flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:e.icon}),e.name]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Cost"}),W===e.id?(0,k.jsx)("input",{type:"number",min:"1",value:e.cost,onChange:t=>Pe(e.id,"cost",parseInt(t.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(S,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,k.jsxs)("span",{className:"font-medium text-purple-600",children:[e.cost," pts"]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),W===e.id?(0,k.jsxs)("select",{value:e.category,onChange:t=>Pe(e.id,"category",t.target.value),className:"w-full px-2 py-1 border rounded text-sm",children:[(0,k.jsx)("option",{value:"food",children:"Food & Drinks"}),(0,k.jsx)("option",{value:"break",children:"Time Off"}),(0,k.jsx)("option",{value:"reward",children:"Rewards"}),(0,k.jsx)("option",{value:"social",children:"Social"})]}):(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("food"===e.category?"bg-orange-100 text-orange-700":"break"===e.category?"bg-blue-100 text-blue-700":"reward"===e.category?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"),children:e.category})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),(0,k.jsx)("button",{onClick:()=>Pe(e.id,"available",!e.available),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.available?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.available?"Available":"Unavailable"})]})]}),(0,k.jsxs)("div",{className:"flex gap-2 ml-4",children:[W===e.id?(0,k.jsx)("button",{onClick:()=>z(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,k.jsx)(G,{className:"w-4 h-4"})}):(0,k.jsx)("button",{onClick:()=>z(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,k.jsx)(X,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>Oe(e.id),className:"p-1 text-red-600 hover:text-red-800",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]})]}),(0,k.jsxs)("div",{className:"mt-3",children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Description"}),W===e.id?(0,k.jsx)("input",{type:"text",value:e.description,onChange:t=>Pe(e.id,"description",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),W===e.id&&(0,k.jsxs)("div",{className:"mt-2",children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Icon"}),(0,k.jsx)("input",{type:"text",value:e.icon,onChange:t=>Pe(e.id,"icon",t.target.value),className:"w-20 px-2 py-1 border rounded text-sm",placeholder:"\ud83c\udf81"})]})]},e.id))),0===o.length&&(0,k.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No store items yet. Add your first item above!"})]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(C?"p-6":"p-2"),children:[(0,k.jsxs)("button",{onClick:()=>E(!C),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(C?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(m,{className:"mr-2 ".concat(C?"w-5 h-5":"w-4 h-4")}),"Prep List Management"]}),(0,k.jsx)("span",{className:"transition-transform ".concat(C?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),C&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Prep Item"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prep Name"}),(0,k.jsx)("input",{type:"text",placeholder:"e.g., Valkosipulimajoneesi",value:xe,onChange:e=>ye(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,k.jsx)("select",{value:be,onChange:e=>we(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:Ae.map((e=>(0,k.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id)))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Time"}),(0,k.jsx)("input",{type:"text",placeholder:"e.g., 15 min",value:Ne,onChange:e=>ke(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency (days)"}),(0,k.jsx)("input",{type:"number",min:"1",max:"30",placeholder:"3",value:_e,onChange:e=>Se(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,k.jsx)("div",{className:"md:col-span-2",children:(0,k.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[(0,k.jsx)("input",{type:"checkbox",checked:Te,onChange:e=>Ce(e.target.checked),className:"rounded border-gray-300 text-green-500 focus:ring-green-500"}),(0,k.jsx)("span",{children:"Include Recipe"})]})}),Te&&(0,k.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredients"}),(0,k.jsx)("textarea",{value:Ee.ingredients,onChange:e=>je((t=>(0,r.A)((0,r.A)({},t),{},{ingredients:e.target.value}))),placeholder:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),(0,k.jsx)("textarea",{value:Ee.instructions,onChange:e=>je((t=>(0,r.A)((0,r.A)({},t),{},{instructions:e.target.value}))),placeholder:"1. **Sekoita**: Yhdist\xe4 majoneesi ja valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm"})]})]}),(0,k.jsx)("div",{className:"md:col-span-2",children:(0,k.jsxs)("button",{onClick:async()=>{if(xe.trim()&&Ne.trim()&&_e.trim()){const e={id:Math.max(...l.map((e=>e.id)),0)+1,name:xe.trim(),category:be,estimatedTime:Ne.trim(),isCustom:!0,hasRecipe:Te,frequency:parseInt(_e)||1,recipe:Te?Ee:null};v((t=>{const n=[...t,e];return x("prepItems",n),n})),ye(""),we("majoneesit"),ke(""),Se(""),Ce(!1),je({ingredients:"",instructions:""})}},className:"w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 flex items-center justify-center",children:[(0,k.jsx)(m,{className:"w-4 h-4 mr-2"}),"Add Prep Item"]})})]})]}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("h4",{className:"font-medium text-gray-700",children:["Current Prep Items (",l.length,")"]}),l.map((e=>{var t,n;const s=Ae.find((t=>t.id===e.category));return(0,k.jsxs)("div",{className:"border rounded-lg p-4 bg-white",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Name"}),B===e.id?(0,k.jsx)("input",{type:"text",value:e.name,onChange:t=>Me(e.id,"name",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsxs)("div",{className:"font-medium text-gray-800 flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:null===s||void 0===s?void 0:s.icon}),e.name]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),B===e.id?(0,k.jsx)("select",{value:e.category,onChange:t=>Me(e.id,"category",t.target.value),className:"w-full px-2 py-1 border rounded text-sm",children:Ae.map((e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id)))}):(0,k.jsx)("span",{className:"text-sm text-gray-600",children:null===s||void 0===s?void 0:s.name})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Time"}),B===e.id?(0,k.jsx)("input",{type:"text",value:e.estimatedTime,onChange:t=>Me(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,k.jsx)(L,{className:"w-3 h-3 mr-1"}),e.estimatedTime]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Frequency"}),B===e.id?(0,k.jsx)("input",{type:"number",min:"1",max:"30",value:e.frequency,onChange:t=>Me(e.id,"frequency",parseInt(t.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm"}):(0,k.jsxs)("span",{className:"text-sm text-gray-600",children:["Every ",e.frequency," days"]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Recipe"}),(0,k.jsx)("div",{className:"flex items-center space-x-2",children:(0,k.jsx)("button",{onClick:()=>Me(e.id,"hasRecipe",!e.hasRecipe),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.hasRecipe?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.hasRecipe?"\ud83d\udcd6 Has Recipe":"No Recipe"})})]})]}),(0,k.jsxs)("div",{className:"flex gap-2 ml-4",children:[B===e.id?(0,k.jsx)("button",{onClick:()=>{return t=e.id,v((e=>{const n=e.map((e=>e.id===t?(0,r.A)({},e):e));return x("prepItems",n),n})),H(null),void J(null);var t},className:"p-1 text-green-600 hover:text-green-800",children:(0,k.jsx)(G,{className:"w-4 h-4"})}):(0,k.jsx)("button",{onClick:()=>{e.hasRecipe?(J($===e.id?null:e.id),H(e.id)):H(e.id)},className:"p-1 text-blue-600 hover:text-blue-800",children:(0,k.jsx)(X,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to remove this prep item?")&&v((e=>{const n=e.filter((e=>e.id!==t));return x("prepItems",n),n})));var t},className:"p-1 text-red-600 hover:text-red-800",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]})]}),$===e.id&&e.hasRecipe&&(0,k.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,k.jsx)("h5",{className:"font-medium text-gray-700 mb-3",children:"Recipe Editor"}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredients"}),(0,k.jsxs)("div",{className:"mb-2 flex space-x-2",children:[(0,k.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","bold"),className:"px-2 py-1 bg-gray-100 rounded text-sm font-bold hover:bg-gray-200",children:"B"}),(0,k.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","italic"),className:"px-2 py-1 bg-gray-100 rounded text-sm italic hover:bg-gray-200",children:"I"}),(0,k.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","bullet"),className:"px-2 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:"\u2022"})]}),(0,k.jsx)("textarea",{id:"ingredients-".concat(e.id),value:(null===(t=e.recipe)||void 0===t?void 0:t.ingredients)||"",onChange:t=>Le(e.id,"ingredients",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm",placeholder:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),(0,k.jsxs)("div",{className:"mb-2 flex space-x-2",children:[(0,k.jsx)("button",{onClick:()=>Fe(e.id,"instructions","bold"),className:"px-2 py-1 bg-gray-100 rounded text-sm font-bold hover:bg-gray-200",children:"B"}),(0,k.jsx)("button",{onClick:()=>Fe(e.id,"instructions","italic"),className:"px-2 py-1 bg-gray-100 rounded text-sm italic hover:bg-gray-200",children:"I"}),(0,k.jsx)("button",{onClick:()=>Fe(e.id,"instructions","number"),className:"px-2 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:"1."})]}),(0,k.jsx)("textarea",{id:"instructions-".concat(e.id),value:(null===(n=e.recipe)||void 0===n?void 0:n.instructions)||"",onChange:t=>Le(e.id,"instructions",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm",placeholder:"1. **Sekoita**: Yhdist\xe4 majoneesi ja valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu"})]})]})]})]},e.id)})),0===l.length&&(0,k.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No prep items yet. Add your first prep item above!"})]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)(b,{className:"w-5 h-5 mr-2"}),"Employee Management"]}),(0,k.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Employee"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("input",{type:"text",placeholder:"Employee name",value:j,onChange:e=>A(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,k.jsx)("select",{value:I,onChange:e=>D(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:i.map((e=>(0,k.jsx)("option",{value:e,children:e},e)))}),(0,k.jsx)("button",{onClick:()=>{oe(j,I,n,c,A,D)},className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center",children:(0,k.jsx)(Q,{className:"w-4 h-4"})})]})]}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-gray-50",children:[(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Name"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Role"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Points"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Mood"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Last Updated"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"Actions"})]})}),(0,k.jsx)("tbody",{children:n.map((e=>(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:O===e.id?(0,k.jsx)("input",{type:"text",value:e.name,onChange:t=>ce(e.id,"name",t.target.value,c),className:"w-full px-2 py-1 border rounded"}):e.name}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:O===e.id?(0,k.jsx)("select",{value:e.role,onChange:t=>ce(e.id,"role",t.target.value,c),className:"w-full px-2 py-1 border rounded",children:i.map((e=>(0,k.jsx)("option",{value:e,children:e},e)))}):e.role}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(S,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,k.jsx)("span",{className:"font-medium text-purple-600",children:e.points})]})}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat((0,N.zQ)(e.mood))}),e.mood,"/5"]})}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2 text-sm text-gray-600",children:e.lastUpdated}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex gap-2 justify-center",children:[O===e.id?(0,k.jsx)("button",{onClick:()=>M(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,k.jsx)(G,{className:"w-4 h-4"})}):(0,k.jsx)("button",{onClick:()=>M(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,k.jsx)(X,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>le(e.id,c),className:"p-1 text-red-600 hover:text-red-800",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]})})]},e.id)))})]})})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,k.jsx)(f,{className:"w-5 h-5 mr-2"}),"Task Management"]}),(0,k.jsxs)("button",{onClick:()=>{const e=Math.max(0,...a.map((e=>e.id)),...Ie.map((e=>e.id)))+1,t={id:e,task:"",location:"",priority:"medium",estimatedTime:"",points:5};De((e=>[...e,t])),U(e)},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center",children:[(0,k.jsx)(q,{className:"w-4 h-4 mr-2"}),"Add Task"]})]}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-gray-50",children:[(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Task"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Location"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Priority"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Points"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Est. Time"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"Actions"})]})}),(0,k.jsxs)("tbody",{children:[Ie.map((e=>(0,k.jsxs)("tr",{className:"hover:bg-yellow-50",children:[(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsx)("input",{type:"text",value:e.task,onChange:t=>Ve(e.id,"task",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsx)("input",{type:"text",value:e.location,onChange:t=>Ve(e.id,"location",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsxs)("select",{value:e.priority,onChange:t=>Ve(e.id,"priority",t.target.value),className:"w-full px-2 py-1 border rounded",children:[(0,k.jsx)("option",{value:"low",children:"Low"}),(0,k.jsx)("option",{value:"medium",children:"Medium"}),(0,k.jsx)("option",{value:"high",children:"High"})]})}),(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsx)("input",{type:"number",min:"1",max:"100",value:e.points,onChange:t=>Ve(e.id,"points",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsx)("input",{type:"text",value:e.estimatedTime,onChange:t=>Ve(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,k.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,k.jsx)("button",{onClick:()=>(e=>{const t=Ie.find((t=>t.id===e));t&&(u((e=>[...e,t])),De((t=>t.filter((t=>t.id!==e)))),U(null))})(e.id),className:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",title:"Save Task",children:(0,k.jsx)(G,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,De((e=>e.filter((e=>e.id!==t)))),void U(null);var t},className:"px-2 py-1 bg-gray-400 text-white rounded hover:bg-gray-600",title:"Cancel",children:"\u2715"})]})})]},e.id))),a.map((e=>(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,k.jsx)("input",{type:"text",value:He(e,"task"),onChange:t=>Be(e.id,"task",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.task}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,k.jsx)("input",{type:"text",value:He(e,"location"),onChange:t=>Be(e.id,"location",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.location}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,k.jsxs)("select",{value:e.priority,onChange:t=>de(e.id,"priority",t.target.value,u),className:"w-full px-2 py-1 border rounded",children:[(0,k.jsx)("option",{value:"low",children:"Low"}),(0,k.jsx)("option",{value:"medium",children:"Medium"}),(0,k.jsx)("option",{value:"high",children:"High"})]}):(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.priority})}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,k.jsx)("input",{type:"number",min:"1",max:"100",value:e.points,onChange:t=>de(e.id,"points",t.target.value,u),className:"w-full px-2 py-1 border rounded"}):(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(S,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,k.jsx)("span",{className:"font-medium text-purple-600",children:e.points})]})}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,k.jsx)("input",{type:"text",value:He(e,"estimatedTime"),onChange:t=>Be(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.estimatedTime}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex gap-2 justify-center",children:[F===e.id?(0,k.jsx)("button",{onClick:()=>U(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,k.jsx)(G,{className:"w-4 h-4"})}):(0,k.jsx)("button",{onClick:()=>U(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,k.jsx)(X,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>ue(e.id,u),className:"p-1 text-red-600 hover:text-red-800",title:"Delete Task",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]})})]},e.id)))]})]})})]})]})},pe=o("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ge=o("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ve=e=>{var t,n,r,s;let{selectedDate:a,setSelectedDate:i,dailyData:o,employees:l,connectionStatus:c}=e;const d=o[a];return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,k.jsx)(pe,{className:"w-5 h-5 mr-2"}),"Daily Reports (Firebase Storage)"]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===c?"bg-green-500":"bg-red-500")}),(0,k.jsx)("span",{className:"text-xs text-gray-600",children:"connected"===c?"Live Data":"Offline"}),(0,k.jsx)("input",{type:"date",value:a,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"}),(0,k.jsxs)("button",{className:"px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 flex items-center",children:[(0,k.jsx)(ge,{className:"w-4 h-4 mr-1"}),"Export"]})]})]}),d?(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null===(t=d.completedTasks)||void 0===t?void 0:t.length)||0}),(0,k.jsx)("div",{className:"text-sm text-blue-700",children:"Tasks Completed"})]}),(0,k.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,k.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[d.completionRate||0,"%"]}),(0,k.jsx)("div",{className:"text-sm text-green-700",children:"Completion Rate"})]}),(0,k.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(null===(n=d.employeeMoods)||void 0===n?void 0:n.length)||0}),(0,k.jsx)("div",{className:"text-sm text-orange-700",children:"Mood Updates"})]})]}):(0,k.jsxs)("div",{className:"text-center py-8 text-gray-500",children:["No data available for ",a]})]}),(null===d||void 0===d?void 0:d.completedTasks)&&(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Task Completions"}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-gray-50",children:[(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Time"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Task"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Employee"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Status"})]})}),(0,k.jsx)("tbody",{children:d.completedTasks.map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.completedAt}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.taskName}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"Completed"})})]},t)}))})]})})]}),(null===d||void 0===d?void 0:d.employeeMoods)&&(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Mood Updates"}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-gray-50",children:[(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Time"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Employee"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Mood"}),(0,k.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Rating"})]})}),(0,k.jsx)("tbody",{children:d.employeeMoods.map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.updatedAt}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,k.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),w._M[e.mood-1]]})}),(0,k.jsxs)("td",{className:"border border-gray-200 px-4 py-2",children:[e.mood,"/5"]})]},t)}))})]})})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"30-Day Overview"}),(0,k.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,k.jsx)("div",{className:"text-sm font-medium text-gray-600 mb-1",children:(new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,k.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>(0,k.jsx)("div",{className:"text-xs font-medium text-gray-500 text-center",children:e},e))),(()=>{const e=new Date,t=[],n=new Date(e.getFullYear(),e.getMonth(),1);for(let s=0;s<n.getDay();s++)t.push((0,k.jsx)("div",{className:"p-2"},"empty-".concat(s)));const r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();for(let s=1;s<=r;s++){const n=new Date(e.getFullYear(),e.getMonth(),s),r=(0,N.po)(n),l=o[r]||{},c=(null===l||void 0===l?void 0:l.completionRate)||0,d=Math.floor((e.getTime()-n.getTime())/864e5);d>=0&&d<30?t.push((0,k.jsx)("div",{className:"p-2 rounded text-xs cursor-pointer transition-colors ".concat(r===a?"bg-purple-500 text-white":c>=80?"bg-green-100 text-green-700 hover:bg-green-200":c>=50?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":c>0?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"),onClick:()=>i(r),title:"".concat(n.toLocaleDateString("en-US",{month:"short"})," ").concat(n.getDate(),": ").concat(c,"% completion"),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{className:"font-medium",children:n.getDate()}),(0,k.jsxs)("span",{children:[c,"%"]})]})},r)):t.push((0,k.jsx)("div",{className:"p-2 rounded text-xs text-gray-300",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:n.getDate()}),(0,k.jsx)("span",{children:"-"})]})},"disabled-".concat(s)))}return t})()]})]}),(0,k.jsxs)("div",{className:"mt-4 flex justify-center space-x-4 text-xs",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-green-100 rounded mr-1"}),"80%+ completion"]}),(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-yellow-100 rounded mr-1"}),"50-79% completion"]}),(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-red-100 rounded mr-1"}),"Below 50%"]})]})]}),d&&(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Daily Summary - ",new Date(a).toLocaleDateString()]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-xl font-bold text-blue-600",children:(null===(r=d.completedTasks)||void 0===r?void 0:r.length)||0}),(0,k.jsx)("div",{className:"text-sm text-blue-700",children:"Tasks Done"})]}),(0,k.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[(0,k.jsxs)("div",{className:"text-xl font-bold text-green-600",children:[d.completionRate||0,"%"]}),(0,k.jsx)("div",{className:"text-sm text-green-700",children:"Completion"})]}),(0,k.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-xl font-bold text-purple-600",children:(null===(s=d.employeeMoods)||void 0===s?void 0:s.length)||0}),(0,k.jsx)("div",{className:"text-sm text-purple-700",children:"Mood Updates"})]})]}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse border border-gray-200",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-gray-50",children:[(0,k.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Time"}),(0,k.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Employee"}),(0,k.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Action"}),(0,k.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Details"})]})}),(0,k.jsxs)("tbody",{children:[(d.completedTasks||[]).map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.completedAt}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2",children:(0,k.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"\u2713 Task Completed"})}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.taskName})]},"task-".concat(t))})),(d.employeeMoods||[]).map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,k.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.updatedAt}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2",children:(0,k.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:"\ud83d\ude0a Mood Update"})}),(0,k.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),w._M[e.mood-1]," (",e.mood,"/5)"]})})]},"mood-".concat(t))})),(!d.completedTasks||0===d.completedTasks.length)&&(!d.employeeMoods||0===d.employeeMoods.length)&&(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:4,className:"border border-gray-200 px-3 py-8 text-center text-gray-500",children:"No activity recorded for this date"})})]})]})})]})]})},xe=o("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ye=[{id:"all",name:"All Items",icon:"\ud83c\udf7d\ufe0f"},{id:"majoneesit",name:"Majoneesit",icon:"\ud83e\udd44"},{id:"proteiinit",name:"Proteiinit",icon:"\ud83e\udd69"},{id:"kasvikset",name:"Kasvikset",icon:"\ud83e\udd57"},{id:"marinointi",name:"Marinointi & pikkel\xf6inti",icon:"\ud83e\udd52"},{id:"kastikkeet",name:"Kastikkeet",icon:"\ud83e\uddc2"},{id:"muut",name:"Muut",icon:"\ud83d\udd27"}],be=[{id:"morning",name:"Morning (6-10 AM)",icon:"\ud83c\udf05"},{id:"midday",name:"Mid-day (10 AM-2 PM)",icon:"\u2600\ufe0f"},{id:"afternoon",name:"Afternoon (2-6 PM)",icon:"\ud83c\udf24\ufe0f"},{id:"evening",name:"Evening (6-10 PM)",icon:"\ud83c\udf06"}],we=[{id:"low",name:"Low",color:"bg-green-100 text-green-700",icon:"\ud83d\udfe2"},{id:"medium",name:"Medium",color:"bg-yellow-100 text-yellow-700",icon:"\ud83d\udfe1"},{id:"high",name:"High",color:"bg-red-100 text-red-700",icon:"\ud83d\udd34"}],Ne=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},ke=e=>e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br/>"),_e=(e,t)=>"".concat(Ne(e),"-").concat(t),Se=()=>Date.now()+Math.random(),Te=o("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Ce=t=>{let{scheduledPreps:n,onToggleCompletion:r,onShowRecipe:s}=t;const[a,i]=(0,e.useState)(new Set),o=Ne(new Date),l=n.filter((e=>e.scheduledDate===o));e.useEffect((()=>{console.log("\ud83d\udd0d TodayView Debug Info:",{todayDateString:o,totalScheduledPreps:n.length,todayScheduledPreps:l.length,allScheduledDates:Array.from(new Set(n.map((e=>e.scheduledDate)))).sort(),sampleTodayPreps:l.slice(0,3).map((e=>({id:e.id,name:e.name,scheduledDate:e.scheduledDate,completed:e.completed})))})}),[o,n.length,l.length]);const c=l.filter((e=>e.completed)).length,d=l.length,h=e=>{var t;const n=we.find((t=>t.id===e.priority)),o=a.has(e.id);return(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg transition-all ".concat(o?"bg-blue-50 border-blue-200":"hover:bg-gray-50"),children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3 select-none",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(a.has(e))console.log("\u23f3 Completion toggle already in progress for prep:",e);else{i((t=>new Set(t).add(e)));try{console.log("\ud83d\udd04 TodayView: Toggling completion for prep:",e),await r(e),console.log("\u2705 TodayView: Completion toggle finished for prep:",e)}catch(t){console.error("\u274c TodayView: Completion toggle failed for prep:",e,t)}finally{i((t=>{const n=new Set(t);return n.delete(e),n}))}}})(e.id)},disabled:o,className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ".concat(e.completed?"bg-green-500 border-green-500":o?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-green-500"," ").concat(o?"cursor-wait":"cursor-pointer"," disabled:cursor-wait"),title:o?"Saving...":e.completed?"Mark as incomplete":"Mark as complete",children:o?(0,k.jsx)(Te,{className:"w-4 h-4 text-blue-500 animate-spin"}):e.completed?(0,k.jsx)(u,{className:"w-4 h-4 text-white"}):null}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"font-medium flex items-center space-x-2 transition-all ".concat(e.completed?"line-through text-gray-500":"text-gray-800"),children:[(0,k.jsx)("span",{children:e.name}),e.hasRecipe&&e.recipe&&(0,k.jsx)("button",{onClick:()=>s(e.recipe,e.name),className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"}),o&&(0,k.jsx)("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:"Saving..."})]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600",children:[e.estimatedTime," \u2022 ",e.category,e.timeSlot&&(0,k.jsxs)(k.Fragment,{children:[" "," \u2022 ",(null===(t=be.find((t=>t.id===e.timeSlot)))||void 0===t?void 0:t.name)||e.timeSlot]})]})]})]}),(0,k.jsx)("div",{className:"flex items-center space-x-2",children:(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===n||void 0===n?void 0:n.color)||"bg-gray-100 text-gray-700"),children:(null===n||void 0===n?void 0:n.name)||"Medium"})})]},e.id)};return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Today's Progress"}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:d}),(0,k.jsx)("div",{className:"text-sm text-blue-700",children:"Total Preps"})]}),(0,k.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-green-600",children:c}),(0,k.jsx)("div",{className:"text-sm text-green-700",children:"Completed"})]}),(0,k.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[(0,k.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[d>0?Math.round(c/d*100):0,"%"]}),(0,k.jsx)("div",{className:"text-sm text-purple-700",children:"Complete"})]})]}),d>0&&(0,k.jsxs)("div",{className:"mt-4",children:[(0,k.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,k.jsx)("span",{children:"Progress"}),(0,k.jsxs)("span",{children:[c," of ",d," tasks"]})]}),(0,k.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,k.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(d>0?c/d*100:0,"%")}})})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Today's Prep Tasks"}),a.size>0&&(0,k.jsxs)("div",{className:"flex items-center text-blue-600 text-sm",children:[(0,k.jsx)(Te,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving ",a.size," change",1!==a.size?"s":"","..."]})]}),0===l.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,k.jsx)(m,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,k.jsx)("p",{className:"text-lg mb-2",children:"No prep tasks scheduled for today"}),(0,k.jsx)("p",{className:"text-sm",children:'Use the "Plan Preps" tab to schedule tasks.'})]}):(0,k.jsxs)("div",{className:"space-y-4",children:[be.map((e=>{const t=l.filter((t=>t.timeSlot===e.id));if(0===t.length)return null;const n=t.filter((e=>e.completed)).length;return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("h4",{className:"font-medium text-gray-700 flex items-center",children:[(0,k.jsx)("span",{className:"mr-2",children:e.icon}),e.name]}),(0,k.jsxs)("span",{className:"text-sm text-gray-500",children:[n,"/",t.length," completed"]})]}),(0,k.jsx)("div",{className:"space-y-3",children:t.map(h)})]},e.id)})),(()=>{const e=l.filter((e=>""===e.timeSlot));if(0===e.length)return null;const t=e.filter((e=>e.completed)).length;return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 flex items-center",children:"\ud83d\udd50 Anytime"}),(0,k.jsxs)("span",{className:"text-sm text-gray-500",children:[t,"/",e.length," completed"]})]}),(0,k.jsx)("div",{className:"space-y-3",children:e.map(h)})]})})()]})]}),d>0&&c===d&&(0,k.jsxs)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 rounded-xl p-6 text-white text-center",children:[(0,k.jsx)("div",{className:"text-3xl mb-2",children:"\ud83c\udf89"}),(0,k.jsx)("h3",{className:"text-xl font-bold mb-1",children:"All Done!"}),(0,k.jsxs)("p",{className:"text-green-100",children:["Great job! You've completed all ",d," prep tasks for today."]})]})]})},Ee=t=>{let{scheduledPreps:n,currentDate:r,setCurrentDate:s,selectedDate:a,setSelectedDate:i,setActiveView:o,onToggleCompletion:l,onShowRecipe:c}=t;const[d,h]=(0,e.useState)(null),f=()=>{const e=[];for(let t=0;t<7;t++){const n=new Date(r);n.setDate(r.getDate()+t),e.push(n)}return e};return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n          .priority-glow {\n            position: relative;\n            z-index: 0;\n            font-weight: 600;\n            border-radius: 0.25rem;\n            padding: 0.125rem 0.25rem;\n          }\n          .priority-glow::before {\n            content: "";\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            width: 110%;\n            height: 2em;\n            transform: translate(-50%, -50%);\n            border-radius: 0.375rem;\n            filter: blur(6px);\n            z-index: -1;\n            opacity: 0.3;\n          }\n          .priority-low {\n            color: #047857;\n          }\n          .priority-low::before {\n            box-shadow: 0 0 8px 4px rgba(5, 150, 105, 0.4);\n          }\n          .priority-medium {\n            color: #92400e;\n          }\n          .priority-medium::before {\n            box-shadow: 0 0 8px 4px rgba(202, 138, 4, 0.4);\n          }\n          .priority-high {\n            color: #b91c1c;\n          }\n          .priority-high::before {\n            box-shadow: 0 0 8px 4px rgba(185, 28, 28, 0.4);\n          }\n        '}}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Week Overview"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("button",{onClick:()=>{const e=new Date(r);e.setDate(e.getDate()-7),s(e)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"\u2190 Previous Week"}),(0,k.jsx)("button",{onClick:()=>{const e=new Date(r);e.setDate(e.getDate()+7),s(e)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"Next Week \u2192"})]})]}),(0,k.jsx)("div",{className:"space-y-3",children:f().map(((e,t)=>{const r=n.filter((t=>t.scheduledDate===Ne(e))),s=r.filter((e=>e.completed)).length,f=Ne(e)===Ne(new Date),m=Ne(e)===Ne(a),p=d===Ne(e);return(0,k.jsxs)("div",{className:"border rounded-xl transition-all duration-500 ease-in-out overflow-hidden ".concat(p?"bg-gray-50":"bg-white hover:bg-gray-50"," ").concat(f?"ring-2 ring-blue-500":m&&!p?"ring-2 ring-purple-500":p?"ring-2 ring-green-500 shadow-lg":"hover:shadow-md"),children:[(0,k.jsxs)("div",{className:"flex items-center cursor-pointer transition-all duration-300 ".concat(p?"p-4 bg-white border-b":"p-4"),onClick:()=>{h(p?null:Ne(e))},children:[(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800 text-sm",children:e.toLocaleDateString("en-US",{weekday:"short"})}),(0,k.jsx)("div",{className:"text-2xl font-bold ".concat(f?"text-blue-600":m&&!p?"text-purple-600":p?"text-green-600":"text-gray-600"),children:e.getDate()}),f&&(0,k.jsx)("div",{className:"text-xs text-blue-600 font-medium",children:"Today"}),m&&!f&&!p&&(0,k.jsx)("div",{className:"text-xs text-purple-600 font-medium",children:"Selected"}),p&&(0,k.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Expanded"})]}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsxs)("div",{className:"text-sm text-gray-600",children:[s,"/",r.length," tasks"]}),r.length>0&&(0,k.jsx)("div",{className:"flex-1 max-w-32",children:(0,k.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,k.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(s===r.length?"bg-green-500":s>0?"bg-yellow-500":"bg-gray-300"),style:{width:"".concat(s/r.length*100,"%")}})})})]}),!p&&r.length>0&&(0,k.jsxs)("div",{className:"text-xs mt-1",children:[r.slice(0,2).map(((e,t)=>(0,k.jsxs)("span",{className:"priority-glow priority-".concat(e.priority," ").concat(t>0?"ml-1":""),children:[e.name,t<Math.min(r.length,2)-1&&", "]},e.id))),r.length>2&&(0,k.jsxs)("span",{className:"text-gray-500 ml-1",children:["+",r.length-2," more"]})]}),!p&&0===r.length&&(0,k.jsx)("div",{className:"text-xs text-gray-400 mt-1 italic",children:"No preps scheduled"})]})]}),(0,k.jsx)("div",{className:"transform transition-transform duration-300 ".concat(p?"rotate-180":"rotate-0"),children:(0,k.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,k.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,k.jsx)("div",{className:"transition-all duration-500 ease-in-out overflow-hidden ".concat(p?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:p&&(0,k.jsx)("div",{className:"p-4 space-y-3 overflow-y-auto max-h-80",children:0===r.length?(0,k.jsxs)("div",{className:"text-center py-8",children:[(0,k.jsx)("div",{className:"text-gray-400 text-sm",children:"No prep tasks scheduled"}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e),o("plan")},className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"Plan Preps for This Day"})]}):(0,k.jsxs)(k.Fragment,{children:[(()=>{const e=r.filter((e=>""===e.timeSlot)),t=be.map((e=>({slot:e,preps:r.filter((t=>t.timeSlot===e.id))}))).filter((e=>e.preps.length>0));return(0,k.jsxs)(k.Fragment,{children:[t.map((e=>{let{slot:t,preps:n}=e;return(0,k.jsxs)("div",{children:[(0,k.jsxs)("h5",{className:"font-medium text-gray-700 text-sm mb-2 flex items-center",children:[(0,k.jsx)("span",{className:"mr-2",children:t.icon}),t.name]}),(0,k.jsx)("div",{className:"space-y-2",children:n.map((e=>{const t=we.find((t=>t.id===e.priority));return(0,k.jsx)("div",{className:"p-3 rounded-lg border-l-4 transition-colors ".concat(e.completed?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:bg-gray-50"),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(e.completed?"bg-green-500 border-green-500":"border-gray-300 hover:border-green-500"),children:e.completed&&(0,k.jsx)(u,{className:"w-3 h-3 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"font-medium text-sm flex items-center space-x-2 priority-glow priority-".concat(e.priority," ").concat(e.completed?"line-through opacity-60":""),children:[(0,k.jsx)("span",{children:e.name}),e.hasRecipe&&(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),e.recipe&&c(e.recipe,e.name)},className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6"})]}),(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:[e.estimatedTime," \u2022 ",e.category]})]})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-700"),children:(null===t||void 0===t?void 0:t.name)||"Medium"})]})},e.id)}))})]},t.id)})),e.length>0&&(0,k.jsxs)("div",{children:[(0,k.jsx)("h5",{className:"font-medium text-gray-700 text-sm mb-2 flex items-center",children:"\ud83d\udd50 Anytime"}),(0,k.jsx)("div",{className:"space-y-2",children:e.map((e=>{const t=we.find((t=>t.id===e.priority));return(0,k.jsx)("div",{className:"p-3 rounded-lg border-l-4 transition-colors ".concat(e.completed?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:bg-gray-50"),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(e.completed?"bg-green-500 border-green-500":"border-gray-300 hover:border-green-500"),children:e.completed&&(0,k.jsx)(u,{className:"w-3 h-3 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"font-medium text-sm flex items-center space-x-2 priority-glow priority-".concat(e.priority," ").concat(e.completed?"line-through opacity-60":""),children:[(0,k.jsx)("span",{children:e.name}),e.hasRecipe&&(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),e.recipe&&c(e.recipe,e.name)},className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6"})]}),(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:[e.estimatedTime," \u2022 ",e.category]})]})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-700"),children:(null===t||void 0===t?void 0:t.name)||"Medium"})]})},e.id)}))})]})]})})(),(0,k.jsxs)("div",{className:"flex gap-2 pt-2 border-t",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e),o("plan")},className:"flex-1 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"Edit Preps"}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),h(null)},className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm",children:"Collapse"})]})]})})})]},t)}))}),(0,k.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-xl font-bold text-blue-600",children:f().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===Ne(t))).length),0)}),(0,k.jsx)("div",{className:"text-sm text-blue-700",children:"Total Tasks This Week"})]}),(0,k.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-xl font-bold text-green-600",children:f().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===Ne(t)&&e.completed)).length),0)}),(0,k.jsx)("div",{className:"text-sm text-green-700",children:"Completed"})]}),(0,k.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[(0,k.jsxs)("div",{className:"text-xl font-bold text-purple-600",children:[(()=>{const e=f().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===Ne(t))).length),0),t=f().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===Ne(t)&&e.completed)).length),0);return e>0?Math.round(t/e*100):0})(),"%"]}),(0,k.jsx)("div",{className:"text-sm text-purple-700",children:"Week Progress"})]})]})]})]})},je=e=>{var t,n,r;let{prep:s,isSelected:a,selection:i,showPriorityOptions:o,showTimeOptions:l,assignmentStep:c,onToggleSelection:d,onUpdateSelection:h,onShowPriorityOptions:f,onShowRecipe:m,onSave:p,context:g="main"}=e;const v="suggested"===g?"suggested-".concat(s.id):s.id;return(0,k.jsx)("div",{className:"border rounded-lg p-4 transition-colors ".concat(a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,k.jsx)("div",{className:"flex items-center justify-between",children:(0,k.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[(0,k.jsx)("button",{onClick:()=>d(s),className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ".concat(a?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-blue-500"),children:a&&(0,k.jsx)(u,{className:"w-4 h-4 text-white"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("h4",{className:"font-medium ".concat(a?"text-blue-900":"text-gray-800"),children:s.name}),s.hasRecipe&&s.recipe&&(0,k.jsx)("button",{onClick:()=>m(s.recipe,s.name),className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"})]}),(0,k.jsxs)("p",{className:"text-sm text-gray-600 flex items-center space-x-2",children:[(0,k.jsx)("span",{children:s.estimatedTime}),(0,k.jsx)("span",{children:"\u2022"}),(0,k.jsx)("span",{children:s.category}),(0,k.jsx)("span",{children:"\u2022"}),(0,k.jsxs)("span",{children:["Every ",s.frequency," days"]}),s.isCustom&&(0,k.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-xs",children:"Custom"})]}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsxs)("div",{className:"relative w-2/3",children:[(0,k.jsx)("button",{onClick:()=>{f(o===v?null:v)},className:"w-full px-2 py-1 rounded text-xs transition-colors ".concat(a?(null===(t=we.find((e=>e.id===i.priority)))||void 0===t?void 0:t.color)+" font-medium":"timeSlot"===c[s.id]?"bg-green-100 text-green-700 font-medium":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:a?"".concat(null===(n=we.find((e=>e.id===i.priority)))||void 0===n?void 0:n.name," Priority").concat(i.timeSlot?" \u2022 ".concat(null===(r=be.find((e=>e.id===i.timeSlot)))||void 0===r?void 0:r.name):" \u2022 Anytime"):"timeSlot"===c[s.id]?"Now choose time slot":"Click to assign priority & time"}),o===v&&(0,k.jsx)("div",{className:"dropdown-container soft-dropdown absolute top-full left-0 mt-2 rounded-xl p-3 z-20 w-full min-w-64 max-w-xs",children:(0,k.jsx)("div",{className:"space-y-3",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,k.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Choose Priority Level"]}),(0,k.jsx)("div",{className:"space-y-2",children:we.map((e=>(0,k.jsx)("button",{onClick:()=>h(s,"priority",e.id,g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 ".concat(e.color),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:e.name}),(0,k.jsx)("span",{className:"text-xs opacity-70",children:e.icon})]})},e.id)))})]})})}),l===v&&(0,k.jsx)("div",{className:"dropdown-container soft-dropdown absolute top-full left-0 mt-2 rounded-xl p-3 z-20 w-full min-w-64 max-w-sm",children:(0,k.jsx)("div",{className:"space-y-3",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,k.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Choose Time Slot"]}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsx)("button",{onClick:()=>h(s,"timeSlot","",g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-gray-50 text-gray-700 hover:bg-gray-100",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:"Anytime"}),(0,k.jsx)("span",{className:"text-xs opacity-70",children:"\ud83d\udd50"})]})}),be.map((e=>(0,k.jsx)("button",{onClick:()=>h(s,"timeSlot",e.id,g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-blue-50 text-blue-700 hover:bg-blue-100",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:e.name}),(0,k.jsx)("span",{className:"text-xs opacity-70",children:e.icon})]})},e.id)))]})]})})})]})})]})]})})})},Ae=e=>{let{isOpen:t,recipe:n,recipeName:r,onClose:s}=e;return t&&n?(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,k.jsx)(m,{className:"w-5 h-5 text-green-600"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:r}),(0,k.jsx)("p",{className:"text-sm text-gray-600",children:"Recipe Details"})]})]}),(0,k.jsx)("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"p-6 space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h4",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[(0,k.jsx)("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm mr-2",children:"\ud83e\udd44"}),"Ingredients"]}),(0,k.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,k.jsx)("div",{className:"whitespace-pre-wrap text-gray-700",dangerouslySetInnerHTML:{__html:ke(n.ingredients)}})})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("h4",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[(0,k.jsx)("span",{className:"w-6 h-6 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm mr-2",children:"\ud83d\udcdd"}),"Instructions"]}),(0,k.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,k.jsx)("div",{className:"whitespace-pre-wrap text-gray-700",dangerouslySetInnerHTML:{__html:ke(n.instructions)}})})]})]}),(0,k.jsx)("div",{className:"flex justify-end p-6 border-t bg-gray-50",children:(0,k.jsx)("button",{onClick:s,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Close Recipe"})})]})}):null},Ie=o("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),De=o("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Re=o("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Pe=o("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Oe=o("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Me=o("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Le=o("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),Fe=o("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Ue=t=>{let{currentDate:n,selectedDate:r,prepItems:s,scheduledPreps:a,prepSelections:i,selectedCategory:o,searchQuery:l,onToggleSelection:c,onUpdateSelection:d,onShowRecipe:u,showPriorityOptions:f,showTimeOptions:m,assignmentStep:p,onShowPriorityOptions:g,onResetWorkflow:v}=t;const[x,y]=(0,e.useState)(!1),[b,w]=(0,e.useState)("smart"),[N,_]=(0,e.useState)(5),[T,C]=(0,e.useState)(!1),[E,j]=(0,e.useState)([]),[A,I]=(0,e.useState)(!1);(0,e.useEffect)((()=>{const e=()=>{var e,t,n;const r=document.querySelector(".bg-red-100.text-red-700"),s=r&&(null===(e=r.textContent)||void 0===e?void 0:e.includes("Admin Mode")),a=document.querySelector(".bg-white.border-b"),i=a&&((null===(t=a.textContent)||void 0===t?void 0:t.includes("Admin Panel"))||(null===(n=a.textContent)||void 0===n?void 0:n.includes("Daily Reports"))),o=document.querySelector('[title="Logout Admin"]'),l=s||i||!!o;I(l),l!==A&&console.log("\ud83d\udd27 Prep Suggestions: Admin mode detected:",{hasAdminBadge:!!s,hasAdminTabs:!!i,hasLogoutButton:!!o,isAdmin:l})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[A]);const D=[{id:"low",name:"Low",color:"bg-green-100 text-green-700",icon:"\ud83d\udfe2"},{id:"medium",name:"Medium",color:"bg-yellow-100 text-yellow-700",icon:"\ud83d\udfe1"},{id:"high",name:"High",color:"bg-red-100 text-red-700",icon:"\ud83d\udd34"}],R=[{id:"morning",name:"Morning (6-10 AM)",icon:"\ud83c\udf05"},{id:"midday",name:"Mid-day (10 AM-2 PM)",icon:"\u2600\ufe0f"},{id:"afternoon",name:"Afternoon (2-6 PM)",icon:"\ud83c\udf24\ufe0f"},{id:"evening",name:"Evening (6-10 PM)",icon:"\ud83c\udf06"}],P=e=>{switch(e){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},O=e=>{switch(e){case"critical":return"bg-red-600";case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},M=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},L=e=>{var t;const n="".concat(M(r),"-").concat(e.id);return(null===(t=i[n])||void 0===t?void 0:t.selected)||!1},F=(0,e.useMemo)((()=>{const e=M(n),t=M(r),i=s.filter((e=>{const n="all"===o||e.category===o,r=""===l||e.name.toLowerCase().includes(l.toLowerCase())||e.category.toLowerCase().includes(l.toLowerCase()),s=a.some((n=>n.prepId===e.id&&n.scheduledDate===t));return n&&r&&!s})).map((t=>{var n;const r=a.filter((e=>e.prepId===t.id&&e.completed)).sort(((e,t)=>new Date(t.scheduledDate).getTime()-new Date(e.scheduledDate).getTime())),s=null===(n=r[0])||void 0===n?void 0:n.scheduledDate,i=s?Math.floor((new Date(e).getTime()-new Date(s).getTime())/864e5):999,{learnedFreq:o,confidence:l,dayPatterns:c}=((e,t)=>{if(t.length<2)return{learnedFreq:0,confidence:0,dayPatterns:{}};const n=[],r={};for(let o=0;o<t.length-1;o++){const e=Math.floor((new Date(t[o].scheduledDate).getTime()-new Date(t[o+1].scheduledDate).getTime())/864e5);n.push(e)}t.forEach((e=>{const t=new Date(e.scheduledDate).toLocaleDateString("en-US",{weekday:"long"});r[t]=(r[t]||0)+1}));const s=n.reduce(((e,t)=>e+t),0)/n.length,a=n.reduce(((e,t)=>e+Math.pow(t-s,2)),0)/n.length,i=100*(1/(1+a/s)*.7+.3*Math.min(t.length/10,1));return{learnedFreq:Math.round(10*s)/10,confidence:Math.round(i),dayPatterns:r}})(t.id,r),d=l>60&&o>0?o:t.frequency;if(A&&o>0&&Math.abs(o-t.frequency)>.5){const e={prepId:t.id,prepName:t.name,timestamp:(new Date).toISOString(),recommendedFreq:t.frequency,learnedFreq:o,reason:"Pattern analysis from ".concat(r.length," completions"),confidence:l,dataPoints:r.length};j((n=>n.some((e=>e.prepId===t.id&&Math.abs(new Date(e.timestamp).getTime()-(new Date).getTime())<6e4))?n:[e,...n.slice(0,49)]))}const u=a.filter((e=>e.prepId===t.id)).length,h=u>0?r.length/u*100:0,f=d,m=i-f;let p,g=0,v="",x="",y="medium",b="morning";return 999===i?(p="high",g=90,v="Never prepared before",x="\u2753",y="high"):m>f?(p="critical",g=100+m,v="".concat(Math.round(m)," days overdue"),x="\ud83d\udea8",y="high",b="morning"):m>0?(p="high",g=70+m,v="".concat(Math.round(m)," ").concat(1===Math.round(m)?"day":"days"," overdue"),x="\u26a0\ufe0f",y="high"):i>=f-1?(p="medium",g=f-i+50,v="Due soon",x="\u23f0",y="medium"):h<60?(p="medium",g=60-h+40,v="Low completion rate (".concat(Math.round(h),"%)"),x="\ud83d\udcc9",y="medium"):l>60&&Math.abs(o-t.frequency)>1?(p="low",g=35,v="Frequency analysis suggests ".concat(Math.round(o)," days"),x="\ud83d\udd0d",y="low",b="afternoon"):(p="low",g=20,v="Routine preparation",x="\u2728",y="low",b="afternoon"),d<=2&&(g+=15),t.hasRecipe&&(g+=10),"majoneesit"===t.category||"kastikkeet"===t.category?b="morning":"proteiinit"===t.category?b="midday":"kasvikset"===t.category?b="afternoon":"marinointi"===t.category&&(b="morning"),{prep:t,reason:v,urgency:p,lastCompleted:s,daysSinceLastPrep:i,suggestedPriority:y,suggestedTimeSlot:b,icon:x,score:g,completionRate:h,avgDaysBetween:o,learnedFrequency:o,frequencyConfidence:l,dayPatterns:c}})).filter((e=>"overdue"===b?"critical"===e.urgency||"high"===e.urgency:"smart"!==b||e.score>=30)).sort(((e,t)=>t.score-e.score)).slice(0,N);return i}),[s,a,n,r,o,l,b,N,A]);return 0===F.length?null:(0,k.jsxs)("div",{className:"mb-6 rounded-xl overflow-hidden shadow-sm border border-orange-200",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 p-4 border-b border-orange-200",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("button",{onClick:()=>y(!x),className:"flex items-center space-x-3 text-left hover:text-orange-600 transition-colors group",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)(Ie,{className:"w-5 h-5 text-orange-600"}),(0,k.jsxs)("h4",{className:"font-semibold text-orange-800",children:["Smart Prep Suggestions",A&&(0,k.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full",children:"ADMIN"})]}),(0,k.jsx)("span",{className:"bg-orange-200 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:F.length})]}),(0,k.jsx)("span",{className:"transform transition-transform duration-200 ".concat(x?"rotate-180":"rotate-0"),children:(0,k.jsx)("svg",{className:"w-4 h-4 text-orange-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,k.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),x&&(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[A&&(0,k.jsxs)("button",{onClick:()=>C(!T),className:"flex items-center space-x-1 px-3 py-1 bg-purple-200 text-purple-800 rounded-lg hover:bg-purple-300 transition-colors text-xs font-medium",title:"View AI Learning Log",children:[(0,k.jsx)(De,{className:"w-3 h-3"}),(0,k.jsx)("span",{children:"Learning Log"})]}),(0,k.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"text-xs bg-white border border-orange-300 rounded-lg px-2 py-1 text-orange-700 focus:ring-2 focus:ring-orange-500",children:[(0,k.jsx)("option",{value:"smart",children:"Smart"}),(0,k.jsx)("option",{value:"overdue",children:"Overdue Only"}),(0,k.jsx)("option",{value:"all",children:"All"})]}),(0,k.jsxs)("button",{onClick:()=>{F.slice(0,3).forEach((e=>{let{prep:t,suggestedPriority:n,suggestedTimeSlot:r}=e;L(t)||(c(t),setTimeout((()=>{d(t,"priority",n,"suggested"),setTimeout((()=>{d(t,"timeSlot",r,"suggested")}),100)}),100))}))},className:"flex items-center space-x-1 px-3 py-1 bg-orange-200 text-orange-800 rounded-lg hover:bg-orange-300 transition-colors text-xs font-medium",title:"Auto-apply top 3 suggestions",children:[(0,k.jsx)(Re,{className:"w-3 h-3"}),(0,k.jsx)("span",{children:"Auto-Apply"})]})]})]}),x&&(0,k.jsx)("div",{className:"mt-2 text-xs text-orange-700",children:(0,k.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,k.jsx)(Pe,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["AI-powered suggestions with hybrid frequency learning from ",a.filter((e=>e.completed)).length," completions"]})]})})]}),A&&T&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,k.jsx)(Oe,{className:"w-5 h-5 text-purple-600"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"AI Learning Log"}),(0,k.jsx)("p",{className:"text-sm text-gray-600",children:"Frequency optimization analysis"})]})]}),(0,k.jsx)("button",{onClick:()=>C(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"\u2715"})]}),(0,k.jsx)("div",{className:"p-6",children:0===E.length?(0,k.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,k.jsx)(Oe,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,k.jsx)("p",{children:"No learning data yet. AI will start analyzing patterns as you complete more preps."})]}):(0,k.jsx)("div",{className:"space-y-4",children:E.map(((e,t)=>(0,k.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-800",children:e.prepName}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.confidence>80?"bg-green-100 text-green-700":e.confidence>60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.confidence,"% confidence"]}),(0,k.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Recommended:"}),(0,k.jsxs)("div",{className:"font-medium",children:["Every ",e.recommendedFreq," days"]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600",children:"AI Learned:"}),(0,k.jsxs)("div",{className:"font-medium text-blue-600",children:["Every ",e.learnedFreq," days"]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Data Points:"}),(0,k.jsxs)("div",{className:"font-medium",children:[e.dataPoints," completions"]})]})]}),(0,k.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:e.reason})]},t)))})})]})}),x&&(0,k.jsxs)("div",{className:"bg-white p-4 space-y-3",children:[F.map((e=>{var t,n,s,a;let{prep:o,reason:l,urgency:h,daysSinceLastPrep:x,icon:y,score:b,completionRate:w,suggestedPriority:N,suggestedTimeSlot:_,learnedFrequency:T,frequencyConfidence:C}=e;const E=L(o),j=(e=>{const t="".concat(M(r),"-").concat(e.id);return i[t]||{priority:"medium",timeSlot:"",selected:!1}})(o),I={low:"text-blue-800",medium:"text-yellow-800",high:"text-orange-800",critical:"text-red-800"};return(0,k.jsx)("div",{className:"rounded-lg border-2 transition-all duration-200 hover:shadow-md ".concat(E?"border-green-400 bg-green-50 shadow-sm":{low:"border-blue-300 bg-blue-50",medium:"border-yellow-300 bg-yellow-50",high:"border-orange-400 bg-orange-50",critical:"border-red-400 bg-red-50"}[h]),children:(0,k.jsx)("div",{className:"p-3 md:p-4",children:(0,k.jsxs)("div",{className:"space-y-3 md:space-y-0 md:flex md:items-center md:justify-between",children:[(0,k.jsxs)("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-0.5",children:[(0,k.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(E?P(j.priority):O(h))}),(0,k.jsx)("button",{onClick:()=>c(o),className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(E?"bg-green-500 border-green-500":"critical"===h?"border-red-400 hover:border-red-500":"high"===h?"border-orange-400 hover:border-orange-500":"border-gray-400 hover:border-gray-500"),children:E&&(0,k.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,k.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("h5",{className:"font-semibold text-base md:text-lg ".concat(E?"text-green-900":I[h]),children:o.name}),o.hasRecipe&&(0,k.jsx)("button",{onClick:()=>o.recipe&&u(o.recipe,o.name),className:"flex-shrink-0 text-sm bg-green-100 text-green-700 px-2 py-1 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"})]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 space-y-1 md:space-y-0",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("span",{className:"font-medium",children:o.estimatedTime}),(0,k.jsx)("span",{children:"\u2022"}),(0,k.jsx)("span",{className:"capitalize",children:o.category}),(0,k.jsx)("span",{children:"\u2022"}),(0,k.jsxs)("span",{children:["Every ",o.frequency," days"]})]}),T>0&&C>60&&(0,k.jsxs)("div",{className:"text-blue-600 text-xs",children:["AI learned: Every ",T," days (",C,"% confidence)"]})]}),(0,k.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,k.jsx)("div",{className:"text-sm font-medium ".concat(I[h]),children:l}),x<999&&(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:["Last done: ",x," days ago"]}),w>0&&(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:[Math.round(w),"% completion rate",A&&" (Score: ".concat(b,")")]})]})]})]}),(0,k.jsx)("div",{className:"md:flex-shrink-0 md:ml-4",children:(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("button",{onClick:()=>{f==="suggested-".concat(o.id)?v():g("suggested-".concat(o.id))},className:"w-full md:w-auto px-4 py-2 md:py-1.5 rounded-lg text-sm transition-colors font-medium ".concat(E?(null===(t=D.find((e=>e.id===j.priority)))||void 0===t?void 0:t.color)+" shadow-sm":"timeSlot"===p[o.id]?"bg-green-100 text-green-700 shadow-sm":"critical"===h?"bg-red-100 text-red-700 hover:bg-red-200":"high"===h?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:E?"".concat(null===(n=D.find((e=>e.id===j.priority)))||void 0===n?void 0:n.name).concat(j.timeSlot?" \u2022 ".concat(null===(s=R.find((e=>e.id===j.timeSlot)))||void 0===s?void 0:s.name.split(" ")[0]):" \u2022 Anytime"):"timeSlot"===p[o.id]?"Choose Time Slot":"Assign ".concat(N.charAt(0).toUpperCase()+N.slice(1)," Priority")}),f==="suggested-".concat(o.id)&&(0,k.jsx)("div",{className:"dropdown-container absolute top-full right-0 mt-2 rounded-xl p-3 z-20 w-52 backdrop-filter backdrop-blur-lg bg-white/95 border border-white/30 shadow-xl",children:(0,k.jsx)("div",{className:"space-y-3",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,k.jsx)(Me,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,k.jsx)("span",{children:"Choose Priority"}),(0,k.jsxs)("span",{className:"ml-auto text-xs text-green-600",children:["Suggested: ",N]})]}),(0,k.jsx)("div",{className:"space-y-2",children:D.map((e=>(0,k.jsx)("button",{onClick:()=>d(o,"priority",e.id,"suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 backdrop-filter backdrop-blur-sm border border-white/20 ".concat(e.color," ").concat(e.id===N?"ring-2 ring-green-400":""),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:e.name}),(0,k.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,k.jsx)("span",{className:"text-xs opacity-70",children:e.icon}),e.id===N&&(0,k.jsx)(S,{className:"w-3 h-3 text-green-500"})]})]})},e.id)))})]})})}),m==="suggested-".concat(o.id)&&(0,k.jsx)("div",{className:"dropdown-container absolute top-full right-0 mt-2 rounded-xl p-3 z-20 w-64 backdrop-filter backdrop-blur-lg bg-white/95 border border-white/30 shadow-xl",children:(0,k.jsx)("div",{className:"space-y-3",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,k.jsx)(Le,{className:"w-4 h-4 mr-2 text-green-500"}),(0,k.jsx)("span",{children:"Choose Time Slot"}),(0,k.jsxs)("span",{className:"ml-auto text-xs text-green-600",children:["Suggested: ",null===(a=R.find((e=>e.id===_)))||void 0===a?void 0:a.name.split(" ")[0]]})]}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsx)("button",{onClick:()=>d(o,"timeSlot","","suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-gray-50 text-gray-700 hover:bg-gray-100 backdrop-filter backdrop-blur-sm border border-white/20",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:"Anytime"}),(0,k.jsx)("span",{className:"text-xs opacity-70",children:"\ud83d\udd50"})]})}),R.map((e=>(0,k.jsx)("button",{onClick:()=>d(o,"timeSlot",e.id,"suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-blue-50 text-blue-700 hover:bg-blue-100 backdrop-filter backdrop-blur-sm border border-white/20 ".concat(e.id===_?"ring-2 ring-green-400":""),children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{children:e.name.split(" ")[0]}),(0,k.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,k.jsx)("span",{className:"text-xs opacity-70",children:e.icon}),e.id===_&&(0,k.jsx)(S,{className:"w-3 h-3 text-green-500"})]})]})},e.id)))]})]})})})]})})]})})},"suggested-".concat(o.id))})),(0,k.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:(0,k.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,k.jsx)(Ie,{className:"w-3 h-3"}),(0,k.jsx)("span",{children:"Hybrid frequency learning"})]}),(0,k.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,k.jsx)(h,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["Based on ",a.filter((e=>e.completed)).length," completions"]})]}),A&&(0,k.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,k.jsx)(Fe,{className:"w-3 h-3"}),(0,k.jsx)("span",{children:"Admin mode active"})]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("span",{children:"Show:"}),(0,k.jsxs)("select",{value:N,onChange:e=>_(Number(e.target.value)),className:"bg-transparent border border-gray-300 rounded px-2 py-1 text-xs",children:[(0,k.jsx)("option",{value:3,children:"3"}),(0,k.jsx)("option",{value:5,children:"5"}),(0,k.jsx)("option",{value:10,children:"10"})]})]})]})})]})]})},We=t=>{let{currentUser:n,connectionStatus:s,prepItems:a,scheduledPreps:i,prepSelections:o,setPrepItems:l,setScheduledPreps:c,setPrepSelections:d,quickSave:h}=t;const[f,p]=(0,e.useState)("today"),[g,v]=(0,e.useState)((()=>new Date)),[x,w]=(0,e.useState)(new Date),[N,_]=(0,e.useState)(!1),[S,T]=(0,e.useState)(""),[C,E]=(0,e.useState)("all"),[j,A]=(0,e.useState)(!1),[I,D]=(0,e.useState)(""),[R,P]=(0,e.useState)(!1),[O,M]=(0,e.useState)({ingredients:"",instructions:""}),[L,F]=(0,e.useState)(!1),[U,W]=(0,e.useState)(null),[z,B]=(0,e.useState)(""),[H,V]=(0,e.useState)(null),[Y,K]=(0,e.useState)(null),[G,$]=(0,e.useState)({}),[X,Q]=(0,e.useState)(!0),[J,Z]=(0,e.useState)(0),[ee,te]=(0,e.useState)(!1),[ne,re]=(0,e.useState)(!1),[se,ae]=(0,e.useState)(!1);(0,e.useEffect)((()=>{const e=()=>{var e,t,n;const r=document.querySelector(".bg-red-100.text-red-700"),s=r&&(null===(e=r.textContent)||void 0===e?void 0:e.includes("Admin Mode")),a=document.querySelector(".bg-white.border-b"),i=a&&((null===(t=a.textContent)||void 0===t?void 0:t.includes("Admin Panel"))||(null===(n=a.textContent)||void 0===n?void 0:n.includes("Daily Reports"))),o=document.querySelector('[title="Logout Admin"]'),l=s||i||!!o;ae(l),l!==se&&console.log("\ud83d\udd27 Admin mode detected:",{hasAdminBadge:!!s,hasAdminTabs:!!i,hasLogoutButton:!!o,isAdmin:l})};e();const t=setInterval(e,500);return()=>clearInterval(t)}),[se]),(0,e.useEffect)((()=>{if(0===a.length){const e=[{id:1,name:"Valkosipulimajoneesi",category:"majoneesit",estimatedTime:"15 min",isCustom:!1,hasRecipe:!0,frequency:3,recipe:{ingredients:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4, hienoksi hakattuna\n\u2022 **1 rkl** sitruunamehua\n\u2022 **Suolaa** ja **mustapippuria** maun mukaan",instructions:"1. **Sekoita**: Yhdist\xe4 majoneesi ja hienonnettu valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu, suola ja pippuri\n3. **Anna maustua**: Anna seisoa j\xe4\xe4kaapissa v\xe4hint\xe4\xe4n 30 minuuttia\n4. **Tarkista maku**: S\xe4\xe4d\xe4 mausteita tarpeen mukaan"}},{id:2,name:"Chilimajoneesi",category:"majoneesit",estimatedTime:"10 min",isCustom:!1,hasRecipe:!0,frequency:4,recipe:{ingredients:"\u2022 **1 cup** majoneesi\n\u2022 **2-3 rkl** sriracha-kastiketta\n\u2022 **1 tl** hunajaa\n\u2022 **1 tl** limemehua",instructions:"1. **Yhdist\xe4**: Sekoita majoneesi ja sriracha-kastike\n2. **Makeutus**: Lis\xe4\xe4 hunaja ja limemehu\n3. **Sekoita hyvin**: Varmista tasainen sekoitus\n4. **Maista ja s\xe4\xe4d\xe4**: Lis\xe4\xe4 chilimakua tai hunajaa tarpeen mukaan"}},{id:3,name:"Kev\xe4tsipulimajoneesi",category:"majoneesit",estimatedTime:"10 min",isCustom:!1,hasRecipe:!1,frequency:3,recipe:null},{id:4,name:"Bad Santa -majoneesi",category:"majoneesit",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:5,name:"Manse-majoneesi",category:"majoneesit",estimatedTime:"12 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:6,name:"Marinoitu kana",category:"proteiinit",estimatedTime:"30 min",isCustom:!1,hasRecipe:!0,frequency:2,recipe:{ingredients:"\u2022 **4** kananfileet\xe4\n\u2022 **1/4 cup** oliivi\xf6ljy\xe4\n\u2022 **2 rkl** sitruunamehua\n\u2022 **3** valkosipulin kyntt\xe4, murskattuna\n\u2022 **1 tl** kuivattuja yrttej\xe4\n\u2022 **Suolaa** ja **pippuria**",instructions:"1. **Valmista marinade**: Sekoita \xf6ljy, sitruunamehu, valkosipuli ja yrtit\n2. **Mausta kana**: Hiero kanaan suolaa ja pippuria\n3. **Marinoi**: Laita kana marinadiin 2-4 tunniksi\n4. **Huoneenl\xe4mp\xf6**: Anna tulla huoneenl\xe4mp\xf6\xf6n ennen kypsennyst\xe4"}},{id:7,name:"Lihapullat",category:"proteiinit",estimatedTime:"45 min",isCustom:!1,hasRecipe:!0,frequency:3,recipe:{ingredients:"\u2022 **500g** jauhelihaa\n\u2022 **1** sipuli, hienoksi hakattuna\n\u2022 **1** muna\n\u2022 **1/2 cup** korppujauhoja\n\u2022 **Suolaa**, **pippuria**, **mausteet**",instructions:"1. **Sekoita**: Yhdist\xe4 kaikki ainekset kulhossa\n2. **Muotoile**: Tee tasakokoisia palloja\n3. **Kypsenn\xe4**: Paista pannulla tai uunissa\n4. **Valmista**: Kypsyys 65\xb0C sis\xe4l\xe4mp\xf6tila"}},{id:8,name:"Tuoreet tomaatit (leikattu)",category:"kasvikset",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:1,recipe:null},{id:9,name:"Kev\xe4tsipuli",category:"kasvikset",estimatedTime:"10 min",isCustom:!1,hasRecipe:!1,frequency:2,recipe:null},{id:10,name:"Marinoitu punasipuli",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!0,frequency:4,recipe:{ingredients:"\u2022 **2** punasipulia, ohuksi viipaloiduna\n\u2022 **1/2 cup** valkoviinietikkaa\n\u2022 **2 rkl** sokeria\n\u2022 **1 tl** suolaa\n\u2022 **1** laakerinlehti",instructions:"1. **Liuota**: Sekoita etikka, sokeri ja suola\n2. **Sipulit**: Laita viipaloidut sipulit kulhoon\n3. **Kaada liuos**: Kaada kuuma liuos sipulien p\xe4\xe4lle\n4. **Anna marinoitua**: V\xe4hint\xe4\xe4n 30 minuuttia ennen k\xe4ytt\xf6\xe4"}},{id:11,name:"Pikkel\xf6ity punasipuli",category:"marinointi",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:12,name:"Pikkel\xf6ity tomaatti",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:13,name:"Pikkel\xf6ity kurkku",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:14,name:"Paholaisen hillo",category:"marinointi",estimatedTime:"30 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:15,name:"Hapan omena -hillo",category:"marinointi",estimatedTime:"35 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:16,name:"Marinoitu punakaali",category:"marinointi",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:17,name:"Konjakki-sinappi",category:"kastikkeet",estimatedTime:"15 min",isCustom:!1,hasRecipe:!0,frequency:6,recipe:{ingredients:"\u2022 **1/2 cup** dijon-sinappia\n\u2022 **3 rkl** konjakkia\n\u2022 **1 rkl** hunajaa\n\u2022 **1 tl** valkosipulijauhetta",instructions:"1. **Sekoita**: Yhdist\xe4 sinappi ja konjakki\n2. **Makeutus**: Lis\xe4\xe4 hunaja ja valkosipulijauhe\n3. **Sekoita hyvin**: Varmista tasainen sekoitus\n4. **Anna vet\xe4yty\xe4**: S\xe4ilyt\xe4 j\xe4\xe4kaapissa k\xe4ytt\xf6\xf6n asti"}},{id:18,name:"BBQ-hunaja-sinappi",category:"kastikkeet",estimatedTime:"12 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:19,name:"T\xe4yt\xe4 kylm\xe4vitriini",category:"muut",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:1,recipe:null},{id:20,name:"Vaihda \xf6ljy",category:"muut",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:21,name:"Asiakasjuomakaappi kuntoon",category:"muut",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:2,recipe:null},{id:22,name:"Alkoholijuomakaappi kuntoon",category:"muut",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:3,recipe:null},{id:23,name:"Keit\xe4 smash-perunat",category:"muut",estimatedTime:"45 min",isCustom:!1,hasRecipe:!0,frequency:2,recipe:{ingredients:"\u2022 **1kg** pieni\xe4 perunoita\n\u2022 **Suolaa** keitinveteen\n\u2022 **Oliivi\xf6ljy\xe4**\n\u2022 **Rosmariinia**\n\u2022 **Merisuolaa**\n\u2022 **Mustapippuria**",instructions:"1. **Keit\xe4**: Keit\xe4 perunat kuoressa suolavedess\xe4 kypsiksi\n2. **Valuta**: Anna valua ja j\xe4\xe4hty\xe4 hieman\n3. **Smash**: Litist\xe4 perunat haarukalla kevyesti\n4. **Paista**: Paista uunissa 200\xb0C \xf6ljyss\xe4 ja mausteissa kultaisiksi"}}];l((()=>e)),h("prepItems",e)}}),[a.length,l,h]),(0,e.useEffect)((()=>{if(i.length>0&&!ee){console.log("\ud83d\udd04 Auto-saving scheduledPreps due to state change");const e=setTimeout((()=>{h("scheduledPreps",i).then((()=>{console.log("\u2705 ScheduledPreps auto-save completed")})).catch((e=>{console.error("\u274c ScheduledPreps auto-save failed:",e)}))}),300);return()=>clearTimeout(e)}}),[i,h,ee]),(0,e.useEffect)((()=>{const e=localStorage.getItem("lastPrepMoveCheck"),t=Ne(new Date);e!==t&&((()=>{const e=new Date,t=new Date(e);t.setDate(t.getDate()-1);const n=Ne(e),s=Ne(t),a=i.filter((e=>e.scheduledDate===s&&!e.completed));if(a.length>0){console.log("\ud83d\udd04 Moving ".concat(a.length," incomplete preps from ").concat(s," to ").concat(n)),Z(a.length),setTimeout((()=>Z(0)),8e3);const t=a.map((e=>(0,r.A)((0,r.A)({},e),{},{id:Se(),scheduledDate:n})));c((e=>[...e.filter((e=>!(e.scheduledDate===s&&!e.completed))),...t]));const i={};a.forEach((t=>{const n=_e(e,t.prepId);i[n]={priority:t.priority,timeSlot:t.timeSlot,selected:!0}})),d((e=>(0,r.A)((0,r.A)({},e),i)))}})(),localStorage.setItem("lastPrepMoveCheck",t))}),[i,d,c]);const ie=async e=>{if(console.log("\ud83d\udd04 Toggling prep completion for ID:",e),ee)console.log("\u23f3 Save in progress, skipping...");else{te(!0),re(!0);try{const t=i.find((t=>t.id===e));if(!t)return void console.error("\u274c Prep item not found:",e);const n=!t.completed;console.log("\ud83d\udccb ".concat(t.name,": ").concat(t.completed?"COMPLETED":"PENDING"," \u2192 ").concat(n?"COMPLETED":"PENDING")),console.log("\ud83d\udee1\ufe0f SYNC PAUSED during save operation");const s=i.map((t=>t.id===e?(0,r.A)((0,r.A)({},t),{},{completed:n}):t)),a=Ne(new Date),o=s.filter((e=>e.scheduledDate===a)),l=o.filter((e=>e.completed));console.log("\ud83d\udce4 About to save scheduledPreps:",{totalCount:s.length,todayCount:o.length,todayCompletedCount:l.length,updatedItem:{id:e,name:t.name,completed:n,scheduledDate:t.scheduledDate}}),c((()=>s)),console.log("\ud83d\udd25 Saving prep completion to Firebase...");await h("scheduledPreps",s)?(console.log("\u2705 Prep completion saved successfully"),setTimeout((async()=>{re(!1),console.log("\ud83d\udd04 SYNC RESUMED after save completion");try{const t=await fetch("https://hamptown-panel-default-rtdb.firebaseio.com/scheduledPreps.json"),r=await t.json();if(r){const t=r.filter((e=>e.scheduledDate===a)),s=t.filter((e=>!0===e.completed)),i=r.find((t=>t.id===e));console.log("\ud83d\udd0d Firebase verification after save:",{firebaseTotalCount:r.length,firebaseTodayCount:t.length,firebaseTodayCompleted:s.length,firebaseUpdatedItem:i?{id:i.id,name:i.name,completed:i.completed,scheduledDate:i.scheduledDate}:"NOT FOUND"}),i&&i.completed===n?console.log("\u2705 Save verification passed"):console.error("\u274c SAVE VERIFICATION FAILED! Item not found or completion status mismatch")}else console.error("\u274c No data found in Firebase during verification")}catch(t){console.warn("\u26a0\ufe0f Failed to verify save:",t)}}),3e3)):(console.error("\u274c Failed to save prep completion to Firebase"),c((()=>i)),re(!1))}catch(t){console.error("\u274c Error toggling prep completion:",t),c((()=>i)),re(!1)}finally{te(!1)}}},oe=e=>{var t;const n=_e(g,e.id);return(null===(t=o[n])||void 0===t?void 0:t.selected)||!1},le=e=>{const t=_e(g,e.id);return o[t]||{priority:"medium",timeSlot:"",selected:!1}},ce=function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";const a=_e(g,e.id),l=o[a]||{priority:"medium",timeSlot:"",selected:!1};if("priority"===t){d((e=>(0,r.A)((0,r.A)({},e),{},{[a]:(0,r.A)((0,r.A)({},e[a]),{},{priority:n,selected:l.selected})}))),$((t=>(0,r.A)((0,r.A)({},t),{},{[e.id]:"timeSlot"}))),V(null);const t="suggested"===s?"suggested-".concat(e.id):e.id;K(t)}else if("timeSlot"===t){const t={priority:l.priority,timeSlot:n,selected:!0};d((e=>(0,r.A)((0,r.A)({},e),{},{[a]:t})));if(i.find((t=>t.prepId===e.id&&t.scheduledDate===Ne(g))))c((s=>s.map((s=>s.prepId===e.id&&s.scheduledDate===Ne(g)?(0,r.A)((0,r.A)({},s),{},{priority:t.priority,timeSlot:n}):s))));else{const r={id:Se(),prepId:e.id,name:e.name,category:e.category,estimatedTime:e.estimatedTime,isCustom:e.isCustom,hasRecipe:e.hasRecipe,recipe:e.recipe,scheduledDate:Ne(g),priority:t.priority,timeSlot:n,completed:!1,assignedTo:null,notes:""};c((e=>[...e,r]))}$((t=>(0,r.A)((0,r.A)({},t),{},{[e.id]:null}))),V(null),K(null)}},de=()=>{V(null),K(null),$({})};(0,e.useEffect)((()=>{const e=e=>{e.target.closest(".dropdown-container")||de()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const ue=(e,t)=>{W(e),B(t),F(!0)},he=e=>{var t;const n=_e(g,e.id);if(null===(t=o[n])||void 0===t?void 0:t.selected)d((e=>{const t=(0,r.A)({},e);return delete t[n],t})),c((t=>t.filter((t=>!(t.prepId===e.id&&t.scheduledDate===Ne(g))))));else{const t=i.find((t=>t.prepId===e.id&&t.scheduledDate===Ne(g)));if(t)d((e=>(0,r.A)((0,r.A)({},e),{},{[n]:{priority:t.priority,timeSlot:t.timeSlot,selected:!0}})));else{const t={priority:"medium",timeSlot:"",selected:!0};d((e=>(0,r.A)((0,r.A)({},e),{},{[n]:t})));const s={id:Se(),prepId:e.id,name:e.name,category:e.category,estimatedTime:e.estimatedTime,isCustom:e.isCustom,hasRecipe:e.hasRecipe,recipe:e.recipe,scheduledDate:Ne(g),priority:"medium",timeSlot:"",completed:!1,assignedTo:null,notes:""};c((e=>[...e,s]))}}},fe=a.filter((e=>{const t="all"===C||e.category===C,n=""===I||e.name.toLowerCase().includes(I.toLowerCase())||e.category.toLowerCase().includes(I.toLowerCase());return t&&n}));return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n.priority-glow {\n  position: relative;\n  z-index: 0;\n  font-weight: 600;\n  border-radius: 0.25rem;\n  padding: 0.125rem 0.25rem;\n}\n.priority-glow::before {\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 110%;\n  height: 2em;\n  transform: translate(-50%, -50%);\n  border-radius: 0.375rem;\n  filter: blur(6px);\n  z-index: -1;\n  opacity: 0.3;\n}\n.priority-low {\n  color: #047857;\n}\n.priority-low::before {\n  box-shadow: 0 0 8px 4px rgba(5, 150, 105, 0.4);\n}\n.priority-medium {\n  color: #92400e;\n}\n.priority-medium::before {\n  box-shadow: 0 0 8px 4px rgba(202, 138, 4, 0.4);\n}\n.priority-high {\n  color: #b91c1c;\n}\n.priority-high::before {\n  box-shadow: 0 0 8px 4px rgba(185, 28, 28, 0.4);\n}\n\n.soft-dropdown {\n  backdrop-filter: blur(16px);\n  background: rgba(255, 255, 255, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15),\n              0 0 0 1px rgba(255, 255, 255, 0.05),\n              inset 0 1px 0 rgba(255, 255, 255, 0.1);\n}\n\n.soft-button {\n  backdrop-filter: blur(8px);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),\n              inset 0 1px 0 rgba(255, 255, 255, 0.1);\n}\n\n.soft-button:hover {\n  backdrop-filter: blur(12px);\n  box-shadow: 0 8px 15px -3px rgba(0, 0, 0, 0.1),\n              inset 0 1px 0 rgba(255, 255, 255, 0.2);\n}\n'}}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(m,{className:"w-8 h-8 text-blue-600 mr-3"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Prep List Manager"}),(0,k.jsx)("p",{className:"text-gray-600",children:"Plan and track kitchen preparation tasks"})]})]}),(0,k.jsx)("div",{className:"flex items-center space-x-2"})]}),(0,k.jsxs)("div",{className:"flex space-x-2",children:[(0,k.jsxs)("button",{onClick:()=>p("today"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("today"===f?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,k.jsx)(u,{className:"w-4 h-4 mr-2"}),"Today's Preps"]}),(0,k.jsxs)("button",{onClick:()=>p("plan"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("plan"===f?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,k.jsx)(pe,{className:"w-4 h-4 mr-2"}),"Plan Preps"]}),(0,k.jsxs)("button",{onClick:()=>p("week"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("week"===f?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,k.jsx)(b,{className:"w-4 h-4 mr-2"}),"Week View"]})]})]}),J>0&&(0,k.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,k.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,k.jsxs)("div",{className:"ml-3 flex-1",children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"\ud83d\udcc5 Prep items moved to today"}),(0,k.jsxs)("div",{className:"mt-1 text-sm text-blue-600",children:[J," incomplete prep",J>1?"s":""," from yesterday ",J>1?"have":"has"," been automatically moved to today's schedule."]})]}),(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("button",{onClick:()=>Z(0),className:"text-blue-400 hover:text-blue-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})})]})}),"today"===f&&(0,k.jsxs)(k.Fragment,{children:[!!se&&(0,k.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsxs)("h4",{className:"font-medium text-blue-800",children:["\ud83d\udd0d Debug Info ",se?"(Admin Mode Active)":"(Development Mode)"]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[!1,(0,k.jsx)("button",{onClick:async()=>{console.log("\ud83d\udd04 Manual Firebase check triggered");try{const e=await fetch("https://hamptown-panel-default-rtdb.firebaseio.com/scheduledPreps.json"),t=await e.json(),n=Ne(new Date),r=t?t.filter((e=>e.scheduledDate===n)):[];console.log("\ud83d\udd0d Manual Firebase check result:",{firebaseHasData:!!t,firebaseTotalCount:t?t.length:0,firebaseTodayCount:r.length,firebaseTodayCompleted:r.filter((e=>!0===e.completed)).length,localTodayCount:i.filter((e=>e.scheduledDate===n)).length,firebaseSample:r.slice(0,3)}),alert("Firebase Check:\nTotal: ".concat(t?t.length:0,"\nToday: ").concat(r.length,"\nCompleted: ").concat(r.filter((e=>!0===e.completed)).length))}catch(e){console.error("\u274c Manual Firebase check failed:",e),alert("Firebase check failed - see console")}},className:"px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600",children:"Check Firebase"}),(0,k.jsx)("button",{onClick:()=>{console.log("\ud83d\udd04 Manual reload triggered"),window.location.reload()},className:"px-3 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:"Force Reload"})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-blue-700",children:"Today's Date"}),(0,k.jsx)("div",{className:"text-blue-600",children:Ne(new Date)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-blue-700",children:"Total Scheduled"}),(0,k.jsx)("div",{className:"text-blue-600",children:i.length})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-blue-700",children:"Today's Preps"}),(0,k.jsx)("div",{className:"text-blue-600",children:i.filter((e=>e.scheduledDate===Ne(new Date))).length})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-blue-700",children:"Connection"}),(0,k.jsx)("div",{className:"connected"===s?"text-green-600":"text-red-600",children:s})]})]}),(0,k.jsxs)("div",{className:"mt-3",children:[(0,k.jsx)("div",{className:"font-medium text-blue-700 mb-1",children:"All Scheduled Dates:"}),(0,k.jsx)("div",{className:"text-blue-600 text-xs",children:Array.from(new Set(i.map((e=>e.scheduledDate)))).sort().join(", ")||"None"})]}),i.length>0&&(0,k.jsxs)("div",{className:"mt-2",children:[(0,k.jsx)("div",{className:"font-medium text-blue-700 mb-1",children:"Sample Preps:"}),(0,k.jsx)("div",{className:"text-blue-600 text-xs",children:i.slice(0,3).map((e=>"".concat(e.name," (").concat(e.scheduledDate,")").concat(e.completed?" \u2705":" \u23f3"))).join(" | ")})]})]}),(0,k.jsx)(Ce,{scheduledPreps:i,onToggleCompletion:ie,onShowRecipe:ue})]}),"plan"===f&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Select Date to Plan"}),(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsx)("input",{type:"date",value:Ne(g),onChange:e=>v(new Date(e.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,k.jsxs)("div",{className:"text-gray-600",children:["Planning for: ",(0,k.jsx)("strong",{children:(me=g,me.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Choose Prep Items"}),(0,k.jsxs)("button",{onClick:()=>A(!j),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(j?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),children:[(0,k.jsx)(xe,{className:"w-4 h-4 mr-2"}),"Search"]})]}),j&&(0,k.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)(xe,{className:"w-5 h-5 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Search prep items...",value:I,onChange:e=>D(e.target.value),className:"flex-1 px-3 py-2 border-0 bg-transparent focus:outline-none",autoFocus:!0}),I&&(0,k.jsx)("button",{onClick:()=>D(""),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-4 h-4"})})]})}),(0,k.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:ye.map((e=>(0,k.jsxs)("button",{onClick:()=>E(e.id),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(C===e.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,k.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))}),(0,k.jsx)(Ue,{currentDate:x,selectedDate:g,prepItems:a,scheduledPreps:i,prepSelections:o,selectedCategory:C,searchQuery:I,onToggleSelection:he,onUpdateSelection:ce,onShowRecipe:ue,showPriorityOptions:H,showTimeOptions:Y,assignmentStep:G,onShowPriorityOptions:V,onResetWorkflow:de}),(0,k.jsx)("div",{className:"space-y-3",children:fe.map((e=>(0,k.jsx)(je,{prep:e,isSelected:oe(e),selection:le(e),showPriorityOptions:H,showTimeOptions:Y,assignmentStep:G,onToggleSelection:he,onUpdateSelection:ce,onShowPriorityOptions:V,onShowRecipe:ue,onSave:(e,t)=>{console.log("Save clicked for prep:",e,t)},context:"main"},e.id)))}),(0,k.jsx)("div",{className:"mt-6 pt-6 border-t",children:N?(0,k.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-800 mb-4",children:"Add Custom Prep"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prep Name"}),(0,k.jsx)("input",{type:"text",value:S,onChange:e=>T(e.target.value),placeholder:"e.g., Prep special sauce",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,k.jsx)("select",{value:"all"===C?"majoneesit":C,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:ye.slice(1).map((e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id)))})]})]}),(0,k.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,k.jsx)("button",{onClick:()=>{if(!S.trim())return;const e={id:Date.now(),name:S.trim(),category:"all"===C?"majoneesit":C,estimatedTime:"20 min",isCustom:!0,hasRecipe:R,frequency:2,recipe:R?{ingredients:O.ingredients,instructions:O.instructions}:null};l((t=>[...t,e])),T(""),_(!1),P(!1),M({ingredients:"",instructions:""}),E("majoneesit"),he(e)},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Add Prep"}),(0,k.jsx)("button",{onClick:()=>{_(!1),T(""),P(!1),M({ingredients:"",instructions:""}),E("majoneesit")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):(0,k.jsxs)("button",{onClick:()=>_(!0),className:"flex items-center px-4 py-2 border border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:text-blue-500 transition-colors",children:[(0,k.jsx)(q,{className:"w-4 h-4 mr-2"}),"Add Custom Prep Item"]})})]})]}),"week"===f&&(0,k.jsx)(Ee,{scheduledPreps:i,currentDate:x,setCurrentDate:w,selectedDate:g,setSelectedDate:v,setActiveView:p,onToggleCompletion:ie,onShowRecipe:ue}),(0,k.jsx)(Ae,{isOpen:L,recipe:U,recipeName:z,onClose:()=>F(!1)})]});var me},ze=o("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Be=o("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),He=o("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Ve=(e,t)=>{if(!e)return"\u2753";if(t){const n=t.find((t=>t.name===e||t.id===e));if(n)return n.icon}switch(e){case"meat":return"\ud83e\udd69";case"dairy":return"\ud83e\udd5b";case"uncategorized":return"\u2753";default:return"\ud83d\udccb"}},qe=e=>{if("undefined"===typeof window)return;if(!document.getElementById("toastContainer")){const e=document.createElement("div");e.id="toastContainer",e.className="fixed top-4 right-4 z-50 space-y-2",document.body.appendChild(e)}const t=document.getElementById("toastContainer"),n=document.createElement("div");n.className="toast bg-white/90 backdrop-blur-sm text-black p-3 mb-2 rounded-lg shadow-lg border transform transition-all duration-300 translate-x-0 opacity-100",n.textContent=e,t.appendChild(n),requestAnimationFrame((()=>{n.classList.add("animate-slide-in")})),setTimeout((()=>{n.classList.add("opacity-0","translate-x-full"),n.addEventListener("transitionend",(()=>{n.parentNode&&n.remove()}))}),3e3)};let Ye=0;const Ke=()=>{Ye>=1e5&&(Ye=0);return 1e5*Math.floor(Date.now()/1e3)+ ++Ye},Ge=[{id:"meat",name:"Meat & Fish",icon:"\ud83e\udd69",color:"#EF4444"},{id:"dairy",name:"Dairy",icon:"\ud83e\udd5b",color:"#3B82F6"}],$e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...Ge.map((e=>({value:e.id,label:"".concat(e.icon," ").concat(e.name),icon:e.icon,isCustom:!1}))),...e.map((e=>({value:e.id,label:"".concat(e.icon," ").concat(e.name),icon:e.icon,isCustom:!0})))]},Xe=(0,e.createContext)(void 0),Qe=()=>{const t=(0,e.useContext)(Xe);if(!t)throw new Error("useInventory must be used within an InventoryProvider");return t},Je=t=>{let{children:s,inventoryDailyItems:a,inventoryWeeklyItems:i,inventoryMonthlyItems:o,inventoryDatabaseItems:l,inventoryActivityLog:c,inventoryCustomCategories:d,setInventoryDailyItems:u,setInventoryWeeklyItems:h,setInventoryMonthlyItems:f,setInventoryDatabaseItems:m,setInventoryActivityLog:p,setInventoryCustomCategories:g,quickSave:v}=t;const x=a,y=i,b=o,w=l,N=c,_=d,[S,T]=(0,e.useState)(new Set),[C,E]=(0,e.useState)("daily"),j=(0,e.useCallback)((e=>{switch(e){case"daily":return x;case"weekly":return y;case"monthly":return b;default:return[]}}),[x,y,b]),A=(0,e.useCallback)(((e,t)=>{switch(e){case"daily":u(t),v("inventoryDailyItems",t);break;case"weekly":h(t),v("inventoryWeeklyItems",t);break;case"monthly":f(t),v("inventoryMonthlyItems",t)}}),[u,h,f,v]),I=(0,e.useCallback)((e=>{const t=[(0,r.A)((0,r.A)({},e),{},{id:Ke(),timestamp:(new Date).toLocaleString()}),...N];p(t),v("inventoryActivityLog",t)}),[N,p,v]),D=(0,e.useCallback)(((e,t,r,s,a,i)=>{const o=j(r),l=o.find((t=>t.id.toString()===e.toString()));if(!l)return void qe("Item not found!");const c=l.currentStock,{updatedItem:d}=n(670).c8(l,t,i||0),u=o.map((t=>t.id.toString()===e.toString()?d:t));A(r,u),I({type:"count_update",item:l.name,quantity:t,unit:l.unit,employee:s,notes:a||"Count updated from ".concat(c," to ").concat(t).concat(i?" (".concat(i," delivered)"):"")});const h=Math.max(0,c-t+(i||0)),f=h>0?" (".concat(h," consumed)"):"";qe("Successfully updated ".concat(l.name," count to ").concat(t," ").concat(l.unit,"!").concat(f))}),[I]),R=(0,e.useCallback)(((e,t,n,s,a,i)=>{const o=j(s),l=o.find((t=>t.id.toString()===e.toString()));if(!l)return void qe("Item not found!");if(t>l.currentStock)return void qe("Waste amount cannot exceed current stock!");const c=o.map((n=>n.id.toString()===e.toString()?(0,r.A)((0,r.A)({},n),{},{currentStock:n.currentStock-t}):n));A(s,c),I({type:"waste",item:l.name,quantity:t,unit:l.unit,employee:a,notes:i||"Waste reported: ".concat(n),reason:n}),qe("Successfully reported waste of ".concat(t," ").concat(l.unit," ").concat(l.name,"!"))}),[I]),P=(0,e.useCallback)((e=>{console.log("Importing items:",e.length);const t=new Set(w.map((e=>e.id))),n=new Set,r=e.filter((e=>((t.has(e.id)||n.has(e.id))&&(console.warn("Duplicate ID detected, generating new ID for:",e.name),e.id=Ke()),n.add(e.id),!0)));console.log("Filtered unique items:",r.length);const s=[...w,...r];m(s),v("inventoryDatabaseItems",s),qe("Imported ".concat(r.length," items to database")),I({type:"import",item:"Excel Import",quantity:r.length,unit:"items",employee:"System"})}),[w,m,v,I]),O=(0,e.useCallback)((e=>{const t=(0,r.A)((0,r.A)({},e),{},{id:Ke(),frequency:"database",isAssigned:!1}),n=[...w,t];m(n),v("inventoryDatabaseItems",n),qe("Item added to database successfully"),I({type:"manual_add",item:e.name,quantity:1,unit:"item",employee:"Current User"})}),[w,m,v,I]),M=(0,e.useCallback)(((e,t,n,s,a)=>{const i=w.filter((t=>e.includes(t.id)));if(0===i.length)return void qe("No items found to assign");const o=["daily","weekly","monthly"],l={};o.forEach((e=>{l[e]=j(e)}));const c=[];i.forEach((e=>{if(e.isAssigned){if(o.forEach((i=>{l[i].filter((t=>t.databaseId===e.id)).length>0&&(l[i]=i===t?l[i].map((t=>t.databaseId===e.id?(0,r.A)((0,r.A)({},t),{},{category:n,minLevel:s,currentStock:a,lastUsed:(new Date).toISOString().split("T")[0]}):t)):l[i].filter((t=>t.databaseId!==e.id)))})),e.assignedTo!==t){const t={id:Ke(),name:e.name,category:n,currentStock:a,minLevel:s,unit:e.unit||"pieces",lastUsed:(new Date).toISOString().split("T")[0],cost:e.cost||0,ean:e.ean||"",databaseId:e.id};c.push(t)}}else{const t={id:Ke(),name:e.name,category:n,currentStock:a,minLevel:s,unit:e.unit||"pieces",lastUsed:(new Date).toISOString().split("T")[0],cost:e.cost||0,ean:e.ean||"",databaseId:e.id};c.push(t)}})),c.length>0&&(l[t]=[...l[t],...c]),o.forEach((e=>{const t=j(e);l[e].length===t.length&&JSON.stringify(l[e])===JSON.stringify(t)||A(e,l[e])}));const d=w.map((s=>e.includes(s.id)?(0,r.A)((0,r.A)({},s),{},{isAssigned:!0,assignedTo:t,assignedCategory:n,assignedDate:(new Date).toISOString().split("T")[0]}):s));m(d),v("inventoryDatabaseItems",d),T(new Set),qe("Successfully ".concat(i.some((e=>e.isAssigned))?"updated":"assigned"," ").concat(i.length," items to ").concat(t," - ").concat(n)),I({type:"manual_add",item:"".concat(i.length," items"),quantity:i.length,unit:"items",employee:"Current User",notes:"".concat(i.some((e=>e.isAssigned))?"Updated assignment to":"Assigned to"," ").concat(t," - ").concat(n)})}),[w,I,j,A,m,v]),L=(0,e.useCallback)((e=>{const t=w.find((t=>t.id===e));if(!t)return void qe("Database item not found!");if(!t.isAssigned)return void qe("Item is not currently assigned!");["daily","weekly","monthly"].forEach((t=>{const n=j(t),r=n.filter((t=>t.databaseId!==e));r.length!==n.length&&(A(t,r),console.log("Removed ".concat(n.length-r.length," duplicate(s) from ").concat(t)))}));const n=w.map((t=>t.id===e?(0,r.A)((0,r.A)({},t),{},{isAssigned:!1,assignedTo:void 0,assignedCategory:void 0,assignedDate:void 0}):t));m(n),v("inventoryDatabaseItems",n),qe("Successfully unassigned ".concat(t.name," from inventory (removed all duplicates)"))}),[w]),F=(0,e.useCallback)((e=>{if(0===e.length)return;const t={};["daily","weekly","monthly"].forEach((n=>{const r=j(n).filter((t=>!e.includes(t.databaseId||"")));t[n]=r})),t.daily.length!==x.length&&u(t.daily),t.weekly.length!==y.length&&h(t.weekly),t.monthly.length!==b.length&&f(t.monthly);const n=w.filter((t=>!e.includes(t.id)));m(n);const r=[];t.daily.length!==x.length&&r.push(v("inventoryDailyItems",t.daily)),t.weekly.length!==y.length&&r.push(v("inventoryWeeklyItems",t.weekly)),t.monthly.length!==b.length&&r.push(v("inventoryMonthlyItems",t.monthly)),r.push(v("inventoryDatabaseItems",n)),Promise.allSettled(r).then((()=>{console.log("\u2705 All delete operations saved successfully")})).catch((e=>{console.warn("\u26a0\ufe0f Some delete operations failed to save:",e)})),T(new Set),qe("Deleted ".concat(e.length," items from database"))}),[w,x.length,y.length,b.length,m,u,h,f,v]),U=(0,e.useCallback)((e=>{T((t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}))}),[]),W=(0,e.useCallback)((e=>{T((t=>{const n=new Set(t);return e.forEach((e=>n.add(e))),n}))}),[]),z=(0,e.useCallback)((()=>{T(new Set)}),[]),B=(0,e.useCallback)((()=>{let e=0;const t=new Set,n=w.map((n=>{if(t.has(n.id)){console.warn("Duplicate database ID detected:",n.id,"for item:",n.name);const s=Ke();return console.log("Assigned new ID:",s),e++,t.add(s),(0,r.A)((0,r.A)({},n),{},{id:s})}return t.add(n.id),n}));e>0&&(m(n),v("inventoryDatabaseItems",n)),["daily","weekly","monthly"].forEach((t=>{const n=j(t),r=new Set,s=n.filter((t=>t.databaseId&&r.has(t.databaseId)?(e++,!1):(t.databaseId&&r.add(t.databaseId),!0)));s.length!==n.length&&(A(t,s),console.log("Cleaned ".concat(n.length-s.length," duplicates from ").concat(t)))})),qe(e>0?"Cleaned up ".concat(e," duplicate items from database and inventory"):"No duplicate items found")}),[w,m,v,j,A]),H=(0,e.useCallback)((e=>{E(e),T(new Set)}),[]),V=(0,e.useCallback)((e=>{const t=(0,r.A)((0,r.A)({},e),{},{id:Ke().toString(),createdAt:(new Date).toISOString(),isDefault:!1}),n=[..._,t];g(n),v("inventoryCustomCategories",n),qe('Custom category "'.concat(e.name,'" created successfully')),I({type:"manual_add",item:"Custom Category: ".concat(e.name),quantity:1,unit:"category",employee:"Current User"})}),[_,g,v,I]),q=(0,e.useCallback)(((e,t)=>{const n=_.map((n=>n.id===e?t:n));g(n),v("inventoryCustomCategories",n),qe('Category "'.concat(t.name,'" updated successfully'))}),[_,g,v]),Y=(0,e.useCallback)((e=>{const t=_.find((t=>t.id===e));if(!t)return void qe("Category not found");const n=_.filter((t=>t.id!==e));g(n),v("inventoryCustomCategories",n),qe('Category "'.concat(t.name,'" deleted successfully')),I({type:"manual_add",item:"Deleted Category: ".concat(t.name),quantity:1,unit:"category",employee:"Current User"})}),[_,g,v,I]),K={dailyItems:x,weeklyItems:y,monthlyItems:b,databaseItems:w,activityLog:N,customCategories:_,selectedItems:S,currentTab:C,setDailyItems:u,setWeeklyItems:h,setMonthlyItems:f,setDatabaseItems:m,setActivityLog:p,setCustomCategories:g,addActivityEntry:I,updateItemStock:D,reportWaste:R,importFromExcel:P,addManualItem:O,assignToCategory:M,unassignFromCategory:L,cleanupDuplicates:B,deleteItems:F,toggleItemSelection:U,selectMultipleItems:W,clearSelection:z,switchTab:H,addCustomCategory:V,updateCustomCategory:q,deleteCustomCategory:Y,quickSave:v};return(0,k.jsx)(Xe.Provider,{value:K,children:s})};var Ze=n(670);const et=o("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),tt=o("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),nt=o("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),rt=t=>{let{onClose:n}=t;const{importFromExcel:r}=Qe(),[s,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,f]=(0,e.useState)(!1);(0,e.useEffect)((()=>{(async()=>{if(window.XLSX)u(!0);else{f(!0);try{const e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",e.async=!0,await new Promise(((t,n)=>{e.onload=t,e.onerror=n,document.head.appendChild(e)})),u(!0),console.log("SheetJS loaded successfully")}catch(e){console.error("Failed to load SheetJS:",e),qe("Failed to load Excel parser. Please try refreshing the page.")}finally{f(!1)}}})()}),[]);const m=()=>{c(!1),o([])};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 mx-4 ".concat(l?"max-w-4xl w-full max-h-[90vh] overflow-y-auto":"max-w-md w-full"),children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:l?"Preview Import Data":"Import Items from Excel"}),(0,k.jsx)("button",{onClick:l?m:n,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),l?(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("div",{className:"flex items-center justify-between",children:(0,k.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,k.jsx)(He,{className:"w-5 h-5 mr-2"}),(0,k.jsxs)("span",{className:"font-medium",children:[i.length," items ready to import"]})]})}),(0,k.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto",children:[(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.slice(0,20).map(((e,t)=>(0,k.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,k.jsx)("div",{className:"font-medium text-sm text-gray-800 truncate",title:e.name,children:e.name}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 space-y-1 mt-1",children:[e.ean&&(0,k.jsxs)("div",{children:["EAN: ",e.ean]}),e.unit&&(0,k.jsxs)("div",{children:["Unit: ",e.unit]}),e.cost&&e.cost>0&&(0,k.jsxs)("div",{children:["Price: \u20ac",e.cost.toFixed(2)]}),e.costWithTax&&e.costWithTax>0&&(0,k.jsxs)("div",{children:["Price (tax): \u20ac",e.costWithTax.toFixed(2)]})]})]},e.id)))}),i.length>20&&(0,k.jsxs)("div",{className:"text-center text-sm text-gray-500 mt-3",children:["... and ",i.length-20," more items"]})]}),(0,k.jsxs)("div",{className:"flex gap-4",children:[(0,k.jsxs)("button",{onClick:()=>{0!==i.length&&(r(i),qe("Successfully imported ".concat(i.length," items!")),n())},className:"flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors",children:["Import ",i.length," Items"]}),(0,k.jsx)("button",{onClick:m,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):(0,k.jsxs)("div",{className:"space-y-4",children:[h&&(0,k.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),(0,k.jsx)("span",{className:"text-blue-700",children:"Loading Excel parser..."})]})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File"}),(0,k.jsx)("input",{type:"file",accept:".xls,.xlsx,.csv",onChange:async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)if(d){a(!0);try{console.log("Processing file:",n.name,"Type:",n.type,"Size:",n.size);const e=[".xls",".xlsx",".csv"],t=n.name.toLowerCase().substring(n.name.lastIndexOf("."));if(!e.includes(t))throw new Error("Invalid file type: ".concat(t,". Please use .xls, .xlsx, or .csv files."));if(n.size>10485760)throw new Error("File size too large. Please use files smaller than 10MB.");const r=await n.arrayBuffer();console.log("File loaded, size:",r.byteLength,"bytes");const s=window.XLSX.read(r,{type:"array",cellStyles:!0,cellFormulas:!1,cellDates:!0,cellNF:!1,sheetStubs:!1});if(console.log("Workbook loaded, sheets:",s.SheetNames),0===s.SheetNames.length)throw new Error("No sheets found in the Excel file");const a=s.SheetNames[0],i=s.Sheets[a];console.log("Processing sheet:",a);const l=window.XLSX.utils.sheet_to_json(i,{header:1,defval:null,blankrows:!1,raw:!1});if(console.log("Raw JSON data sample:",l.slice(0,3)),!l||0===l.length)throw new Error("Sheet appears to be empty");const d=(e=>{if(e.length<2)throw new Error("File appears to be empty or invalid");const t=e[0];console.log("Header row:",t);const n=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("tuotenimi")||t.includes("name")||t.includes("nimi")||t.includes("product")||t.includes("catentdesc")})),r=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("ean")||t.includes("barcode")})),s=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return"pmy"===t||t.includes("unit")||t.includes("yksikk\xf6")||t.includes("baseunit")||"baseunit_size"===t})),a=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("hinta veroton")||t.includes("price")&&!t.includes("tax")||t.includes("veroton")})),i=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("hinta verollinen")||t.includes("pricetax")||t.includes("hinta")&&t.includes("verollinen")}));if(console.log("Column mapping:",{nameIdx:n>=0?t[n]:"Not found",eanIdx:r>=0?t[r]:"Not found",unitIdx:s>=0?t[s]:"Not found",priceIdx:a>=0?t[a]:"Not found",priceTaxIdx:i>=0?t[i]:"Not found"}),-1===n)throw new Error('Could not find product name column. Expected columns containing "tuotenimi", "name", "nimi", or "product".');const o=e.slice(1).filter((e=>e&&e[n]&&e[n].toString().trim().length>0));console.log("Found ".concat(o.length," valid data rows out of ").concat(e.length-1," total rows"));const l=o.map(((e,t)=>{var o,l,c;return{id:Ke(),name:(null===(o=e[n])||void 0===o?void 0:o.toString().trim())||"",ean:-1!==r&&(null===(l=e[r])||void 0===l?void 0:l.toString().trim())||"",unit:-1!==s&&(null===(c=e[s])||void 0===c?void 0:c.toString().trim())||"",cost:-1!==a&&parseFloat(e[a])||0,costWithTax:-1!==i&&parseFloat(e[i])||0,type:"",frequency:"database"}})).filter((e=>e.name.length>0));return console.log("Successfully parsed ".concat(l.length," items")),l})(l);if(0===d.length)throw new Error("No valid items found in the file. Please check that your file has a header row and product names.");o(d),c(!0),qe("Found ".concat(d.length," items. Review before importing."))}catch(r){console.error("Excel parsing error:",r);const e=r instanceof Error?r.message:"Unknown error occurred";qe("Error reading file: "+e)}finally{a(!1),e.target.value=""}}else qe("Excel parser is still loading. Please wait a moment and try again.")},disabled:s||!d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"}),(0,k.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Supports .xls, .xlsx, and .csv files (max 10MB)"})]}),(0,k.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,k.jsxs)("h4",{className:"font-medium text-blue-800 mb-2 flex items-center",children:[(0,k.jsx)(nt,{className:"w-4 h-4 mr-1"}),"Expected Excel Format:"]}),(0,k.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,k.jsxs)("li",{children:["\u2022 ",(0,k.jsx)("strong",{children:"Product Name:"})," tuotenimi, name, nimi, product"]}),(0,k.jsxs)("li",{children:["\u2022 ",(0,k.jsx)("strong",{children:"EAN Code:"})," ean, barcode"]}),(0,k.jsxs)("li",{children:["\u2022 ",(0,k.jsx)("strong",{children:"Unit:"})," PMY, unit, yksikk\xf6, baseunit_size"]}),(0,k.jsxs)("li",{children:["\u2022 ",(0,k.jsx)("strong",{children:"Price (excl. tax):"})," hinta veroton, price"]}),(0,k.jsxs)("li",{children:["\u2022 ",(0,k.jsx)("strong",{children:"Price (incl. tax):"})," hinta verollinen, pricetax"]})]}),(0,k.jsxs)("button",{onClick:()=>{const e=[["tuotenimi","ean","PMY","hinta veroton","hinta verollinen"],["Sample Product 1","1234567890123","kg","10.50","12.60"],["Sample Product 2","2345678901234","pcs","5.25","6.30"],["Sample Product 3","3456789012345","liters","8.75","10.50"]].map((e=>e.join(","))).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="sample_inventory.csv",r.click(),window.URL.revokeObjectURL(n)},className:"mt-2 text-xs text-blue-600 hover:text-blue-800 flex items-center",children:[(0,k.jsx)(ge,{className:"w-3 h-3 mr-1"}),"Download sample file"]})]}),s&&(0,k.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,k.jsx)("span",{className:"ml-2 text-gray-600",children:"Processing file..."})]})]}),!l&&(0,k.jsx)("div",{className:"flex gap-4 mt-6",children:(0,k.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})},st=t=>{let{onClose:n}=t;const{addManualItem:s,customCategories:a}=Qe(),[i,o]=(0,e.useState)({name:"",ean:"",unit:"",cost:"",costWithTax:"",type:""}),l=$e(a);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Add Manual Item"}),(0,k.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name"}),(0,k.jsx)("input",{type:"text",placeholder:"Enter product name",value:i.name,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EAN Code (Optional)"}),(0,k.jsx)("input",{type:"text",placeholder:"Enter EAN code",value:i.ean,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{ean:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),(0,k.jsx)("input",{type:"text",placeholder:"e.g., kg, pieces, bottles",value:i.unit,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{unit:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (excl. tax)"}),(0,k.jsx)("input",{type:"number",step:"0.01",placeholder:"0.00",value:i.cost,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{cost:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (incl. tax)"}),(0,k.jsx)("input",{type:"number",step:"0.01",placeholder:"0.00",value:i.costWithTax,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{costWithTax:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),(0,k.jsxs)("select",{value:i.type,onChange:e=>o((t=>(0,r.A)((0,r.A)({},t),{},{type:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"",children:"Select type..."}),l.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value)))]})]})]}),(0,k.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,k.jsx)("button",{onClick:()=>{if(!i.name.trim())return void qe("Please enter a product name");const e={name:i.name.trim(),ean:i.ean.trim(),unit:i.unit.trim(),cost:parseFloat(i.cost)||0,costWithTax:parseFloat(i.costWithTax)||0,type:i.type};s(e),n()},className:"flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Add to Database"}),(0,k.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},at=t=>{let{onClose:n,preSelectedFrequency:r}=t;const{databaseItems:s,selectedItems:a,customCategories:i,assignToCategory:o}=Qe(),[l,c]=(0,e.useState)(r||"daily"),[d,u]=(0,e.useState)("produce"),[h,f]=(0,e.useState)(5),[m,p]=(0,e.useState)(0),g=s.filter((e=>a.has(e.id))),v=$e(i);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Assign Category and Settings"}),(0,k.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[!r&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),(0,k.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"daily",children:"\ud83d\udd25 Daily Items"}),(0,k.jsx)("option",{value:"weekly",children:"\ud83d\udcc5 Weekly Items"}),(0,k.jsx)("option",{value:"monthly",children:"\ud83d\udce6 Monthly Items"})]})]}),r&&(0,k.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Selected Frequency:"}),(0,k.jsxs)("div",{className:"text-lg font-semibold text-blue-700",children:["daily"===r&&"\ud83d\udd25 Daily Items","weekly"===r&&"\ud83d\udcc5 Weekly Items","monthly"===r&&"\ud83d\udce6 Monthly Items"]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,k.jsx)("select",{value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:v.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Stock Level"}),(0,k.jsx)("input",{type:"number",min:"0",value:h,onChange:e=>f(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Stock"}),(0,k.jsx)("input",{type:"number",min:"0",value:m,onChange:e=>p(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,k.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Items to assign:"}),(0,k.jsx)("div",{className:"text-sm text-blue-700 max-h-32 overflow-y-auto",children:g.map((e=>(0,k.jsxs)("div",{className:"py-1",children:["\u2022 ",e.name]},e.id)))})]})]}),(0,k.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,k.jsx)("button",{onClick:()=>{o(Array.from(a),l,d,h,m),n()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Assign Category"}),(0,k.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},it=t=>{let{onClose:n}=t;const{customCategories:s,addCustomCategory:a,updateCustomCategory:i,deleteCustomCategory:o}=Qe(),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(null),[h,f]=(0,e.useState)({name:"",icon:"\ud83d\udce6",color:"#3B82F6"}),m=()=>{f({name:"",icon:"\ud83d\udce6",color:"#3B82F6"}),u(null),c(!1)};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,k.jsx)(tt,{className:"w-6 h-6 mr-2 text-blue-600"}),"Category Editor"]}),(0,k.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-6 h-6"})})]}),(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsx)("h4",{className:"text-lg font-medium text-gray-700 mb-3",children:"Default Categories"}),(0,k.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:Ge.map((e=>(0,k.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsx)("div",{className:"text-xs text-gray-500",children:"Built-in"})]})]})},e.id)))})]}),(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsx)("h4",{className:"text-lg font-medium text-gray-700",children:"Custom Categories"}),(0,k.jsxs)("button",{onClick:()=>c(!0),className:"bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center text-sm",children:[(0,k.jsx)(q,{className:"w-4 h-4 mr-1"}),"Add Category"]})]}),0===s.length?(0,k.jsxs)("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[(0,k.jsx)(tt,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),(0,k.jsx)("p",{className:"font-medium",children:"No custom categories yet"}),(0,k.jsx)("p",{className:"text-sm",children:"Create your first custom category to get started"})]}):(0,k.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:s.map((e=>(0,k.jsxs)("div",{className:"bg-white p-3 rounded-lg border-2 border-gray-200 relative group",children:[(0,k.jsxs)("div",{className:"flex items-center mb-2",children:[(0,k.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsx)("div",{className:"text-xs text-gray-500",children:"Custom"})]})]}),(0,k.jsx)("div",{className:"w-full h-2 rounded-full mb-2",style:{backgroundColor:e.color}}),(0,k.jsxs)("div",{className:"flex items-center justify-between opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,k.jsx)("button",{onClick:()=>(e=>{u(e),f({name:e.name,icon:e.icon,color:e.color}),c(!0)})(e),className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit category",children:(0,k.jsx)(X,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to delete this category? This action cannot be undone.")&&o(t));var t},className:"text-red-600 hover:text-red-800 p-1",title:"Delete category",children:(0,k.jsx)(Y,{className:"w-4 h-4"})})]})]},e.id)))})]}),l&&(0,k.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,k.jsx)("h5",{className:"font-medium text-blue-800 mb-3",children:d?"Edit Category":"Add New Category"}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h.name.trim()&&(d?i(d.id,(0,r.A)((0,r.A)({},d),{},{name:h.name.trim(),icon:h.icon,color:h.color})):a({name:h.name.trim(),icon:h.icon,color:h.color}),m())},className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name"}),(0,k.jsx)("input",{type:"text",value:h.name,onChange:e=>f((0,r.A)((0,r.A)({},h),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter category name...",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,k.jsx)("input",{type:"text",value:h.icon,onChange:e=>f((0,r.A)((0,r.A)({},h),{},{icon:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-20 text-center text-lg"}),(0,k.jsx)("span",{className:"text-sm text-gray-500",children:"Or choose from common icons:"})]}),(0,k.jsx)("div",{className:"grid grid-cols-7 gap-2",children:["\ud83d\udce6","\ud83e\udd6c","\ud83e\udd69","\ud83e\udd5b","\ud83c\udf5e","\ud83e\udd64","\ud83e\uddfd","\ud83c\udf7d\ufe0f","\ud83d\udd27","\ud83c\udfa8","\ud83c\udff7\ufe0f","\u2b50","\ud83c\udfaf","\ud83d\udca1"].map((e=>(0,k.jsx)("button",{type:"button",onClick:()=>f((0,r.A)((0,r.A)({},h),{},{icon:e})),className:"p-2 text-xl border rounded-lg hover:bg-gray-100 ".concat(h.icon===e?"border-blue-500 bg-blue-50":"border-gray-300"),children:e},e)))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,k.jsx)("input",{type:"color",value:h.color,onChange:e=>f((0,r.A)((0,r.A)({},h),{},{color:e.target.value})),className:"w-12 h-10 border border-gray-300 rounded-lg cursor-pointer"}),(0,k.jsx)("input",{type:"text",value:h.color,onChange:e=>f((0,r.A)((0,r.A)({},h),{},{color:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 flex-1",placeholder:"#3B82F6"})]}),(0,k.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["#3B82F6","#10B981","#EF4444","#F59E0B","#8B5CF6","#F97316","#6B7280","#EC4899","#14B8A6","#84CC16"].map((e=>(0,k.jsx)("button",{type:"button",onClick:()=>f((0,r.A)((0,r.A)({},h),{},{color:e})),className:"w-full h-8 rounded-lg border-2 ".concat(h.color===e?"border-gray-800":"border-gray-300"),style:{backgroundColor:e}},e)))})]}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:d?"Update Category":"Add Category"}),(0,k.jsx)("button",{type:"button",onClick:m,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]}),(0,k.jsx)("div",{className:"flex justify-end",children:(0,k.jsx)("button",{onClick:n,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})]})})},ot=e=>{let{onAssignCategory:t,onDelete:n}=e;const{selectedItems:r,clearSelection:s}=Qe();return 0===r.size?null:(0,k.jsx)("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-1/2 md:right-auto md:transform md:-translate-x-1/2",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border p-4 w-full md:min-w-96 md:w-auto",children:[(0,k.jsxs)("div",{className:"block md:hidden space-y-3",children:[(0,k.jsx)("div",{className:"text-center",children:(0,k.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[r.size," items selected"]})}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,k.jsx)("button",{onClick:()=>t("daily"),className:"bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition-colors flex items-center justify-center",children:"\ud83d\udd25 Daily"}),(0,k.jsx)("button",{onClick:()=>t("weekly"),className:"bg-yellow-500 text-white px-2 py-1 rounded text-xs hover:bg-yellow-600 transition-colors flex items-center justify-center",children:"\ud83d\udcc5 Weekly"}),(0,k.jsx)("button",{onClick:()=>t("monthly"),className:"bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 transition-colors flex items-center justify-center",children:"\ud83d\udce6 Monthly"})]}),(0,k.jsxs)("div",{className:"flex space-x-2",children:[(0,k.jsx)("button",{onClick:s,className:"flex-1 bg-gray-500 text-white px-3 py-2 rounded text-sm hover:bg-gray-600 transition-colors",children:"Clear"}),(0,k.jsx)("button",{onClick:n,className:"flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 transition-colors",children:"Delete"})]})]}),(0,k.jsxs)("div",{className:"hidden md:flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[r.size," items selected"]}),(0,k.jsx)("div",{className:"h-4 w-px bg-gray-300"}),(0,k.jsxs)("div",{className:"flex space-x-2",children:[(0,k.jsx)("button",{onClick:()=>t("daily"),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"\ud83d\udd25 Daily"}),(0,k.jsx)("button",{onClick:()=>t("weekly"),className:"bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors",children:"\ud83d\udcc5 Weekly"}),(0,k.jsx)("button",{onClick:()=>t("monthly"),className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors",children:"\ud83d\udce6 Monthly"})]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("button",{onClick:s,className:"bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors",children:"Clear"}),(0,k.jsx)("button",{onClick:n,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Delete"})]})]})]})})},lt=t=>{let{item:n,onClose:r,onSave:s,onUnassign:a}=t;const{customCategories:i}=Qe(),[o,l]=(0,e.useState)(n.assignedTo||"daily"),[c,d]=(0,e.useState)(n.assignedCategory||"produce"),[u,h]=(0,e.useState)(5),[f,m]=(0,e.useState)(0),p=$e(i);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Edit Item Assignment"}),(0,k.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-2xl mr-3",children:Ve(n.isAssigned&&n.assignedCategory?n.assignedCategory:n.type||"supplies")}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-medium text-gray-800",children:n.name}),(0,k.jsxs)("p",{className:"text-sm text-gray-600",children:[n.ean||"No EAN"," \u2022 ",n.unit||"pieces"]}),n.isAssigned&&(0,k.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["Currently assigned to ",n.assignedTo," - ",n.assignedCategory]})]})]})}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),(0,k.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"daily",children:"\ud83d\udd25 Daily Items"}),(0,k.jsx)("option",{value:"weekly",children:"\ud83d\udcc5 Weekly Items"}),(0,k.jsx)("option",{value:"monthly",children:"\ud83d\udce6 Monthly Items"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,k.jsx)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:p.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Level"}),(0,k.jsx)("input",{type:"number",min:"0",value:u,onChange:e=>h(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Stock"}),(0,k.jsx)("input",{type:"number",min:"0",value:f,onChange:e=>m(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,k.jsxs)("div",{className:"flex gap-3 mt-6",children:[n.isAssigned&&(0,k.jsx)("button",{onClick:()=>{a(),r()},className:"flex-1 bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Unassign"}),(0,k.jsx)("button",{onClick:()=>{s(o,c,u,f),r()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:n.isAssigned?"Update Assignment":"Assign to Inventory"}),(0,k.jsx)("button",{onClick:r,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},ct=()=>{const{databaseItems:t,selectedItems:n,toggleItemSelection:r,selectMultipleItems:s,clearSelection:a,deleteItems:i,assignToCategory:o,unassignFromCategory:l,cleanupDuplicates:c,customCategories:d}=Qe(),[u,h]=(0,e.useState)(!1),[f,m]=(0,e.useState)(!1),[p,g]=(0,e.useState)(!1),[v,x]=(0,e.useState)(!1),[y,b]=(0,e.useState)(void 0),[w,N]=(0,e.useState)(!1),[_,S]=(0,e.useState)(null),[T,C]=(0,e.useState)("all"),[E,j]=(0,e.useState)(""),[A,I]=(0,e.useState)(!1),D=$e(d),R=t.filter((e=>{const t="all"===T||"assigned"===T&&e.isAssigned||"unassigned"===T&&!e.isAssigned||"uncategorized"===T&&(!e.type||""===e.type)||e.type===T,n=!E||e.name.toLowerCase().includes(E.toLowerCase())||e.ean&&e.ean.toLowerCase().includes(E.toLowerCase());return t&&n}));(0,e.useEffect)((()=>{a(),I(!1)}),[T,E,a]),(0,e.useEffect)((()=>{if(0===R.length)return void I(!1);const e=R.every((e=>n.has(e.id))),t=R.some((e=>n.has(e.id)));I(e&&t)}),[n,R]);const P=t.filter((e=>e.isAssigned)).length,O=t.filter((e=>!e.isAssigned)).length;return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)("span",{className:"mr-2",children:"\ud83d\udcbe"}),"Items Database Management"]}),(0,k.jsx)("p",{className:"text-gray-600 mb-4",children:"Import items from Excel and assign them to inventory categories"}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,k.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:t.length}),(0,k.jsx)("div",{className:"text-sm text-blue-600",children:"Total Items"})]}),(0,k.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-green-700",children:P}),(0,k.jsx)("div",{className:"text-sm text-green-600",children:"Assigned"})]}),(0,k.jsxs)("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-orange-700",children:O}),(0,k.jsx)("div",{className:"text-sm text-orange-600",children:"Unassigned"})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,k.jsxs)("button",{onClick:()=>h(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(et,{className:"w-5 h-5 mr-2"}),"Import from Excel"]}),(0,k.jsxs)("button",{onClick:()=>m(!0),className:"bg-green-500 text-white px-4 py-3 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(q,{className:"w-5 h-5 mr-2"}),"Add Manual Item"]}),(0,k.jsxs)("button",{onClick:()=>x(!0),className:"bg-indigo-500 text-white px-4 py-3 rounded-lg hover:bg-indigo-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(tt,{className:"w-5 h-5 mr-2"}),"Manage Categories"]}),(0,k.jsxs)("button",{onClick:()=>{if(0===t.length)return void alert("No items in database to export");const e=[["Name","EAN","Unit","Price (excl. tax)","Price (incl. tax)","Type","Assigned To","Category"].join(","),...t.map((e=>['"'.concat(e.name||"",'"'),e.ean||"",e.unit||"",e.cost||0,e.costWithTax||0,e.type||"",e.assignedTo||"",e.assignedCategory||""].join(",")))].join("\n"),n=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download="database_items_".concat((new Date).toISOString().split("T")[0],".csv"),s.click(),window.URL.revokeObjectURL(r)},className:"bg-purple-500 text-white px-4 py-3 rounded-lg hover:bg-purple-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(ge,{className:"w-5 h-5 mr-2"}),"Export Database"]}),(0,k.jsxs)("button",{onClick:c,className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(Y,{className:"w-5 h-5 mr-2"}),"Clean Duplicates"]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsxs)("div",{className:"p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Database Items"}),(0,k.jsx)("div",{className:"text-sm text-gray-500",children:"Click on items to edit individually, or use checkboxes for bulk actions"})]}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("input",{type:"checkbox",checked:A,onChange:()=>{if(A)a(),I(!1);else{const e=R.map((e=>e.id));a(),s(e),I(!0)}},className:"rounded"}),(0,k.jsx)("label",{className:"text-sm text-gray-600",children:(()=>{const e="all"!==T,n=t.length,r=R.length;return e?"Select All Visible (".concat(r," of ").concat(n,")"):"Select All (".concat(n,")")})()})]}),(0,k.jsxs)("select",{value:T,onChange:e=>C(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[(0,k.jsx)("option",{value:"all",children:"All Items"}),(0,k.jsx)("option",{value:"assigned",children:"\u2705 Assigned Items"}),(0,k.jsx)("option",{value:"unassigned",children:"\u23f3 Unassigned Items"}),D.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value))),(0,k.jsx)("option",{value:"uncategorized",children:"\u2753 Uncategorized"})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Search database...",value:E,onChange:e=>j(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,k.jsx)("div",{className:"p-6",children:0===R.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,k.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcc2"}),(0,k.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No items found"}),(0,k.jsx)("p",{className:"text-sm",children:E||"all"!==T?"Try adjusting your search or filter":"Import items from Excel or add them manually to get started"})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map((e=>(0,k.jsxs)("div",{onClick:t=>((e,t)=>{const n=t.target;"INPUT"===n.tagName&&"checkbox"===n.type||S(e)})(e,t),className:"cursor-pointer bg-white border rounded-xl p-4 transition-all hover:shadow-md ".concat(n.has(e.id)?"border-blue-500 bg-blue-50":e.isAssigned?"border-green-300 bg-green-50":"border-gray-200 hover:border-gray-300"),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("input",{type:"checkbox",checked:n.has(e.id),onChange:()=>r(e.id),className:"mr-3 rounded",onClick:e=>e.stopPropagation()}),(0,k.jsx)("span",{className:"text-2xl mr-3",children:Ve(e.isAssigned&&e.assignedCategory?e.assignedCategory:e.type||"supplies")}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,k.jsx)("p",{className:"text-sm text-gray-600",children:e.ean||"No EAN"})]})]}),(0,k.jsx)("div",{className:"flex items-center space-x-1",children:e.isAssigned?(0,k.jsxs)("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:["\u2705 ",e.assignedTo]}):(0,k.jsx)("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u23f3 Unassigned"})})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"font-medium",children:"Unit:"})," ",e.unit||"pieces"]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"font-medium",children:"Cost:"})," \u20ac",(e.cost||0).toFixed(2)]})]}),e.isAssigned&&(0,k.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,k.jsxs)("div",{children:["Category: ",(0,k.jsx)("span",{className:"font-medium capitalize",children:e.assignedCategory})]}),(0,k.jsxs)("div",{children:["Assigned: ",e.assignedDate]})]}),(0,k.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:["Click to ",e.isAssigned?"edit assignment":"assign to inventory"]}),(0,k.jsx)(X,{className:"w-4 h-4 text-gray-400"})]})]},e.id)))})})]}),(0,k.jsx)(ot,{onAssignCategory:e=>{b(e),g(!0)},onDelete:()=>{0!==n.size&&N(!0)}}),w&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center mb-4",children:[(0,k.jsx)("div",{className:"p-3 bg-red-100 rounded-lg mr-4",children:(0,k.jsx)(ze,{className:"w-6 h-6 text-red-600"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Confirm Deletion"}),(0,k.jsx)("p",{className:"text-gray-600",children:"This action cannot be undone."})]})]}),(0,k.jsxs)("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete ",(0,k.jsx)("span",{className:"font-semibold",children:n.size})," selected items? This will permanently remove them from the database and any assigned inventory lists."]}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{onClick:()=>N(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,k.jsx)("button",{onClick:()=>{i(Array.from(n)),N(!1),I(!1)},className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Delete Items"})]})]})}),u&&(0,k.jsx)(rt,{onClose:()=>h(!1)}),f&&(0,k.jsx)(st,{onClose:()=>m(!1)}),p&&(0,k.jsx)(at,{onClose:()=>{g(!1),b(void 0)},preSelectedFrequency:y}),v&&(0,k.jsx)(it,{onClose:()=>x(!1)}),_&&(0,k.jsx)(lt,{item:_,onClose:()=>S(null),onSave:(e,t,n,r)=>{_&&o([_.id],e,t,n,r)},onUnassign:()=>{_&&l(_.id)}})]})},dt=e=>{let{item:t,onUpdateCount:n,onReportWaste:r,showQuickActions:s=!0}=e;const a=(0,Ze.V0)(t.currentStock,t.minLevel),i=a;return(0,k.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm transition-all hover:shadow-md hover:-translate-y-1 ".concat((()=>{switch(i){case"out":return"bg-gradient-to-br from-red-50 to-red-100 border-l-4 border-red-600";case"critical":return"bg-gradient-to-br from-orange-50 to-orange-100 border-l-4 border-orange-500";case"low":return"bg-gradient-to-br from-yellow-50 to-yellow-100 border-l-4 border-yellow-500";default:return"bg-gradient-to-br from-green-50 to-green-100 border-l-4 border-green-500"}})()),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-2xl mr-3",children:Ve(t.category)}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800",children:t.name}),(0,k.jsx)("p",{className:"text-sm text-gray-600 capitalize",children:t.category})]})]}),(()=>{switch(i){case"out":return(0,k.jsx)("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs font-medium animate-pulse",children:"\ud83d\uded1 Out of Stock"});case"critical":return(0,k.jsx)("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-xs font-medium animate-pulse",children:"\ud83d\udea8 Critical"});case"low":return(0,k.jsx)("span",{className:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u26a0\ufe0f Low Stock"});default:return(0,k.jsx)("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u2705 Good Stock"})}})()]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Current Count"}),(0,k.jsxs)("div",{className:"text-lg font-bold ".concat((()=>{switch(i){case"out":return"text-red-700";case"critical":return"text-orange-600";case"low":return"text-yellow-600";default:return"text-green-600"}})()),children:[t.currentStock," ",t.unit]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Min Level"}),(0,k.jsxs)("div",{className:"text-lg font-medium text-gray-700",children:[t.minLevel," ",t.unit]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs text-gray-600",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"font-medium",children:"Cost:"})," \u20ac",t.cost.toFixed(2)]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"font-medium",children:"Last Used:"})," ",t.lastUsed]})]}),t.ean&&(0,k.jsxs)("div",{className:"mb-4 text-xs text-gray-500",children:[(0,k.jsx)("span",{className:"font-medium",children:"EAN:"})," ",t.ean]}),s&&(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsxs)("button",{onClick:()=>n(t.id),className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[(0,k.jsx)(X,{className:"w-4 h-4 mr-1"}),"Update Count"]}),(0,k.jsxs)("button",{onClick:()=>r(t.id),className:"flex-1 flex items-center justify-center px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm",children:[(0,k.jsx)(Y,{className:"w-4 h-4 mr-1"}),"Report Waste"]})]})]})},ut=t=>{let{value:n,onChange:r,min:s=0,max:a=100,step:i=1}=t;const o=(0,e.useRef)(null),l=(0,e.useRef)(null),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(0),[f,m]=(0,e.useState)(0),[p,g]=(0,e.useState)(!1),[v,x]=(0,e.useState)(""),[y,b]=(0,e.useState)(0),w=(0,e.useRef)(null),N=[];for(let e=s;e<=a;e+=i)N.push(e);const _=48,S=192,T=(0,e.useCallback)((e=>{const t=N.indexOf(e);if(-1===t)return 0;return 72-t*_}),[N,S,_]),C=(0,e.useCallback)((e=>{const t=Math.round((72-e)/_);return N[Math.max(0,Math.min(t,N.length-1))]}),[N,S,_]),E=(0,e.useCallback)((e=>{const t=72-_*(N.length-1);return Math.max(t,Math.min(72,e))}),[N.length,S,_]);(0,e.useEffect)((()=>{p&&w.current&&(w.current.focus(),w.current.select())}),[p]),(0,e.useEffect)((()=>{if(l.current&&!c){const e=T(n);l.current.style.transform="translateY(".concat(e,"px)")}}),[n,c,T]);const j=(0,e.useCallback)(((e,t)=>{if(t&&(t.preventDefault(),t.stopPropagation()),d(!0),h(e),l.current){const e=window.getComputedStyle(l.current),t=new DOMMatrix(e.transform);m(t.m42),l.current.style.transition="none"}}),[]),A=(0,e.useCallback)(((e,t)=>{if(!c||!l.current)return;t&&(t.preventDefault(),t.stopPropagation());const n=E(f+(e-u));l.current.style.transform="translateY(".concat(n,"px)")}),[c,u,f,E]),I=(0,e.useCallback)((e=>{if(!c||!l.current)return;e&&(e.preventDefault(),e.stopPropagation()),d(!1),l.current.style.transition="transform 0.3s ease-in-out";const t=window.getComputedStyle(l.current),n=new DOMMatrix(t.transform).m42,s=C(n),a=T(s);l.current.style.transform="translateY(".concat(a,"px)"),r(s)}),[c,C,T,r]),D=(0,e.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),x(n.toString()),g(!0)}),[n]),R=(0,e.useCallback)((e=>{const t=Date.now(),r=t-y;r<300&&r>0&&(e.preventDefault(),e.stopPropagation(),x(n.toString()),g(!0)),b(t)}),[y,n]),P=(0,e.useCallback)((e=>{const t=parseFloat(e);if(isNaN(t))return!1;const n=Math.max(s,Math.min(a,t)),o=Math.round((n-s)/i),l=s+o*i;return!!N.includes(l)&&(r(l),!0)}),[s,a,i,N,r]),O=(0,e.useCallback)((()=>{P(v)&&g(!1)}),[v,P]),M=(0,e.useCallback)((()=>{g(!1),x("")}),[]),L=(0,e.useCallback)((e=>{"Enter"===e.key?(e.preventDefault(),O()):"Escape"===e.key&&(e.preventDefault(),M())}),[O,M]),F=(0,e.useCallback)((()=>{O()}),[O]),U=(0,e.useCallback)((e=>{p||(e.preventDefault(),e.stopPropagation(),j(e.clientY,e.nativeEvent))}),[j,p]);(0,e.useEffect)((()=>{const e=e=>{A(e.clientY,e)},t=e=>{I(e)};return c&&(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",t,{passive:!1})),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}),[c,A,I]);const W=(0,e.useCallback)((e=>{p||(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&(R(e),j(e.touches[0].clientY,e.nativeEvent)))}),[j,R,p]),z=(0,e.useCallback)((e=>{p||(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&c&&A(e.touches[0].clientY,e.nativeEvent))}),[c,A,p]),B=(0,e.useCallback)((e=>{p||(e.preventDefault(),e.stopPropagation(),I(e.nativeEvent))}),[I,p]),H=(0,e.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]);return(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("div",{ref:o,className:"relative h-48 overflow-hidden bg-white border-2 border-gray-200 rounded-xl touch-none select-none",style:{height:"".concat(S,"px"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onMouseDown:U,onDoubleClick:D,onTouchStart:W,onTouchMove:z,onTouchEnd:B,onContextMenu:H,children:[(0,k.jsx)("div",{className:"absolute top-0 left-0 right-0 h-16 bg-gradient-to-b from-white to-transparent pointer-events-none z-10"}),(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-white to-transparent pointer-events-none z-10"}),(0,k.jsx)("div",{className:"absolute left-0 right-0 border-t border-b border-gray-300 pointer-events-none z-10",style:{top:"".concat(72,"px"),height:"".concat(_,"px")}}),p&&(0,k.jsx)("div",{className:"absolute left-0 right-0 z-20 flex items-center justify-center",style:{top:"".concat(72,"px"),height:"".concat(_,"px")},children:(0,k.jsx)("input",{ref:w,type:"number",value:v,onChange:e=>x(e.target.value),onKeyDown:L,onBlur:F,min:s,max:a,step:i,className:"w-20 h-8 text-center text-lg font-semibold border-2 border-blue-500 rounded bg-white text-black focus:outline-none focus:ring-2 focus:ring-blue-300"})}),(0,k.jsx)("div",{ref:l,className:"absolute left-0 right-0 transition-transform duration-300 ease-in-out touch-none select-none",style:{transform:"translateY(".concat(T(n),"px)"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},children:N.map(((e,t)=>{const r=e===n;return(0,k.jsx)("div",{className:"flex items-center justify-center transition-all duration-200 touch-none select-none ".concat(r?"text-black font-semibold text-xl":"text-gray-400 text-lg"),style:{height:"".concat(_,"px"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},children:e},e)}))})]}),(0,k.jsxs)("div",{className:"mt-2 text-center",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Selected: "}),(0,k.jsx)("span",{className:"font-semibold text-gray-800",children:n}),(0,k.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Double-click or double-tap to enter value manually"})]})]})},ht=t=>{let{frequency:n,selectedItemId:r,onClose:s}=t;const{dailyItems:a,weeklyItems:i,monthlyItems:o,updateItemStock:l}=Qe(),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(0),[f,m]=(0,e.useState)("1"),[p,g]=(0,e.useState)(""),v=(()=>{switch(n){case"daily":return a;case"weekly":return i;case"monthly":return o;default:return[]}})();(0,e.useEffect)((()=>{if(r){const e=v.find((e=>e.id===r));e&&(d(r.toString()),h(e.currentStock))}}),[r,v]);const x=v.find((e=>e.id.toString()===c));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Update Current Count"}),(0,k.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Item"}),(0,k.jsxs)("select",{value:c,onChange:e=>{d(e.target.value);const t=v.find((t=>t.id.toString()===e.target.value));t&&h(t.currentStock)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"",children:"Choose an item..."}),v.map((e=>(0,k.jsxs)("option",{value:e.id,children:[e.name," (Currently: ",e.currentStock," ",e.unit,")"]},e.id)))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Count"}),(0,k.jsx)(ut,{value:u,onChange:h,min:0,max:Math.max(100,((null===x||void 0===x?void 0:x.currentStock)||0)+20)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),(0,k.jsxs)("select",{value:f,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"1",children:"John Smith - Kitchen"}),(0,k.jsx)("option",{value:"2",children:"Sarah Johnson - Prep"}),(0,k.jsx)("option",{value:"3",children:"Mike Wilson - Grill"}),(0,k.jsx)("option",{value:"4",children:"Emily Davis - Pantry"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,k.jsx)("textarea",{rows:2,placeholder:"Any notes about the count...",value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,k.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,k.jsx)("button",{onClick:()=>{if(!c||u<0)return void alert("Please select an item and enter a valid count!");l(c,u,n,{1:"John Smith",2:"Sarah Johnson",3:"Mike Wilson",4:"Emily Davis"}[f],p),s()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Update Count"}),(0,k.jsx)("button",{onClick:s,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},ft=t=>{let{frequency:n,selectedItemId:r,onClose:s}=t;const{dailyItems:a,weeklyItems:i,monthlyItems:o,reportWaste:l}=Qe(),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(""),[f,m]=(0,e.useState)("expired"),[p,g]=(0,e.useState)("1"),[v,x]=(0,e.useState)(""),b=(()=>{switch(n){case"daily":return a;case"weekly":return i;case"monthly":return o;default:return[]}})();(0,e.useEffect)((()=>{r&&d(r.toString())}),[r]);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Report Waste"}),(0,k.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Item"}),(0,k.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"",children:"Choose an item..."}),b.map((e=>(0,k.jsxs)("option",{value:e.id,children:[e.name," (Available: ",e.currentStock," ",e.unit,")"]},e.id)))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Amount"}),(0,k.jsx)("input",{type:"number",min:"0",step:"0.1",placeholder:"Enter waste amount",value:u,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Reason"}),(0,k.jsxs)("select",{value:f,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"expired",children:"Expired/Spoiled"}),(0,k.jsx)("option",{value:"overcooked",children:"Overcooked"}),(0,k.jsx)("option",{value:"dropped",children:"Dropped/Contaminated"}),(0,k.jsx)("option",{value:"overordered",children:"Over-ordered"}),(0,k.jsx)("option",{value:"customer-return",children:"Customer Return"}),(0,k.jsx)("option",{value:"other",children:"Other"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),(0,k.jsxs)("select",{value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"1",children:"John Smith - Kitchen"}),(0,k.jsx)("option",{value:"2",children:"Sarah Johnson - Prep"}),(0,k.jsx)("option",{value:"3",children:"Mike Wilson - Grill"}),(0,k.jsx)("option",{value:"4",children:"Emily Davis - Pantry"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,k.jsx)("textarea",{rows:2,placeholder:"Details about the waste...",value:v,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,k.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,k.jsx)("button",{onClick:()=>{const e=parseFloat(u);if(!c||!u||e<=0)return void alert("Please select an item and enter a valid waste amount!");const t=b.find((e=>e.id.toString()===c));if(!t)return void alert("Item not found!");if(e>t.currentStock)return void alert("Waste amount cannot exceed current stock!");l(c,e,f,n,{1:"John Smith",2:"Sarah Johnson",3:"Mike Wilson",4:"Emily Davis"}[p],v),s()},className:"flex-1 bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Report Waste"}),(0,k.jsx)("button",{onClick:s,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},mt=()=>{const{dailyItems:t,activityLog:n,customCategories:r}=Qe(),[s,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)("all"),[h,f]=(0,e.useState)(""),m=$e(r),p=t.filter((e=>{const t="all"===d||e.category===d,n=!h||e.name.toLowerCase().includes(h.toLowerCase());return t&&n})),g=e=>{c(e),a(!0)},v=e=>{c(e),o(!0)},x=n.filter((e=>new Date(e.timestamp).toDateString()===(new Date).toDateString())).slice(0,10);return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,k.jsx)("span",{className:"mr-2",children:"\ud83d\udd25"}),"Daily High-Usage Items - ",(0,k.jsx)("span",{className:"text-red-600",children:(y=new Date,new Date(y).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]}),(0,k.jsx)("p",{className:"text-gray-600 mb-4",children:"At the end of each day, count and update current quantities for high-usage items"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("button",{onClick:()=>a(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(X,{className:"w-5 h-5 mr-2"}),"Update Current Count"]}),(0,k.jsxs)("button",{onClick:()=>o(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(Y,{className:"w-5 h-5 mr-2"}),"Report Waste"]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsxs)("div",{className:"p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Daily Usage Items"}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,k.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"all",children:"All Types"}),m.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Search daily items...",value:h,onChange:e=>f(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(h||"all"!==d)&&(0,k.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",p.length," of ",t.length," daily items",h&&' matching "'.concat(h,'"'),"all"!==d&&" in ".concat(d," category")]})]}),(0,k.jsx)("div",{className:"p-6",children:(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((e=>(0,k.jsx)(dt,{item:e,onUpdateCount:g,onReportWaste:v},e.id)))})})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsx)("div",{className:"p-6 border-b",children:(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Today's Activity"})}),(0,k.jsx)("div",{className:"p-6",children:(0,k.jsx)("div",{className:"space-y-3",children:0===x.length?(0,k.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,k.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\udccb"}),(0,k.jsx)("p",{children:"No activity recorded for today"})]}):x.map((e=>{let t,n,r;switch(e.type){case"count_update":t="\ud83d\udcdd",n="blue",r="Count Updated";break;case"waste":t="\ud83d\uddd1\ufe0f",n="red",r="Waste";break;default:t="\ud83d\udce6",n="gray",r="Activity"}return(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"bg-".concat(n,"-100 p-2 rounded-lg mr-3"),children:(0,k.jsx)("span",{className:"text-".concat(n,"-600"),children:t})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"font-medium text-gray-800",children:[r,": ",e.item]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600",children:[e.employee," \u2022 ",e.timestamp,e.notes&&" \u2022 ".concat(e.notes),e.reason&&" (".concat(e.reason,")")]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"font-bold text-gray-700",children:[e.quantity," ",e.unit]}),(0,k.jsx)("div",{className:"text-xs text-gray-500",children:e.type})]})]},e.id)}))})})]}),s&&(0,k.jsx)(ht,{frequency:"daily",selectedItemId:l,onClose:()=>{a(!1),c(null)}}),i&&(0,k.jsx)(ft,{frequency:"daily",selectedItemId:l,onClose:()=>{o(!1),c(null)}})]});var y},pt=()=>{const{weeklyItems:t}=Qe(),[n,r]=(0,e.useState)(!1),[s,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)("all"),f=t.filter((e=>{const t=!l||e.name.toLowerCase().includes(l.toLowerCase()),n="all"===d||e.category===d;return t&&n})),m=[...new Set(t.map((e=>e.category)))],p=e=>{o(e),r(!0)},g=e=>{o(e),a(!0)},v=t.length,x=t.filter((e=>0===e.currentStock)).length,y=t.filter((e=>e.currentStock>0&&e.currentStock<=e.minLevel)).length,b=t.reduce(((e,t)=>e+t.cost*t.currentStock),0),w=new Date,N=(8-w.getDay())%7,_=new Date(w);return _.setDate(w.getDate()+N),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,k.jsx)(pe,{className:"w-6 h-6 mr-2 text-yellow-600"}),"Weekly Reorder Items"]}),(0,k.jsx)("p",{className:"text-gray-600",children:"Items counted and updated weekly for regular restocking"})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,k.jsx)(L,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Next count: ",_.toLocaleDateString()]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-yellow-600 font-medium",children:"Total Items"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:v})]}),(0,k.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-red-600 font-medium",children:"Critical"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-red-800",children:x})]}),(0,k.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Low Stock"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-orange-800",children:y})]}),(0,k.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Total Value"}),(0,k.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["\u20ac",b.toFixed(2)]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("button",{onClick:()=>r(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(X,{className:"w-5 h-5 mr-2"}),"Weekly Count Update"]}),(0,k.jsxs)("button",{onClick:()=>a(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(Y,{className:"w-5 h-5 mr-2"}),"Report Waste"]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsxs)("div",{className:"p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Weekly Items Status"}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,k.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"all",children:"All Categories"}),m.map((e=>(0,k.jsx)("option",{value:e,className:"capitalize",children:e},e)))]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Search weekly items...",value:l,onChange:e=>c(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(l||"all"!==d)&&(0,k.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",f.length," of ",v," weekly items",l&&' matching "'.concat(l,'"'),"all"!==d&&" in ".concat(d," category")]})]}),(0,k.jsx)("div",{className:"p-6",children:0===f.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,k.jsx)(pe,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,k.jsx)("h3",{className:"text-lg font-medium mb-2",children:l||"all"!==d?"No items match your filters":"No weekly items yet"}),(0,k.jsx)("p",{className:"text-sm",children:l||"all"!==d?"Try adjusting your search or filter criteria":"Add items from the database to start tracking weekly inventory"})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map((e=>(0,k.jsx)(dt,{item:e,onUpdateCount:p,onReportWaste:g},e.id)))})})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[(0,k.jsx)(h,{className:"w-5 h-5 mr-2 text-yellow-600"}),"Weekly Inventory Insights"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Weekly Patterns"}),(0,k.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Monitor weekend vs weekday usage"}),(0,k.jsx)("li",{children:"\u2022 Track seasonal demand changes"}),(0,k.jsx)("li",{children:"\u2022 Identify peak consumption days"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udd04 Reorder Strategy"}),(0,k.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Set reorder points based on lead times"}),(0,k.jsx)("li",{children:"\u2022 Consider supplier delivery schedules"}),(0,k.jsx)("li",{children:"\u2022 Account for weekend availability"})]})]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"This Week's Turnover"}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Fast Moving:"}),(0,k.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock<.5*e.minLevel)).length})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Normal:"}),(0,k.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock>=.5*e.minLevel&&e.currentStock<=e.minLevel)).length})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Slow Moving:"}),(0,k.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock>e.minLevel)).length})]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Reorder Recommendations"}),(0,k.jsxs)("div",{className:"space-y-2",children:[t.filter((e=>e.currentStock<=e.minLevel)).slice(0,3).map((e=>(0,k.jsxs)("div",{className:"text-sm",children:[(0,k.jsx)("div",{className:"font-medium text-gray-700",children:e.name}),(0,k.jsxs)("div",{className:"text-gray-500",children:["Order: ",2*e.minLevel," ",e.unit]})]},e.id))),0===t.filter((e=>e.currentStock<=e.minLevel)).length&&(0,k.jsx)("p",{className:"text-gray-500 text-sm",children:"All items adequately stocked"})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cost Analysis"}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Avg. Cost/Item:"}),(0,k.jsxs)("span",{className:"font-medium",children:["\u20ac",v>0?(b/v).toFixed(2):"0.00"]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Weekly Budget:"}),(0,k.jsxs)("span",{className:"font-medium",children:["\u20ac",(.25*b).toFixed(2)]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Reorder Value:"}),(0,k.jsxs)("span",{className:"font-medium text-orange-600",children:["\u20ac",t.filter((e=>e.currentStock<=e.minLevel)).reduce(((e,t)=>e+t.cost*t.minLevel),0).toFixed(2)]})]})]})]})]}),n&&(0,k.jsx)(ht,{frequency:"weekly",selectedItemId:i,onClose:()=>{r(!1),o(null)}}),s&&(0,k.jsx)(ft,{frequency:"weekly",selectedItemId:i,onClose:()=>{a(!1),o(null)}})]})},gt=()=>{const{monthlyItems:t,customCategories:n}=Qe(),[r,s]=(0,e.useState)(!1),[a,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)("all"),f=$e(n),m=t.filter((e=>{const t=!c||e.name.toLowerCase().includes(c.toLowerCase()),n="all"===u||e.category===u;return t&&n})),p=(new Set(t.map((e=>e.category))),e=>{l(e),s(!0)}),g=e=>{l(e),i(!0)},v=t.length,x=t.filter((e=>0===e.currentStock)).length,y=t.filter((e=>e.currentStock>0&&e.currentStock<=e.minLevel)).length,b=t.reduce(((e,t)=>e+t.cost*t.currentStock),0);return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,k.jsx)(K,{className:"w-6 h-6 mr-2 text-green-600"}),"Monthly Bulk Items"]}),(0,k.jsx)("p",{className:"text-gray-600",children:"Items counted and updated monthly for bulk ordering and storage"})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,k.jsx)(pe,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Last monthly count: ",(new Date).toLocaleDateString()]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-green-600 font-medium",children:"Total Items"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-green-800",children:v})]}),(0,k.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-red-600 font-medium",children:"Critical"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-red-800",children:x})]}),(0,k.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-yellow-600 font-medium",children:"Low Stock"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:y})]}),(0,k.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Total Value"}),(0,k.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["\u20ac",b.toFixed(2)]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("button",{onClick:()=>s(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(X,{className:"w-5 h-5 mr-2"}),"Monthly Count Update"]}),(0,k.jsxs)("button",{onClick:()=>i(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,k.jsx)(Y,{className:"w-5 h-5 mr-2"}),"Report Waste/Damage"]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsxs)("div",{className:"p-6 border-b",children:[(0,k.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Monthly Items Inventory"}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,k.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,k.jsx)("option",{value:"all",children:"All Categories"}),f.map((e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Search monthly items...",value:c,onChange:e=>d(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(c||"all"!==u)&&(0,k.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",m.length," of ",v," monthly items",c&&' matching "'.concat(c,'"'),"all"!==u&&" in ".concat(u," category")]})]}),(0,k.jsx)("div",{className:"p-6",children:0===m.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,k.jsx)(K,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,k.jsx)("h3",{className:"text-lg font-medium mb-2",children:c||"all"!==u?"No items match your filters":"No monthly items yet"}),(0,k.jsx)("p",{className:"text-sm",children:c||"all"!==u?"Try adjusting your search or filter criteria":"Add items from the database to start tracking monthly inventory"})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((e=>(0,k.jsx)(dt,{item:e,onUpdateCount:p,onReportWaste:g},e.id)))})})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[(0,k.jsx)(K,{className:"w-5 h-5 mr-2 text-green-600"}),"Monthly Inventory Tips"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udce6 Bulk Items Management"}),(0,k.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Review monthly consumption patterns"}),(0,k.jsx)("li",{children:"\u2022 Check expiration dates on bulk items"}),(0,k.jsx)("li",{children:"\u2022 Plan storage space for large orders"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udcca Cost Optimization"}),(0,k.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Compare supplier prices monthly"}),(0,k.jsx)("li",{children:"\u2022 Track seasonal price variations"}),(0,k.jsx)("li",{children:"\u2022 Identify bulk discount opportunities"})]})]})]})]}),x>0&&(0,k.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[(0,k.jsxs)("div",{className:"flex items-center mb-3",children:[(0,k.jsx)("div",{className:"p-2 bg-red-100 rounded-lg mr-3",children:(0,k.jsx)(Y,{className:"w-5 h-5 text-red-600"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Monthly Items Need Attention"}),(0,k.jsxs)("p",{className:"text-red-600 text-sm",children:[x," monthly items are out of stock and may need immediate ordering"]})]})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.filter((e=>0===e.currentStock)).map((e=>(0,k.jsxs)("div",{className:"bg-white p-3 rounded-lg border-l-4 border-red-500",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsxs)("div",{className:"text-sm text-red-600",children:["Out of stock - Min required: ",e.minLevel," ",e.unit]}),(0,k.jsx)("div",{className:"text-xs text-gray-500 capitalize",children:e.category})]},e.id)))})]}),r&&(0,k.jsx)(ht,{frequency:"monthly",selectedItemId:o,onClose:()=>{s(!1),l(null)}}),a&&(0,k.jsx)(ft,{frequency:"monthly",selectedItemId:o,onClose:()=>{i(!1),l(null)}})]})},vt=o("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),xt=()=>{const{dailyItems:e,weeklyItems:t,monthlyItems:n,activityLog:r}=Qe(),s=[...e,...t,...n],a=s.filter((e=>"critical"===(0,Ze.V0)(e.currentStock,e.minLevel))),i=s.filter((e=>"low"===(0,Ze.V0)(e.currentStock,e.minLevel))),o=s.reduce(((e,t)=>e+t.cost*t.currentStock),0),l=r.filter((e=>new Date(e.timestamp).toDateString()===(new Date).toDateString())),c=l.filter((e=>"waste"===e.type)).reduce(((e,t)=>e+t.quantity),0),d=l.filter((e=>"waste"===e.type)).reduce(((e,t)=>{const n=s.find((e=>e.name===t.item));return e+t.quantity*((null===n||void 0===n?void 0:n.cost)||0)}),0);return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,k.jsx)(Oe,{className:"w-6 h-6 mr-2 text-purple-600"}),"Inventory Analytics Dashboard"]}),(0,k.jsx)("p",{className:"text-gray-600",children:"Overview of inventory status, trends, and performance metrics"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Items"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.length}),(0,k.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Daily: ",e.length," | Weekly: ",t.length," | Monthly: ",n.length]})]}),(0,k.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,k.jsx)(Oe,{className:"w-6 h-6 text-blue-600"})})]})}),(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Critical Items"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a.length}),(0,k.jsx)("p",{className:"text-xs text-red-500 mt-1",children:a.length>0?"Immediate attention required":"All items properly stocked"})]}),(0,k.jsx)("div",{className:"p-3 bg-red-100 rounded-lg",children:(0,k.jsx)(ze,{className:"w-6 h-6 text-red-600"})})]})}),(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Inventory Value"}),(0,k.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["\u20ac",o.toFixed(2)]}),(0,k.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Current stock value"})]}),(0,k.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,k.jsx)(vt,{className:"w-6 h-6 text-green-600"})})]})}),(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Waste"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:c}),(0,k.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Items wasted today"})]}),(0,k.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg",children:(0,k.jsx)(h,{className:"w-6 h-6 text-orange-600"})})]})})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Stock Status Distribution"}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Normal Stock"})]}),(0,k.jsx)("span",{className:"font-semibold text-green-600",children:s.filter((e=>"ok"===(0,Ze.V0)(e.currentStock,e.minLevel))).length})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Low Stock"})]}),(0,k.jsx)("span",{className:"font-semibold text-yellow-600",children:i.length})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Critical Stock"})]}),(0,k.jsx)("span",{className:"font-semibold text-red-600",children:a.length})]})]})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Today's Activity Summary"}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udcdd"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Count Updates"})]}),(0,k.jsx)("span",{className:"font-semibold text-blue-600",children:l.filter((e=>"count_update"===e.type)).length})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\uddd1\ufe0f"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Waste Reports"})]}),(0,k.jsx)("span",{className:"font-semibold text-orange-600",children:l.filter((e=>"waste"===e.type)).length})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udcb0"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Waste Value"})]}),(0,k.jsxs)("span",{className:"font-semibold text-red-600",children:["\u20ac",d.toFixed(2)]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udce5"}),(0,k.jsx)("span",{className:"text-sm text-gray-600",children:"Manual Adds"})]}),(0,k.jsx)("span",{className:"font-semibold text-green-600",children:l.filter((e=>"manual_add"===e.type)).length})]})]})]})]}),a.length>0&&(0,k.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[(0,k.jsxs)("div",{className:"flex items-center mb-4",children:[(0,k.jsx)(ze,{className:"w-6 h-6 text-red-600 mr-2"}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"\ud83d\udea8 Critical Stock Alert"})]}),(0,k.jsx)("p",{className:"text-red-700 mb-4",children:"The following items are critically low and require immediate restocking:"}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map((e=>(0,k.jsxs)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-red-500",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsxs)("div",{className:"text-sm text-red-600",children:["Current: ",(0,k.jsxs)("span",{className:"font-bold",children:[e.currentStock," ",e.unit]})," | Min Required: ",(0,k.jsxs)("span",{className:"font-bold",children:[e.minLevel," ",e.unit]})]}),(0,k.jsx)("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:e.category}),(0,k.jsxs)("div",{className:"text-xs text-red-500 mt-1",children:["Shortage: ",e.minLevel-e.currentStock," ",e.unit]})]},e.id)))})]}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,k.jsxs)("div",{className:"p-6 border-b",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Recent Activity Log"}),(0,k.jsx)("p",{className:"text-gray-600 text-sm",children:"Latest inventory transactions and updates"})]}),(0,k.jsx)("div",{className:"p-6",children:0===r.length?(0,k.jsxs)("div",{className:"text-center py-8",children:[(0,k.jsx)("div",{className:"text-gray-400 text-4xl mb-2",children:"\ud83d\udccb"}),(0,k.jsx)("p",{className:"text-gray-500",children:"No activity recorded yet"}),(0,k.jsx)("p",{className:"text-sm text-gray-400",children:"Start by updating item counts or reporting waste"})]}):(0,k.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.slice(0,20).map((e=>(0,k.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("span",{className:"text-lg mr-3",children:"count_update"===e.type?"\ud83d\udcdd":"waste"===e.type?"\ud83d\uddd1\ufe0f":"import"===e.type?"\ud83d\udce5":"\u2795"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.item}),(0,k.jsxs)("div",{className:"text-sm text-gray-600",children:["count_update"===e.type&&"Updated count to ".concat(e.quantity," ").concat(e.unit),"waste"===e.type&&"Wasted ".concat(e.quantity," ").concat(e.unit," - ").concat(e.reason),"import"===e.type&&"Imported ".concat(e.quantity," ").concat(e.unit),"manual_add"===e.type&&"Added to database"]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{className:"text-sm text-gray-500",children:e.employee}),(0,k.jsx)("div",{className:"text-xs text-gray-400",children:e.timestamp})]})]},e.id)))})})]})]})},yt=o("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),bt=(e,t)=>{const n=e.filter(((e,t)=>t>0&&e.received>0)).map((e=>e.previousStock/t*100));return n.length>0?n.reduce(((e,t)=>e+t))/n.length:20},wt=(e,t)=>{const n=[],r=new Date,s="daily"===t?14:"weekly"===t?56:180,a="daily"===t?.2:"weekly"===t?.05:.015;let i=e.currentStock;for(let o=s;o>=0;o--){const t=new Date(r.getTime()-24*o*60*60*1e3),s=.7+.6*Math.random(),l=Math.max(0,e.minLevel*a*s),c=i<=.3*e.minLevel&&Math.random()<.3?e.minLevel*(1.5+Math.random()):0,d=i;i=Math.max(0,i+c-l),n.push({itemId:e.id.toString(),date:t,previousStock:d,currentStock:i,received:c,consumed:l})}return n},Nt=(e,t,n)=>[...e.map((e=>(0,r.A)((0,r.A)({},e),{},{frequency:"daily"}))),...t.map((e=>(0,r.A)((0,r.A)({},e),{},{frequency:"weekly"}))),...n.map((e=>(0,r.A)((0,r.A)({},e),{},{frequency:"monthly"})))].map((e=>((e,t)=>{const n=e.consumptionHistory||wt(e,t),s=(0,Ze.ex)(n,t),a=(0,Ze.ch)(e.currentStock,s),i=e.optimalLevel||2*e.minLevel,o=(0,Ze.cw)(e.currentStock,e.minLevel,i,s,3),l={itemId:e.id.toString(),averageDailyConsumption:s,daysRemaining:a,recommendedOrderQty:o,usualOrderThreshold:bt(n,e.minLevel)},c=(0,Ze.V0)(e.currentStock,e.minLevel);return(0,r.A)((0,r.A)({},e),{},{minimumLevel:e.minLevel,optimalLevel:i,consumptionHistory:n,forecast:l,frequency:t,status:c,daysRemaining:l.daysRemaining,recommendedOrder:l.recommendedOrderQty})})(e,e.frequency))).filter((e=>{const t=(0,Ze.V0)(e.currentStock,e.minimumLevel);return["out","critical","low"].includes(t)})).sort(((e,t)=>"out"===e.status&&"out"!==t.status?-1:"out"===t.status&&"out"!==e.status?1:(e.daysRemaining||0)-(t.daysRemaining||0))),kt={NEW_YEAR:{date:"01-01",name:"New Year",floating:!1},EPIPHANY:{date:"01-06",name:"Epiphany",floating:!1},VALENTINES:{date:"02-14",name:"Valentine's Day",floating:!1},EASTER:{date:null,name:"Easter",floating:!0},MAY_DAY:{date:"05-01",name:"Vappu",floating:!1},MIDSUMMER:{date:null,name:"Juhannus",floating:!0},INDEPENDENCE:{date:"12-06",name:"Independence Day",floating:!1},CHRISTMAS:{date:"12-24",name:"Christmas Eve",floating:!1}};var _t={version:"0.18.5"},St=1200,Tt=1252,Ct=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Et={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},jt=function(e){-1!=Ct.indexOf(e)&&(Tt=Et[0]=e)};var At=function(e){St=e,jt(e)};function It(){At(1200),jt(1252)}function Dt(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Rt,Pt=function(e){return String.fromCharCode(e)},Ot=function(e){return String.fromCharCode(e)};var Mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Lt(e){for(var t="",n=0,r=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)a=(n=e.charCodeAt(c++))>>2,i=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(s=e.charCodeAt(c++))>>6,l=63&s,isNaN(r)?o=l=64:isNaN(s)&&(l=64),t+=Mt.charAt(a)+Mt.charAt(i)+Mt.charAt(o)+Mt.charAt(l);return t}function Ft(e){var t="",n=0,r=0,s=0,a=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=Mt.indexOf(e.charAt(l++))<<2|(a=Mt.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&a)<<4|(i=Mt.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),s=(3&i)<<6|(o=Mt.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(s));return t}var Ut=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Wt=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function zt(e){return Ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Bt(e){return Ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ht=function(e){return Ut?Wt(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Vt(e){if("undefined"===typeof ArrayBuffer)return Ht(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function qt(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var Yt=Ut?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Wt(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),s=0;for(t=0,n=0;t<e.length;n+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Kt=/\u0000/g,Gt=/[\u0001-\u0006]/g;function $t(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Xt(e,t){var n=""+e;return n.length>=t?n:cr("0",t-n.length)+n}function Qt(e,t){var n=""+e;return n.length>=t?n:cr(" ",t-n.length)+n}function Jt(e,t){var n=""+e;return n.length>=t?n:n+cr(" ",t-n.length)}var Zt=Math.pow(2,32);function en(e,t){return e>Zt||e<-Zt?function(e,t){var n=""+Math.round(e);return n.length>=t?n:cr("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:cr("0",t-n.length)+n}(Math.round(e),t)}function tn(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var nn=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var sn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},an={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},on={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ln(e,t,n){for(var r=e<0?-1:1,s=e*r,a=0,i=1,o=0,l=1,c=0,d=0,u=Math.floor(s);c<t&&(o=(u=Math.floor(s))*i+a,d=u*c+l,!(s-u<5e-8));)s=1/(s-u),a=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=a):(d=c,o=i)),!n)return[0,r*o,d];var h=Math.floor(r*o/d);return[h,r*o-h*d,d]}function cn(e,t,n){if(e>2958465||e<0)return null;var r=0|e,s=Math.floor(86400*(e-r)),a=0,i=[],o={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++s&&(o.T=s=0,++r,++o.D)),60===r)i=n?[1317,10,29]:[1900,2,29],a=3;else if(0===r)i=n?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),r<60&&(a=(a+6)%7),n&&(a=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var dn=new Date(1899,11,31,0,0,0),un=dn.getTime(),hn=new Date(1900,2,1,0,0,0);function fn(e,t){var n=e.getTime();return t?n-=1262304e5:e>=hn&&(n+=864e5),(n-(un+6e4*(e.getTimezoneOffset()-dn.getTimezoneOffset())))/864e5}function mn(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pn(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=mn(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=mn(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),mn(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function gn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):pn(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Ln(14,fn(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function vn(e,t,n,r){var s,a="",i=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:s=l%100,c=2;break;default:s=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:s=n.m,c=t.length;break;case 3:return rn[n.m-1][1];case 5:return rn[n.m-1][0];default:return rn[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=n.d,c=t.length;break;case 3:return nn[n.q][0];default:return nn[n.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(o*(n.S+n.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(a=Xt(i,2+r),"ss"===t?a.substr(0,2):"."+a.substr(2,t.length-1))):Xt(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":s=24*n.D+n.H;break;case"[m]":case"[mm]":s=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":s=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:s=l,c=1}return c>0?Xt(s,c):""}function xn(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var yn=/%/g;function bn(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+bn(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),-1===(n=(t/Math.pow(10,a)).toPrecision(r+1+(s+a)%s)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+a):n+="E+"+(i-a);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,s)+"."+n.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(s+a)%s)+"."+r.substr(a)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var wn=/# (\?+)( ?)\/( ?)(\d+)/;var Nn=/^#*0*\.([0#]+)/,kn=/\).*[0#]/,_n=/\(###\) ###\\?-####/;function Sn(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Tn(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Cn(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function En(e,t,n){if(40===e.charCodeAt(0)&&!t.match(kn)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?En("n",r,n):"("+En("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return In(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(yn,""),s=t.length-r.length;return In(e,r,n*Math.pow(10,2*s))+cr("%",s)}(e,t,n);if(-1!==t.indexOf("E"))return bn(t,n);if(36===t.charCodeAt(0))return"$"+En(e,t.substr(" "==t.charAt(1)?2:1),n);var s,a,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+en(l,t.length);if(t.match(/^[#?]+$/))return"0"===(s=en(n,0))&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(wn))return function(e,t,n){var r=parseInt(e[4],10),s=Math.round(t*r),a=Math.floor(s/r),i=s-a*r,o=r;return n+(0===a?"":""+a)+" "+(0===i?cr(" ",e[1].length+1+e[4].length):Qt(i,e[1].length)+e[2]+"/"+e[3]+Xt(o,e[4].length))}(a,l,c);if(t.match(/^#+0+$/))return c+en(l,t.length-t.indexOf("0"));if(a=t.match(Nn))return s=Tn(n,a[1].length).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+cr("0",Sn(a[1]).length-t.length)})),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Tn(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+xn(en(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+En(e,t,-n):xn(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,a[1].length)))+"."+Xt(Cn(n,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return En(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=$t(En(e,t.replace(/[\\-]/g,""),n)),i=0,$t($t(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""})));if(t.match(_n))return"("+(s=En(e,"##########",n)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=ln(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=In("n",a[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],(d=Jt(o[2],i)).length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),s+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=ln(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Qt(o[1],i)+a[2]+"/"+a[3]+Jt(o[2],i):cr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=en(n,0),t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return Sn(t.substr(0,u)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Cn(n,a[1].length),n<0?"-"+En(e,t,-n):xn(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Xt(0,3-e.length):"")+e}))+"."+Xt(i,a[1].length);switch(t){case"###,##0.00":return En(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=xn(en(l,0));return"0"!==f?c+f:"";case"###,###.00":return En(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return En(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jn(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+jn(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),!(n=(t/Math.pow(10,a)).toPrecision(r+1+(s+a)%s)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+a):n+="E+"+(i-a),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(s+a)%s)+"."+r.substr(a)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function An(e,t,n){if(40===e.charCodeAt(0)&&!t.match(kn)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?An("n",r,n):"("+An("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return In(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(yn,""),s=t.length-r.length;return In(e,r,n*Math.pow(10,2*s))+cr("%",s)}(e,t,n);if(-1!==t.indexOf("E"))return jn(t,n);if(36===t.charCodeAt(0))return"$"+An(e,t.substr(" "==t.charAt(1)?2:1),n);var s,a,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Xt(l,t.length);if(t.match(/^[#?]+$/))return s=""+n,0===n&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(wn))return function(e,t,n){return n+(0===t?"":""+t)+cr(" ",e[1].length+2+e[4].length)}(a,l,c);if(t.match(/^#+0+$/))return c+Xt(l,t.length-t.indexOf("0"));if(a=t.match(Nn))return s=(s=(""+n).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+cr("0",Sn(a[1]).length-t.length)})),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+xn(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+An(e,t,-n):xn(""+n)+"."+cr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return An(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=$t(An(e,t.replace(/[\\-]/g,""),n)),i=0,$t($t(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""})));if(t.match(_n))return"("+(s=An(e,"##########",n)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=ln(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=In("n",a[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],(d=Jt(o[2],i)).length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),s+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=ln(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Qt(o[1],i)+a[2]+"/"+a[3]+Jt(o[2],i):cr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+n,t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return Sn(t.substr(0,u)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+An(e,t,-n):xn(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Xt(0,3-e.length):"")+e}))+"."+Xt(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=xn(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return An(e,t.slice(0,t.lastIndexOf(".")),n)+Sn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function In(e,t,n){return(0|n)===n?An(e,t,n):En(e,t,n)}var Dn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rn(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":tn(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Dn))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Pn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function On(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function Mn(e,t){var n=function(e){for(var t=[],n=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(s,r-s),s=r+1}if(t[t.length]=e.substr(s),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,s=n[r-1].indexOf("@");if(r<4&&s>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||s>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=s>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=s>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=s>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var a=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,a];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var i=n[0].match(Pn),o=n[1].match(Pn);return On(t,i)?[r,n[0]]:On(t,o)?[r,n[1]]:[r,n[null!=i&&null!=o?2:1]]}return[r,a]}function Ln(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:sn)[e])&&(r=n.table&&n.table[an[e]]||sn[an[e]]),null==r&&(r=on[e]||"General")}if(tn(r,0))return gn(t,n);t instanceof Date&&(t=fn(t,n.date1904));var s=Mn(r,t);if(tn(s[1]))return gn(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var s,a,i,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!tn(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==s&&null==(s=cn(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==s&&null==(s=cn(t,n)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"\u4e0a":var p={t:d,v:d};if(null==s&&(s=cn(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=s&&(p.v=s.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=s&&(p.v=s.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=s&&(p.v=s.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==s&&"T"===p.t)return"";o[o.length]=p,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Dn)){if(null==s&&null==(s=cn(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rn(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=s){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,v=0,x=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(x=Math.max(x,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M),s.M>=60&&(s.M=0,++s.H);break;case 2:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M)}var y,b="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=vn(o[c].t.charCodeAt(0),o[c].v,s,x),o[c].t="t";break;case"n":case"?":for(y=c+1;null!=o[y]&&("?"===(d=o[y].t)||"D"===d||(" "===d||"t"===d)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[c].v+=o[y].v,o[y]={v:"",t:";"},++y;b+=o[c].v,c=y-1;break;case"G":o[c].t="t",o[c].v=gn(t,n)}var w,N,k="";if(b.length>0){40==b.charCodeAt(0)?(w=t<0&&45===b.charCodeAt(0)?-t:t,N=In("n",b,w)):(N=In("n",b,w=t<0&&r>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(N=N.substr(1),o[0].v="-"+o[0].v)),y=N.length-1;var _=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){_=c;break}var S=o.length;if(_===o.length&&-1===N.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(y>=o[c].v.length-1?(y-=o[c].v.length,o[c].v=N.substr(y+1,o[c].v.length)):y<0?o[c].v="":(o[c].v=N.substr(0,y+1),y=-1),o[c].t="t",S=c);y>=0&&S<o.length&&(o[S].v=N.substr(0,y+1)+o[S].v)}else if(_!==o.length&&-1===N.indexOf("E")){for(y=N.indexOf(".")-1,c=_;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(a=o[c].v.indexOf(".")>-1&&c===_?o[c].v.indexOf(".")-1:o[c].v.length-1,k=o[c].v.substr(a+1);a>=0;--a)y>=0&&("0"===o[c].v.charAt(a)||"#"===o[c].v.charAt(a))&&(k=N.charAt(y--)+k);o[c].v=k,o[c].t="t",S=c}for(y>=0&&S<o.length&&(o[S].v=N.substr(0,y+1)+o[S].v),y=N.indexOf(".")+1,c=_;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===_)){for(a=o[c].v.indexOf(".")>-1&&c===_?o[c].v.indexOf(".")+1:0,k=o[c].v.substr(0,a);a<o[c].v.length;++a)y<N.length&&(k+=N.charAt(y++));o[c].v=k,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=In(o[c].t,o[c].v,w),o[c].t="t");var T="";for(c=0;c!==o.length;++c)null!=o[c]&&(T+=o[c].v);return T}(s[1],t,n,s[0])}function Fn(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=sn[n]){if(sn[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return sn[t]=e,t}function Un(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Fn(e[t],t)}function Wn(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',sn=e}var zn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Bn=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,s="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)s[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=s[t]=n>>>8^e[255&n];var a=[];for(r=1;16!=r;++r)a[r-1]="undefined"!==typeof Int32Array?s.subarray(256*r,256*r+256):s.slice(256*r,256*r+256);return a}(t),r=n[0],s=n[1],a=n[2],i=n[3],o=n[4],l=n[5],c=n[6],d=n[7],u=n[8],h=n[9],f=n[10],m=n[11],p=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,s=0,a=e.length;s<a;)r=r>>>8^t[255&(r^e.charCodeAt(s++))];return~r},e.buf=function(e,n){for(var x=-1^n,y=e.length-15,b=0;b<y;)x=v[e[b++]^255&x]^g[e[b++]^x>>8&255]^p[e[b++]^x>>16&255]^m[e[b++]^x>>>24]^f[e[b++]]^h[e[b++]]^u[e[b++]]^d[e[b++]]^c[e[b++]]^l[e[b++]]^o[e[b++]]^i[e[b++]]^a[e[b++]]^s[e[b++]]^r[e[b++]]^t[e[b++]];for(y+=15;b<y;)x=x>>>8^t[255&(x^e[b++])];return~x},e.str=function(e,n){for(var r=-1^n,s=0,a=e.length,i=0,o=0;s<a;)(i=e.charCodeAt(s++))<128?r=r>>>8^t[255&(r^i)]:i<2048?r=(r=r>>>8^t[255&(r^(192|i>>6&31))])>>>8^t[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(s++),r=(r=(r=(r=r>>>8^t[255&(r^(240|i>>8&7))])>>>8^t[255&(r^(128|i>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|i>>12&15))])>>>8^t[255&(r^(128|i>>6&63))])>>>8^t[255&(r^(128|63&i))];return~r},e}(),Hn=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function s(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function a(e){Fs(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),s=e.read_shift(2),a=e.l+s,i={};if(21589===r)1&(n=e.read_shift(1))&&(i.mtime=e.read_shift(4)),s>5&&(2&n&&(i.atime=e.read_shift(4)),4&n&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=a,t[r]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(Ut&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),s=0,a="";for(s=0;s<r.length;++s)if(a=r[s],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),n||(n=a.slice(0,a.lastIndexOf("/")+1)),a.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),a.slice(0,n.length)!=n););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};h(d);var u,f=0;for(s=0;s<r.length;++s){var m=r[s];m!==o&&m!==o+"--"||(f++&&ce(d,r.slice(u,s),n),u=s)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,s,a,i,o,f=512,m=[],p=e.slice(0,512);Fs(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(x,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(n=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&Fs(p=e.slice(0,f),28);var y=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,n);var b=p.read_shift(4,"i");if(3===n&&0!==b)throw new Error("# Directory Sectors: Expected 0 saw "+b);p.l+=4,a=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),r=p.read_shift(4,"i"),o=p.read_shift(4,"i"),s=p.read_shift(4,"i");for(var w=-1,k=0;k<109&&!((w=p.read_shift(4,"i"))<0);++k)m[k]=w;var _=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],s=1;s<n;++s)r[s-1]=e.slice(s*t,(s+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(o,s,_,f,m);var S=function(e,t,n,r){var s=e.length,a=[],i=[],o=[],l=[],c=r-1,d=0,u=0,h=0,f=0;for(d=0;d<s;++d)if(o=[],(h=d+t)>=s&&(h-=s),!i[h]){l=[];var m=[];for(u=h;u>=0;){m[u]=!0,i[u]=!0,o[o.length]=u,l.push(e[u]);var p=n[Math.floor(4*u/r)];if(r<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+r);if(!e[p])break;if(m[u=As(e[p],f)])break}a[h]={nodes:o,data:as([l])}}return a}(_,a,m,f);S[a].name="!Directory",r>0&&i!==v&&(S[i].name="!MiniFAT"),S[m[0]].name="!FAT",S.fat_addrs=m,S.ssz=f;var T=[],C=[],E=[];!function(e,t,n,r,s,a,i,o){for(var c,h=0,f=r.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var x=m.slice(p,p+128);Fs(x,64),g=x.read_shift(2),c=os(x,0,g-f),r.push(c);var y={name:c,type:x.read_shift(1),color:x.read_shift(1),L:x.read_shift(4,"i"),R:x.read_shift(4,"i"),C:x.read_shift(4,"i"),clsid:x.read_shift(16),state:x.read_shift(4,"i"),start:0,size:0};0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(y.ct=u(x,x.l-8)),0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(y.mt=u(x,x.l-8)),y.start=x.read_shift(4,"i"),y.size=x.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=v,y.name=""),5===y.type?(h=y.start,s>0&&h!==v&&(t[h].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=d(n,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:h!==v&&y.start!==v&&t[h]&&(y.content=l(y,t[h].data,(t[o]||{}).data))),y.content&&Fs(y.content,0),a[c]=y,i.push(y)}}(a,S,_,T,r,{},C,i),function(e,t,n){for(var r=0,s=0,a=0,i=0,o=0,l=n.length,c=[],d=[];r<l;++r)c[r]=d[r]=r,t[r]=n[r];for(;o<d.length;++o)s=e[r=d[o]].L,a=e[r].R,i=e[r].C,c[r]===r&&(-1!==s&&c[s]!==s&&(c[r]=c[s]),-1!==a&&c[a]!==a&&(c[r]=c[a])),-1!==i&&(c[i]=r),-1!==s&&r!=c[r]&&(c[s]=c[r],d.lastIndexOf(s)<o&&d.push(s)),-1!==a&&r!=c[r]&&(c[a]=c[r],d.lastIndexOf(a)<o&&d.push(a));for(r=1;r<l;++r)c[r]===r&&(-1!==a&&c[a]!==a?c[r]=c[a]:-1!==s&&c[s]!==s&&(c[r]=c[s]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(C,E,T),T.shift();var j={FileIndex:C,FullPaths:E};return t&&t.raw&&(j.raw={header:y,sectors:_}),j}function l(e,t,n){for(var r=e.start,s=e.size,a=[],i=r;n&&s>0&&i>=0;)a.push(t.slice(i*g,i*g+g)),s-=g,i=As(n,4*i);return 0===a.length?Ws(0):Yt(a).slice(0,e.size)}function c(e,t,n,r,s){var a=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=n[e],o=(r>>>2)-1;if(!i)return;for(var l=0;l<o&&(a=As(i,4*l))!==v;++l)s.push(a);c(As(i,r-4),t-1,n,r,s)}}function d(e,t,n,r,s){var a=[],i=[];s||(s=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){s[l]=!0,a[a.length]=l,i.push(e[l]);var d=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[d])break;l=As(e[d],c)}return{nodes:a,data:as([i])}}function u(e,t){return new Date(1e3*(js(e,t+4)/1e7*Math.pow(2,32)+js(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(Hn.find(e,"/"+t))return;var n=Ws(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var s=!1,a=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:a?s=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(s=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(s=!0);break;default:s=!0}}if(s||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var f=n(u[i][0]);(a=d[f])||(u.push([f,{name:r(f).replace("/",""),type:1,clsid:b,ct:l,mt:l,content:null}]),d[f]=!0)}for(u.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),s=0,a=0,i=Math.min(n.length,r.length);s<i;++s){if(a=n[s].length-r[s].length)return a;if(n[s]!=r[s])return n[s]<r[s]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=r(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||b,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&n(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&n(e.FullPaths[c])!=n(p);++c);m.R=c>=u.length?-1:c,m.type=1}else n(e.FullPaths[i+1]||"")==n(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",s=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],a=e.FullPaths[0],i=a,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(a.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,d=Ut&&Buffer.isBuffer(c)?c.toString("binary"):N(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;s.push(r),s.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+i),s.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),s.push("Content-Type: "+ie(o,i)),s.push(""),s.push(p?le(d):oe(d))}return s.push(r+"--\r\n"),s.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],a=[],i=Ws(1),o=n.compression?8:0,l=0;0;var c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var x=u,y=Ws(m.length);for(d=0;d<m.length;++d)y.write_shift(1,127&m.charCodeAt(d));y=y.slice(0,y.l),g[h]=Bn.buf(p.content,0);var b=p.content;8==o&&(b=k(b)),(i=Ws(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?s(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:b.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,y.length),i.write_shift(2,0),u+=i.length,r.push(i),u+=y.length,r.push(y),u+=b.length,r.push(b),8&l&&((i=Ws(12)).write_shift(-4,g[h]),i.write_shift(4,b.length),i.write_shift(4,p.content.length),u+=i.l,r.push(i)),(i=Ws(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,b.length),i.write_shift(4,p.content.length),i.write_shift(2,y.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,x),v+=i.l,a.push(i),v+=y.length,a.push(y),++h}return i=Ws(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,v),i.write_shift(4,u),i.write_shift(2,0),Yt([Yt(r),Yt(a),i])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var s=e.FileIndex[r];if(s.content){var a=s.content.length;a>0&&(a<4096?t+=a+63>>6:n+=a+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+i+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,i,n,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),a=Ws(r[7]<<9),i=0,o=0;for(i=0;i<8;++i)a.write_shift(1,y[i]);for(i=0;i<8;++i)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),i=0;i<3;++i)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,r[2]),a.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),a.write_shift(4,r[3]),a.write_shift(-4,r[1]?r[0]-1:v),a.write_shift(4,r[1]),i=0;i<109;++i)a.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(o=0;o<r[1];++o){for(;i<236+127*o;++i)a.write_shift(-4,i<r[2]?r[1]+i:-1);a.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)a.write_shift(-4,i+1);e&&(++i,a.write_shift(-4,v))};for(o=i=0,o+=r[1];i<o;++i)a.write_shift(-4,w.DIFSECT);for(o+=r[2];i<o;++i)a.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(r[6]+7>>3);511&a.l;)a.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&a.l;)a.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:v);var m=0===i&&n.root||u.name;if(d=2*(m.length+1),a.write_shift(64,m,"utf16le"),a.write_shift(2,d),a.write_shift(1,u.type),a.write_shift(1,u.color),a.write_shift(-4,u.L),a.write_shift(-4,u.R),a.write_shift(-4,u.C),u.clsid)a.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)a.write_shift(4,0);a.write_shift(4,u.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,u.start),a.write_shift(4,u.size),a.write_shift(4,0)}else{for(c=0;c<17;++c)a.write_shift(4,0);for(c=0;c<3;++c)a.write_shift(4,-1);for(c=0;c<12;++c)a.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(a.l=u.start+1<<9,Ut&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;511&c;++c)a.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(Ut&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;63&c;++c)a.write_shift(1,0)}if(Ut)a.l=a.length;else for(;a.l<a.length;)a.write_shift(1,0);return a}t.version="1.2.1";var p,g=64,v=-2,x="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],b="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:x,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:b,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function k(e){return p?p.deflateRawSync(e):G(e)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var E="undefined"!==typeof Uint8Array,j=E?new Uint8Array(256):[],A=0;A<256;++A)j[A]=C(A);function I(e,t){var n=j[255&e];return t<=8?n>>>8-t:(n=n<<8|j[e>>8&255],t<=16?n>>>16-t:(n=n<<8|j[e>>16&255])>>>24-t)}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function R(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function M(e,t,n){var r=7&t,s=t>>>3,a=(1<<n)-1,i=e[s]>>>r;return n<8-r?i&a:(i|=e[s+1]<<8-r,n<16-r?i&a:(i|=e[s+2]<<16-r,n<24-r?i&a:(i|=e[s+3]<<24-r)&a))}function L(e,t,n){var r=7&t,s=t>>>3;return r<=5?e[s]|=(7&n)<<r:(e[s]|=n<<r&255,e[s+1]=(7&n)>>8-r),t+3}function F(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function W(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function z(e,t){var n=e.length,r=2*n>t?2*n:t+5,s=0;if(n>=t)return e;if(Ut){var a=Bt(r);if(e.copy)e.copy(a);else for(;s<e.length;++s)a[s]=e[s];return a}if(E){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;s<n;++s)i[s]=e[s];return i}return e.length=r,e}function B(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function H(e,t,n){var r=1,s=0,a=0,i=0,o=0,l=e.length,c=E?new Uint16Array(32):B(32);for(a=0;a<32;++a)c[a]=0;for(a=l;a<n;++a)e[a]=0;l=e.length;var d=E?new Uint16Array(l):B(l);for(a=0;a<l;++a)c[s=e[a]]++,r<s&&(r=s),d[a]=0;for(c[0]=0,a=1;a<=r;++a)c[a+16]=o=o+c[a-1]<<1;for(a=0;a<l;++a)0!=(o=e[a])&&(d[a]=c[o+16]++);var u=0;for(a=0;a<l;++a)if(0!=(u=e[a]))for(o=I(d[a],r)>>r-u,i=(1<<r+4-u)-1;i>=0;--i)t[o|i<<u]=15&u|a<<4;return r}var V=E?new Uint16Array(512):B(512),q=E?new Uint16Array(32):B(32);if(!E){for(var Y=0;Y<512;++Y)V[Y]=0;for(Y=0;Y<32;++Y)q[Y]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,q,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);H(n,V,288)}();var K=function(){for(var e=E?new Uint8Array(32768):[],t=0,n=0;t<T.length-1;++t)for(;n<T[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=E?new Uint8Array(259):[];for(t=0,n=0;t<S.length-1;++t)for(;n<S[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),s=n+r==e.length;for(t.write_shift(1,+s),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var s=0,a=0,i=E?new Uint16Array(32768):[];a<t.length;){var o=Math.min(65535,t.length-a);if(o<10){for(7&(s=L(n,s,+!(a+o!=t.length)))&&(s+=8-(7&s)),n.l=s/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[a++];s=8*n.l}else{s=L(n,s,+!(a+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[a],d=-1,u=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&a)>a&&(d-=32768),d<a))for(;t[d+u]==t[a+u]&&u<250;)++u;if(u>2){(c=r[u])<=22?s=U(n,s,j[c+1]>>1)-1:(U(n,s,3),U(n,s+=5,j[c-23]>>5),s+=3);var h=c<8?0:c-4>>2;h>0&&(W(n,s,u-S[c]),s+=h),c=e[a-d],s=U(n,s,j[c]>>3),s-=3;var f=c<4?0:c-2>>1;f>0&&(W(n,s,a-d-T[c]),s+=f);for(var m=0;m<u;++m)i[l]=32767&a,l=32767&(l<<5^t[a]),++a;o-=u-1}else c<=143?c+=48:s=F(n,s,1),s=U(n,s,j[c]),i[l]=32767&a,++a}s=U(n,s,0)-1}}return n.l=(s+7)/8|0,n.l}(t,n)}}();function G(e){var t=Ws(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var $=E?new Uint16Array(32768):B(32768),X=E?new Uint16Array(32768):B(32768),Q=E?new Uint16Array(128):B(128),J=1,Z=1;function ee(e,t){var n=P(e,t)+257,r=P(e,t+=5)+1,s=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var a=0,i=E?new Uint8Array(19):B(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=E?new Uint8Array(8):B(8),d=E?new Uint8Array(8):B(8),u=i.length,h=0;h<s;++h)i[_[h]]=a=R(e,t),l<a&&(l=a),c[a]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=i[h])&&(o[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=i[h])){f=j[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)Q[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(f=Q[O(e,t)]),f>>>=3){case 16:for(a=3+D(e,t),t+=2,f=g[g.length-1];a-- >0;)g.push(f);break;case 17:for(a=3+R(e,t),t+=3;a-- >0;)g.push(0);break;case 18:for(a=11+O(e,t),t+=7;a-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,n),x=g.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)x[h]=0;return J=H(v,$,286),Z=H(x,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[zt(t),2];for(var n=0,r=0,s=Bt(t||1<<18),a=0,i=s.length>>>0,o=0,l=0;0==(1&r);)if(r=R(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=J,l=Z);;){!t&&i<a+32767&&(i=(s=z(s,a+32767)).length);var c=M(e,n,o),d=r>>>1==1?V[c]:$[c];if(n+=15&d,0===((d>>>=4)>>>8&255))s[a++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=a+S[d];u>0&&(h+=M(e,n,u),n+=u),c=M(e,n,l),n+=15&(d=r>>>1==1?q[c]:X[c]);var f=(d>>>=4)<4?0:d-2>>1,m=T[d];for(f>0&&(m+=M(e,n,f),n+=f),!t&&i<h&&(i=(s=z(s,h+100)).length);a<h;)s[a]=s[a-m],++a}}else{7&n&&(n+=8-(7&n));var p=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,p>0)for(!t&&i<a+p&&(i=(s=z(s,a+p)).length);p-- >0;)s[a++]=e[n>>>3],n+=8}return t?[s,n+7>>>3]:[s.slice(0,a),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;Fs(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var s=n.length-4;(80!=n[s]||75!=n[s+1]||5!=n[s+2]||6!=n[s+3])&&s>=0;)--s;n.l=s+4,n.l+=4;var i=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,s=0;s<i;++s){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),d=n.read_shift(2),u=n.read_shift(2),f=n.read_shift(2);n.l+=8;var m=n.read_shift(4),p=a(n.slice(n.l+d,n.l+d+u));n.l+=d+u+f;var g=n.l;n.l=m+4,se(n,l,c,r,p),n.l=g}return r}function se(e,t,n,r,s){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,s=31&n,a=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(a-1),r.setDate(s);var i=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=a(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((s||{})[21589]||{}).mt&&(l=s[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!p)return te(e,t);var n=new(0,p.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var x=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),x=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&ne(x,"Bad compressed size: "+t+" != "+c),d!=n&&ne(x,"Bad uncompressed size: "+n+" != "+d),de(r,f,v,{unsafe:!0,mt:l})}var ae={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ae[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ae[r[1]]?ae[r[1]]:"application/octet-stream"}function oe(e){for(var t=Lt(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),s=0;s<r.length;++s){var a=r[s];if(0!=a.length)for(var i=0;i<a.length;){var o=76,l=a.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=a.slice(i,i+o),(i+=o)<a.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,s="",a="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":s=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":a=c[2].trim()}}switch(++o,a.toLowerCase()){case"base64":r=Ht(Ft(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var s=0;s<t.length;++s)t[s]=t[s].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Ht(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+a)}var d=de(e,s.slice(n.length),r,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,n,s){var a=s&&s.unsafe;a||h(e);var i=!a&&Hn.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:r(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),a||Hn.utils.cfb_gc(e)}return i.content=n,i.size=n?n.length:0,s&&(s.CLSID&&(i.clsid=s.CLSID),s.mt&&(i.mt=s.mt),s.ct&&(i.ct=s.ct)),i}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),s=!1;47===t.charCodeAt(0)?(s=!0,t=n[0].slice(0,-1)+t):s=-1!==t.indexOf("/");var a=t.toUpperCase(),i=!0===s?n.indexOf(a):r.indexOf(a);if(-1!==i)return e.FileIndex[i];var o=!a.match(Gt);for(a=a.replace(Kt,""),o&&(a=a.replace(Gt,"!")),i=0;i<n.length;++i){if((o?n[i].replace(Gt,"!"):n[i]).replace(Kt,"")==a)return e.FileIndex[i];if((o?r[i].replace(Gt,"!"):r[i]).replace(Kt,"")==a)return e.FileIndex[i]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||Ut&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return i(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(Ht(Ft(t)),n);case"binary":return o(Ht(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=m(t,n);switch(n&&n.type||"buffer"){case"file":return i(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:N(r);case"base64":return Lt("string"==typeof r?r:N(r));case"buffer":if(Ut)return Buffer.isBuffer(r)?r:Wt(r);case"array":return"string"==typeof r?Ht(r):r}return r},t.writeFile=function(t,n,r){i();var s=m(t,r);e.writeFileSync(n,s)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var n=Hn.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var s=Hn.find(e,t);if(s)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==s)return e.FileIndex[a].name=r(n),e.FullPaths[a]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ds,CheckField:Ls,prep_blob:Fs,bconcat:Yt,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:G,_inflateRaw:te,consts:w},t}();let Vn;function qn(e){return"string"===typeof e?Vt(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Yn(e,t,n){if("undefined"!==typeof Vn&&Vn.writeFileSync)return n?Vn.writeFileSync(e,t,n):Vn.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Vt(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?Ar(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var s=new Blob([qn(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if("undefined"!==typeof saveAs)return saveAs(s,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),a}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=qt(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Kn(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Gn(e,t){for(var n=[],r=Kn(e),s=0;s!==r.length;++s)null==n[e[r[s]][t]]&&(n[e[r[s]][t]]=r[s]);return n}function $n(e){for(var t=[],n=Kn(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Xn(e){for(var t=[],n=Kn(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var Qn=new Date(1899,11,30,0,0,0);function Jn(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Qn.getTime()+6e4*(e.getTimezoneOffset()-Qn.getTimezoneOffset())))/864e5}var Zn=new Date,er=Qn.getTime()+6e4*(Zn.getTimezoneOffset()-Qn.getTimezoneOffset()),tr=Zn.getTimezoneOffset();function nr(e){var t=new Date;return t.setTime(24*e*60*60*1e3+er),t.getTimezoneOffset()!==tr&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-tr)),t}var rr=new Date("2017-02-19T19:06:09.000Z"),sr=isNaN(rr.getFullYear())?new Date("2/19/17"):rr,ar=2017==sr.getFullYear();function ir(e,t){var n=new Date(e);if(ar)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==sr.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function or(e,t){if(Ut&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Ar(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Ar(Dt(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Ar(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Ar(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(a){}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function lr(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=lr(e[n]));return t}function cr(e,t){for(var n="";n.length<t;)n+=e;return n}function dr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var ur=["january","february","march","april","may","june","july","august","september","october","november","december"];function hr(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return n;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ur.indexOf(i))return n}else if(i.match(/[a-z]/))return n;return r<0||r>8099?n:(s>0||a>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function fr(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=Ut?Wt(n):function(e){for(var t=[],n=0,r=e.length+250,s=zt(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[n++]=i;else if(i<2048)s[n++]=192|i>>6&31,s[n++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++a);s[n++]=240|i>>8&7,s[n++]=128|i>>2&63,s[n++]=128|o>>6&15|(3&i)<<4,s[n++]=128|63&o}else s[n++]=224|i>>12&15,s[n++]=128|i>>6&63,s[n++]=128|63&i;n>r&&(t.push(s.slice(0,n)),n=0,s=zt(65535),r=65530)}return t.push(s.slice(0,n)),Yt(t)}(n),Hn.utils.cfb_add(e,t,r);Hn.utils.cfb_add(e,t,n)}else e.file(t,n)}function mr(){return Hn.utils.cfb_new()}var pr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var gr={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vr=$n(gr),xr=/[&<>'"]/g,yr=/[\u0000-\u0008\u000b-\u001f]/g;function br(e){return(e+"").replace(xr,(function(e){return vr[e]})).replace(yr,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function wr(e){return br(e).replace(/ /g,"_x0020_")}var Nr=/[\u0000-\u001f]/g;function kr(e){return(e+"").replace(xr,(function(e){return vr[e]})).replace(/\n/g,"<br/>").replace(Nr,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function _r(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sr(e){for(var t="",n=0,r=0,s=0,a=0,i=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(s=e.charCodeAt(n++),r>191&&r<224?(i=(31&r)<<6,i|=63&s,t+=String.fromCharCode(i)):(a=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a):(o=((7&r)<<18|(63&s)<<12|(63&a)<<6|63&(i=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Tr(e){var t,n,r,s=zt(2*e.length),a=1,i=0,o=0;for(n=0;n<e.length;n+=a)a=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),a=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),a=3):(a=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(s[i++]=255&o,s[i++]=o>>>8,o=0),s[i++]=t%256,s[i++]=t>>>8;return s.slice(0,i).toString("ucs2")}function Cr(e){return Wt(e,"binary").toString("utf8")}var Er="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",jr=Ut&&(Cr(Er)==Sr(Er)&&Cr||Tr(Er)==Sr(Er)&&Tr)||Sr,Ar=Ut?function(e){return Wt(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,s=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,s=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(63&s)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Ir=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var Dr=/(^\s|\s$|\n)/;function Rr(e,t){return"<"+e+(t.match(Dr)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Pr(e){return Kn(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Or(e,t,n){return"<"+e+(null!=n?Pr(n):"")+(null!=t?(t.match(Dr)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mr(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}var Lr="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Fr="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Ur="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Wr="http://schemas.openxmlformats.org/package/2006/content-types",zr="http://schemas.openxmlformats.org/package/2006/relationships",Br="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Hr="http://purl.org/dc/elements/1.1/",Vr="http://purl.org/dc/terms/",qr="http://purl.org/dc/dcmitype/",Yr="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Kr="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Gr="http://www.w3.org/2001/XMLSchema-instance",$r="http://www.w3.org/2001/XMLSchema",Xr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qr="urn:schemas-microsoft-com:office:office",Jr="urn:schemas-microsoft-com:office:excel",Zr="urn:schemas-microsoft-com:office:spreadsheet",es="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",ts="http://macVmlSchemaUri",ns="urn:schemas-microsoft-com:vml",rs="http://www.w3.org/TR/REC-html40";var ss=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,s=e[0][n].length;r<s;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},as=Ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Wt(e)}))):ss(e)}:ss,is=function(e,t,n){for(var r=[],s=t;s<n;s+=2)r.push(String.fromCharCode(Cs(e,s)));return r.join("").replace(Kt,"")},os=Ut?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Kt,""):is(e,t,n)}:is,ls=function(e,t,n){for(var r=[],s=t;s<t+n;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},cs=Ut?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):ls(e,t,n)}:ls,ds=function(e,t,n){for(var r=[],s=t;s<n;s++)r.push(String.fromCharCode(Ts(e,s)));return r.join("")},us=Ut?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):ds(e,t,n)}:ds,hs=function(e,t){var n=js(e,t);return n>0?us(e,t+4,t+4+n-1):""},fs=hs,ms=function(e,t){var n=js(e,t);return n>0?us(e,t+4,t+4+n-1):""},ps=ms,gs=function(e,t){var n=2*js(e,t);return n>0?us(e,t+4,t+4+n-1):""},vs=gs,xs=function(e,t){var n=js(e,t);return n>0?os(e,t+4,t+4+n):""},ys=xs,bs=function(e,t){var n=js(e,t);return n>0?us(e,t+4,t+4+n):""},ws=bs,Ns=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),s=15&e[t+6],a=5;a>=0;--a)s=256*s+e[t+a];return 2047==r?0==s?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,s+=Math.pow(2,52)),n*Math.pow(2,r-52)*s)}(e,t)},ks=Ns,_s=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Ss(){os=function(e,t,n){return Rt.utils.decode(1200,e.slice(t,n)).replace(Kt,"")},us=function(e,t,n){return Rt.utils.decode(65001,e.slice(t,n))},fs=function(e,t){var n=js(e,t);return n>0?Rt.utils.decode(Tt,e.slice(t+4,t+4+n-1)):""},ps=function(e,t){var n=js(e,t);return n>0?Rt.utils.decode(St,e.slice(t+4,t+4+n-1)):""},vs=function(e,t){var n=2*js(e,t);return n>0?Rt.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},ys=function(e,t){var n=js(e,t);return n>0?Rt.utils.decode(1200,e.slice(t+4,t+4+n)):""},ws=function(e,t){var n=js(e,t);return n>0?Rt.utils.decode(65001,e.slice(t+4,t+4+n)):""}}Ut&&(fs=function(e,t){if(!Buffer.isBuffer(e))return hs(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},ps=function(e,t){if(!Buffer.isBuffer(e))return ms(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},vs=function(e,t){if(!Buffer.isBuffer(e))return gs(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},ys=function(e,t){if(!Buffer.isBuffer(e))return xs(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},ws=function(e,t){if(!Buffer.isBuffer(e))return bs(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},ks=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ns(e,t)},_s=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Rt&&Ss();var Ts=function(e,t){return e[t]},Cs=function(e,t){return 256*e[t+1]+e[t]},Es=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},js=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},As=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Is=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ds(e,t){var n,r,s,a,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Ut&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Cs(this,o)),o+=2;e*=2;break;case"utf8":l=us(this,this.l,this.l+e);break;case"utf16le":e*=2,l=os(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Rt)return Ds.call(this,e,"dbcs");l=Rt.utils.decode(St,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=fs(this,this.l),e=4+js(this,this.l);break;case"lpstr-cp":l=ps(this,this.l),e=4+js(this,this.l);break;case"lpwstr":l=vs(this,this.l),e=4+2*js(this,this.l);break;case"lpp4":e=4+js(this,this.l),l=ys(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+js(this,this.l),l=ws(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(s=Ts(this,this.l+e++));)c.push(Pt(s));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(s=Cs(this,this.l+e));)c.push(Pt(s)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=Ts(this,o),this.l=o+1,a=Ds.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(Pt(Cs(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Rt){l=Rt.utils.decode(St,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=Ts(this,o),this.l=o+1,a=Ds.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(Pt(Ts(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=Ts(this,this.l),this.l++,n;case 2:return n=("i"===t?Es:Cs)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?As:Is)(this,this.l),this.l+=4,n):(r=js(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?ks(this,this.l):ks([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=cs(this,this.l,e)}}return this.l+=e,l}var Rs=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},Ps=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},Os=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function Ms(e,t,n){var r=0,s=0;if("dbcs"===n){for(s=0;s!=t.length;++s)Os(this,t.charCodeAt(s),this.l+2*s);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof Rt&&874==Tt)for(s=0;s!=t.length;++s){var a=Rt.utils.encode(Tt,t.charAt(s));this[this.l+s]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=255&t.charCodeAt(s);r=t.length}else{if("hex"===n){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}if("utf16le"===n){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Rs(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=r?-t:t;isFinite(i)?0==i?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[n+o]=255&a;e[n+6]=(15&s)<<4|15&a,e[n+7]=s>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Ps(this,t,this.l)}}return this.l+=r,this}function Ls(e,t){var n=cs(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Fs(e,t){e.l=t,e.read_shift=Ds,e.chk=Ls,e.write_shift=Ms}function Us(e,t){e.l+=t}function Ws(e){var t=zt(e);return Fs(t,0),t}function zs(){var e=[],t=Ut?256:2048,n=function(e){var t=Ws(e);return Fs(t,0),t},r=n(t),s=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},a=function(e){return r&&e<r.length-r.l?r:(s(),r=n(Math.max(e+1,t)))};return{next:a,push:function(e){s(),null==(r=e).l&&(r.l=r.length),a(t)},end:function(){return s(),Yt(e)},_bufs:e}}function Bs(e,t,n,r){var s,a=+t;if(!isNaN(a)){r||(r=ec[a].p||(n||[]).length||0),s=1+(a>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,128+(127&a)),i.write_shift(1,a>>7));for(var o=0;4!=o;++o){if(!(r>=128)){i.write_shift(1,r);break}i.write_shift(1,128+(127&r)),r>>=7}r>0&&_s(n)&&e.push(n)}}function Hs(e,t,n){var r=lr(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Vs(e,t,n){var r=lr(e);return r.s=Hs(r.s,t.s,n),r.e=Hs(r.e,t.s,n),r}function qs(e,t){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Js(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function Ys(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?qs(e.s,t.biff)+":"+qs(e.e,t.biff):(e.s.rRel?"":"$")+Gs(e.s.r)+":"+(e.e.rRel?"":"$")+Gs(e.e.r):(e.s.cRel?"":"$")+Xs(e.s.c)+":"+(e.e.cRel?"":"$")+Xs(e.e.c)}function Ks(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Gs(e){return""+(e+1)}function $s(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Xs(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Qs(e){for(var t=0,n=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(n=26*n+(s-64))}return{c:n-1,r:t-1}}function Js(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Zs(e){var t=e.indexOf(":");return-1==t?{s:Qs(e),e:Qs(e)}:{s:Qs(e.slice(0,t)),e:Qs(e.slice(t+1))}}function ea(e,t){return"undefined"===typeof t||"number"===typeof t?ea(e.s,e.e):("string"!==typeof e&&(e=Js(e)),"string"!==typeof t&&(t=Js(t)),e==t?e:e+":"+t)}function ta(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,s=0,a=e.length;for(n=0;r<a&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)n=26*n+s;for(t.s.c=--n,n=0;r<a&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)n=10*n+s;if(t.s.r=--n,r===a||10!=s)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=a&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)n=26*n+s;for(t.e.c=--n,n=0;r!=a&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)n=10*n+s;return t.e.r=--n,t}function na(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Ln(e.z,n?Jn(t):t)}catch(r){}try{return e.w=Ln((e.XF||{}).numFmtId||(n?14:0),n?Jn(t):t)}catch(r){return""+t}}function ra(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?Fa[e.v]||e.v:na(e,void 0==t?e.v:t))}function sa(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function aa(e,t,n){var r=n||{},s=e?Array.isArray(e):r.dense;var a=e||(s?[]:{}),i=0,o=0;if(a&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var l="string"==typeof r.origin?Qs(r.origin):r.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ta(a["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if("undefined"!==typeof t[u][h]){var f={v:t[u][h]},m=i+u,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!==typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||sn[14],r.cellDates?(f.t="d",f.w=Ln(f.z,Jn(f.v))):(f.t="n",f.v=Jn(f.v),f.w=Ln(f.z,f.v))):f.t="s";else f=t[u][h];if(s)a[m]||(a[m]=[]),a[m][p]&&a[m][p].z&&(f.z=a[m][p].z),a[m][p]=f;else{var g=Js({c:p,r:m});a[g]&&a[g].z&&(f.z=a[g].z),a[g]=f}}}return c.s.c<1e7&&(a["!ref"]=ea(c)),a}function ia(e,t){return aa(null,e,t)}function oa(e,t){return t||(t=Ws(4)),t.write_shift(4,e),t}function la(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function ca(e,t){var n=!1;return null==t&&(n=!0,t=Ws(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function da(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ua(e,t){var n=e.l,r=e.read_shift(1),s=la(e),a=[],i={t:s,h:s};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(da(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=n+t,i}var ha=ua;function fa(e,t){var n=!1;return null==t&&(n=!0,t=Ws(23+4*e.t.length)),t.write_shift(1,1),ca(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Ws(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function ma(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function pa(e,t){return null==t&&(t=Ws(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ga(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function va(e,t){return null==t&&(t=Ws(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var xa=la,ya=ca;function ba(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function wa(e,t){var n=!1;return null==t&&(n=!0,t=Ws(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var Na=la,ka=ba,_a=wa;function Sa(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var s=0===r?ks([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):As(t,0)>>2;return n?s/100:s}function Ta(e,t){null==t&&(t=Ws(4));var n=0,r=0,s=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:s==(0|s)&&s>=-(1<<29)&&s<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?s:e)<<2)+(n+2))}function Ca(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ea=Ca,ja=function(e,t){return t||(t=Ws(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Aa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ia(e,t){return(t||Ws(8)).write_shift(8,e,"f")}function Da(e,t){if(t||(t=Ws(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var Ra=80,Pa={1:{n:"CodePage",t:2},2:{n:"Category",t:Ra},3:{n:"PresentationFormat",t:Ra},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Ra},15:{n:"Company",t:Ra},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Ra},27:{n:"ContentStatus",t:Ra},28:{n:"Language",t:Ra},29:{n:"Version",t:Ra},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Oa={1:{n:"CodePage",t:2},2:{n:"Title",t:Ra},3:{n:"Subject",t:Ra},4:{n:"Author",t:Ra},5:{n:"Keywords",t:Ra},6:{n:"Comments",t:Ra},7:{n:"Template",t:Ra},8:{n:"LastAuthor",t:Ra},9:{n:"RevNumber",t:Ra},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Ra},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Ma(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var La=lr(Ma([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Fa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ua={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function za(e,t){var n,r=function(e){for(var t=[],n=Kn(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(Ua),s=[];s[s.length]=pr,s[s.length]=Or("Types",null,{xmlns:Wr,"xmlns:xsd":$r,"xmlns:xsi":Gr}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return Or("Default",null,{Extension:e[0],ContentType:e[1]})})));var a=function(r){e[r]&&e[r].length>0&&(n=e[r][0],s[s.length]=Or("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:Wa[r][t.bookType]||Wa[r].xlsx}))},i=function(n){(e[n]||[]).forEach((function(e){s[s.length]=Or("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Wa[n][t.bookType]||Wa[n].xlsx})}))},o=function(t){(e[t]||[]).forEach((function(e){s[s.length]=Or("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})}))};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ba={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ha(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Va(e){var t=[pr,Or("Relationships",null,{xmlns:zr})];return Kn(e["!id"]).forEach((function(n){t[t.length]=Or("Relationship",null,e["!id"][n])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function qa(e,t,n,r,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=r,s.Target=n,a?s.TargetMode=a:[Ba.HLINK,Ba.XPATH,Ba.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function Ya(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Ka(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_t.version+"</meta:generator></office:meta></office:document-meta>"}var Ga=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function $a(e,t,n,r,s){null==s[e]&&null!=t&&""!==t&&(s[e]=t,t=br(t),r[r.length]=n?Or(e,t,n):Rr(e,t))}function Xa(e,t){var n=t||{},r=[pr,Or("cp:coreProperties",null,{"xmlns:cp":Lr,"xmlns:dc":Hr,"xmlns:dcterms":Vr,"xmlns:dcmitype":qr,"xmlns:xsi":Gr})],s={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&$a("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Mr(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),null!=e.ModifiedDate&&$a("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Mr(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var a=0;a!=Ga.length;++a){var i=Ga[a],o=n.Props&&null!=n.Props[i[1]]?n.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&$a(i[0],o,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Qa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ja=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Za(e){var t=[],n=Or;return e||(e={}),e.Application="SheetJS",t[t.length]=pr,t[t.length]=Or("Properties",null,{xmlns:Ur,"xmlns:vt":Kr}),Qa.forEach((function(r){if(void 0!==e[r[1]]){var s;switch(r[2]){case"string":s=br(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false"}void 0!==s&&(t[t.length]=n(r[0],s))}})),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+br(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function ei(e){var t=[pr,Or("Properties",null,{xmlns:Fr,"xmlns:vt":Kr})];if(!e)return t.join("");var n=1;return Kn(e).forEach((function(r){++n,t[t.length]=Or("property",function(e,t){switch(typeof e){case"string":var n=Or("vt:lpwstr",br(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Or((0|e)==e?"vt:i4":"vt:r8",br(String(e)));case"boolean":return Or("vt:bool",e?"true":"false")}if(e instanceof Date)return Or("vt:filetime",Mr(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:br(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ti={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ni(e,t){var n=Ws(4),r=Ws(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=Ws(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var s=(n*=1e7)/Math.pow(2,32)|0;s>0&&(n%=Math.pow(2,32),r+=s);var a=Ws(8);return a.write_shift(4,n),a.write_shift(4,r),a}(t);break;case 31:case 80:for((r=Ws(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yt([n,r])}var ri=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function si(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ai(e,t,n){var r=Ws(8),s=[],a=[],i=8,o=0,l=Ws(8),c=Ws(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),s.push(c),i+=8+l.length,!t){(c=Ws(8)).write_shift(4,0),s.unshift(c);var d=[Ws(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=Ws(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Yt(d),a.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(ri.indexOf(e[o][0])>-1||Ja.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var m=n[f=+t[e[o][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=ni(m.t,h)}else{var g=si(h);-1==g&&(g=31,h=String(h)),l=ni(g,h)}a.push(l),(c=Ws(8)).write_shift(4,t?f:2+o),s.push(c),i+=8+l.length}var v=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,v),v+=a[o].length;return r.write_shift(4,i),r.write_shift(4,a.length),Yt([r].concat(s).concat(a))}function ii(e,t,n,r,s,a){var i=Ws(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Hn.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=ai(e,n,r);if(o.push(l),s){var c=ai(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Yt(o)}function oi(e,t){return 1===e.read_shift(t)}function li(e,t){return t||(t=Ws(2)),t.write_shift(2,+!!e),t}function ci(e){return e.read_shift(2,"u")}function di(e,t){return t||(t=Ws(2)),t.write_shift(2,e),t}function ui(e,t,n){return n||(n=Ws(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function hi(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),s="sbcs-cont",a=St;(n&&n.biff>=8&&(St=1200),n&&8!=n.biff)?12==n.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont");n.biff>=2&&n.biff<=5&&(s="cpstr");var i=r?e.read_shift(r,s):"";return St=a,i}function fi(e){var t=e.t||"",n=Ws(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=Ws(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),Yt([n,r])}function mi(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function pi(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):mi(e,r,n)}function gi(e,t,n){if(n.biff>5)return pi(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vi(e,t,n){return n||(n=Ws(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function xi(e,t){t||(t=Ws(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function yi(e){var t=Ws(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var s=r.indexOf("#"),a=s>-1?31:23;switch(r.charAt(0)){case"#":a=28;break;case".":a&=-3}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(n=0;n<i.length;++n)t.write_shift(4,i[n]);if(28==a)xi(r=r.slice(1),t);else if(2&a){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<i.length;++n)t.write_shift(1,parseInt(i[n],16));var o=s>-1?r.slice(0,s):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&a&&xi(s>-1?r.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<i.length;++n)t.write_shift(1,parseInt(i[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function bi(e,t,n,r){return r||(r=Ws(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function wi(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Ni(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function ki(e,t){return t||(t=Ws(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function _i(e,t,n){var r=1536,s=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;default:throw new Error("unsupported BIFF version")}var a=Ws(s);return a.write_shift(2,r),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Si(e,t){var n=!t||t.biff>=8?2:1,r=Ws(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function Ti(e,t,n,r){var s=n&&5==n.biff;r||(r=Ws(s?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(s?1:2,t.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return null==a.l&&(a.l=a.length),a}function Ci(e,t,n,r){var s=n&&5==n.biff;r||(r=Ws(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),r.write_shift(4,a),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function Ei(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=hi(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],s=e.l+t,a=e.read_shift(n.biff>8?4:2);0!==a--;)r.push(wi(e,n.biff,n));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function ji(e){var t=Ws(24),n=Qs(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(r[s],16));return Yt([t,yi(e[1])])}function Ai(e){var t=e[1].Tooltip,n=Ws(10+2*(t.length+1));n.write_shift(2,2048);var r=Qs(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var s=0;s<t.length;++s)n.write_shift(2,t.charCodeAt(s));return n.write_shift(2,0),n}function Ii(e,t,n){if(!n.cellStyles)return Us(e,t);var r=n&&n.biff>=12?4:2,s=e.read_shift(r),a=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:s,e:a,w:i,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var Di=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=$n({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var s=ia(function(t,n){var r=[],s=zt(1);switch(n.type){case"base64":s=Ht(Ft(t));break;case"binary":s=Ht(t);break;case"buffer":case"array":s=t}Fs(s,0);var a=s.read_shift(1),i=!!(136&a),o=!1,l=!1;switch(a){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var c=0,d=521;2==a&&(c=s.read_shift(2)),s.l+=3,2!=a&&(c=s.read_shift(4)),c>1048576&&(c=1e6),2!=a&&(d=s.read_shift(2));var u=s.read_shift(2),h=n.codepage||1252;2!=a&&(s.l+=16,s.read_shift(1),0!==s[s.l]&&(h=e[s[s.l]]),s.l+=1,s.l+=2),l&&(s.l+=36);for(var f=[],m={},p=Math.min(s.length,2==a?521:d-10-(o?264:0)),g=l?32:11;s.l<p&&13!=s[s.l];)switch((m={}).name=Rt.utils.decode(h,s.slice(s.l,s.l+g)).replace(/[\u0000\r\n].*$/g,""),s.l+=g,m.type=String.fromCharCode(s.read_shift(1)),2==a||l||(m.offset=s.read_shift(4)),m.len=s.read_shift(1),2==a&&(m.offset=s.read_shift(2)),m.dec=s.read_shift(1),m.name.length&&f.push(m),2!=a&&(s.l+=l?13:14),m.type){case"B":o&&8==m.len||!n.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==s[s.l]&&(s.l=d-1),13!==s.read_shift(1))throw new Error("DBF Terminator not found "+s.l+" "+s[s.l]);s.l=d;var v=0,x=0;for(r[0]=[],x=0;x!=f.length;++x)r[0][x]=f[x].name;for(;c-- >0;)if(42!==s[s.l])for(++s.l,r[++v]=[],x=0,x=0;x!=f.length;++x){var y=s.slice(s.l,s.l+f[x].len);s.l+=f[x].len,Fs(y,0);var b=Rt.utils.decode(h,y);switch(f[x].type){case"C":b.trim().length&&(r[v][x]=b.replace(/\s+$/,""));break;case"D":8===b.length?r[v][x]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):r[v][x]=b;break;case"F":r[v][x]=parseFloat(b.trim());break;case"+":case"I":r[v][x]=l?2147483648^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":r[v][x]=!0;break;case"N":case"F":r[v][x]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));r[v][x]="##MEMO##"+(l?parseInt(b.trim(),10):y.read_shift(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(r[v][x]=+b||0);break;case"@":r[v][x]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":r[v][x]=new Date(864e5*(y.read_shift(4)-2440588)+y.read_shift(4));break;case"Y":r[v][x]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][x]=-y.read_shift(-8,"f");break;case"B":if(o&&8==f[x].len){r[v][x]=y.read_shift(8,"f");break}case"G":case"P":y.l+=f[x].len;break;case"0":if("_NullFlags"===f[x].name)break;default:throw new Error("DBF Unsupported data type "+f[x].type)}}else s.l+=u;if(2!=a&&s.l<s.length&&26!=s[s.l++])throw new Error("DBF EOF Marker missing "+(s.l-1)+" of "+s.length+" "+s[s.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return s["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,s}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return sa(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var s=n||{};if(+s.codepage>=0&&At(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var a=zs(),i=Qc(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++h;else if(null!=o[d]){if(++h,"number"===typeof o[d]&&(o[d]=o[d].toString(10)),"string"!==typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}var m=ta(e["!ref"]),p=[],g=[],v=[];for(d=0;d<=m.e.c-m.s.c;++d){var x="",y="",b=0,w=[];for(u=0;u<l.length;++u)null!=l[u][d]&&w.push(l[u][d]);if(0!=w.length&&null!=o[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=w[u]instanceof Date?"D":"C"}b=Math.max(b,String(w[u]).length),x=x&&x!=y?"C":y}b>250&&(b=250),"C"==(y=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>b&&(b=c[d].DBF.len),"B"==x&&"N"==y&&(x="N",v[d]=c[d].DBF.dec,b=c[d].DBF.len),g[d]="C"==x||"N"==y?b:r[x]||0,f+=g[d],p[d]=x}else p[d]="?"}var N=a.next(32);for(N.write_shift(4,318902576),N.write_shift(4,l.length),N.write_shift(2,296+32*h),N.write_shift(2,f),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+t[Tt]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var k=a.next(32),_=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,_,"sbcs"),k.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),k.write_shift(4,u),k.write_shift(1,g[d]||r[p[d]]||0),k.write_shift(1,v[d]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),u+=g[d]||r[p[d]]||0}var S=a.next(264);for(S.write_shift(4,13),d=0;d<65;++d)S.write_shift(4,0);for(d=0;d<l.length;++d){var T=a.next(f);for(T.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(p[u]){case"L":T.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":T.write_shift(8,l[d][u]||0,"f");break;case"N":var C="0";for("number"==typeof l[d][u]&&(C=l[d][u].toFixed(v[u]||0)),h=0;h<g[u]-C.length;++h)T.write_shift(1,32);T.write_shift(1,C,"sbcs");break;case"D":l[d][u]?(T.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var E=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(T.write_shift(1,E,"sbcs"),h=0;h<g[u]-E.length;++h)T.write_shift(1,32)}}return a.next(1).write_shift(1,26),a.end()}}}(),Ri=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Kn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?Ot(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:Ot(r)};function s(e,s){var a,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],g=[],v=[],x=0;for(+s.codepage>=0&&At(+s.codepage);c!==i.length;++c){x=0;var y,b=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),w=b.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),N=w[0];if(b.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(b.slice(3).replace(/;;/g,";"));break;case"C":var k=!1,_=!1,S=!1,T=!1,C=-1,E=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,_=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,_||(l=0),a=u.length;a<=o;++a)u[a]=[];break;case"K":'"'===(y=w[d].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(dr(y))?isNaN(hr(y).getDate())||(y=ir(y)):(y=dr(y),null!==f&&Rn(f)&&(y=nr(y))),"undefined"!==typeof Rt&&"string"==typeof y&&"string"!=(s||{}).type&&(s||{}).codepage&&(y=Rt.utils.decode(s.codepage,y)),k=!0;break;case"E":T=!0;var j=So(w[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],j];break;case"S":S=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":C=parseInt(w[d].slice(1))-1;break;case"C":E=parseInt(w[d].slice(1))-1;break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+b)}if(k&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=y:u[o][l]=y,f=null),S){if(T)throw new Error("SYLK shared formula cannot have own formula");var A=C>-1&&u[C][E];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Eo(A[1],{r:o-C,c:l-E})}break;case"F":var I=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++I;break;case"Y":for(o=parseInt(w[d].slice(1))-1,a=u.length;a<=o;++a)u[a]=[];break;case"M":x=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(v=w[d].slice(1).split(" "),a=parseInt(v[0],10);a<=parseInt(v[1],10);++a)x=parseInt(v[2],10),g[a-1]=0===x?{hidden:!0}:{wch:x},Xi(g[a-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(w[d].slice(1))-1]||(p[o]={}),x>0?(p[o].hpt=x,p[o].hpx=Zi(x)):0===x&&(p[o].hidden=!0);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+b)}I<1&&(f=null);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+b)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),[u,m]}function a(e,t){var n=function(e,t){switch(t.type){case"base64":return s(Ft(e),t);case"binary":return s(e,t);case"buffer":return s(Ut&&Buffer.isBuffer(e)?e.toString("binary"):qt(e),t);case"array":return s(or(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],a=n[1],i=ia(r,t);return Kn(a).forEach((function(e){i[e]=a[e]})),i}function i(e,t,n,r){var s="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":s+=e.v||0,e.f&&!e.F&&(s+=";E"+Co(e.f,{r:n,c:r}));break;case"b":s+=e.v?"TRUE":"FALSE";break;case"e":s+=e.w||e.v;break;case"d":s+='"'+(e.w||e.v)+'"';break;case"s":s+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return s}return e["|"]=254,{to_workbook:function(e,t){return sa(a(e,t),t)},to_sheet:a,from_sheet:function(e,t){var n,r,s=["ID;PWXL;N;E"],a=[],o=ta(e["!ref"]),l=Array.isArray(e),c="\r\n";s.push("P;PGeneral"),s.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=s,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Ki(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Gi(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*Ji(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(s,e["!rows"]),s.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var u=o.s.c;u<=o.e.c;++u){var h=Js({r:d,c:u});(n=l?(e[d]||[])[u]:e[h])&&(null!=n.v||n.f&&!n.F)&&a.push(i(n,0,d,u))}return s.join(c)+c+a.join(c)+c+"E"+c}}}(),Pi=function(){function e(e,t){for(var n=e.split("\n"),r=-1,s=-1,a=0,i=[];a!==n.length;++a)if("BOT"!==n[a].trim()){if(!(r<0)){for(var o=n[a].trim().split(","),l=o[0],c=o[1],d=n[++a]||"";1&(d.match(/["]/g)||[]).length&&a<n.length-1;)d+="\n"+n[++a];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++r]=[],s=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[r][s]=!0:"FALSE"===d?i[r][s]=!1:isNaN(dr(c))?isNaN(hr(c).getDate())?i[r][s]=c:i[r][s]=ir(c):i[r][s]=dr(c),++s;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[r][s++]=""!==d?d:null}if("EOD"===d)break}}else i[++r]=[],s=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,n){return ia(function(t,n){switch(n.type){case"base64":return e(Ft(t),n);case"binary":return e(t,n);case"buffer":return e(Ut&&Buffer.isBuffer(t)?t.toString("binary"):qt(t),n);case"array":return e(or(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return sa(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,r,s){e.push(t),e.push(n+","+r),e.push('"'+s.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,s=[],a=ta(n["!ref"]),i=Array.isArray(n);e(s,"TABLE",0,1,"sheetjs"),e(s,"VECTORS",0,a.e.r-a.s.r+1,""),e(s,"TUPLES",0,a.e.c-a.s.c+1,""),e(s,"DATA",0,0,"");for(var o=a.s.r;o<=a.e.r;++o){t(s,-1,0,"BOT");for(var l=a.s.c;l<=a.e.c;++l){var c=Js({r:o,c:l});if(r=i?(n[o]||[])[l]:n[c])switch(r.t){case"n":var d=r.w;d||null==r.v||(d=r.v),null==d?r.f&&!r.F?t(s,1,0,"="+r.f):t(s,1,0,""):t(s,0,d,"V");break;case"b":t(s,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(s,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Ln(r.z||sn[14],Jn(ir(r.v)))),t(s,0,r.w,"V");break;default:t(s,1,0,"")}else t(s,1,0,"")}}t(s,-1,0,"EOD");return s.join("\r\n")}}()}}(),Oi=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return ia(function(e,t){for(var n=e.split("\n"),r=-1,s=-1,a=0,i=[];a!==n.length;++a){var o=n[a].trim().split(":");if("cell"===o[0]){var l=Qs(o[1]);if(i.length<=l.r)for(r=i.length;r<=l.r;++r)i[r]||(i[r]=[]);switch(r=l.r,s=l.c,o[2]){case"t":i[r][s]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":i[r][s]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?i[r][s]=!!+o[4]:i[r][s]=+o[4],"vtf"==o[2]&&(i[r][s]=[i[r][s],c])}}}return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),a="--SocialCalcSpreadsheetControlSave--";function i(t){if(!t||!t["!ref"])return"";for(var n,r=[],s=[],a="",i=Zs(t["!ref"]),o=Array.isArray(t),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(a=Js({r:l,c:c}),(n=o?(t[l]||[])[c]:t[a])&&null!=n.v&&"z"!==n.t){switch(s=["cell",a,"t"],n.t){case"s":case"str":s.push(e(n.v));break;case"n":n.f?(s[2]="vtf",s[3]="n",s[4]=n.v,s[5]=e(n.f)):(s[2]="v",s[3]=n.v);break;case"b":s[2]="vt"+(n.f?"f":"c"),s[3]="nl",s[4]=n.v?"1":"0",s[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var d=Jn(ir(n.v));s[2]="vtc",s[3]="nd",s[4]=""+d,s[5]=n.w||Ln(n.z||sn[14],d);break;case"e":continue}r.push(s.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return sa(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,s,r,i(e),a].join("\n")}}}(),Mi=function(){function e(e,t,n,r,s){s.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(dr(e))?isNaN(hr(e).getDate())?t[n][r]=e:t[n][r]=ir(e):t[n][r]=dr(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},s=!1,a=0,i=0;a<e.length;++a)34==(i=e.charCodeAt(a))?s=!s:!s&&i in t&&(r[i]=(r[i]||0)+1);for(a in i=[],r)Object.prototype.hasOwnProperty.call(r,a)&&i.push([r[a],a]);if(!i.length)for(a in r=n)Object.prototype.hasOwnProperty.call(r,a)&&i.push([r[a],a]);return i.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[i.pop()[1]]||44}function s(e,t){var n=t||{},s="";var a=n.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(s=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(s=e.charAt(4),e=e.slice(6)):s=r(e.slice(0,1024)):s=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,h=s.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?sn[e]:e;return t=t.replace(zn,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(d,u),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=dr(t)))if(!isNaN(hr(t).getDate())||g&&t.match(g)){r.z=n.dateNF||sn[14];var s=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(zn)||[]).forEach((function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":a=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:s=c}})),l>=0&&-1==o&&s>=0&&(o=s,s=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==r&&-1==s&&-1==a?d:c+"T"+d}(0,n.dateNF,t.match(g)||[]),s=1),n.cellDates?(r.t="d",r.v=ir(t,s)):(r.t="n",r.v=Jn(ir(t,s))),!1!==n.cellText&&(r.w=Ln(r.z,r.v instanceof Date?Jn(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(a[o]||(a[o]=[]),a[o][l]=r):a[Js({c:l,r:o})]=r),d=u+1,p=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return u-d>0&&v(),a["!ref"]=ea(i),a}function a(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?s(t,n):ia(function(t,n){var r=n||{},s=[];if(!t||0===t.length)return s;for(var a=t.split(/[\r\n]/),i=a.length-1;i>=0&&0===a[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=a[c].indexOf(" "))?l=a[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){s[c]=[];var d=0;for(e(a[c].slice(0,o).trim(),s,c,d,r),d=1;d<=(a[c].length-o)/10+1;++d)e(a[c].slice(o+10*(d-1),o+10*d).trim(),s,c,d,r)}return r.sheetRows&&(s=s.slice(0,r.sheetRows)),s}(t,n),n):s(t,n)}function i(e,t){var n="",r="string"==t.type?[0,0,0,0]:Hc(e,t);switch(t.type){case"base64":n=Ft(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Rt?Rt.utils.decode(t.codepage,e):Ut&&Buffer.isBuffer(e)?e.toString("binary"):qt(e);break;case"array":n=or(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=jr(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=jr(n):"binary"==t.type&&"undefined"!==typeof Rt&&t.codepage&&(n=Rt.utils.decode(t.codepage,Rt.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?Oi.to_sheet("string"==t.type?n:jr(n),t):a(n,t)}return{to_workbook:function(e,t){return sa(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,n=[],r=ta(e["!ref"]),s=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){for(var i=[],o=r.s.c;o<=r.e.c;++o){var l=Js({r:a,c:o});if((t=s?(e[a]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(ra(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}n.push(i.join(""))}return n.join("\n")}}}();var Li=function(){function e(e,t,n){if(e){Fs(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var s=e.read_shift(2),a=r[s]||r[65535],i=e.read_shift(2),o=e.l+i,l=a.f&&a.f(e,i,n);if(e.l=o,t(l,a,s))return}}}function t(t,n){if(!t)return t;var r=n||{};var s=r.dense?[]:{},a="Sheet1",i="",o=0,l={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||sn[14],r.cellDates&&(e[1].t="d",e[1].v=nr(e[1].v))),r.qpro&&e[3]>o&&(s["!ref"]=ea(u),l[a]=s,c.push(a),s=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a=i||"Sheet"+(o+1),i="");var d=r.dense?(s[e[0].r]||[])[e[0].c]:s[Js(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}r.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[Js(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=x,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:a=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(s["!ref"]=ea(u),l[a]=s,c.push(a),s=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[Js(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(a=e[1])}}),r)}if(s["!ref"]=ea(u),l[i||a]=s,c.push(i||a),!d.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<d.length;++p)l[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=l[d[p]]||l[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var s=e.l+t,a=n(e,0,r);if(a[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return a[1].v=e.read_shift(i,"utf8"),a}return r.qpro&&e.l++,a[1].v=e.read_shift(s-e.l,"cstr"),a}function s(e,t,n){var r=Ws(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var s=0;s<r.length;++s){var a=n.charCodeAt(s);r.write_shift(1,a>=128?95:a)}return r.write_shift(1,0),r}function a(e,t,n){var r=Ws(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function i(e,t,n){var r=Ws(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?Xs(t):Gs(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,n,r){var s=Ws(6+r.length);s.write_shift(2,e),s.write_shift(1,n),s.write_shift(1,t),s.write_shift(1,39);for(var a=0;a<r.length;++a){var i=r.charCodeAt(a);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}function h(e,t){var n=d(e),r=e.read_shift(4),s=e.read_shift(4),a=e.read_shift(2);if(65535==a)return 0===r&&3221225472===s?(n[1].t="e",n[1].v=15):0===r&&3489660928===s?(n[1].t="e",n[1].v=42):n[1].v=0,n;var i=32768&a;return a=(32767&a)-16446,n[1].v=(1-2*i)*(s*Math.pow(2,a+32)+r*Math.pow(2,a)),n}function f(e,t,n,r){var s=Ws(14);if(s.write_shift(2,e),s.write_shift(1,n),s.write_shift(1,t),0==r)return s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,65535),s;var a,i=0,o=0,l=0;return r<0&&(i=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,a=(r*=Math.pow(2,32))>>>0,s.write_shift(4,a),s.write_shift(4,l),o+=16383+(i?32768:0),s.write_shift(2,o),s}function m(e,t){var n=d(e),r=e.read_shift(8,"f");return n[1].v=r,n}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=Ws(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var s=e.charCodeAt(r);n[n.l++]=s>127?95:s}return n[n.l++]=0,n}var v={0:{n:"BOF",f:ci},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var s=n(e,0,r);return s[1].v=e.read_shift(2,"i"),s}},14:{n:"NUMBER",f:function(e,t,r){var s=n(e,0,r);return s[1].v=e.read_shift(8,"f"),s}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var s=e.l+t,a=n(e,0,r);if(a[1].v=e.read_shift(8,"f"),r.qpro)e.l=s;else{var i=e.read_shift(2);!function(e,t){Fs(e,0);var n=[],r=0,s="",a="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:n.push(e.read_shift(8,"f"));break;case 1:a=o(t[0].c,e.read_shift(2),!0),s=o(t[0].r,e.read_shift(2),!1),n.push(a+s);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);a=o(t[0].c,e.read_shift(2),!0),s=o(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+a+s);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);n.push('"'+m.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:d=n.pop(),i=n.pop(),n.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=n.pop(),i=n.pop(),n.push(i+c[u]+d);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(r=l[u][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+n.join("|")+"|");var p=n.slice(-r);n.length-=r,n.push(l[u][0]+"("+p.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+i),a),e.l+=i}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},x={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=d(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=d(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var s=e.read_shift(2);if(14e3==s){for(n[s]=[0,""],n[s][0]=e.read_shift(2);e[e.l];)n[s][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=d(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var n=m(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&At(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=zs(),o=ta(e["!ref"]),l=Array.isArray(e),c=[];tc(r,0,function(e){var t=Ws(2);return t.write_shift(2,e),t}(1030)),tc(r,6,function(e){var t=Ws(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var d=Math.min(o.e.r,8191),u=o.s.r;u<=d;++u)for(var h=Gs(u),f=o.s.c;f<=o.e.c;++f){u===o.s.r&&(c[f]=Xs(f));var m=c[f]+h,p=l?(e[u]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?tc(r,13,a(u,f,p.v)):tc(r,14,i(u,f,p.v));else tc(r,15,s(u,f,ra(p).slice(0,239)))}return tc(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&At(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=zs();tc(r,0,function(e){var t=Ws(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,s=0,a=0;a<e.SheetNames.length;++a){var i=e.SheetNames[a],o=e.Sheets[i];if(o&&o["!ref"]){++s;var l=Zs(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,s),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var s=0,a=0;s<e.SheetNames.length;++s)(e.Sheets[e.SheetNames[s]]||{})["!ref"]&&tc(r,27,g(e.SheetNames[s],a++));var i=0;for(s=0;s<e.SheetNames.length;++s){var o=e.Sheets[e.SheetNames[s]];if(o&&o["!ref"]){for(var l=ta(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=Gs(m),v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(d[v]=Xs(v));var x=d[v]+p,y=c?(o[m]||[])[v]:o[x];if(y&&"z"!=y.t)if("n"==y.t)tc(r,23,f(m,v,i,y.v));else tc(r,22,u(m,v,i,ra(y).slice(0,239)))}++i}}return tc(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Ht(Ft(e)),n);case"binary":return t(Ht(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var Fi=/^\s|\s$|[\t\n\r]/;function Ui(e,t){if(!t.bookSST)return"";var n=[pr];n[n.length]=Or("sst",null,{xmlns:Xr[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var s=e[r],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Fi)&&(a+=' xml:space="preserve"'),a+=">"+br(s.t)+"</t>"),a+="</si>",n[n.length]=a}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var Wi=function(e,t){var n=!1;return null==t&&(n=!0,t=Ws(15+4*e.t.length)),t.write_shift(1,0),ca(e.t,t),n?t.slice(0,t.l):t};function zi(e){var t=zs();Bs(t,159,function(e,t){return t||(t=Ws(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)Bs(t,19,Wi(e[n]));return Bs(t,160),t.end()}function Bi(e){if("undefined"!==typeof Rt)return Rt.utils.encode(Tt,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Hi(e){var t,n,r=0,s=Bi(e),a=s.length+1;for((t=zt(a))[0]=s.length,n=1;n!=a;++n)t[n]=s[n-1];for(n=a-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var Vi=function(){function e(e,n){switch(n.type){case"base64":return t(Ft(e),n);case"binary":return t(e,n);case"buffer":return t(Ut&&Buffer.isBuffer(e)?e.toString("binary"):qt(e),n);case"array":return t(or(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,a=/\\\w+\b/g,i=0,o=-1;r=a.exec(e);){if("\\cell"===r[0]){var l=e.slice(i,a.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[Js({r:t,c:o})]=c}}i=a.lastIndex}o>s.e.c&&(s.e.c=o)})),n["!ref"]=ea(s),n}return{to_workbook:function(t,n){return sa(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=ta(e["!ref"]),s=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){n.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)n.push("\\cellx"+(i+1));for(n.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var o=Js({r:a,c:i});(t=s?(e[a]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(ra(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function qi(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var Yi=6;function Ki(e){return Math.floor((e+Math.round(128/Yi)/256)*Yi)}function Gi(e){return Math.floor((e-5)/Yi*100+.5)/100}function $i(e){return Math.round((e*Yi+5)/Yi*256)/256}function Xi(e){e.width?(e.wpx=Ki(e.width),e.wch=Gi(e.wpx),e.MDW=Yi):e.wpx?(e.wch=Gi(e.wpx),e.width=$i(e.wch),e.MDW=Yi):"number"==typeof e.wch&&(e.width=$i(e.wch),e.wpx=Ki(e.width),e.MDW=Yi),e.customWidth&&delete e.customWidth}var Qi=96;function Ji(e){return 96*e/Qi}function Zi(e){return e*Qi/96}function eo(e,t){var n,r=[pr,Or("styleSheet",null,{xmlns:Xr[0],"xmlns:vt":Kr})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=Or("numFmt",null,{numFmtId:r,formatCode:br(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Or("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=Or("cellXfs",null),e.forEach((function(e){t[t.length]=Or("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Or("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function to(e,t,n){n||(n=Ws(6+4*t.length)),n.write_shift(2,e),ca(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function no(e,t){t||(t=Ws(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Ws(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Da(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),ca(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ro,so=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ao=Us;function io(e,t){t||(t=Ws(84)),ro||(ro=$n(so));var n=ro[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(Da({auto:1},t),Da({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function oo(e,t,n){n||(n=Ws(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function lo(e,t){return t||(t=Ws(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var co=Us;function uo(e){var t;Bs(e,613,oa(1)),Bs(e,46,(t||(t=Ws(51)),t.write_shift(1,0),lo(0,t),lo(0,t),lo(0,t),lo(0,t),lo(0,t),t.length>t.l?t.slice(0,t.l):t)),Bs(e,614)}function ho(e){var t,n;Bs(e,619,oa(1)),Bs(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=Ws(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),wa(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),Bs(e,620)}function fo(e){Bs(e,508,function(e,t,n){var r=Ws(2052);return r.write_shift(4,e),wa(t,r),wa(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),Bs(e,509)}function mo(e,t){var n=zs();return Bs(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n})),0!=n&&(Bs(e,615,oa(n)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&Bs(e,44,to(r,t[r]))})),Bs(e,616))}}(n,e.SSF),function(e){Bs(e,611,oa(1)),Bs(e,43,no({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Bs(e,612)}(n),function(e){Bs(e,603,oa(2)),Bs(e,45,io({patternType:"none"})),Bs(e,45,io({patternType:"gray125"})),Bs(e,604)}(n),uo(n),function(e){Bs(e,626,oa(1)),Bs(e,47,oo({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Bs(e,627)}(n),function(e,t){Bs(e,617,oa(t.length)),t.forEach((function(t){Bs(e,47,oo(t,0))})),Bs(e,618)}(n,t.cellXfs),ho(n),function(e){Bs(e,505,oa(0)),Bs(e,506)}(n),fo(n),Bs(n,279),n.end()}function po(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[pr];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function go(){var e=zs();return Bs(e,332),Bs(e,334,oa(1)),Bs(e,335,function(e){var t=Ws(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ca(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Bs(e,336),Bs(e,339,function(e,t){var n=Ws(8+2*t.length);return n.write_shift(4,e),ca(t,n),n.slice(0,n.l)}(1,"XLDAPR")),Bs(e,52),Bs(e,35,oa(514)),Bs(e,4096,oa(0)),Bs(e,4097,di(1)),Bs(e,36),Bs(e,53),Bs(e,340),Bs(e,337,function(e,t){var n=Ws(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),Bs(e,51,function(e){var t=Ws(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),Bs(e,338),Bs(e,333),e.end()}function vo(){var e=[pr];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var xo=1024;function yo(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),s=[Or("xml",null,{"xmlns:v":ns,"xmlns:o":Qr,"xmlns:x":Jr,"xmlns:mv":ts}).replace(/\/>/,">"),Or("o:shapelayout",Or("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Or("v:shapetype",[Or("v:stroke",null,{joinstyle:"miter"}),Or("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];xo<1e3*e;)xo+=1e3;return t.forEach((function(e){var t=Qs(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?Or("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=Or("v:fill",r,n);++xo,s=s.concat(["<v:shape"+Pr({id:"_x0000_s"+xo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,Or("v:shadow",null,{on:"t",obscured:"t"}),Or("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rr("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Rr("x:AutoFill","False"),Rr("x:Row",String(t.r)),Rr("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),s.push("</xml>"),s.join("")}function bo(e){var t=[pr,Or("comments",null,{xmlns:Xr[0]})],n=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=br(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,s=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(r=n.indexOf(br(e.a))),s.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),s.length<=1)t.push(Rr("t",br(s[0]||"")));else{for(var a="Comment:\n    "+s[0]+"\n",i=1;i<s.length;++i)a+="Reply:\n    "+s[i]+"\n";t.push(Rr("t",br(a)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wo(e,t,n){var r=[pr,Or("ThreadedComments",null,{xmlns:Br}).replace(/[\/]>/,">")];return e.forEach((function(e){var s="";(e[1]||[]).forEach((function(a,i){if(a.T){a.a&&-1==t.indexOf(a.a)&&t.push(a.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==i?s=o.id:o.parentId=s,a.ID=o.id,a.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),r.push(Or("threadedComment",Rr("text",a.t||""),o))}else delete a.ID}))})),r.push("</ThreadedComments>"),r.join("")}var No=la;function ko(e){var t=zs(),n=[];return Bs(t,628),Bs(t,630),e.forEach((function(e){e[1].forEach((function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),Bs(t,632,function(e){return ca(e.slice(0,54))}(e.a)))}))})),Bs(t,631),Bs(t,633),e.forEach((function(e){e[1].forEach((function(r){r.iauthor=n.indexOf(r.a);var s={s:Qs(e[0]),e:Qs(e[0])};Bs(t,635,function(e,t){return null==t&&(t=Ws(36)),t.write_shift(4,e[1].iauthor),ja(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([s,r])),r.t&&r.t.length>0&&Bs(t,637,fa(r)),Bs(t,636),delete r.iauthor}))})),Bs(t,634),Bs(t,629),t.end()}var _o=["xlsb","xlsm","xlam","biff8","xla"];var So=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,s){var a=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==s.length?a=!0:"["==s.charAt(0)&&(a=!0,s=s.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=s.length>0?0|parseInt(s,10):0;return a?l+=t.c:--l,i?o+=t.r:--o,n+(a?"":"$")+Xs(l)+(i?"":"$")+Gs(o)}return function(r,s){return t=s,r.replace(e,n)}}(),To=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Co=function(){return function(e,t){return e.replace(To,(function(e,n,r,s,a,i){var o=$s(s)-(r?0:t.c),l=Ks(i)-(a?0:t.r);return n+"R"+(0==l?"":a?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function Eo(e,t){return e.replace(To,(function(e,n,r,s,a,i){return n+("$"==r?r+s:Xs($s(s)+t.c))+("$"==a?a+i:Gs(Ks(i)+t.r))}))}function jo(e){e.l+=1}function Ao(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function Io(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Do(e);12==n.biff&&(r=4)}var s=e.read_shift(r),a=e.read_shift(r),i=Ao(e,2),o=Ao(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Do(e){var t=Ao(e,2),n=Ao(e,2),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:s,cRel:n[1],rRel:n[2]}}}function Ro(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Ao(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),s=Ao(e,2);return{r:r,c:s[0],cRel:s[1],rRel:s[2]}}function Po(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function Oo(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Mo(e){return[e.read_shift(1),e.read_shift(1)]}function Lo(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=oi(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=Fa[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Aa(e);break;case 2:n[1]=gi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Fo(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),s=[],a=0;a!=r;++a)s.push((12==n.biff?Ea:Ni)(e,8));return s}function Uo(e,t,n){var r=0,s=0;12==n.biff?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--s&&(s=256));for(var a=0,i=[];a!=r&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=Lo(e,n.biff);return i}function Wo(e,t,n){return e.l+=2,[Po(e)]}function zo(e){return e.l+=6,[]}function Bo(e){return e.l+=2,[ci(e),1&e.read_shift(2)]}var Ho=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Vo={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:Us},3:{n:"PtgAdd",f:jo},4:{n:"PtgSub",f:jo},5:{n:"PtgMul",f:jo},6:{n:"PtgDiv",f:jo},7:{n:"PtgPower",f:jo},8:{n:"PtgConcat",f:jo},9:{n:"PtgLt",f:jo},10:{n:"PtgLe",f:jo},11:{n:"PtgEq",f:jo},12:{n:"PtgGe",f:jo},13:{n:"PtgGt",f:jo},14:{n:"PtgNe",f:jo},15:{n:"PtgIsect",f:jo},16:{n:"PtgUnion",f:jo},17:{n:"PtgRange",f:jo},18:{n:"PtgUplus",f:jo},19:{n:"PtgUminus",f:jo},20:{n:"PtgPercent",f:jo},21:{n:"PtgParen",f:jo},22:{n:"PtgMissArg",f:jo},23:{n:"PtgStr",f:function(e,t,n){return e.l++,hi(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Fa[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Aa(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(n&&n.biff<=3?1:2);return[cl[s],ll[s],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],s=e.read_shift(1),a=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[s,(0===a[0]?ll:ol)[a[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,s=!n||n.biff>=8?4:2,a=e.read_shift(s);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,a]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,Ro(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,Io(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:Us},40:{n:"PtgMemNoMem",f:Us},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var s=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,s=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==s&&n>=128&&(n-=256),{r:t,c:n,cRel:s,rRel:r}}(e);var s=e.read_shift(r>=12?4:2),a=e.read_shift(2),i=(16384&a)>>14,o=(32768&a)>>15;if(a&=16383,1==o)for(;s>524287;)s-=1048576;if(1==i)for(;a>8191;)a-=16384;return{r:s,c:a,cRel:i,rRel:o}}(e,0,n);return[r,s]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,s=function(e,t,n){if(n.biff<8)return Do(e);var r=e.read_shift(12==n.biff?4:2),s=e.read_shift(12==n.biff?4:2),a=Ao(e,2),i=Ao(e,2);return{s:{r:r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,n);return[r,s]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,s,Ro(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,s=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,s,Io(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,s=e.read_shift(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[r,s]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,s=e.read_shift(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[r,s]}},255:{}},qo={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Yo={1:{n:"PtgElfLel",f:Bo},2:{n:"PtgElfRw",f:Wo},3:{n:"PtgElfCol",f:Wo},6:{n:"PtgElfRwV",f:Wo},7:{n:"PtgElfColV",f:Wo},10:{n:"PtgElfRadical",f:Wo},11:{n:"PtgElfRadicalS",f:zo},13:{n:"PtgElfColS",f:zo},15:{n:"PtgElfColSV",f:zo},16:{n:"PtgElfRadicalLel",f:Bo},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2);return{ixti:t,coltype:3&n,rt:Ho[n>>2&31],idx:r,c:s,C:a}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Ko={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),s=[],a=0;a<=r;++a)s.push(e.read_shift(n&&2==n.biff?1:2));return s}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Oo},33:{n:"PtgAttrBaxcel",f:Oo},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Mo(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Mo(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Go(e,t,n,r){if(r.biff<8)return Us(e,t);for(var s=e.l+t,a=[],i=0;i!==n.length;++i)switch(n[i][0]){case"PtgArray":n[i][1]=Uo(e,0,r),a.push(n[i][1]);break;case"PtgMemArea":n[i][2]=Fo(e,n[i][1],r),a.push(n[i][2]);break;case"PtgExp":r&&12==r.biff&&(n[i][1][1]=e.read_shift(4),a.push(n[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[i][0]}return 0!==(t=s-e.l)&&a.push(Us(e,t)),a}function $o(e,t,n){for(var r,s,a=e.l+t,i=[];a!=e.l;)t=a-e.l,s=e[e.l],r=Vo[s]||Vo[qo[s]],24!==s&&25!==s||(r=(24===s?Yo:Ko)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,t,n)]):Us(e,t);return i}function Xo(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],s=[],a=0;a<r.length;++a){var i=r[a];if(i)if(2===i[0])s.push('"'+i[1].replace(/"/g,'""')+'"');else s.push(i[1]);else s.push("")}t.push(s.join(","))}return t.join(";")}var Qo={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Jo(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var s="";if(n.biff>8)switch(e[r[0]][0]){case 357:return s=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(s=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Zo(e,t,n){var r=Jo(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function el(e,t,n,r,s){var a,i,o,l,c=s&&s.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,x=e[0].length;v<x;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=cr(" ",e[0][p][1][1]);break;case 1:g=cr("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+Qo[y[0]]+a);break;case"PtgIsect":a=u.pop(),i=u.pop(),u.push(i+" "+a);break;case"PtgUnion":a=u.pop(),i=u.pop(),u.push(i+","+a);break;case"PtgRange":a=u.pop(),i=u.pop(),u.push(i+":"+a);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Hs(y[1][1],d,s),u.push(qs(o,c));break;case"PtgRefN":o=n?Hs(y[1][1],n,s):y[1][1],u.push(qs(o,c));break;case"PtgRef3d":h=y[1][1],o=Hs(y[1][2],d,s);m=Zo(r,h,s);u.push(m+"!"+qs(o,c));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],w=y[1][1];b||(b=0);var N=0==(b&=127)?[]:u.slice(-b);u.length-=b,"User"===w&&(w=N.shift()),u.push(w+"("+N.join(",")+")");break;case"PtgBool":u.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(y[1]);break;case"PtgNum":u.push(String(y[1]));break;case"PtgStr":u.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Vs(y[1][1],n?{s:n}:d,s),u.push(Ys(l,s));break;case"PtgArea":l=Vs(y[1][1],d,s),u.push(Ys(l,s));break;case"PtgArea3d":h=y[1][1],l=y[1][2],m=Zo(r,h,s),u.push(m+"!"+Ys(l,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=y[1][2];var k=(r.names||[])[f-1]||(r[0]||[])[f],_=k?k.Name:"SH33TJSNAME"+String(f);_&&"_xlfn."==_.slice(0,6)&&!s.xlfn&&(_=_.slice(6)),u.push(_);break;case"PtgNameX":var S,T=y[1][1];if(f=y[1][2],!(s.biff<=5)){var C="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][f]&&r[T][f].itab>0&&(C=r.SheetNames[r[T][f].itab-1]+"!"):C=r.SheetNames[f-1]+"!"),r[T]&&r[T][f])C+=r[T][f].Name;else if(r[0]&&r[0][f])C+=r[0][f].Name;else{var E=(Jo(r,T,s)||"").split(";;");E[f-1]?C=E[f-1]:C+="SH33TJSERRX"}u.push(C);break}T<0&&(T=-T),r[T]&&(S=r[T][f]),S||(S={Name:"SH33TJSERRY"}),u.push(S.Name);break;case"PtgParen":var j="(",A=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:j=cr(" ",e[0][p][1][1])+j;break;case 3:j=cr("\r",e[0][p][1][1])+j;break;case 4:A=cr(" ",e[0][p][1][1])+A;break;case 5:A=cr("\r",e[0][p][1][1])+A;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(j+u.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var I={c:n.c,r:n.r};if(r.sharedf[Js(o)]){var D=r.sharedf[Js(o)];u.push(el(D,d,I,r,s))}else{var R=!1;for(a=0;a!=r.arrayf.length;++a)if(i=r.arrayf[a],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){u.push(el(i[1],d,I,r,s)),R=!0;break}R||u.push(y[1])}break;case"PtgArray":u.push("{"+Xo(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=s.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var P=!0;switch((y=e[0][p])[1][0]){case 4:P=!1;case 0:g=cr(" ",y[1][1]);break;case 5:P=!1;case 1:g=cr("\r",y[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}u.push((P?g:"")+u.pop()+(P?"":g)),p=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function tl(e,t,n,r,s){var a=bi(t,n,s),i=function(e){if(null==e){var t=Ws(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Ia("number"==typeof e?e:0)}(e.v),o=Ws(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Ws(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Yt([a,i,o,l])}function nl(e,t,n){var r=e.read_shift(4),s=$o(e,r,n),a=e.read_shift(4);return[s,a>0?Go(e,a,s,n):null]}var rl=nl,sl=nl,al=nl,il=nl,ol={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ll={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cl={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};var dl="undefined"!==typeof Map;function ul(e,t,n){var r=0,s=e.length;if(n){if(dl?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var a=dl?n.get(t):n[t];r<a.length;++r)if(e[a[r]].t===t)return e.Count++,a[r]}else for(;r<s;++r)if(e[r].t===t)return e.Count++,r;return e[s]={t:t},e.Count++,e.Unique++,n&&(dl?(n.has(t)||n.set(t,[]),n.get(t).push(s)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(s))),s}function hl(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Yi=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=Gi(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=$i(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function fl(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function ml(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],s=60,a=e.length;if(null==r&&n.ssf)for(;s<392;++s)if(null==n.ssf[s]){Fn(t.z,s),n.ssf[s]=t.z,n.revssf[t.z]=r=s;break}for(s=0;s!=a;++s)if(e[s].numFmtId===r)return s;return e[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function pl(e,t,n){if(e&&e["!ref"]){var r=ta(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var gl=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vl=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xl(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var s="",a=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Fa[e.v];break;case"d":r&&r.cellDates?s=ir(e.v,-1).toISOString():((e=lr(e)).t="n",s=""+(e.v=Jn(ir(e.v)))),"undefined"===typeof e.z&&(e.z=sn[14]);break;default:s=e.v}var o=Rr("v",br(s)),l={r:t},c=ml(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Rr("v",""+ul(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=a&&(e.t=a,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Or("f",br(e.f),d)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Or("c",o,l)}function yl(e,t,n,r){var s,a=[pr,Or("worksheet",null,{xmlns:Xr[0],"xmlns:r":Yr})],i=n.SheetNames[e],o="",l=n.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",d=ta(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=ea(d)}r||(r={}),l["!comments"]=[];var u=[];!function(e,t,n,r,s){var a=!1,i={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(d){}a=!0,i.codeName=Ar(br(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Or("outlinePr",null,c)}(a||o)&&(s[s.length]=Or("sheetPr",o,i))}(l,n,e,t,a),a[a.length]=Or("dimension",null,{ref:c}),a[a.length]=function(e,t,n,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Or("sheetViews",Or("sheetView",null,s),{})}(0,0,0,n),t.sheetFormat&&(a[a.length]=Or("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(a[a.length]=function(e,t){for(var n,r=["<cols>"],s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Or("col",null,hl(s,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,s=[],a=[],i=ta(e["!ref"]),o="",l="",c=[],d=0,u=0,h=e["!rows"],f=Array.isArray(e),m={r:l},p=-1;for(u=i.s.c;u<=i.e.c;++u)c[u]=Xs(u);for(d=i.s.r;d<=i.e.r;++d){for(a=[],l=Gs(d),u=i.s.c;u<=i.e.c;++u){n=c[u]+l;var g=f?(e[d]||[])[u]:e[n];void 0!==g&&null!=(o=xl(g,n,e,t))&&a.push(o)}(a.length>0||h&&h[d])&&(m={r:l},h&&h[d]&&((r=h[d]).hidden&&(m.hidden=1),p=-1,r.hpx?p=Ji(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level)),s[s.length]=Or("row",a.join(""),m))}if(h)for(;d<h.length;++d)h&&h[d]&&(m={r:d+1},(r=h[d]).hidden&&(m.hidden=1),p=-1,r.hpx?p=Ji(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level),s[s.length]=Or("row","",m));return s.join("")}(l,t,0,0),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=function(e){var t={sheet:1};return gl.forEach((function(n){null!=e[n]&&e[n]&&(t[n]="1")})),vl.forEach((function(n){null==e[n]||e[n]||(t[n]="0")})),e.password&&(t.password=Hi(e.password).toString(16).toUpperCase()),Or("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(a[a.length]=function(e,t,n,r){var s="string"==typeof e.ref?e.ref:ea(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,i=Zs(s);i.s.r==i.e.r&&(i.e.r=Zs(t["!ref"]).e.r,s=ea(i));for(var o=0;o<a.length;++o){var l=a[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Or("autoFilter",null,{ref:s})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(a[a.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+ea(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,p=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=qa(r,-1,br(e[1].Target).replace(/#.*$/,""),Ba.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=br(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=br(e[1].Tooltip)),a[a.length]=Or("hyperlink",null,h))})),a[a.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(a[a.length]=(fl(f=l["!margins"]),Or("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(a[a.length]=Rr("ignoredErrors",Or("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=qa(r,-1,"../drawings/drawing"+(e+1)+".xml",Ba.DRAW),a[a.length]=Or("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=u),l["!comments"].length>0&&(p=qa(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ba.VML),a[a.length]=Or("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function bl(e,t,n,r){var s=function(e,t,n){var r=Ws(145),s=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var a=320;s.hpx?a=20*Ji(s.hpx):s.hpt&&(a=20*s.hpt),r.write_shift(2,a),r.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),r.write_shift(1,i),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[Js(c)])&&(u<0&&(u=f),h=f);u<0||(++o,r.write_shift(4,u),r.write_shift(4,h))}var m=r.l;return r.l=l,r.write_shift(4,o),r.l=m,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(s.length>17||(t["!rows"]||[])[r])&&Bs(e,0,s)}var wl=Ea,Nl=ja;function kl(e){return[ga(e),Aa(e),"n"]}var _l=Ea,Sl=ja;var Tl=["left","right","top","bottom","header","footer"];function Cl(e,t,n,r,s,a,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=lr(t)).z=t.z||sn[14],t.v=Jn(ir(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=ml(s.cellXfs,t,s),t.l&&a["!links"].push([Js(l),t.l]),t.c&&a["!comments"].push([Js(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=ul(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,i?Bs(e,18,function(e,t,n){return null==n&&(n=Ws(8)),va(t,n),n.write_shift(4,t.v),n}(0,l)):Bs(e,7,function(e,t,n){return null==n&&(n=Ws(12)),pa(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",i?Bs(e,17,function(e,t,n){return null==n&&(n=Ws(8+4*e.v.length)),va(t,n),ca(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):Bs(e,6,function(e,t,n){return null==n&&(n=Ws(12+4*e.v.length)),pa(t,n),ca(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Bs(e,13,function(e,t,n){return null==n&&(n=Ws(8)),va(t,n),Ta(e.v,n),n}(t,l)):Bs(e,2,function(e,t,n){return null==n&&(n=Ws(12)),pa(t,n),Ta(e.v,n),n}(t,l)):i?Bs(e,16,function(e,t,n){return null==n&&(n=Ws(12)),va(t,n),Ia(e.v,n),n}(t,l)):Bs(e,5,function(e,t,n){return null==n&&(n=Ws(16)),pa(t,n),Ia(e.v,n),n}(t,l)),!0;case"b":return l.t="b",i?Bs(e,15,function(e,t,n){return null==n&&(n=Ws(5)),va(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):Bs(e,4,function(e,t,n){return null==n&&(n=Ws(9)),pa(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",i?Bs(e,14,function(e,t,n){return null==n&&(n=Ws(8)),va(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):Bs(e,3,function(e,t,n){return null==n&&(n=Ws(9)),pa(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return i?Bs(e,12,function(e,t,n){return null==n&&(n=Ws(4)),va(t,n)}(0,l)):Bs(e,1,function(e,t,n){return null==n&&(n=Ws(8)),pa(t,n)}(0,l)),!0}function El(e,t){var n,r;t&&t["!merges"]&&(Bs(e,177,(n=t["!merges"].length,null==r&&(r=Ws(4)),r.write_shift(4,n),r)),t["!merges"].forEach((function(t){Bs(e,176,Sl(t))})),Bs(e,178))}function jl(e,t){t&&t["!cols"]&&(Bs(e,390),t["!cols"].forEach((function(t,n){t&&Bs(e,60,function(e,t,n){null==n&&(n=Ws(18));var r=hl(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var s=0;return t.hidden&&(s|=1),"number"==typeof r.width&&(s|=2),t.level&&(s|=t.level<<8),n.write_shift(2,s),n}(n,t))})),Bs(e,391))}function Al(e,t){t&&t["!ref"]&&(Bs(e,648),Bs(e,649,function(e){var t=Ws(24);return t.write_shift(4,4),t.write_shift(4,1),ja(e,t),t}(ta(t["!ref"]))),Bs(e,650))}function Il(e,t,n){t["!links"].forEach((function(t){if(t[1].Target){var r=qa(n,-1,t[1].Target.replace(/#.*$/,""),Ba.HLINK);Bs(e,494,function(e,t){var n=Ws(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ja({s:Qs(e[0]),e:Qs(e[0])},n),_a("rId"+t,n);var r=e[1].Target.indexOf("#");return ca((-1==r?"":e[1].Target.slice(r+1))||"",n),ca(e[1].Tooltip||"",n),ca("",n),n.slice(0,n.l)}(t,r))}})),delete t["!links"]}function Dl(e,t,n){Bs(e,133),Bs(e,137,function(e,t,n){null==n&&(n=Ws(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),Bs(e,138),Bs(e,134)}function Rl(e,t){var n,r;t["!protect"]&&Bs(e,535,(n=t["!protect"],null==r&&(r=Ws(66)),r.write_shift(2,n.password?Hi(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)})),r))}function Pl(e,t,n,r){var s=zs(),a=n.SheetNames[e],i=n.Sheets[a]||{},o=a;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(u){}var l,c,d=ta(i["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Bs(s,129),(n.vbaraw||i["!outline"])&&Bs(s,147,function(e,t,n){null==n&&(n=Ws(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var s=1;s<3;++s)n.write_shift(1,0);return Da({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),ya(e,n),n.slice(0,n.l)}(o,i["!outline"])),Bs(s,148,Nl(d)),Dl(s,0,n.Workbook),jl(s,i),function(e,t,n,r){var s,a=ta(t["!ref"]||"A1"),i="",o=[];Bs(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=c;++d){i=Gs(d),bl(e,t,a,d);var u=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(o[h]=Xs(h)),s=o[h]+i;var f=l?(t[d]||[])[h]:t[s];u=!!f&&Cl(e,f,d,h,r,t,u)}}Bs(e,146)}(s,i,0,t),Rl(s,i),function(e,t,n,r){if(t["!autofilter"]){var s=t["!autofilter"],a="string"===typeof s.ref?s.ref:ea(s.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,o=Zs(a);o.s.r==o.e.r&&(o.e.r=Zs(t["!ref"]).e.r,a=ea(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Bs(e,161,ja(ta(a))),Bs(e,162)}}(s,i,n,e),El(s,i),Il(s,i,r),i["!margins"]&&Bs(s,476,(l=i["!margins"],null==c&&(c=Ws(48)),fl(l),Tl.forEach((function(e){Ia(l[e],c)})),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||Al(s,i),function(e,t,n,r){if(t["!comments"].length>0){var s=qa(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Ba.VML);Bs(e,551,_a("rId"+s)),t["!legacy"]=s}}(s,i,e,r),Bs(s,130),s.end()}var Ol=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var Ml="][*?/\\".split("");function Ll(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return Ml.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}function Fl(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,s=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=s,r=!!e.vbaraw,t.forEach((function(e,s){Ll(e);for(var a=0;a<s;++a)if(e==t[a])throw new Error("Duplicate Sheet Name: "+e);if(r){var i=n&&n[s]&&n[s].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}}));for(var a=0;a<e.SheetNames.length;++a)pl(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}function Ul(e){var t=[pr];t[t.length]=Or("workbook",null,{xmlns:Xr[0],"xmlns:r":Yr});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ol.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Or("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&s[a]&&s[a].Hidden;++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:br(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Or("sheet",null,i)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=Or("definedName",br(e.Ref),n))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Wl(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,s=t.Workbook.Sheets,a=0,i=-1,o=-1;a<s.length;++a)!s[a]||!s[a].Hidden&&-1==i?i=a:1==s[a].Hidden&&-1==o&&(o=a);if(!(o>i))Bs(e,135),Bs(e,158,(n=i,r||(r=Ws(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),Bs(e,136)}}function zl(e,t){var n=zs();return Bs(n,131),Bs(n,128,function(e,t){t||(t=Ws(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return ca("SheetJS",t),ca(_t.version,t),ca(_t.version,t),ca("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Bs(n,153,function(e,t){t||(t=Ws(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),ya(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Wl(n,e),function(e,t){Bs(e,143);for(var n=0;n!=t.SheetNames.length;++n){Bs(e,156,(r={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]},(s=void 0)||(s=Ws(127)),s.write_shift(4,r.Hidden),s.write_shift(4,r.iTabID),_a(r.strRelID,s),ca(r.name.slice(0,31),s),s.length>s.l?s.slice(0,s.l):s))}var r,s;Bs(e,144)}(n,e),Bs(n,132),n.end()}function Bl(e,t,n,r,s){return(".bin"===t.slice(-4)?Pl:yl)(e,n,r,s)}function Hl(e,t,n){return(".bin"===t.slice(-4)?ko:bo)(e,n)}function Vl(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return Kn(ti).map((function(e){for(var t=0;t<Ga.length;++t)if(Ga[t][1]==e)return Ga[t];for(t=0;t<Qa.length;++t)if(Qa[t][1]==e)return Qa[t];throw e})).forEach((function(r){if(null!=e[r[1]]){var s=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof s?s=String(s):!0===s||!1===s?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),n.push(Rr(ti[r[1]]||r[1],s))}})),Or("DocumentProperties",n.join(""),{xmlns:Qr})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&Kn(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<Ga.length;++r)if(t==Ga[r][1])return;for(r=0;r<Qa.length;++r)if(t==Qa[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var a=e[t],i="string";"number"==typeof a?(i="float",a=String(a)):!0===a||!1===a?(i="boolean",a=a?"1":"0"):a=String(a),s.push(Or(wr(t),a,{"dt:dt":i}))}})),t&&Kn(t).forEach((function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],a="string";"number"==typeof r?(a="float",r=String(r)):!0===r||!1===r?(a="boolean",r=r?"1":"0"):r instanceof Date?(a="dateTime.tz",r=r.toISOString()):r=String(r),s.push(Or(wr(n),r,{"dt:dt":a}))}})),"<"+r+' xmlns="'+Qr+'">'+s.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function ql(e){return Or("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Co(e.Ref,{r:0,c:0})})}function Yl(e,t,n,r,s,a,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+br(Co(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Qs(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=br(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=br(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Fa[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||sn[14]);break;case"s":u="String",h=((e.v||"")+"").replace(xr,(function(e){return vr[e]})).replace(Nr,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=ml(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=i.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map((function(e){var t=Or("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Or("Comment",t,{"ss:Author":e.a})})).join("")),Or("Cell",p,o)}function Kl(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Zi(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function Gl(e,t,n){var r=[],s=n.SheetNames[e],a=n.Sheets[s],i=a?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||a.push(ql(o)))}return a.join("")}(a,0,e,n):"";return i.length>0&&r.push("<Names>"+i+"</Names>"),i=a?function(e,t){if(!e["!ref"])return"";var n=ta(e["!ref"]),r=e["!merges"]||[],s=0,a=[];e["!cols"]&&e["!cols"].forEach((function(e,t){Xi(e);var n=!!e.width,r=hl(t,e),s={"ss:Index":t+1};n&&(s["ss:Width"]=Ki(r.width)),e.hidden&&(s["ss:Hidden"]="1"),a.push(Or("Column",null,s))}));for(var i=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[Kl(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var d=!1;for(s=0;s!=r.length;++s)if(!(r[s].s.c>c)&&!(r[s].s.r>o)&&!(r[s].e.c<c)&&!(r[s].e.r<o)){r[s].s.c==c&&r[s].s.r==o||(d=!0);break}if(!d){var u={r:o,c:c},h=Js(u),f=i?(e[o]||[])[c]:e[h];l.push(Yl(f,h,e,t,0,0,u))}}l.push("</Row>"),l.length>2&&a.push(l.join(""))}return a.join("")}(a,t):"",i.length>0&&r.push("<Table>"+i+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Or("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Or("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Or("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)s.push(Or("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<n&&(!r.Workbook.Sheets[a]||r.Workbook.Sheets[a].Hidden);++a);a==n&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Rr("ProtectContents","True")),e["!protect"].objects&&s.push(Rr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Rr("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||s.push(Rr("EnableSelection","UnlockedCells")):s.push(Rr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&s.push("<"+t[1]+"/>")}))),0==s.length?"":Or("WorksheetOptions",s.join(""),{xmlns:Jr})}(a,0,e,n)),r.join("")}function $l(e,t){t||(t={}),e.SSF||(e.SSF=lr(sn)),e.SSF&&(Wn(),Un(e.SSF),t.revssf=Xn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ml(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(Vl(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Or("Worksheet",Gl(r,t,e),{"ss:Name":br(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var r=[];r.push(Or("NumberFormat",null,{"ss:Format":br(sn[e.numFmtId])}));var s={"ss:ID":"s"+(21+t)};n.push(Or("Style",r.join(""),s))})),Or("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var s=t[r];null==s.Sheet&&(s.Name.match(/^_xlfn\./)||n.push(ql(s)))}return Or("Names",n.join(""))}(e),pr+Or("Workbook",n.join(""),{xmlns:Zr,"xmlns:o":Qr,"xmlns:x":Jr,"xmlns:ss":Zr,"xmlns:dt":es,"xmlns:html":rs})}var Xl="e0859ff2f94f6810ab9108002b27b3d9",Ql="02d5cdd59c2e1b10939708002b2cf9ae",Jl="05d5cdd59c2e1b10939708002b2cf9ae";function Zl(e,t){var n=t||{},r=Hn.utils.cfb_new({root:"R"}),s="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":s="/Workbook",n.biff=8;break;case"biff5":s="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Hn.utils.cfb_add(r,s,dc(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],s=[],a=[],i=0,o=Gn(Pa,"n"),l=Gn(Oa,"n");if(e.Props)for(n=Kn(e.Props),i=0;i<n.length;++i)(Object.prototype.hasOwnProperty.call(o,n[i])?r:Object.prototype.hasOwnProperty.call(l,n[i])?s:a).push([n[i],e.Props[n[i]]]);if(e.Custprops)for(n=Kn(e.Custprops),i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},n[i])||(Object.prototype.hasOwnProperty.call(o,n[i])?r:Object.prototype.hasOwnProperty.call(l,n[i])?s:a).push([n[i],e.Custprops[n[i]]]);var c=[];for(i=0;i<a.length;++i)ri.indexOf(a[i][0])>-1||Ja.indexOf(a[i][0])>-1||null!=a[i][1]&&c.push(a[i]);s.length&&Hn.utils.cfb_add(t,"/\x05SummaryInformation",ii(s,Xl,l,Oa)),(r.length||c.length)&&Hn.utils.cfb_add(t,"/\x05DocumentSummaryInformation",ii(r,Ql,o,Pa,c.length?c:null,Jl))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(n,r){if(0!=r){var s=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==s.slice(-1)&&Hn.utils.cfb_add(e,s,t.FileIndex[r].content)}}))}(r,Hn.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var ec={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=r,7&a&&(n.level=7&a),16&a&&(n.hidden=!0),32&a&&(n.hpt=s/20),n}},1:{f:function(e){return[ma(e)]}},2:{f:function(e){return[ma(e),Sa(e),"n"]}},3:{f:function(e){return[ma(e),e.read_shift(1),"e"]}},4:{f:function(e){return[ma(e),e.read_shift(1),"b"]}},5:{f:function(e){return[ma(e),Aa(e),"n"]}},6:{f:function(e){return[ma(e),la(e),"str"]}},7:{f:function(e){return[ma(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,s=ma(e);s.r=n["!row"];var a=[s,la(e),"str"];if(n.cellFormula){e.l+=2;var i=sl(e,r-e.l,n);a[3]=el(i,0,s,n.supbooks,n)}else e.l=r;return a}},9:{f:function(e,t,n){var r=e.l+t,s=ma(e);s.r=n["!row"];var a=[s,Aa(e),"n"];if(n.cellFormula){e.l+=2;var i=sl(e,r-e.l,n);a[3]=el(i,0,s,n.supbooks,n)}else e.l=r;return a}},10:{f:function(e,t,n){var r=e.l+t,s=ma(e);s.r=n["!row"];var a=[s,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var i=sl(e,r-e.l,n);a[3]=el(i,0,s,n.supbooks,n)}else e.l=r;return a}},11:{f:function(e,t,n){var r=e.l+t,s=ma(e);s.r=n["!row"];var a=[s,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var i=sl(e,r-e.l,n);a[3]=el(i,0,s,n.supbooks,n)}else e.l=r;return a}},12:{f:function(e){return[ga(e)]}},13:{f:function(e){return[ga(e),Sa(e),"n"]}},14:{f:function(e){return[ga(e),e.read_shift(1),"e"]}},15:{f:function(e){return[ga(e),e.read_shift(1),"b"]}},16:{f:kl},17:{f:function(e){return[ga(e),la(e),"str"]}},18:{f:function(e){return[ga(e),e.read_shift(4),"s"]}},19:{f:ua},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Na(e),i=al(e,0,n),o=ba(e);e.l=r;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var s=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var a=e.read_shift(1);0!=a&&(r.underline=a);var i=e.read_shift(1);i>0&&(r.family=i);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=La[r];l&&(t.rgb=qi(l));break;case 2:t.rgb=qi([a,i,o]);break;case 3:t.theme=r}return 0!=s&&(t.tint=s>0?s/32767:s/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=la(e),r}},44:{f:function(e,t){return[e.read_shift(2),la(e)]}},45:{f:ao},46:{f:co},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),s=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:s}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ii},62:{f:function(e){return[ma(e),ua(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Js(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Us,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=xa(e,t-19),n}},148:{f:wl,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var s=t>8?la(e):"";return s.length>0&&(n.CodeName=s),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=ka(e,t-8),n.name=la(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Ea},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_l},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:la(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ka},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ei},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,s=Ca(e),a=e.read_shift(1),i=[s];if(i[2]=a,n.cellFormula){var o=rl(e,r-e.l,n);i[1]=o}else e.l=r;return i}},427:{f:function(e,t,n){var r=e.l+t,s=[Ea(e,16)];if(n.cellFormula){var a=il(e,r-e.l,n);s[1]=a,e.l=r}else e.l=r;return s}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Tl.forEach((function(n){t[n]=Aa(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=Ea(e,16),s=ba(e),a=la(e),i=la(e),o=la(e);e.l=n;var l={rfx:r,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ka},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:No},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=Ea(e,16);return t.rfx=n.s,t.ref=Js(n.s),e.l+=16,t}},636:{T:-1},637:{f:ha},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:la(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function tc(e,t,n,r){var s=t;if(!isNaN(s)){var a=r||(n||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&_s(n)&&e.push(n)}}function nc(e,t,n){return e||(e=Ws(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function rc(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var s="d"==t.t?Jn(ir(t.v)):t.v;return void(s==(0|s)&&s>=0&&s<65536?tc(e,2,function(e,t,n){var r=Ws(9);return nc(r,e,t),r.write_shift(2,n),r}(n,r,s)):tc(e,3,function(e,t,n){var r=Ws(15);return nc(r,e,t),r.write_shift(8,n,"f"),r}(n,r,s)));case"b":case"e":return void tc(e,5,function(e,t,n,r){var s=Ws(9);return nc(s,e,t),ui(n,r||"b",s),s}(n,r,t.v,t.t));case"s":case"str":return void tc(e,4,function(e,t,n){var r=Ws(8+2*n.length);return nc(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}tc(e,1,nc(null,n,r))}function sc(e,t){var n=t||{};for(var r=zs(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==n.sheet&&(s=a);if(0==s&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return tc(r,4==n.biff?1033:3==n.biff?521:9,_i(0,16,n)),function(e,t,n,r){var s,a=Array.isArray(t),i=ta(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=ea(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Gs(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=Xs(d)),s=l[d]+o;var u=a?(t[c]||[])[d]:t[s];u&&rc(e,u,c,d)}}}(r,e.Sheets[e.SheetNames[s]],0,n),tc(r,10),r.end()}function ac(e,t,n){tc(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,s=Ws(r?15+n.length:16+2*n.length);return s.write_shift(2,20*(e.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function ic(e,t){if(t){var n=0;t.forEach((function(t,r){++n<=256&&t&&tc(e,125,function(e,t){var n=Ws(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(hl(r,t),r))}))}}function oc(e,t,n,r,s){var a=16+ml(s.cellXfs,t,s);if(null!=t.v||t.bf)if(t.bf)tc(e,6,tl(t,n,r,0,a));else switch(t.t){case"d":case"n":tc(e,515,function(e,t,n,r){var s=Ws(14);return bi(e,t,r,s),Ia(n,s),s}(n,r,"d"==t.t?Jn(ir(t.v)):t.v,a));break;case"b":case"e":tc(e,517,function(e,t,n,r,s,a){var i=Ws(8);return bi(e,t,r,i),ui(n,a,i),i}(n,r,t.v,a,0,t.t));break;case"s":case"str":if(s.bookSST)tc(e,253,function(e,t,n,r){var s=Ws(10);return bi(e,t,r,s),s.write_shift(4,n),s}(n,r,ul(s.Strings,t.v,s.revStrings),a));else tc(e,516,function(e,t,n,r,s){var a=!s||8==s.biff,i=Ws(+a+8+(1+a)*n.length);return bi(e,t,r,i),i.write_shift(2,n.length),a&&i.write_shift(1,1),i.write_shift((1+a)*n.length,n,a?"utf16le":"sbcs"),i}(n,r,(t.v||"").slice(0,255),a,s));break;default:tc(e,513,bi(n,r,a))}else tc(e,513,bi(n,r,a))}function lc(e,t,n){var r,s=zs(),a=n.SheetNames[e],i=n.Sheets[a]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=8==t.biff,u="",h=[],f=ta(i["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}tc(s,2057,_i(0,16,t)),tc(s,13,di(1)),tc(s,12,di(100)),tc(s,15,li(!0)),tc(s,17,li(!1)),tc(s,16,Ia(.001)),tc(s,95,li(!0)),tc(s,42,li(!1)),tc(s,43,li(!1)),tc(s,130,di(1)),tc(s,128,function(e){var t=Ws(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),tc(s,131,li(!1)),tc(s,132,li(!1)),d&&ic(s,i["!cols"]),tc(s,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=Ws(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),d&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){u=Gs(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=Xs(g)),r=h[g]+u;var v=c?(i[p]||[])[g]:i[r];v&&(oc(s,v,p,g,t),d&&v.l&&i["!links"].push([r,v.l]))}}var x=l.CodeName||l.name||a;return d&&tc(s,574,function(e){var t=Ws(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&tc(s,229,function(e){var t=Ws(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)ki(e[n],t);return t}(i["!merges"])),d&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];tc(e,440,ji(r)),r[1].Tooltip&&tc(e,2048,Ai(r))}delete t["!links"]}(s,i),tc(s,442,vi(x)),d&&function(e,t){var n=Ws(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),tc(e,2151,n),(n=Ws(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),ki(ta(t["!ref"]||"A1"),n),n.write_shift(4,4),tc(e,2152,n)}(s,i),tc(s,10),s.end()}function cc(e,t,n){var r=zs(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=8==n.biff,l=5==n.biff;(tc(r,2057,_i(0,5,n)),"xla"==n.bookType&&tc(r,135),tc(r,225,o?di(1200):null),tc(r,193,function(e,t){t||(t=Ws(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&tc(r,191),l&&tc(r,192),tc(r,226),tc(r,92,function(e,t){var n=!t||8==t.biff,r=Ws(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),tc(r,66,di(o?1200:1252)),o&&tc(r,353,di(0)),o&&tc(r,448),tc(r,317,function(e){for(var t=Ws(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&tc(r,211),o&&e.vbaraw)&&tc(r,442,vi(i.CodeName||"ThisWorkbook"));tc(r,156,di(17)),tc(r,25,li(!1)),tc(r,18,li(!1)),tc(r,19,di(0)),o&&tc(r,431,li(!1)),o&&tc(r,444,di(0)),tc(r,61,function(){var e=Ws(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),tc(r,64,li(!1)),tc(r,141,di(0)),tc(r,34,li("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&_r(e.Workbook.WBProps.date1904)?"true":"false"}(e))),tc(r,14,li(!0)),o&&tc(r,439,li(!1)),tc(r,218,di(0)),ac(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var s=r[0];s<=r[1];++s)null!=t[s]&&tc(e,1054,Ti(s,t[s],n))}))}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)tc(e,224,Ci({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(n){tc(e,224,Ci(n,0,t))}))}(r,n),o&&tc(r,352,li(!1));var c,d=r.end(),u=zs();o&&tc(u,140,(c||(c=Ws(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var s=r||(n||[]).length||0;if(s<=8224)return tc(e,t,n,s);var a=t;if(!isNaN(a)){for(var i=n.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<s;){for((d=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;d.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(u,252,function(e){var t=Ws(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=fi(e[r]);var s=Yt([t].concat(n));return s.parts=[t.length].concat(n.map((function(e){return e.length}))),s}(n.Strings)),tc(u,10);var h=u.end(),f=zs(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=d.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){tc(f,133,Si({pos:g,hs:(a[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},n)),g+=t[p].length}var v=f.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var x=[];return d.length&&x.push(d),v.length&&x.push(v),h.length&&x.push(h),Yt(x)}function dc(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])Zs(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var s=t||{};switch(s.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=lr(sn)),e&&e.SSF&&(Wn(),Un(e.SSF),n.revssf=Xn(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Wc(n),n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=lc(s,n,e);return r.unshift(cc(e,r,n)),Yt(r)}(e,t);case 4:case 3:case 2:return sc(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function uc(e,t,n,r){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>n||s[c].s.c>i)&&!(s[c].e.r<n||s[c].e.c<i)){if(s[c].s.r<n||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var d=Js({r:n,c:i}),u=r.dense?(e[n]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||kr(u.w||(ra(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+d,a.push(Or("td",h,f))}}return"<tr>"+a.join("")+"</tr>"}var hc='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fc="</body></html>";function mc(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function pc(e,t){var n=t||{},r=null!=n.header?n.header:hc,s=null!=n.footer?n.footer:fc,a=[r],i=Zs(e["!ref"]);n.dense=Array.isArray(e),a.push(mc(0,0,n));for(var o=i.s.r;o<=i.e.r;++o)a.push(uc(e,i,o,n));return a.push("</table>"+s),a.join("")}function gc(e,t,n){var r=n||{};var s=0,a=0;if(null!=r.origin)if("number"==typeof r.origin)s=r.origin;else{var i="string"==typeof r.origin?Qs(r.origin):r.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=Zs(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==s&&(c.e.r=s=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var b=o[m];if(xc(b)){if(r.display)continue;f[p]={hidden:!0}}var w=b.children;for(g=v=0;g<w.length;++g){var N=w[g];if(!r.display||!xc(N)){var k=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Ir(N.innerHTML),_=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<u.length;++h){var S=u[h];S.s.c==v+a&&S.s.r<p+s&&p+s<=S.e.r&&(v=S.e.c+1-a,h=-1)}y=+N.getAttribute("colspan")||1,((x=+N.getAttribute("rowspan")||1)>1||y>1)&&u.push({s:{r:p+s,c:v+a},e:{r:p+s+(x||1)-1,c:v+a+(y||1)-1}});var T={t:"s",v:k},C=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=k&&(0==k.length?T.t=C||"z":r.raw||0==k.trim().length||"s"==C||("TRUE"===k?T={t:"b",v:!0}:"FALSE"===k?T={t:"b",v:!1}:isNaN(dr(k))?isNaN(hr(k).getDate())||(T={t:"d",v:ir(k)},r.cellDates||(T={t:"n",v:Jn(T.v)}),T.z=r.dateNF||sn[14]):T={t:"n",v:dr(k)})),void 0===T.z&&null!=_&&(T.z=_);var E="",j=N.getElementsByTagName("A");if(j&&j.length)for(var A=0;A<j.length&&(!j[A].hasAttribute("href")||"#"==(E=j[A].getAttribute("href")).charAt(0));++A);E&&"#"!=E.charAt(0)&&(T.l={Target:E}),r.dense?(e[p+s]||(e[p+s]=[]),e[p+s][v+a]=T):e[Js({c:v+a,r:p+s})]=T,c.e.c<v+a&&(c.e.c=v+a),v+=y}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+s),e["!ref"]=ea(c),p>=l&&(e["!fullref"]=ea((c.e.r=o.length-m+p-1+s,c))),e}function vc(e,t){return gc((t||{}).dense?[]:{},e,t)}function xc(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var yc=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Pr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+t}}(),bc=function(){var e="          <table:table-cell />\n",t=function(t,n,r){var s=[];s.push('      <table:table table:name="'+br(n.SheetNames[r])+'" table:style-name="ta1">\n');var a=0,i=0,o=Zs(t["!ref"]||"A1"),l=t["!merges"]||[],c=0,d=Array.isArray(t);if(t["!cols"])for(i=0;i<=o.e.c;++i)s.push("        <table:table-column"+(t["!cols"][i]?' table:style-name="co'+t["!cols"][i].ods+'"':"")+"></table:table-column>\n");var u="",h=t["!rows"]||[];for(a=0;a<o.s.r;++a)u=h[a]?' table:style-name="ro'+h[a].ods+'"':"",s.push("        <table:table-row"+u+"></table:table-row>\n");for(;a<=o.e.r;++a){for(u=h[a]?' table:style-name="ro'+h[a].ods+'"':"",s.push("        <table:table-row"+u+">\n"),i=0;i<o.s.c;++i)s.push(e);for(;i<=o.e.c;++i){var f=!1,m={},p="";for(c=0;c!=l.length;++c)if(!(l[c].s.c>i)&&!(l[c].s.r>a)&&!(l[c].e.c<i)&&!(l[c].e.r<a)){l[c].s.c==i&&l[c].s.r==a||(f=!0),m["table:number-columns-spanned"]=l[c].e.c-l[c].s.c+1,m["table:number-rows-spanned"]=l[c].e.r-l[c].s.r+1;break}if(f)s.push("          <table:covered-table-cell/>\n");else{var g=Js({r:a,c:i}),v=d?(t[a]||[])[i]:t[g];if(v&&v.f&&(m["table:formula"]=br(("of:="+v.f.replace(To,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,g.length)==g)){var x=Zs(v.F);m["table:number-matrix-columns-spanned"]=x.e.c-x.s.c+1,m["table:number-matrix-rows-spanned"]=x.e.r-x.s.r+1}if(v){switch(v.t){case"b":p=v.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=v.v?"true":"false";break;case"n":p=v.w||String(v.v||0),m["office:value-type"]="float",m["office:value"]=v.v||0;break;case"s":case"str":p=null==v.v?"":v.v,m["office:value-type"]="string";break;case"d":p=v.w||ir(v.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=ir(v.v).toISOString(),m["table:style-name"]="ce1";break;default:s.push(e);continue}var y=br(p).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var b=v.l.Target;"#"==(b="#"==b.charAt(0)?"#"+b.slice(1).replace(/\./,"!"):b).charAt(0)||b.match(/^\w+:/)||(b="../"+b),y=Or("text:a",y,{"xlink:href":b.replace(/&/g,"&amp;")})}s.push("          "+Or("table:table-cell",Or("text:p",y,{}),m)+"\n")}else s.push(e)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,n){var r=[pr],s=Pr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),a=Pr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==n.bookType?(r.push("<office:document"+s+a+">\n"),r.push(Ka().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+s+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var s=t["!cols"][r];if(null==s.width&&null==s.wpx&&null==s.wch)continue;Xi(s),s.ods=n;var a=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+a+'"/>\n'),e.push("  </style:style>\n"),++n}}));var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var s=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)r.push(t(e.Sheets[e.SheetNames[i]],e,i));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==n.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function wc(e,t){if("fods"==t.bookType)return bc(e,t);var n=mr(),r="",s=[],a=[];return fr(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),fr(n,r="content.xml",bc(e,t)),s.push([r,"text/xml"]),a.push([r,"ContentFile"]),fr(n,r="styles.xml",yc(e,t)),s.push([r,"text/xml"]),a.push([r,"StylesFile"]),fr(n,r="meta.xml",pr+Ka()),s.push([r,"text/xml"]),a.push([r,"MetadataFile"]),fr(n,r="manifest.rdf",function(e){var t,n,r=[pr];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var s=0;s!=e.length;++s)r.push(Ya(e[s][0],e[s][1])),r.push((t="",n=e[s][0],['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+'"/>\n',"  </rdf:Description>\n"].join("")));return r.push(Ya("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(a)),s.push([r,"application/rdf+xml"]),fr(n,r="META-INF/manifest.xml",function(e){var t=[pr];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(s)),n}function Nc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kc(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Ht(Ar(e))}function _c(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function Sc(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function Tc(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Cc(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function Ec(e){for(var t=[],n=[0];n[0]<e.length;){var r,s=n[0],a=Sc(e,n),i=7&a,o=0;if(0==(a=Math.floor(a/8)))break;switch(i){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Sc(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(s))}var c={data:r,type:i};null==t[a]?t[a]=[c]:t[a].push(c)}return t}function jc(e){var t=[];return e.forEach((function(e,n){e.forEach((function(e){e.data&&(t.push(Tc(8*n+e.type)),2==e.type&&t.push(Tc(e.data.length)),t.push(e.data))}))})),_c(t)}function Ac(e){for(var t,n=[],r=[0];r[0]<e.length;){var s=Sc(e,r),a=Ec(e.slice(r[0],r[0]+s));r[0]+=s;var i={id:Cc(a[1][0].data),messages:[]};a[2].forEach((function(t){var n=Ec(t.data),s=Cc(n[3][0].data);i.messages.push({meta:n,data:e.slice(r[0],r[0]+s)}),r[0]+=s})),(null==(t=a[3])?void 0:t[0])&&(i.merge=Cc(a[3][0].data)>>>0>0),n.push(i)}return n}function Ic(e){var t=[];return e.forEach((function(e){var n=[];n[1]=[{data:Tc(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:Tc(+!!e.merge),type:0}]);var r=[];e.messages.forEach((function(e){r.push(e.data),e.meta[3]=[{type:0,data:Tc(e.data.length)}],n[2].push({data:jc(e.meta),type:2})}));var s=jc(n);t.push(Tc(s.length)),t.push(s),r.forEach((function(e){return t.push(e)}))})),_c(t)}function Dc(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Sc(t,n),s=[];n[0]<t.length;){var a=3&t[n[0]];if(0!=a){var i=0,o=0;if(1==a?(o=4+(t[n[0]]>>2&7),i=(224&t[n[0]++])<<3,i|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==a?(i=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(i=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),s=[_c(s)],0==i)throw new Error("Invalid offset 0");if(i>s[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(s.push(s[0].slice(-i)),o-=i;o>=s[s.length-1].length;)s.push(s[s.length-1]),o-=s[s.length-1].length;s.push(s[0].slice(-i,-i+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}s.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var d=_c(s);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Rc(e){for(var t=[],n=0;n<e.length;){var r=e[n++],s=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(Dc(r,e.slice(n,n+s))),n+=s}if(n!==e.length)throw new Error("data is not a valid framed stream!");return _c(t)}function Pc(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),s=new Uint8Array(4);t.push(s);var a=Tc(r),i=a.length;t.push(a),r<=60?(i++,t.push(new Uint8Array([r-1<<2]))):r<=256?(i+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(i+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(i+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(i+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),i+=r,s[0]=0,s[1]=255&i,s[2]=i>>8&255,s[3]=i>>16&255,n+=r}return _c(t)}function Oc(e,t){var n=new Uint8Array(32),r=Nc(n),s=12,a=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,s=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=255&s;e[t+15]|=n>=0?0:128}(n,s,e.v),a|=1,s+=16;break;case"b":n[1]=6,r.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,a,!0),n.slice(0,s)}function Mc(e,t){var n=new Uint8Array(32),r=Nc(n),s=12,a=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":n[2]=6,r.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,a,!0),n.slice(0,s)}function Lc(e){return Sc(Ec(e)[1][0].data)}function Fc(e,t,n){var r,s,a,i;if(!(null==(r=e[6])?void 0:r[0])||!(null==(s=e[7])?void 0:s[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(a=e[8])?void 0:a[0])?void 0:i.data)&&Cc(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Nc(e[7][0].data),c=0,d=[],u=Nc(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),u.setUint16(2*m,h,!0),typeof t[m]){case"string":p=Oc({t:"s",v:t[m]},n),g=Mc({t:"s",v:t[m]},n);break;case"number":p=Oc({t:"n",v:t[m]},n),g=Mc({t:"n",v:t[m]},n);break;case"boolean":p=Oc({t:"b",v:t[m]},n),g=Mc({t:"b",v:t[m]},n);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),c+=p.length,f.push(g),h+=g.length,++o}else l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535);for(e[2][0].data=Tc(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535,!0);return e[6][0].data=_c(d),e[3][0].data=_c(f),o}function Uc(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function Wc(e){Uc([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zc(e,t){return"ods"==t.bookType?wc(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Zs(n["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ea(r)));var a=Qc(n,{range:r,header:1}),i=["~Sh33tJ5~"];a.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&i.push(e)}))}));var o={},l=[],c=Hn.read(t.numbers,{type:"base64"});c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&Ac(Rc(t.content)).forEach((function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:Cc(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var d=l.filter((function(e){return e>1})).map((function(e){return[e,Tc(e)]}));c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Ac(Rc(t.content)).forEach((function(e){e.messages.forEach((function(t){d.forEach((function(t){e.messages.some((function(e){return 11006!=Cc(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])}))&&o[t[0]].deps.push(e.id)}))}))}))}));for(var u,h=Hn.find(c,o[1].location),f=Ac(Rc(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(u=p)}var g=Lc(Ec(u.messages[0].data)[1][0].data);for(f=Ac(Rc((h=Hn.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Lc(Ec(u.messages[0].data)[2][0].data),f=Ac(Rc((h=Hn.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Lc(Ec(u.messages[0].data)[2][0].data),f=Ac(Rc((h=Hn.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);var v=Ec(u.messages[0].data);v[6][0].data=Tc(r.e.r+1),v[7][0].data=Tc(r.e.c+1);for(var x=Lc(v[46][0].data),y=Hn.find(c,o[x].location),b=Ac(Rc(y.content)),w=0;w<b.length&&b[w].id!=x;++w);if(b[w].id!=x)throw"Bad ColumnRowUIDMapArchive";var N=Ec(b[w].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var k=0;k<=r.e.c;++k){var _=[];_[1]=_[2]=[{type:0,data:Tc(k+420690)}],N[1].push({type:2,data:jc(_)}),N[2].push({type:0,data:Tc(k)}),N[3].push({type:0,data:Tc(k)})}N[4]=[],N[5]=[],N[6]=[];for(var S=0;S<=r.e.r;++S)(_=[])[1]=_[2]=[{type:0,data:Tc(S+726270)}],N[4].push({type:2,data:jc(_)}),N[5].push({type:0,data:Tc(S)}),N[6].push({type:0,data:Tc(S)});b[w].messages[0].data=jc(N),y.content=Pc(Ic(b)),y.size=y.content.length,delete v[46];var T=Ec(v[4][0].data);T[7][0].data=Tc(r.e.r+1);var C=Lc(Ec(T[1][0].data)[2][0].data);if((b=Ac(Rc((y=Hn.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var E=Ec(b[0].messages[0].data);for(S=0;S<a.length;++S){var j=Ec(E[2][0].data);j[1][0].data=Tc(S),j[4][0].data=Tc(a[S].length),E[2][S]={type:E[2][0].type,data:jc(j)}}b[0].messages[0].data=jc(E),y.content=Pc(Ic(b)),y.size=y.content.length;var A=Lc(T[2][0].data);if((b=Ac(Rc((y=Hn.find(c,o[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";for(E=Ec(b[0].messages[0].data),k=0;k<=r.e.c;++k)(j=Ec(E[2][0].data))[1][0].data=Tc(k),j[4][0].data=Tc(r.e.r+1),E[2][k]={type:E[2][0].type,data:jc(j)};b[0].messages[0].data=jc(E),y.content=Pc(Ic(b)),y.size=y.content.length;var I=Lc(T[4][0].data);!function(){for(var e,t=Hn.find(c,o[I].location),n=Ac(Rc(t.content)),r=0;r<n.length;++r){var s=n[r];s.id==I&&(e=s)}var a=Ec(e.messages[0].data);a[3]=[];var l=[];i.forEach((function(e,t){l[1]=[{type:0,data:Tc(t)}],l[2]=[{type:0,data:Tc(1)}],l[3]=[{type:2,data:kc(e)}],a[3].push({type:2,data:jc(l)})})),e.messages[0].data=jc(a);var d=Pc(Ic(n));t.content=d,t.size=t.content.length}();var D=Ec(T[3][0].data),R=D[1][0];delete D[2];var P=Ec(R.data),O=Lc(P[2][0].data);!function(){for(var e,t=Hn.find(c,o[O].location),n=Ac(Rc(t.content)),s=0;s<n.length;++s){var l=n[s];l.id==O&&(e=l)}var d=Ec(e.messages[0].data);delete d[6],delete D[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var h=0,f=0;f<=r.e.r;++f){var m=Ec(u);h+=Fc(m,a[f],i),m[1][0].data=Tc(f),d[5].push({data:jc(m),type:2})}d[1]=[{type:0,data:Tc(r.e.c+1)}],d[2]=[{type:0,data:Tc(r.e.r+1)}],d[3]=[{type:0,data:Tc(h)}],d[4]=[{type:0,data:Tc(r.e.r+1)}],e.messages[0].data=jc(d);var p=Pc(Ic(n));t.content=p,t.size=t.content.length}(),R.data=jc(P),T[3][0].data=jc(D),v[4][0].data=jc(T),u.messages[0].data=jc(v);var M=Pc(Ic(f));return h.content=M,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){xo=1024,e&&!e.SSF&&(e.SSF=lr(sn));e&&e.SSF&&(Wn(),Un(e.SSF),t.revssf=Xn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=_o.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Wc(t=t||{});var a=mr(),i="",o=0;t.cellXfs=[],ml(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(fr(a,i="docProps/core.xml",Xa(e.Props,t)),s.coreprops.push(i),qa(t.rels,2,i,Ba.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,fr(a,i,Za(e.Props)),s.extprops.push(i),qa(t.rels,3,i,Ba.EXT_PROPS),e.Custprops!==e.Props&&Kn(e.Custprops||{}).length>0&&(fr(a,i="docProps/custom.xml",ei(e.Custprops)),s.custprops.push(i),qa(t.rels,4,i,Ba.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];(u||{})["!type"];if(fr(a,i="xl/worksheets/sheet"+o+"."+n,Bl(o-1,i,t,e,d)),s.sheets.push(i),qa(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Ba.WS[0]),u){var h=u["!comments"],f=!1,m="";h&&h.length>0&&(fr(a,m="xl/comments"+o+"."+n,Hl(h,m,t)),s.comments.push(m),qa(d,-1,"../comments"+o+"."+n,Ba.CMNT),f=!0),u["!legacy"]&&f&&fr(a,"xl/drawings/vmlDrawing"+o+".vml",yo(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&fr(a,Ha(i),Va(d))}null!=t.Strings&&t.Strings.length>0&&(fr(a,i="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?zi:Ui)(e,n)}(t.Strings,i,t)),s.strs.push(i),qa(t.wbrels,-1,"sharedStrings."+n,Ba.SST));fr(a,i="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?zl:Ul)(e,n)}(e,i,t)),s.workbooks.push(i),qa(t.rels,1,i,Ba.WB),fr(a,i="xl/theme/theme1.xml",po(e.Themes,t)),s.themes.push(i),qa(t.wbrels,-1,"theme/theme1.xml",Ba.THEME),fr(a,i="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?mo:eo)(e,n)}(e,i,t)),s.styles.push(i),qa(t.wbrels,-1,"styles."+n,Ba.STY),e.vbaraw&&r&&(fr(a,i="xl/vbaProject.bin",e.vbaraw),s.vba.push(i),qa(t.wbrels,-1,"vbaProject.bin",Ba.VBA));return fr(a,i="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?go:vo)()}(i)),s.metadata.push(i),qa(t.wbrels,-1,"metadata."+n,Ba.XLMETA),fr(a,"[Content_Types].xml",za(s,t)),fr(a,"_rels/.rels",Va(t.rels)),fr(a,"xl/_rels/workbook."+n+".rels",Va(t.wbrels)),delete t.revssf,delete t.ssf,a}(e,t):Bc(e,t)}function Bc(e,t){xo=1024,e&&!e.SSF&&(e.SSF=lr(sn)),e&&e.SSF&&(Wn(),Un(e.SSF),t.revssf=Xn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=_o.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Wc(t=t||{});var a=mr(),i="",o=0;if(t.cellXfs=[],ml(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),fr(a,i="docProps/core.xml",Xa(e.Props,t)),s.coreprops.push(i),qa(t.rels,2,i,Ba.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,fr(a,i,Za(e.Props)),s.extprops.push(i),qa(t.rels,3,i,Ba.EXT_PROPS),e.Custprops!==e.Props&&Kn(e.Custprops||{}).length>0&&(fr(a,i="docProps/custom.xml",ei(e.Custprops)),s.custprops.push(i),qa(t.rels,4,i,Ba.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(fr(a,i="xl/worksheets/sheet"+o+"."+n,yl(o-1,t,e,u)),s.sheets.push(i),qa(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Ba.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach((function(e){e[1].forEach((function(e){1==e.T&&(g=!0)}))})),g&&(fr(a,p="xl/threadedComments/threadedComment"+o+"."+n,wo(f,d,t)),s.threadedcomments.push(p),qa(u,-1,"../threadedComments/threadedComment"+o+"."+n,Ba.TCMNT)),fr(a,p="xl/comments"+o+"."+n,bo(f)),s.comments.push(p),qa(u,-1,"../comments"+o+"."+n,Ba.CMNT),m=!0}h["!legacy"]&&m&&fr(a,"xl/drawings/vmlDrawing"+o+".vml",yo(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&fr(a,Ha(i),Va(u))}return null!=t.Strings&&t.Strings.length>0&&(fr(a,i="xl/sharedStrings."+n,Ui(t.Strings,t)),s.strs.push(i),qa(t.wbrels,-1,"sharedStrings."+n,Ba.SST)),fr(a,i="xl/workbook."+n,Ul(e)),s.workbooks.push(i),qa(t.rels,1,i,Ba.WB),fr(a,i="xl/theme/theme1.xml",po(e.Themes,t)),s.themes.push(i),qa(t.wbrels,-1,"theme/theme1.xml",Ba.THEME),fr(a,i="xl/styles."+n,eo(e,t)),s.styles.push(i),qa(t.wbrels,-1,"styles."+n,Ba.STY),e.vbaraw&&r&&(fr(a,i="xl/vbaProject.bin",e.vbaraw),s.vba.push(i),qa(t.wbrels,-1,"vbaProject.bin",Ba.VBA)),fr(a,i="xl/metadata."+n,vo()),s.metadata.push(i),qa(t.wbrels,-1,"metadata."+n,Ba.XLMETA),d.length>1&&(fr(a,i="xl/persons/person.xml",function(e){var t=[pr,Or("personList",null,{xmlns:Br,"xmlns:x":Xr[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,n){t.push(Or("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(d)),s.people.push(i),qa(t.wbrels,-1,"persons/person.xml",Ba.PEOPLE)),fr(a,"[Content_Types].xml",za(s,t)),fr(a,"_rels/.rels",Va(t.rels)),fr(a,"xl/_rels/workbook.xml.rels",Va(t.wbrels)),delete t.revssf,delete t.ssf,a}function Hc(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Ft(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Vc(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Yn(t.file,Hn.write(e,{type:Ut?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Hn.write(e,t)}function qc(e,t){var n={},r=Ut?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Hn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof s){if("binary"==t.type||"base64"==t.type)return s;s=new Uint8Array(Vt(s))}return t.password&&"undefined"!==typeof encrypt_agile?Vc(encrypt_agile(s,t.password),t):"file"===t.type?Yn(t.file,s):"string"==t.type?jr(s):s}function Yc(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Lt(Ar(r));case"binary":return Ar(r);case"string":return e;case"file":return Yn(t.file,r,"utf8");case"buffer":return Ut?Wt(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):Yc(r,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function Kc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Lt(n):"string"==t.type?jr(n):n;case"file":return Yn(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Gc(e,t){It(),Fl(e);var n=lr(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=Gc(e,n);return n.type="array",Vt(r)}var s=0;if(n.sheet&&(s="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Yc($l(e,n),n);case"slk":case"sylk":return Yc(Ri.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"htm":case"html":return Yc(pc(e.Sheets[e.SheetNames[s]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Lt(e);case"binary":case"string":return e;case"file":return Yn(t.file,e,"binary");case"buffer":return Ut?Wt(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(td(e.Sheets[e.SheetNames[s]],n),n);case"csv":return Yc(ed(e.Sheets[e.SheetNames[s]],n),n,"\ufeff");case"dif":return Yc(Pi.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"dbf":return Kc(Di.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"prn":return Yc(Mi.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"rtf":return Yc(Vi.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"eth":return Yc(Oi.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"fods":return Yc(wc(e,n),n);case"wk1":return Kc(Li.sheet_to_wk1(e.Sheets[e.SheetNames[s]],n),n);case"wk3":return Kc(Li.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Kc(dc(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return Vc(Zl(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=lr(t||{});return qc(zc(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function $c(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Xc(e,t,n,r,s,a,i,o){var l=Gs(n),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===s?[]:{};if(1!==s)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(g){h.__rowNum__=n}else h.__rowNum__=n;if(!i||e[n])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[n][f]:e[r[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=a[f]){if(null==p)if("e"==m.t&&null===p)h[a[f]]=null;else if(void 0!==c)h[a[f]]=c;else{if(!d||null!==p)continue;h[a[f]]=null}else h[a[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:ra(m,p,o);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=a[f]&&(h[a[f]]=c)}}return{row:h,isempty:u}}function Qc(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof d){case"string":l=ta(d);break;case"number":(l=ta(e["!ref"])).s.r=d;break;default:l=d}r>0&&(s=0);var u=Gs(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),v=l.s.r,x=0,y={};g&&!e[v]&&(e[v]=[]);var b=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(b[x]||{}).hidden)switch(h[x]=Xs(x),n=g?e[v][x]:e[h[x]+u],r){case 1:a[x]=x-l.s.c;break;case 2:a[x]=h[x];break;case 3:a[x]=c.header[x-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=i=ra(n,null,c),p=y[i]||0){do{o=i+"_"+p++}while(y[o]);y[i]=p,y[o]=1}else y[i]=1;a[x]=o}for(v=l.s.r+s;v<=l.e.r;++v)if(!(w[v]||{}).hidden){var N=Xc(e,l,v,h,r,a,g,c);(!1===N.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[m++]=N.row)}return f.length=m,f}var Jc=/"/g;function Zc(e,t,n,r,s,a,i,o){for(var l=!0,c=[],d="",u=Gs(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=o.dense?(e[n]||[])[h]:e[r[h]+u];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(o.rawNumbers&&"n"==f.t?f.v:ra(f,null,o));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===s||p===a||34===p||o.forceQuotes){d='"'+d.replace(Jc,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(Jc,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}function ed(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var s=ta(e["!ref"]),a=void 0!==r.FS?r.FS:",",i=a.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),d="",u=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(h[m]||{}).hidden||(u[m]=Xs(m));for(var p=0,g=s.s.r;g<=s.e.r;++g)(f[g]||{}).hidden||null!=(d=Zc(e,s,g,u,i,l,a,r))&&(r.strip&&(d=d.replace(c,"")),(d||!1!==r.blankrows)&&n.push((p++?o:"")+d));return delete r.dense,n.join("")}function td(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=ed(e,t);if("undefined"==typeof Rt||"string"==t.type)return n;var r=Rt.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function nd(e,t,n){var r,s=n||{},a=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var c="string"==typeof s.origin?Qs(s.origin):s.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var u=ta(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+a)}else-1==o&&(o=0,d.e.r=t.length-1+a);var h=s.header||[],f=0;t.forEach((function(e,t){Kn(e).forEach((function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var c=e[n],d="z",u="",m=Js({c:l+f,r:o+t+a});r=rd(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",s.cellDates||(d="n",c=Jn(c)),u=s.dateNF||sn[14]):null===c&&s.nullError&&(d="e",c=0),r?(r.t=d,r.v=c,delete r.w,delete r.R,u&&(r.z=u)):i[m]=r={t:d,v:c},u&&(r.z=u)):i[m]=c}))})),d.e.c=Math.max(d.e.c,l+h.length-1);var m=Gs(o);if(a)for(f=0;f<h.length;++f)i[Xs(f+l)+m]={t:"s",v:h[f]};return i["!ref"]=ea(d),i}function rd(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Qs(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return rd(e,Js("number"!=typeof t?t:{r:t,c:n||0}))}function sd(){return{SheetNames:[],Sheets:{}}}function ad(e,t,n,r){var s=1;if(!n)for(;s<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+s);++s,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var a=n.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||n;for(++s;s<=65535&&-1!=e.SheetNames.indexOf(n=i+s);++s);}if(Ll(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function id(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var od={encode_col:Xs,encode_row:Gs,encode_cell:Js,encode_range:ea,decode_col:$s,decode_row:Ks,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Qs,decode_range:Zs,format_cell:ra,sheet_add_aoa:aa,sheet_add_json:nd,sheet_add_dom:gc,aoa_to_sheet:ia,json_to_sheet:function(e,t){return nd(null,e,t)},table_to_sheet:vc,table_to_book:function(e,t){return sa(vc(e,t),t)},sheet_to_csv:ed,sheet_to_txt:td,sheet_to_json:Qc,sheet_to_html:pc,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var s,a=ta(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(s=a.s.c;s<=a.e.c;++s)o[s]=Xs(s);for(var d=a.s.r;d<=a.e.r;++d)for(i=Gs(d),s=a.s.c;s<=a.e.c;++s)if(n=o[s]+i,r="",void 0!==(t=c?(e[d]||[])[s]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Qc,sheet_get_cell:rd,book_new:sd,book_append_sheet:ad,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:id,cell_set_internal_link:function(e,t,n){return id(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var s="string"!=typeof t?t:ta(t),a="string"==typeof t?t:ea(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=rd(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};_t.version;const ld=e=>{const t=e.filter((e=>{var t;const n=(0,Ze.V0)(e.currentStock,e.minimumLevel);return["out","critical","low"].includes(n)&&!(null!==(t=e.orderedStatus)&&void 0!==t&&t.isOrdered)})).map((e=>{var t;return{EAN:e.ean||"","Product Name":e.name,"Current Stock":"".concat(e.currentStock," ").concat(e.unit),Minimum:"".concat(e.minimumLevel," ").concat(e.unit),Optimal:"".concat(e.optimalLevel||2*e.minimumLevel," ").concat(e.unit),Status:(0,Ze.V0)(e.currentStock,e.minimumLevel),"Stock %":"".concat(Math.round(e.currentStock/e.minimumLevel*100),"%"),"Days Remaining":e.daysRemaining===1/0?"No data":0===e.daysRemaining?"OUT NOW":"".concat(e.daysRemaining," days"),"Avg Daily Use":null!==(t=e.forecast)&&void 0!==t&&t.averageDailyConsumption?"".concat(e.forecast.averageDailyConsumption.toFixed(1)," ").concat(e.unit,"/day"):"No data","Recommended Order":"".concat(e.recommendedOrder||0," ").concat(e.unit),"Pack Size":e.unitPackSize||1,"Packs to Order":Math.ceil((e.recommendedOrder||0)/(e.unitPackSize||1)),Frequency:e.frequency.toUpperCase(),Category:e.category,"Cost per Unit":e.cost?"\u20ac".concat(e.cost.toFixed(2)):"N/A","Total Cost":e.cost?"\u20ac".concat((e.cost*(e.recommendedOrder||0)).toFixed(2)):"N/A","Last Updated":new Date(e.lastUsed).toLocaleDateString(),Urgent:"out"===e.status?"YES":"critical"===e.status?"CRITICAL":(e.daysRemaining||0)<=3?"YES":"NO"}})),n=od.book_new(),r=od.json_to_sheet(t);r["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:12},{wch:12},{wch:10},{wch:8},{wch:12},{wch:15},{wch:15},{wch:10},{wch:12},{wch:10},{wch:15},{wch:12},{wch:12},{wch:12},{wch:8}],od.book_append_sheet(n,r,"Order List");const s=t.reduce(((e,t)=>e+(parseFloat(t["Total Cost"].replace("\u20ac",""))||0)),0),a=[{Metric:"Report Generated",Value:(new Date).toLocaleString()},{Metric:"Total Items to Order",Value:t.length},{Metric:"Out of Stock (RED)",Value:t.filter((e=>"out"===e.Status)).length},{Metric:"Critical \u226420% (ORANGE)",Value:t.filter((e=>"critical"===e.Status)).length},{Metric:"Low Stock \u226450% (YELLOW)",Value:t.filter((e=>"low"===e.Status)).length},{Metric:"Urgent Orders (\u22643 days)",Value:t.filter((e=>"YES"===e.Urgent||"CRITICAL"===e.Urgent)).length},{Metric:"Total Estimated Cost",Value:"\u20ac".concat(s.toFixed(2))},{Metric:"Daily Frequency Items",Value:t.filter((e=>"DAILY"===e.Frequency)).length},{Metric:"Weekly Frequency Items",Value:t.filter((e=>"WEEKLY"===e.Frequency)).length},{Metric:"Monthly Frequency Items",Value:t.filter((e=>"MONTHLY"===e.Frequency)).length}],i=od.json_to_sheet(a);i["!cols"]=[{wch:25},{wch:20}],od.book_append_sheet(n,i,"Summary");const o=od.json_to_sheet([{Instructions:"Color Coding Guide"},{Instructions:'Status = "out" \u2192 RED - Out of stock, order immediately'},{Instructions:'Status = "critical" \u2192 ORANGE - \u226420% of minimum, urgent order'},{Instructions:'Status = "low" \u2192 YELLOW - \u226450% of minimum, order soon'},{Instructions:""},{Instructions:"Priority Order:"},{Instructions:'1. All items with Urgent = "YES"'},{Instructions:'2. Items with lowest "Days Remaining"'},{Instructions:"3. Items with highest daily consumption"},{Instructions:""},{Instructions:"Pack Size Information:"},{Instructions:'Use "Packs to Order" for ordering if supplier sells in packs'},{Instructions:'Use "Recommended Order" for individual unit ordering'}]);o["!cols"]=[{wch:50}],od.book_append_sheet(n,o,"Instructions");const l=(new Date).toISOString().split("T")[0],c="Hamptown_Order_".concat(l,".xlsx");try{return function(e,t,n){var r=n||{};r.type="file",r.file=t,$c(r),Gc(e,r)}(n,c),c}catch(d){throw console.error("Error generating Excel file:",d),new Error("Failed to generate Excel file")}},cd=o("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),dd=t=>{var n;let{alert:r}=t;const[s,a]=(0,e.useState)(!1),i={topItems:[{id:"1",name:"Chocolate Hearts",consumed:45,normal:15},{id:"2",name:"Red Wine",consumed:30,normal:10},{id:"3",name:"Fresh Roses",consumed:25,normal:5}],totalIncrease:"165%",peakDay:"February 14th"};return(0,k.jsxs)("div",{className:"border-l-4 p-4 rounded-lg transition-all ".concat(r.daysUntil<=7?"border-red-500 bg-red-50":r.daysUntil<=14?"border-orange-500 bg-orange-50":"border-yellow-500 bg-yellow-50"),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex items-start flex-1",children:[(0,k.jsx)(pe,{className:"w-5 h-5 text-orange-500 mt-1 mr-3 flex-shrink-0"}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("h3",{className:"font-semibold text-orange-900 text-sm md:text-base",children:r.daysUntil<=7?"\ud83d\udea8 URGENT - Order Now!":r.daysUntil<=14?"\u26a0\ufe0f Important - Plan Order":"\ud83d\udcc5 Upcoming - Review Soon"}),(0,k.jsxs)("span",{className:"text-xs md:text-sm font-medium px-2 py-1 bg-orange-200 text-orange-800 rounded-full",children:[r.daysUntil," days"]})]}),(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("p",{className:"text-orange-700 font-medium text-sm md:text-base",children:r.holiday}),(0,k.jsx)("p",{className:"text-orange-600 text-xs md:text-sm",children:"Based on last year, expect significant consumption increases"})]}),(0,k.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-3 gap-2 text-xs",children:[(0,k.jsxs)("div",{className:"bg-white bg-opacity-50 rounded p-2",children:[(0,k.jsx)("div",{className:"font-medium text-orange-800",children:"Expected Increase"}),(0,k.jsxs)("div",{className:"text-orange-600",children:["+",i.totalIncrease]})]}),(0,k.jsxs)("div",{className:"bg-white bg-opacity-50 rounded p-2",children:[(0,k.jsx)("div",{className:"font-medium text-orange-800",children:"Top Item Impact"}),(0,k.jsx)("div",{className:"text-orange-600",children:null===(n=i.topItems[0])||void 0===n?void 0:n.name})]}),(0,k.jsxs)("div",{className:"bg-white bg-opacity-50 rounded p-2 col-span-2 md:col-span-1",children:[(0,k.jsx)("div",{className:"font-medium text-orange-800",children:"Peak Day"}),(0,k.jsx)("div",{className:"text-orange-600",children:i.peakDay})]})]})]})]}),(0,k.jsx)("button",{onClick:()=>a(!s),className:"ml-2 p-1 hover:bg-orange-200 rounded transition-colors flex-shrink-0","aria-label":s?"Collapse details":"Expand details",children:s?(0,k.jsx)(cd,{className:"w-4 h-4 text-orange-600"}):(0,k.jsx)(l,{className:"w-4 h-4 text-orange-600"})})]}),s&&(0,k.jsxs)("div",{className:"mt-4 pt-4 border-t border-orange-200",children:[(0,k.jsxs)("h4",{className:"font-medium text-orange-900 mb-3 flex items-center text-sm",children:[(0,k.jsx)(h,{className:"w-4 h-4 mr-2"}),"Last Year's Consumption Pattern"]}),(0,k.jsx)("div",{className:"space-y-3",children:i.topItems.map(((e,t)=>(0,k.jsxs)("div",{className:"flex items-center justify-between bg-white bg-opacity-60 rounded p-3",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("span",{className:"w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:t+1}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-orange-900 text-sm",children:e.name}),(0,k.jsxs)("div",{className:"text-xs text-orange-600",children:["Used ",e.consumed," units (normal: ",e.normal,")"]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"font-bold text-orange-800",children:["+",Math.round((e.consumed-e.normal)/e.normal*100),"%"]}),(0,k.jsx)("div",{className:"text-xs text-orange-600",children:"increase"})]})]},e.id)))}),(0,k.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row gap-2",children:[(0,k.jsx)("button",{className:"flex-1 bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors text-sm font-medium",children:"\ud83d\udccb Generate Holiday Order List"}),(0,k.jsx)("button",{className:"flex-1 bg-white border border-orange-300 text-orange-700 px-4 py-2 rounded hover:bg-orange-50 transition-colors text-sm font-medium",children:"\ud83d\udcca View Full Analysis"})]}),(0,k.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:(0,k.jsxs)("div",{className:"flex items-start",children:[(0,k.jsx)("span",{className:"text-yellow-600 mr-2",children:"\ud83d\udca1"}),(0,k.jsxs)("div",{className:"text-xs text-yellow-700",children:[(0,k.jsx)("strong",{children:"Pro Tip:"})," Order 2-3 days before the holiday to ensure delivery. Consider staff schedule changes and supplier availability during holiday periods."]})]})})]})]})},ud=e=>{var t,n,r,s,a,i;let{item:o,isSelected:l,onToggleSelection:c}=e;const d=null===(t=o.orderedStatus)||void 0===t?void 0:t.isOrdered;return(0,k.jsxs)("div",{className:"border-2 rounded-lg p-4 relative ".concat(d?"border-blue-500 bg-blue-50 opacity-75":{out:"border-red-500 bg-red-50",critical:"border-orange-500 bg-orange-50",low:"border-yellow-500 bg-yellow-50",ok:"border-green-500 bg-green-50"}[o.status||"ok"]," ").concat(l?"ring-2 ring-blue-400":""),children:[!d&&(0,k.jsx)("div",{className:"absolute top-2 right-2",children:(0,k.jsx)("input",{type:"checkbox",checked:l,onChange:c,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),d&&(0,k.jsxs)("div",{className:"mb-2 text-sm bg-blue-100 text-blue-700 px-2 py-1 rounded",children:[(0,k.jsx)(yt,{className:"w-4 h-4 inline mr-1"}),"Ordered ",null===(n=o.orderedStatus)||void 0===n?void 0:n.orderedQuantity," units on ",null!==(r=o.orderedStatus)&&void 0!==r&&r.orderedDate?new Date(o.orderedStatus.orderedDate).toLocaleDateString():"Unknown date",(null===(s=o.orderedStatus)||void 0===s?void 0:s.expectedDelivery)&&(0,k.jsxs)("div",{className:"text-xs mt-1",children:["Expected: ",new Date(o.orderedStatus.expectedDelivery).toLocaleDateString()]})]}),(0,k.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,k.jsx)("h3",{className:"font-semibold text-lg pr-6",children:o.name}),(0,k.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat({daily:"bg-red-200 text-red-800",weekly:"bg-yellow-200 text-yellow-800",monthly:"bg-green-200 text-green-800",database:"bg-blue-200 text-blue-800",outofstock:"bg-gray-200 text-gray-800"}[o.frequency]),children:o.frequency})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Current:"}),(0,k.jsxs)("span",{className:"font-medium",children:[o.currentStock," ",o.unit]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Minimum:"}),(0,k.jsxs)("span",{children:[o.minimumLevel," ",o.unit]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Optimal:"}),(0,k.jsxs)("span",{children:[o.optimalLevel," ",o.unit]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,k.jsxs)("span",{className:"font-medium capitalize ".concat("out"===o.status?"text-red-600":"critical"===o.status?"text-orange-600":"low"===o.status?"text-yellow-600":"text-green-600"),children:[o.status," (",Math.round(o.currentStock/o.minimumLevel*100),"%)"]})]}),(0,k.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,k.jsxs)("div",{className:"flex items-center text-gray-700",children:[(0,k.jsx)(Be,{className:"w-4 h-4 mr-1"}),(0,k.jsxs)("span",{children:["~",null===(a=o.forecast)||void 0===a?void 0:a.averageDailyConsumption.toFixed(1)," ",o.unit,"/day"]})]}),(0,k.jsx)("div",{className:"font-medium mt-1 ".concat((o.daysRemaining||0)<=2?"text-red-600":(o.daysRemaining||0)<=7?"text-orange-600":"text-green-600"),children:0===o.daysRemaining?"Out of stock!":o.daysRemaining===1/0?"No consumption data":"Will last ".concat(o.daysRemaining," days")}),(null===(i=o.forecast)||void 0===i?void 0:i.usualOrderThreshold)&&(0,k.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Usually order at ",o.forecast.usualOrderThreshold.toFixed(0),"% of minimum"]})]}),(0,k.jsxs)("div",{className:"border-t pt-2 mt-2 bg-white rounded p-2",children:[(0,k.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Recommended order:"}),(0,k.jsxs)("div",{className:"font-semibold text-green-600",children:[o.recommendedOrder," ",o.unit,o.unitPackSize&&(0,k.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["(",Math.ceil((o.recommendedOrder||0)/o.unitPackSize)," packs)"]})]})]})]})]})},hd=()=>{const{dailyItems:t,weeklyItems:n,monthlyItems:r,setDailyItems:s,setWeeklyItems:a,setMonthlyItems:i,quickSave:o}=Qe(),[l,c]=(0,e.useState)("critical"),[d]=(0,e.useState)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;const t=new Date,n=[];return Object.entries(kt).forEach((r=>{let[s,a]=r;if(!a.date||a.floating)return;const[i,o]=a.date.split("-").map(Number),l=new Date(t.getFullYear(),i-1,o),c=new Date(t.getFullYear()+1,i-1,o),d=l>=t?l:c,u=Math.ceil((d.getTime()-t.getTime())/864e5);u<=e&&u>0&&n.push({holiday:a.name,daysUntil:u,lastYearData:{date:a.date,items:[]},recommendations:[]})})),n.sort(((e,t)=>e.daysUntil-t.daysUntil))}()),[u,h]=(0,e.useState)(new Set),f=(0,e.useMemo)((()=>Nt(t,n,r)),[t,n,r]),m=(0,e.useMemo)((()=>"all"===l?f:f.filter((e=>e.status===l))),[f,l]),p=(()=>{const e=[...t,...n,...r];return{out:e.filter((e=>0===e.currentStock)).length,critical:e.filter((e=>{const t=e.currentStock/e.minLevel*100;return t>0&&t<=20})).length,low:e.filter((e=>{const t=e.currentStock/e.minLevel*100;return t>20&&t<=50})).length,total:e.filter((e=>{const t=(0,Ze.V0)(e.currentStock,e.minLevel);return["out","critical","low"].includes(t)})).length}})();return(0,k.jsxs)("div",{className:"space-y-6 pb-20",children:[d.length>0&&(0,k.jsx)("div",{className:"space-y-4",children:d.map(((e,t)=>(0,k.jsx)(dd,{alert:e},t)))}),(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[(0,k.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Stock Status Summary"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{className:"text-center p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-red-600",children:p.out}),(0,k.jsx)("div",{className:"text-sm text-red-600",children:"Out of Stock"})]}),(0,k.jsxs)("div",{className:"text-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:p.critical}),(0,k.jsx)("div",{className:"text-sm text-orange-600",children:"Critical (\u226420%)"})]}),(0,k.jsxs)("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:p.low}),(0,k.jsx)("div",{className:"text-sm text-yellow-600",children:"Low Stock (\u226450%)"})]}),(0,k.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p.total}),(0,k.jsx)("div",{className:"text-sm text-blue-600",children:"Total Needs Attention"})]})]})]}),(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-2",children:(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("div",{className:"flex space-x-2 min-w-max",children:[(0,k.jsxs)("button",{onClick:()=>c("out"),className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center ".concat("out"===l?"bg-red-500 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,k.jsx)(ze,{className:"w-4 h-4 mr-2"}),"Out of Stock (",p.out,")"]}),(0,k.jsxs)("button",{onClick:()=>c("critical"),className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center ".concat("critical"===l?"bg-orange-500 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,k.jsx)(ze,{className:"w-4 h-4 mr-2"}),"Critical (",p.critical,")"]}),(0,k.jsxs)("button",{onClick:()=>c("low"),className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center ".concat("low"===l?"bg-yellow-500 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,k.jsx)(Be,{className:"w-4 h-4 mr-2"}),"Low Stock (",p.low,")"]}),(0,k.jsxs)("button",{onClick:()=>c("all"),className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center ".concat("all"===l?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"),children:["All Items (",f.length,")"]})]})})}),u.size>0&&(0,k.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("span",{className:"text-blue-800 font-medium",children:[u.size," items selected"]}),(0,k.jsxs)("div",{className:"space-x-2",children:[(0,k.jsx)("button",{onClick:()=>h(new Set),className:"px-3 py-1 text-blue-600 hover:bg-blue-100 rounded text-sm",children:"Clear Selection"}),(0,k.jsxs)("button",{onClick:async()=>{if(0===u.size)return void qe("Please select items to mark as ordered");const e=Array.from(u),l=e.map((e=>{const t=f.find((t=>t.id.toString()===e));return(null===t||void 0===t?void 0:t.recommendedOrder)||(null===t||void 0===t?void 0:t.optimalLevel)||(null!==t&&void 0!==t&&t.minLevel?2*t.minLevel:10)}));try{const c=(0,Ze.Lz)(t,e,l),d=(0,Ze.Lz)(n,e,l),f=(0,Ze.Lz)(r,e,l);s(c),a(d),i(f),await o("inventoryDailyItems",c),await o("inventoryWeeklyItems",d),await o("inventoryMonthlyItems",f),h(new Set),qe("".concat(u.size," items marked as ordered"))}catch(c){qe("Error marking items as ordered"),console.error("Mark as ordered error:",c)}},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:[(0,k.jsx)(yt,{className:"w-4 h-4 inline mr-1"}),"Mark as Ordered"]})]})]})}),0===m.length?(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-8 text-center",children:[(0,k.jsx)(K,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Items Found"}),(0,k.jsx)("p",{className:"text-gray-600",children:"all"===l?"All items are well stocked!":"No items with ".concat(l," stock status.")})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((e=>(0,k.jsx)(ud,{item:e,isSelected:u.has(e.id.toString()),onToggleSelection:()=>(e=>{const t=new Set(u);t.has(e)?t.delete(e):t.add(e),h(t)})(e.id.toString())},e.id)))}),f.length>0&&(0,k.jsx)("div",{className:"fixed bottom-20 md:bottom-6 right-4 md:right-6 z-10",children:(0,k.jsxs)("button",{onClick:()=>{try{const e=ld(f);qe('Excel file "'.concat(e,'" generated successfully!'))}catch(e){qe("Error generating Excel file"),console.error("Excel generation error:",e)}},className:"bg-green-500 text-white px-6 py-3 rounded-full shadow-lg hover:bg-green-600 flex items-center transition-colors",children:[(0,k.jsx)(ge,{className:"w-5 h-5 mr-2"}),"Generate Excel Order"]})})]})},fd=o("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),md=()=>{const{currentTab:t,switchTab:n,dailyItems:r,weeklyItems:s,monthlyItems:a,databaseItems:i}=Qe(),o=e.useMemo((()=>Nt(r,s,a).length),[r,s,a]),l=[{id:"daily",label:"Daily Items",icon:fd,count:r.length,color:"red"},{id:"weekly",label:"Weekly Items",icon:pe,count:s.length,color:"yellow"},{id:"monthly",label:"Monthly Items",icon:K,count:a.length,color:"green"},{id:"outofstock",label:"Out of Stock",icon:ze,count:o,color:"orange"},{id:"database",label:"Items Database",icon:v,count:i.length,color:"blue"},{id:"reports",label:"Analytics",icon:Oe,count:0,color:"purple"}],c=(e,n)=>{const r="flex-1 flex items-center justify-center px-4 py-3 rounded-lg transition-all font-medium";return t===e?"".concat(r," bg-").concat(n,"-500 text-white"):"".concat(r," text-gray-600 hover:bg-gray-100")};return(0,k.jsx)("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-2",children:(0,k.jsx)("div",{className:"flex space-x-2",children:l.map((e=>{const r=e.icon;return(0,k.jsxs)("button",{onClick:()=>n(e.id),className:c(e.id,e.color),children:[(0,k.jsx)(r,{className:"w-5 h-5 mr-2"}),e.label,(0,k.jsx)("span",{className:(s=e.id,a=e.color,t===s?"ml-2 bg-".concat(a,"-600 px-2 py-1 rounded-full text-xs"):"ml-2 bg-gray-300 text-gray-700 px-2 py-1 rounded-full text-xs"),children:e.count})]},e.id);var s,a}))})})},pd=()=>((0,e.useEffect)((()=>{let e=document.getElementById("toastContainer");return e||(e=document.createElement("div"),e.id="toastContainer",e.className="fixed top-4 right-4 z-50 space-y-2 pointer-events-none",document.body.appendChild(e)),()=>{const e=document.getElementById("toastContainer");e&&0===e.children.length&&e.remove()}}),[]),(0,k.jsx)("div",{id:"toastContainer",className:"fixed top-4 right-4 z-50 space-y-2 pointer-events-none",style:{zIndex:9999}})),gd=()=>{const{dailyItems:e,weeklyItems:t,monthlyItems:n,databaseItems:r}=Qe(),s=[...e,...t,...n],a=s.filter((e=>"critical"===(0,Ze.V0)(e.currentStock,e.minLevel))).length,i=s.filter((e=>"low"===(0,Ze.V0)(e.currentStock,e.minLevel))).length,o=s.filter((e=>"ok"===(0,Ze.V0)(e.currentStock,e.minLevel))).length,l=r.length;return(0,k.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 md:p-6",children:[(0,k.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4",children:(0,k.jsxs)("div",{className:"flex items-center mb-4 sm:mb-0",children:[(0,k.jsx)("div",{className:"bg-orange-500 p-2 md:p-3 rounded-lg mr-3 md:mr-4",children:(0,k.jsx)(m,{className:"text-white w-6 h-6 md:w-8 md:h-8"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:"Restaurant Inventory"}),(0,k.jsx)("p",{className:"text-sm md:text-base text-gray-600",children:"Track usage, waste, and consumption patterns"})]})]})}),(0,k.jsxs)("div",{className:"space-y-3",children:[a>0&&(0,k.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 rounded-lg",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(ze,{className:"w-5 h-5 text-red-600 mr-2"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"text-sm font-medium text-red-800",children:[a," Critical Item",a>1?"s":""," Need Attention"]}),(0,k.jsx)("div",{className:"text-xs text-red-600",children:"Immediate restocking required"})]}),(0,k.jsx)("div",{className:"text-2xl font-bold text-red-700",children:a})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,k.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs font-medium text-yellow-600",children:"Low Stock"}),(0,k.jsx)("div",{className:"text-lg font-bold text-yellow-800",children:i})]}),(0,k.jsx)(Be,{className:"w-4 h-4 text-yellow-600"})]})}),(0,k.jsx)("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs font-medium text-green-600",children:"Good Stock"}),(0,k.jsx)("div",{className:"text-lg font-bold text-green-800",children:o})]}),(0,k.jsx)(He,{className:"w-4 h-4 text-green-600"})]})}),(0,k.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs font-medium text-blue-600",children:"Database"}),(0,k.jsx)("div",{className:"text-lg font-bold text-blue-800",children:l})]}),(0,k.jsx)(v,{className:"w-4 h-4 text-blue-600"})]})}),(0,k.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-xs font-medium text-gray-600",children:"Total Items"}),(0,k.jsx)("div",{className:"text-lg font-bold text-gray-800",children:s.length})]}),(0,k.jsx)(K,{className:"w-4 h-4 text-gray-600"})]})})]})]})]})},vd=()=>{const{currentTab:e}=Qe();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(pd,{}),(0,k.jsx)(gd,{}),(0,k.jsx)(md,{}),(()=>{switch(e){case"daily":default:return(0,k.jsx)(mt,{});case"weekly":return(0,k.jsx)(pt,{});case"monthly":return(0,k.jsx)(gt,{});case"outofstock":return(0,k.jsx)(hd,{});case"database":return(0,k.jsx)(ct,{});case"reports":return(0,k.jsx)(xt,{})}})()]})},xd=e=>{let{currentUser:t,connectionStatus:n,inventoryDailyItems:r,inventoryWeeklyItems:s,inventoryMonthlyItems:a,inventoryDatabaseItems:i,inventoryActivityLog:o,inventoryCustomCategories:l,setInventoryDailyItems:c,setInventoryWeeklyItems:d,setInventoryMonthlyItems:u,setInventoryDatabaseItems:h,setInventoryActivityLog:f,setInventoryCustomCategories:m,quickSave:p}=e;return(0,k.jsx)(Je,{inventoryDailyItems:r,inventoryWeeklyItems:s,inventoryMonthlyItems:a,inventoryDatabaseItems:i,inventoryActivityLog:o,inventoryCustomCategories:l,setInventoryDailyItems:c,setInventoryWeeklyItems:d,setInventoryMonthlyItems:u,setInventoryDatabaseItems:h,setInventoryActivityLog:f,setInventoryCustomCategories:m,quickSave:p,children:(0,k.jsx)(vd,{})})},yd=o("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),bd=o("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),wd=o("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Nd=o("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),kd=o("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),_d=o("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Sd=o("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Td=o("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Cd=o("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Ed=t=>{let{isLoading:n,lastSync:s,connectionStatus:a,loadFromFirebase:i,activeDevices:o=[],syncEvents:l=[],deviceCount:c=1,isMultiDeviceEnabled:d=!0,toggleMultiDeviceSync:u=()=>{},refreshFromAllDevices:h=()=>{},conflictCount:f=0}=t;const[m,p]=(0,e.useState)(!1),[g,v]=(0,e.useState)(!1),[x,y]=(0,e.useState)(null),[w,N]=(0,e.useState)({x:"right",y:window.innerHeight-100}),[_,S]=(0,e.useState)(!1),[T,C]=(0,e.useState)({x:0,y:0}),[E,j]=(0,e.useState)({x:0,y:0,startY:0,startSide:"right"}),A=(0,e.useRef)(null);(0,e.useEffect)((()=>{const e=()=>{N((e=>(0,r.A)((0,r.A)({},e),{},{y:Math.min(e.y,window.innerHeight-100)})))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,e.useEffect)((()=>{if(l.length>0){const e=l.filter((e=>Date.now()-e.timestamp<3e3));if(e.length>0){const t=e[0];y(t),p(!0);const n=setTimeout((()=>{p(!1),y(null)}),2e3);return()=>clearTimeout(n)}}}),[l]);const I=e=>{const t=Date.now()-e;return t<6e4?"Just now":t<36e5?"".concat(Math.floor(t/6e4),"m ago"):t<864e5?"".concat(Math.floor(t/36e5),"h ago"):"".concat(Math.floor(t/864e5),"d ago")};(0,e.useEffect)((()=>{const e=e=>{if(!_)return;const t=e.clientX-E.x,n=e.clientY-E.y,r=Math.max(16,Math.min(window.innerWidth-56,("left"===E.startSide?16:window.innerWidth-56)+t)),s=Math.max(24,Math.min(window.innerHeight-64,E.startY+n));C({x:r,y:s})},t=e=>{if(!_)return;e.preventDefault();const t=e.touches[0],n=t.clientX-E.x,r=t.clientY-E.y,s=Math.max(16,Math.min(window.innerWidth-56,("left"===E.startSide?16:window.innerWidth-56)+n)),a=Math.max(24,Math.min(window.innerHeight-64,E.startY+r));C({x:s,y:a})},n=e=>{if(!_)return;const t=e.clientX-E.x,n=e.clientY-E.y,r=("left"===E.startSide?16:window.innerWidth-56)+t>window.innerWidth/2?"right":"left",s=Math.max(24,Math.min(window.innerHeight-64,E.startY+n));N({x:r,y:s}),S(!1)},r=e=>{if(!_)return;const t=e.changedTouches[0],n=t.clientX-E.x,r=t.clientY-E.y,s=("left"===E.startSide?16:window.innerWidth-56)+n>window.innerWidth/2?"right":"left",a=Math.max(24,Math.min(window.innerHeight-64,E.startY+r));N({x:s,y:a}),S(!1)};return _&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",r)),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",r)}}),[_,E]);const D=n?{icon:(0,k.jsx)(Nd,{className:"w-3 h-3 animate-spin"}),text:x?"Syncing ".concat(x.field||"data"):"Syncing",bgColor:"bg-blue-500/90",pulseColor:"bg-blue-400"}:"connected"===a&&s?{icon:m?(0,k.jsx)(Nd,{className:"w-3 h-3 animate-spin"}):c>1?(0,k.jsx)(b,{className:"w-3 h-3"}):(0,k.jsx)(kd,{className:"w-3 h-3"}),text:m?x?"Syncing ".concat(x.field||"data"):"Syncing":c>1?"".concat(c," devices"):"Synced",bgColor:"bg-emerald-500/90",pulseColor:"bg-emerald-400"}:"error"===a?{icon:(0,k.jsx)(_d,{className:"w-3 h-3"}),text:"Offline",bgColor:"bg-red-500/90",pulseColor:"bg-red-400"}:{icon:(0,k.jsx)(Sd,{className:"w-3 h-3"}),text:"Connecting",bgColor:"bg-amber-500/90",pulseColor:"bg-amber-400"},R=(()=>{const e=window.innerHeight,t=window.innerWidth,n=w.y+450+8>e-20;let r="0px";"left"===w.x?(r="".concat(48,"px"),384>t&&(r="-".concat(272,"px"))):(r="-".concat(328,"px"),328>t-64&&(r="".concat(48,"px")));let s="0px";return s=n?"-".concat(458,"px"):"".concat(48,"px"),{translateX:r,translateY:s,isAbove:n}})();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{ref:A,className:"\n          fixed z-50 transition-all duration-300 ease-out\n          ".concat(_?"transition-none":"","\n          ").concat(_?"scale-110 cursor-grabbing":"cursor-grab hover:scale-105","\n        "),style:{left:_?"".concat(T.x,"px"):"left"===w.x?"16px":void 0,right:_?void 0:"right"===w.x?"16px":void 0,top:"".concat(_?T.y:w.y,"px")},onMouseDown:e=>{var t;e.preventDefault(),S(!0);const n=null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect();n&&(C({x:n.left,y:n.top}),j({x:e.clientX,y:e.clientY,startY:w.y,startSide:w.x}))},onTouchStart:e=>{var t;e.preventDefault(),S(!0);const n=e.touches[0],r=null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect();r&&(C({x:r.left,y:r.top}),j({x:n.clientX,y:n.clientY,startY:w.y,startSide:w.x}))},children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"absolute inset-0 rounded-full bg-black/10 blur-md scale-110"}),(0,k.jsxs)("div",{className:"\n              relative w-10 h-10 rounded-full transform transition-all duration-300\n              ".concat(m?"animate-pulse":"","\n            "),onClick:e=>{_||(e.stopPropagation(),"error"===a?i():v(!g))},title:"".concat(D.text).concat(s?" - Last sync: ".concat(s):""),children:[(0,k.jsx)("div",{className:"\n              absolute inset-0 rounded-full backdrop-blur-xl ".concat(D.bgColor,"\n              border border-white/40 shadow-lg\n            ")}),(0,k.jsx)("div",{className:"absolute inset-0.5 rounded-full bg-gradient-to-tr from-white/25 to-transparent"}),(0,k.jsx)("div",{className:"relative flex items-center justify-center w-full h-full text-white",children:D.icon}),"connected"===a&&c>1?(0,k.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full backdrop-blur-xl bg-blue-500/95  border border-white/60 shadow-md flex items-center justify-center text-xs font-bold text-white",children:c}):null,m&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"absolute inset-0 rounded-full animate-ping",children:(0,k.jsx)("div",{className:"w-full h-full rounded-full ".concat(D.pulseColor,"/50 border border-current")})}),(0,k.jsx)("div",{className:"absolute inset-0 rounded-full animate-ping",style:{animationDelay:"150ms"},children:(0,k.jsx)("div",{className:"w-full h-full rounded-full ".concat(D.pulseColor,"/30 border border-current scale-125")})})]}),f&&f>0?(0,k.jsxs)("div",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs px-2 py-0.5 rounded-full animate-pulse z-50",children:[f," conflict",f>1?"s":""]}):null]})]}),g&&!_&&(0,k.jsxs)("div",{className:"absolute z-40 w-80",style:{transform:"translate(".concat(R.translateX,", ").concat(R.translateY,")"),transformOrigin:R.isAbove?"bottom center":"top center"},children:[(0,k.jsx)("div",{className:"absolute w-0.5 bg-gradient-to-b from-blue-500/30 to-purple-500/30 ".concat(R.isAbove?"bottom-0 h-2 translate-y-full":"top-0 h-2 -translate-y-full"),style:{left:"left"===w.x?"-9px":"calc(100% + 8px)"}}),(0,k.jsxs)("div",{className:"relative bg-white/95 backdrop-blur-xl rounded-xl shadow-xl border border-white/50 overflow-hidden",children:[(0,k.jsx)("div",{className:"bg-gradient-to-r from-emerald-500/15 to-blue-500/15 px-4 py-3 border-b border-white/30",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-emerald-500 to-blue-500 flex items-center justify-center",children:(0,k.jsx)(b,{className:"w-3 h-3 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-800",children:"Multi-Device Sync"}),(0,k.jsxs)("div",{className:"text-xs text-gray-600",children:[c," device",1!==c?"s":""," connected"]})]})]}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),v(!1)},className:"w-6 h-6 rounded-full bg-white/30 backdrop-blur-sm border border-white/40  text-gray-600 hover:text-gray-800 hover:bg-white/50 transition-all duration-200 flex items-center justify-center text-xs",children:"\u2715"})]})}),(0,k.jsxs)("div",{className:"p-4 space-y-4 max-h-80 overflow-y-auto",children:[(0,k.jsxs)("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Real-time Sync"}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===a?"bg-green-500":"bg-red-500")}),(0,k.jsx)("span",{className:"text-xs font-medium ".concat("connected"===a?"text-green-600":"text-red-600"),children:"connected"===a?"Active":"Offline"})]})]}),(0,k.jsx)("div",{className:"text-xs text-gray-600",children:"connected"===a?"All changes sync automatically across devices":"connecting"===a?"Connecting to sync service...":"Connection failed - working offline"}),s&&(0,k.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Last sync: ",s]})]}),(0,k.jsxs)("div",{className:"bg-white/30 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Connected Devices (",o.length,")"]}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),h()},className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full hover:bg-blue-200 transition-colors",children:"Refresh"})]}),o.length>0?(0,k.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:o.map(((e,t)=>{return(0,k.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white/40 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.isActive?"bg-green-500":"bg-gray-400")}),(0,k.jsx)("div",{className:"text-blue-600",children:(n=e,"mobile"===n.platform?(0,k.jsx)(yd,{className:"w-3 h-3"}):"tablet"===n.platform?(0,k.jsx)(bd,{className:"w-3 h-3"}):(0,k.jsx)(wd,{className:"w-3 h-3"}))}),(0,k.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,k.jsx)("div",{className:"text-xs font-medium text-gray-700 truncate",children:e.name}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:[e.user," \u2022 ",e.browserInfo]})]})]}),(0,k.jsx)("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:I(e.lastSeen)})]},e.id);var n}))}):(0,k.jsx)("div",{className:"text-center py-4 text-xs text-gray-500",children:"No other devices connected"})]}),l.length>0&&(0,k.jsxs)("div",{className:"bg-white/30 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,k.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Activity"}),(0,k.jsx)("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:l.slice(0,5).map(((e,t)=>(0,k.jsxs)("div",{className:"text-xs text-gray-600 flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[(0,k.jsx)("div",{className:"w-1.5 h-1.5 rounded-full flex-shrink-0 ".concat("data_update"===e.type?"bg-blue-500":"device_join"===e.type?"bg-green-500":"device_leave"===e.type?"bg-red-500":"bg-purple-500")}),(0,k.jsx)("span",{className:"truncate",children:e.description||"".concat(e.field||"Data"," ").concat("data_update"===e.type?"updated":e.type.replace("_"," "))})]}),(0,k.jsx)("span",{className:"text-gray-400 whitespace-nowrap ml-2",children:I(e.timestamp)})]},t)))})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),"error"===a?i():h()},className:"flex-1 py-2 px-3 bg-gradient-to-r from-emerald-500 to-blue-500  text-white rounded-lg hover:from-emerald-600 hover:to-blue-600  transition-all duration-300 text-xs font-semibold shadow-md transform hover:scale-105",children:"error"===a?"Reconnect":"Refresh All"}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),u()},className:"py-2 px-3 bg-white/20 backdrop-blur-sm border border-white/30  text-gray-700 rounded-lg hover:bg-white/30  transition-all duration-300 text-xs font-semibold",title:d?"Disable sync":"Enable sync",children:d?(0,k.jsx)(Td,{className:"w-3 h-3"}):(0,k.jsx)(Cd,{className:"w-3 h-3"})})]})]})]})]})]}),g&&(0,k.jsx)("div",{className:"fixed inset-0 z-30",onClick:()=>v(!1)})]})};var jd=n(277),Ad=n(291),Id=n(578),Dd=n(815);const Rd=e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||Date.now()+Math.random(),prepId:e.prepId||0,name:e.name||"Unknown Prep",category:e.category||"muut",estimatedTime:e.estimatedTime||"30 min",isCustom:e.isCustom||!1,hasRecipe:e.hasRecipe||!1,recipe:e.recipe||null,scheduledDate:e.scheduledDate||(0,N.po)(new Date),priority:e.priority||"medium",timeSlot:e.timeSlot||"",completed:"boolean"===typeof e.completed&&e.completed,assignedTo:e.assignedTo||null,notes:e.notes||""}))):[],Pd=()=>{const[t,n]=(0,e.useState)(!1),[s,a]=(0,e.useState)(null),[i,o]=(0,e.useState)("connecting"),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)([]),[h,f]=(0,e.useState)({}),[m,p]=(0,e.useState)(new Set),[g,v]=(0,e.useState)({}),[x,y]=(0,e.useState)(["Cleaner","Manager","Supervisor"]),[b,k]=(0,e.useState)([]),[_,S]=(0,e.useState)([]),[T,C]=(0,e.useState)({}),[E,j]=(0,e.useState)([]),[A,I]=(0,e.useState)([]),[D,R]=(0,e.useState)([]),[P,O]=(0,e.useState)([]),[M,L]=(0,e.useState)([]),[F,U]=(0,e.useState)([]),[W,z]=(0,e.useState)([]),B=new jd.f,H=(0,e.useRef)(null),V=(0,e.useRef)(""),q=(0,e.useRef)(!1),Y=(0,e.useRef)(!1),K=(0,e.useCallback)((async(e,t)=>{console.log("\ud83d\udd25 QuickSave: ".concat(e));try{const n="https://hamptown-panel-default-rtdb.firebaseio.com";let s=t instanceof Set?Array.from(t):t;if("scheduledPreps"===e){const e=(0,N.po)(new Date),t=s.filter((t=>t.scheduledDate===e)),n=t.filter((e=>!0===e.completed));console.log("\ud83d\udd0d Saving scheduledPreps to Firebase:",{totalCount:s.length,todayCount:t.length,todayCompletedCount:n.length,completionPercentage:t.length>0?Math.round(n.length/t.length*100):0,sampleTodayPreps:t.slice(0,3).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate})))}),s=s.map((e=>(0,r.A)((0,r.A)({},e),{},{completed:Boolean(e.completed)})))}if(["scheduledPreps","completedTasks","taskAssignments","dailyData"].includes(e)){console.log("\ud83d\udd12 Critical save - waiting for confirmation:",e);const t=await fetch("".concat(n,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("Critical save failed: ".concat(t.status));a((new Date).toLocaleTimeString()),o("connected"),console.log("\u2705 Critical QuickSave completed:",e),"scheduledPreps"===e&&setTimeout((async()=>{try{const t=await fetch("".concat(n,"/").concat(e,".json")),r=await t.json();if(r){const e=(0,N.po)(new Date),t=r.filter((t=>t.scheduledDate===e)),n=t.filter((e=>!0===e.completed));console.log("\ud83d\udd0d Verified scheduledPreps in Firebase after save:",{totalCount:r.length,todayCount:t.length,todayCompletedCount:n.length,completionPercentage:t.length>0?Math.round(n.length/t.length*100):0});const a=s.filter((t=>t.scheduledDate===e&&!0===t.completed)).length;n.length!==a?console.warn("\u26a0\ufe0f Completion count mismatch after save!",{sent:a,verified:n.length}):console.log("\u2705 Completion status successfully verified")}else console.warn("\u26a0\ufe0f No data returned from verification")}catch(t){console.warn("\u26a0\ufe0f Failed to verify save:",t)}}),500)}else fetch("".concat(n,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>{if(!t.ok)throw new Error("Save failed: ".concat(t.status));a((new Date).toLocaleTimeString()),o("connected"),console.log("\u2705 QuickSave completed:",e)})).catch((e=>{console.warn("\u26a0\ufe0f QuickSave failed (non-blocking):",e),o("error")}));return!0}catch(n){return console.error("\u274c QuickSave error:",n),o("error"),!1}}),[]),G=((0,e.useCallback)((async()=>{}),[]),(0,e.useCallback)((async()=>{}),[l,d,h,m,g,x,b,_,T,E])),$=(0,e.useCallback)((async()=>{if(Y.current||"error"===i)return void console.log("\u23ed\ufe0f Skipping save (already saving or offline)");const e=JSON.stringify({employees:l.length,tasks:d.length,dailyDataKeys:Object.keys(h).length,completedTasksSize:m.size,taskAssignmentsKeys:Object.keys(g).length,customRolesLength:x.length,prepItemsLength:b.length,scheduledPrepsLength:_.length,prepSelectionsKeys:Object.keys(T).length,storeItemsLength:E.length,inventoryDailyItemsLength:A.length,inventoryWeeklyItemsLength:D.length,inventoryMonthlyItemsLength:P.length,inventoryDatabaseItemsLength:M.length,inventoryActivityLogLength:F.length});if(e!==V.current){Y.current=!0,console.log("\ud83d\udcbe Saving data (non-blocking)...");try{await B.saveData({employees:l,tasks:d,dailyData:h,completedTasks:m,taskAssignments:g,customRoles:x,prepItems:b,scheduledPreps:_,prepSelections:T,storeItems:E,inventoryDailyItems:A,inventoryWeeklyItems:D,inventoryMonthlyItems:P,inventoryDatabaseItems:M,inventoryActivityLog:F}),a((new Date).toLocaleTimeString()),V.current=e,o("connected")}catch(t){console.error("\u274c Save failed:",t),o("error")}finally{Y.current=!1}}}),[l,d,h,m,g,x,b,_,T,E,A,D,P,M,F,i,G]),X=(0,e.useCallback)((()=>{"connected"===i?(H.current&&clearTimeout(H.current),H.current=setTimeout((()=>{$()}),2e3)):console.warn("\u26d4 Not saving to Firebase: offline or error connection")}),[$,i]),Q=(0,e.useCallback)((async()=>{if(!t){n(!0),o("connecting");try{console.log("\ud83d\udce1 Loading data (fast mode)...");const e=B.loadData(),t=new Promise(((e,t)=>setTimeout((()=>t(new Error("Load timeout"))),1e4))),n=await Promise.race([e,t]),r=(e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||0,name:e.name||"Unknown",mood:e.mood||3,lastUpdated:e.lastUpdated||"Not updated",role:e.role||"Cleaner",lastMoodDate:e.lastMoodDate||null,points:"number"===typeof e.points?e.points:0}))):(0,Ad.PR)())(n.employees),s=(e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||0,task:e.task||"Unknown Task",location:e.location||"Unknown Location",priority:e.priority||"medium",estimatedTime:e.estimatedTime||"30 min",points:"number"===typeof e.points?e.points:5}))):(0,Ad.w4)())(n.tasks),i=Rd(n.scheduledPreps||[]);console.log("\ud83d\udd0d Loading scheduledPreps from Firebase:",{count:i.length,todayPreps:i.filter((e=>e.scheduledDate===(0,N.po)(new Date))).length,todayCompleted:i.filter((e=>e.scheduledDate===(0,N.po)(new Date)&&!0===e.completed)).length,sampleData:i.slice(0,5).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate}))),rawDataSample:n.scheduledPreps?n.scheduledPreps.slice(0,3):"No raw data"}),c(r),u(s),f(n.dailyData),p(new Set(n.completedTasks)),v(n.taskAssignments),y(n.customRoles),k(n.prepItems||[]),S(i),C(n.prepSelections||{}),j(n.storeItems||(0,Ad.h3)()),I(n.inventoryDailyItems||[]),R(n.inventoryWeeklyItems||[]),O(n.inventoryMonthlyItems||[]),L(n.inventoryDatabaseItems||[]),U(n.inventoryActivityLog||[]),z(n.inventoryCustomCategories||[]);const l=(0,N.po)(new Date),d=i.filter((e=>e.scheduledDate===l)),h=d.filter((e=>!0===e.completed));console.log("\u2705 Set scheduledPreps state:",{count:i.length,todayCount:d.length,todayCompletedCount:h.length,completionPercentage:d.length>0?Math.round(h.length/d.length*100):0}),o("connected"),a((new Date).toLocaleTimeString()),V.current=JSON.stringify({loaded:!0}),q.current=!0,console.log("\u2705 Data loaded successfully")}catch(e){console.error("\u274c Load failed:",e),o("error"),q.current||(console.log("\u26a0\ufe0f Setting defaults due to load failure - sync disabled until manual load succeeds"),c((0,Ad.PR)()),u((0,Ad.w4)()),f((0,Ad.tU)()),k([]),S([]),C({}),j((0,Ad.h3)()))}finally{n(!1)}}}),[t]);(0,e.useEffect)((()=>{if(q.current&&!Y.current){const e=setTimeout((()=>{X()}),1e3);return()=>clearTimeout(e)}}),[l,d,h,m,g,x,_]),(0,e.useEffect)((()=>{if(q.current){const e=setTimeout((()=>{X()}),3e3);return()=>clearTimeout(e)}}),[b,T,E]);const J=(0,e.useRef)(null),Z=(0,e.useRef)(null);J.current||(J.current=(0,Dd.Wp)(w.Nd),Z.current=(0,Id.C3)(J.current)),(0,e.useEffect)((()=>{const e=Z.current;if(!e)return;const t=(0,Id.KR)(e,"employees"),n=e=>{const t=e.val()||[];c(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(t,n);const r=(0,Id.KR)(e,"tasks"),s=e=>{const t=e.val()||[];u(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(r,s);const a=(0,Id.KR)(e,"dailyData"),i=e=>{f(e.val()||{})};(0,Id.Zy)(a,i);const o=(0,Id.KR)(e,"completedTasks"),l=e=>{p(new Set(e.val()||[]))};(0,Id.Zy)(o,l);const d=(0,Id.KR)(e,"taskAssignments"),h=e=>{v(e.val()||{})};(0,Id.Zy)(d,h);const m=(0,Id.KR)(e,"customRoles"),g=e=>{y(Array.isArray(e.val())?e.val():[])};(0,Id.Zy)(m,g);const x=(0,Id.KR)(e,"prepItems"),b=e=>{const t=e.val()||[];k(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(x,b);const w=(0,Id.KR)(e,"scheduledPreps"),N=e=>{const t=e.val()||[],n=Rd(Array.isArray(t)?t:Object.values(t));S(n)};(0,Id.Zy)(w,N);const _=(0,Id.KR)(e,"prepSelections"),T=e=>{C(e.val()||{})};(0,Id.Zy)(_,T);const E=(0,Id.KR)(e,"storeItems"),A=e=>{const t=e.val()||[];j(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(E,A);const D=(0,Id.KR)(e,"inventoryDailyItems"),P=e=>{const t=e.val()||[];I(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(D,P);const M=(0,Id.KR)(e,"inventoryWeeklyItems"),F=e=>{const t=e.val()||[];R(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(M,F);const W=(0,Id.KR)(e,"inventoryMonthlyItems"),B=e=>{const t=e.val()||[];O(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(W,B);const H=(0,Id.KR)(e,"inventoryDatabaseItems"),V=e=>{const t=e.val()||[];L(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(H,V);const q=(0,Id.KR)(e,"inventoryActivityLog"),Y=e=>{const t=e.val()||[];U(Array.isArray(t)?t:Object.values(t))};(0,Id.Zy)(q,Y);const K=(0,Id.KR)(e,"inventoryCustomCategories");return(0,Id.Zy)(K,(e=>{const t=e.val()||[];z(Array.isArray(t)?t:Object.values(t))})),()=>{(0,Id.AU)(t,"value",n),(0,Id.AU)(r,"value",s),(0,Id.AU)(a,"value",i),(0,Id.AU)(o,"value",l),(0,Id.AU)(d,"value",h),(0,Id.AU)(m,"value",g),(0,Id.AU)(x,"value",b),(0,Id.AU)(w,"value",N),(0,Id.AU)(_,"value",T),(0,Id.AU)(E,"value",A),(0,Id.AU)(D,"value",P),(0,Id.AU)(M,"value",F),(0,Id.AU)(W,"value",B),(0,Id.AU)(H,"value",V),(0,Id.AU)(q,"value",Y)}}),[]);return{isLoading:t,lastSync:s,connectionStatus:i,employees:l,tasks:d,dailyData:h,completedTasks:m,taskAssignments:g,customRoles:x,prepItems:b,scheduledPreps:_,prepSelections:T,storeItems:E,inventoryDailyItems:A,inventoryWeeklyItems:D,inventoryMonthlyItems:P,inventoryDatabaseItems:M,inventoryActivityLog:F,inventoryCustomCategories:W,setEmployees:c,setTasks:u,setDailyData:f,setCompletedTasks:p,setTaskAssignments:v,setCustomRoles:y,setPrepItems:k,setScheduledPreps:S,setPrepSelections:C,setStoreItems:j,setInventoryDailyItems:I,setInventoryWeeklyItems:R,setInventoryMonthlyItems:O,setInventoryDatabaseItems:L,setInventoryActivityLog:U,setInventoryCustomCategories:z,loadFromFirebase:Q,saveToFirebase:X,quickSave:K,applyTaskSyncOperation:e=>{u((t=>ne(t,e)))}}};class Od{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown User";this.baseUrl=w.Nd.databaseURL,this.deviceId=void 0,this.deviceInfo=void 0,this.presenceRef=void 0,this.syncCallbacks=new Map,this.isConnected=!1,this.heartbeatInterval=null,this.onDeviceCountChange=void 0,this.onSyncEvent=void 0,this.lastDataTimestamp=new Map,this.eventSource=null,this.connectionRetryCount=0,this.maxRetries=3,this.retryTimeout=null,this.syncQueue=new Map,this.syncTimer=null,this.isSyncing=!1,this.ourOperations=new Set,this.operationTimeout=3e4,this.deviceCountTimeout=null,this.deviceCache=null,this.DEVICE_CACHE_TTL=3e4,this.lastKnownData=new Map,this.deviceId=this.generateDeviceId(),this.deviceInfo=this.createDeviceInfo(e),this.presenceRef="presence/".concat(this.deviceId),console.log("\ud83d\udd04 Sync service initialized:",{deviceId:this.deviceId.substring(0,8)+"...",user:e}),window.addEventListener("beforeunload",(()=>{this.disconnect()})),document.addEventListener("visibilitychange",(()=>{document.hidden?this.updatePresence(!1):this.updatePresence(!0)}))}generateDeviceId(){let e=localStorage.getItem("workVibe_deviceId");if(!e){const t=Date.now().toString(36),n=Math.random().toString(36).substr(2,6);e="device_".concat(t,"_").concat(n),localStorage.setItem("workVibe_deviceId",e)}return e}createDeviceInfo(e){const t=navigator.userAgent;let n="Desktop",r="Browser";return/Mobile|Android|iPhone|iPod/.test(t)?n="Mobile":/iPad|Tablet/.test(t)&&(n="Tablet"),t.includes("Chrome")?r="Chrome":t.includes("Firefox")?r="Firefox":t.includes("Safari")&&(r="Safari"),{id:this.deviceId,name:"".concat(n," \u2022 ").concat(r),lastSeen:Date.now(),user:e,platform:n.toLowerCase(),isActive:!0,browserInfo:"".concat(r," on ").concat(navigator.platform||"Unknown")}}async connect(){if(this.isConnected)console.log("\u2705 Already connected");else try{console.log("\ud83d\udd17 Connecting sync service..."),this.updatePresence(!0).catch(console.warn),this.startListening(),this.startHeartbeat(),this.isConnected=!0,this.connectionRetryCount=0,this.emitSyncEvent({type:"device_join",timestamp:Date.now(),deviceId:this.deviceId,deviceName:this.deviceInfo.name,description:"".concat(this.deviceInfo.name," connected")}),console.log("\u2705 Sync service connected")}catch(e){console.error("\u274c Connection failed:",e),this.scheduleReconnect()}}async disconnect(){if(this.isConnected)try{console.log("\ud83d\udd0c Disconnecting..."),this.isConnected=!1,this.stopListening(),this.stopHeartbeat(),this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.syncTimer&&(clearTimeout(this.syncTimer),this.syncTimer=null),this.removePresence().catch(console.warn),console.log("\u2705 Disconnected")}catch(e){console.error("\u274c Disconnect error:",e)}}async updatePresence(e){this.deviceInfo=(0,r.A)((0,r.A)({},this.deviceInfo),{},{lastSeen:Date.now(),isActive:e});try{fetch("".concat(this.baseUrl,"/").concat(this.presenceRef,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.deviceInfo)}).then((e=>{e.ok&&(this.deviceCountTimeout&&clearTimeout(this.deviceCountTimeout),this.deviceCountTimeout=setTimeout((()=>{this.getActiveDevices().then((e=>{this.onDeviceCountChange&&(console.log("\ud83d\udcf1 Device count updated: ".concat(e.length," devices connected")),this.onDeviceCountChange(e.length,e))})).catch(console.warn)}),1e3))})).catch(console.warn)}catch(t){console.warn("\u26a0\ufe0f Presence update failed:",t)}}async removePresence(){try{await fetch("".concat(this.baseUrl,"/").concat(this.presenceRef,".json"),{method:"DELETE"})}catch(e){console.warn("\u26a0\ufe0f Failed to remove presence:",e)}}async getActiveDevices(){try{const e=Date.now();if(this.deviceCache&&e-this.deviceCache.timestamp<this.DEVICE_CACHE_TTL)return this.deviceCache.devices;const t=await fetch("".concat(this.baseUrl,"/presence.json")),n=await t.json();if(!n)return this.deviceCache={devices:[],timestamp:e},[];const r=Object.values(n).filter((t=>t.isActive&&e-t.lastSeen<3e5)).slice(0,10);return this.deviceCache={devices:r,timestamp:e},r}catch(e){return console.warn("\u26a0\ufe0f Failed to get devices:",e),[]}}startListening(){if(this.eventSource)return void console.log("\ud83d\udc42 Already listening");console.log("\ud83d\udc42 Starting single EventSource listener...");const e="".concat(this.baseUrl,"/.json");this.eventSource=new EventSource(e),this.eventSource.onmessage=e=>{try{const t=JSON.parse(e.data);if(null===t)return;console.log("\ud83d\udce5 Received data update"),this.processDataUpdate(t)}catch(t){console.warn("\u26a0\ufe0f Error processing data update:",t)}},this.eventSource.onerror=e=>{console.warn("\u26a0\ufe0f EventSource error:",e),this.handleConnectionError()}}processDataUpdate(e){const t=["employees","tasks","dailyData","completedTasks","taskAssignments","customRoles","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"];for(const n of t)if(e[n]&&this.syncCallbacks.has(n)){const t=this.syncCallbacks.get(n),r=Date.now();if(r-(this.lastDataTimestamp.get(n)||0)>3e3){const s="".concat(n,"_").concat(JSON.stringify(e[n]).slice(0,100));if(this.ourOperations.has(s)){console.log("\ud83d\udd04 [SYNC] ".concat(n," update ignored - this was our own operation"));continue}this.lastDataTimestamp.set(n,r);let a=e[n];"completedTasks"===n&&Array.isArray(a)&&(a=new Set(a)),console.log("\ud83d\udd04 [SYNC] Received ".concat(n," update from Firebase:"),Array.isArray(e[n])?e[n]:Object.keys(e[n]||{}).length);const i=this.hasDataChanged(n,a);i?(console.log("\ud83d\udd04 [SYNC] ".concat(n.charAt(0).toUpperCase()+n.slice(1)," actually changed, updating state")),t(a)):console.log("\ud83d\udd04 [SYNC] ".concat(n.charAt(0).toUpperCase()+n.slice(1)," unchanged, keeping current state")),i&&this.emitSyncEvent({type:"data_update",timestamp:r,deviceId:"remote",deviceName:"Remote Device",field:n,description:"".concat(n," updated")})}}}hasDataChanged(e,t){const n=this.lastKnownData.get(e);return JSON.stringify(t)!==JSON.stringify(n)&&(this.lastKnownData.set(e,t),!0)}stopListening(){this.eventSource&&(console.log("\ud83d\udd07 Stopping listener"),this.eventSource.close(),this.eventSource=null)}handleConnectionError(){this.stopListening(),this.connectionRetryCount<this.maxRetries?this.scheduleReconnect():(console.warn("\u26a0\ufe0f Max reconnection attempts reached"),this.isConnected=!1)}scheduleReconnect(){if(this.retryTimeout)return;this.connectionRetryCount++;const e=Math.min(1e3*Math.pow(2,this.connectionRetryCount),3e4);console.log("\ud83d\udd04 Reconnecting in ".concat(e/1e3,"s (attempt ").concat(this.connectionRetryCount,")")),this.retryTimeout=setTimeout((()=>{this.retryTimeout=null,this.isConnected||this.startListening()}),e)}async syncData(e,t){const n="".concat(e,"_").concat(JSON.stringify(t).slice(0,100));this.ourOperations.add(n),setTimeout((()=>{this.ourOperations.delete(n)}),this.operationTimeout),this.syncQueue.set(e,t),this.syncTimer&&clearTimeout(this.syncTimer),this.syncTimer=setTimeout((()=>{this.processSyncQueue()}),1500)}async processSyncQueue(){if(this.isSyncing||0===this.syncQueue.size)return;this.isSyncing=!0;const e=new Map(this.syncQueue);this.syncQueue.clear();try{console.log("\ud83d\udce4 Processing sync queue:",Array.from(e.keys()));const t=Array.from(e.entries()).map((async e=>{let[t,n]=e;try{let e=n instanceof Set?Array.from(n):n;const r=await fetch("".concat(this.baseUrl,"/").concat(t,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw new Error("Sync failed for ".concat(t,": ").concat(r.status));console.log("\u2705 Synced ".concat(t)),this.emitSyncEvent({type:"data_update",timestamp:Date.now(),deviceId:this.deviceId,deviceName:this.deviceInfo.name,field:t,description:"".concat(t," synced")})}catch(r){console.warn("\u26a0\ufe0f Failed to sync ".concat(t,":"),r),this.syncQueue.set(t,n)}}));await Promise.allSettled(t)}catch(t){console.error("\u274c Sync queue processing failed:",t)}finally{this.isSyncing=!1,this.syncQueue.size>0&&setTimeout((()=>this.processSyncQueue()),2e3)}}startHeartbeat(){this.heartbeatInterval=setInterval((()=>{this.isConnected&&this.updatePresence(!0).catch(console.warn)}),9e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}onFieldChange(e,t){this.syncCallbacks.set(e,t)}offFieldChange(e){this.syncCallbacks.delete(e)}onDeviceCountChanged(e){this.onDeviceCountChange=e}onSyncEventReceived(e){this.onSyncEvent=e}emitSyncEvent(e){this.onSyncEvent&&this.onSyncEvent(e)}async refreshDataFromAllDevices(){try{console.log("\ud83d\udd04 Fast refresh...");const e=new AbortController,t=setTimeout((()=>e.abort()),8e3),n=["employees","tasks","dailyData","completedTasks","taskAssignments","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"],r=n.map((t=>fetch("".concat(this.baseUrl,"/").concat(t,".json"),{signal:e.signal}).then((e=>e.json())).then((e=>({[t]:e}))))),s=await Promise.allSettled(r);clearTimeout(t);const a={};return s.forEach(((e,t)=>{"fulfilled"===e.status?Object.assign(a,e.value):console.warn("\u26a0\ufe0f Failed to fetch ".concat(n[t],":"),e.reason)})),console.log("\u2705 Fast refresh completed"),a}catch(e){throw console.error("\u274c Fast refresh failed:",e),e}}getDeviceInfo(){return(0,r.A)((0,r.A)({},this.deviceInfo),{},{lastSeen:Date.now()})}updateCurrentUser(e){this.deviceInfo.user=e,this.updatePresence(!0).catch(console.warn)}getSyncStats(){var e;return{isConnected:this.isConnected,deviceCount:(null===(e=this.deviceCache)||void 0===e?void 0:e.devices.length)||0,lastSync:Math.max(...Array.from(this.lastDataTimestamp.values()),0),isListening:null!==this.eventSource,queueSize:this.syncQueue.size}}}const Md=()=>{const t=e.useRef(null);t.current||(t.current=new(n(277).f));const{isLoading:s,lastSync:a,connectionStatus:i,employees:o,tasks:b,dailyData:S,completedTasks:T,taskAssignments:C,customRoles:E,prepItems:j,scheduledPreps:A,prepSelections:I,storeItems:D,inventoryDailyItems:R,inventoryWeeklyItems:P,inventoryMonthlyItems:M,inventoryDatabaseItems:L,inventoryActivityLog:F,inventoryCustomCategories:U,setEmployees:W,setTasks:z,setDailyData:B,setCompletedTasks:V,setTaskAssignments:q,setCustomRoles:Y,setPrepItems:K,setScheduledPreps:G,setPrepSelections:$,setStoreItems:X,setInventoryDailyItems:Q,setInventoryWeeklyItems:J,setInventoryMonthlyItems:Z,setInventoryDatabaseItems:ne,setInventoryActivityLog:ae,setInventoryCustomCategories:ie,loadFromFirebase:oe,saveToFirebase:le,quickSave:ce,applyTaskSyncOperation:de}=Pd();(0,e.useEffect)((()=>{if(!t.current)return;let e,n;const r=t.current.onCompletedTasksChange((t=>{clearTimeout(e),e=setTimeout((()=>{console.log("\ud83d\udd04 [SYNC] Received completedTasks update from Firebase:",t);const e=new Set(Array.isArray(t)?t:Array.from(t));V((t=>{const n=Array.from(t),r=Array.from(e);return n.length===r.length&&n.every((t=>e.has(t)))?(console.log("\ud83d\udd04 [SYNC] CompletedTasks unchanged, keeping current state"),t):(console.log("\ud83d\udd04 [SYNC] CompletedTasks actually changed, updating state"),e)}))}),150)})),s=t.current.onTaskAssignmentsChange((e=>{clearTimeout(n),n=setTimeout((()=>{console.log("\ud83d\udd04 [SYNC] Received taskAssignments update from Firebase:",e),q((t=>JSON.stringify(t)!==JSON.stringify(e||{})?(console.log("\ud83d\udd04 [SYNC] TaskAssignments actually changed, updating state"),e||{}):(console.log("\ud83d\udd04 [SYNC] TaskAssignments unchanged, keeping current state"),t)))}),150)}));return()=>{clearTimeout(e),clearTimeout(n),r&&r(),s&&s()}}),[V,q]);const{currentUser:ue,isAdmin:he,setIsAdmin:fe,switchUser:pe,logoutAdmin:ge}=(()=>{const[t,n]=(0,e.useState)({id:1,name:"Luka"}),[r,s]=(0,e.useState)(!1),a=(0,e.useCallback)((e=>{n({id:e.id,name:e.name}),localStorage.setItem("currentUserName",e.name)}),[]),i=(0,e.useCallback)((()=>{s(!1)}),[]);return(0,e.useEffect)((()=>{t.name&&localStorage.setItem("currentUserName",t.name)}),[t.name]),{currentUser:t,isAdmin:r,setCurrentUser:n,setIsAdmin:s,switchUser:a,logoutAdmin:i}})(),[xe,ye]=(0,e.useState)(3),[be,we]=(0,e.useState)("mood"),[Ne,ke]=(0,e.useState)(!1),[_e,Se]=(0,e.useState)(!1),[Te,Ce]=(0,e.useState)(""),[Ee,je]=(0,e.useState)((0,N.po)(new Date)),[Ae,Ie]=(0,e.useState)((0,Ad.h3)()),[De,Re]=(0,e.useState)(!1),[Pe,Oe]=(0,e.useState)(0),[Me,Le]=(0,e.useState)([]),[Fe,Ue]=(0,e.useState)([]),[ze,Be]=(0,e.useState)(1),[He,Ve]=(0,e.useState)(!0),qe=(0,e.useRef)(null),[Ye,Ke]=(0,e.useState)([]),[Ge,$e]=(0,e.useState)([]);(0,e.useEffect)((()=>{let e=!0;return(async()=>{e&&0===o.length&&(console.log("\ud83d\ude80 Initializing app..."),await oe())})(),()=>{e=!1}}),[]),(0,e.useEffect)((()=>(!qe.current&&ue&&(console.log("\ud83d\udd04 Initializing Multi-Device Sync Service..."),qe.current=new Od(ue.name),qe.current.onDeviceCountChanged(((e,t)=>{Be(e),Le(t)})),qe.current.onSyncEventReceived((e=>{Ue((t=>[e,...t.slice(0,9)]))})),qe.current.onFieldChange("completedTasks",(e=>{e instanceof Set?V(e):Array.isArray(e)&&V(new Set(e))})),qe.current.onFieldChange("taskAssignments",q),qe.current.onFieldChange("employees",W),qe.current.onFieldChange("tasks",z),qe.current.onFieldChange("dailyData",B),qe.current.connect().catch(console.error)),()=>{qe.current&&(qe.current.disconnect(),qe.current=null)})),[ue]),(0,e.useEffect)((()=>{const e=setInterval((async()=>{if("connected"===i&&!s){console.log("\ud83e\uddf9 [AUTO-SAVE] Cleaning tasks: Initiating periodic auto-save...");try{await le();(async()=>{var e,n;const r=await(null===(e=(n=t.current).getCleaningTasksData)||void 0===e?void 0:e.call(n));if(r){const e=Array.from(T).every((e=>{var t,n;return null===(t=r.completedTasks)||void 0===t||null===(n=t.includes)||void 0===n?void 0:n.call(t,e)})),t=JSON.stringify(C)===JSON.stringify(r.taskAssignments);e&&t?console.log("\u2705 [AUTO-SAVE] Cleaning tasks verified after save."):console.warn("\u26a0\ufe0f [AUTO-SAVE] Cleaning tasks verification failed.",{completedMatch:e,assignmentsMatch:t,data:r})}else console.warn("\u26a0\ufe0f [AUTO-SAVE] Cleaning tasks verification: No data returned.")})()}catch(e){console.error("\u274c [AUTO-SAVE] Cleaning tasks save failed:",e)}}}),3e5);return()=>clearInterval(e)}),[i,s,le,T,C]),(0,e.useEffect)((()=>{const e=()=>{const e=localStorage.getItem("lastDailyResetNotification"),t=localStorage.getItem("lastTaskResetDate"),n=(0,N.po)(new Date);console.log("\ud83d\udd0d Checking notification:",{lastNotificationDate:e,lastResetDate:t,today:n,completedTasksSize:T.size,taskAssignmentsCount:Object.keys(C).length,shouldShow:t===n&&e!==n&&0===T.size&&0===Object.keys(C).length}),t===n&&e!==n&&0===T.size&&0===Object.keys(C).length&&(console.log("\ud83d\udce2 Showing daily reset notification"),Re(!0),localStorage.setItem("lastDailyResetNotification",n),setTimeout((()=>{Re(!1)}),8e3))};if(!s&&"connected"===i){const t=setTimeout(e,2e3);return()=>clearTimeout(t)}}),[T.size,C,s,i]),(0,e.useEffect)((()=>{const e=o.find((e=>e.id===ue.id));e&&ye(e.mood)}),[ue.id,o]),(0,e.useEffect)((()=>{D&&D.length>0&&Ie(D)}),[D]),(0,e.useEffect)((()=>{const e=Ye.length-(t=Ye,ee.resolveConflicts(t)).length;var t;Oe(e)}),[Ye]),(0,e.useEffect)((()=>{const e=Ge.length-(t=Ge,re.resolveConflicts(t)).length;var t;Oe((t=>t+e))}),[Ge]);(0,e.useCallback)((e=>{Ke((t=>[...t,e])),de(e)}),[de]),(0,e.useCallback)((e=>{$e((t=>[...t,e])),se(o,e)}),[o]);(0,e.useEffect)((()=>{const e=()=>{te.processQueue((async e=>{}))};return window.addEventListener("online",e),()=>{window.removeEventListener("online",e)}}),[]);const Xe=(0,e.useCallback)((()=>{"connected"===i&&le()}),[i,le]),Qe=(0,e.useCallback)((e=>{W(e),Xe()}),[W,Xe]),Je=(0,e.useCallback)((e=>{z(e),Xe()}),[z,Xe]),Ze=(0,e.useCallback)((e=>{B(e),Xe()}),[B,Xe]),et=(0,e.useCallback)((async e=>{console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save completedTasks:",Array.from(e));try{const s=await ce("completedTasks",Array.from(e));if(!0===s){var n,r;console.log("\ud83d\udd12 [CRITICAL-SAVE] CompletedTasks QuickSave confirmed by Firebase."),V(e);const s=await(null===(n=(r=t.current).getCleaningTasksData)||void 0===n?void 0:n.call(r));if(s){Array.from(e).every((e=>{var t,n;return null===(t=s.completedTasks)||void 0===t||null===(n=t.includes)||void 0===n?void 0:n.call(t,e)}))?console.log("\u2705 [CRITICAL-SAVE] Completed tasks successfully verified in Firebase."):console.warn("\u26a0\ufe0f [CRITICAL-SAVE] Completed tasks verification failed.",{tasks:e,data:s})}}else console.error("\u274c [CRITICAL-SAVE] CompletedTasks QuickSave failed:",s)}catch(s){console.error("\u274c [CRITICAL-SAVE] CompletedTasks QuickSave error:",s)}}),[ce,V]),tt=(0,e.useCallback)((async e=>{const n="function"===typeof e?e((0,r.A)({},C)):e;console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save taskAssignments:",n);try{const e=await ce("taskAssignments",n);if(!0===e){var s,a;console.log("\ud83d\udd12 [CRITICAL-SAVE] TaskAssignments QuickSave confirmed by Firebase."),q((()=>n));const e=await(null===(s=(a=t.current).getCleaningTasksData)||void 0===s?void 0:s.call(a));if(e){JSON.stringify(n)===JSON.stringify(e.taskAssignments)?console.log("\u2705 [CRITICAL-SAVE] Task assignments successfully verified in Firebase."):console.warn("\u26a0\ufe0f [CRITICAL-SAVE] Task assignments verification failed.",{newAssignments:n,data:e})}}else console.error("\u274c [CRITICAL-SAVE] TaskAssignments QuickSave failed:",e)}catch(i){console.error("\u274c [CRITICAL-SAVE] TaskAssignments QuickSave error:",i)}}),[ce,q,C]),nt=(0,e.useCallback)((e=>{Y(e),Xe()}),[Y,Xe]),rt=(0,e.useCallback)((e=>{const t="function"===typeof e?e(Ae):e;Ie(t),X((()=>t)),Xe()}),[Ae,X,Xe]),st=(0,e.useCallback)((()=>{if(!he)return;console.log("\ud83e\uddea MANUAL RESET: Triggered by admin"),console.log("\ud83d\udccb Before manual reset:",{completedTasksCount:T.size,taskAssignmentsCount:Object.keys(C).length,taskAssignments:C});const e=(0,N.po)(new Date);localStorage.removeItem("resetInProgress"),localStorage.removeItem("lastDailyResetNotification"),localStorage.removeItem("resetCheckedToday"),V(new Set),q((()=>({}))),localStorage.setItem("lastTaskResetDate",e),console.log("\u2705 MANUAL RESET: Cleared both completed tasks AND task assignments"),Re(!0),setTimeout((()=>{Re(!1)}),8e3),setTimeout((()=>{Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})]).then((()=>{console.log("\u2705 MANUAL RESET: Both completedTasks=[] and taskAssignments={} saved to Firebase")})).catch((e=>{console.error("\u274c MANUAL RESET: Failed to save to Firebase:",e)}))}),500)}),[he,V,q,ce,T,C]),at=(0,e.useCallback)((()=>{((e,t,n,r)=>{e===w.qw?(t(!0),n("admin"),r("")):alert("Invalid password!")})(Te,fe,we,Ce),Se(!1)}),[Te,fe,we,Ce]),it=o.find((e=>e.id===ue.id)),ot=(0,e.useCallback)((()=>{Ve((e=>!e)),qe.current&&(He?qe.current.disconnect():qe.current.connect())}),[He]),lt=(0,e.useCallback)((async()=>{if(qe.current)try{console.log("\ud83d\udd04 Refreshing data from all devices...");const e=await qe.current.refreshDataFromAllDevices();e.employees&&W(e.employees),e.tasks&&z(e.tasks),e.dailyData&&B(e.dailyData),e.completedTasks&&Array.isArray(e.completedTasks)&&V(new Set(e.completedTasks)),e.taskAssignments&&q(e.taskAssignments),console.log("\u2705 Data refreshed from all devices")}catch(e){console.error("\u274c Failed to refresh from all devices:",e)}else await oe()}),[oe,W,z,B,V,q]);return(0,e.useEffect)((()=>{if(!s&&"connected"===i&&o.length>0){const e=setTimeout((()=>{(async()=>{const e=(0,N.po)(new Date),n=await t.current.getLastTaskResetDate();if(console.log("\ud83d\udd0d [CROSS-DEVICE] Checking for automatic daily reset:",{today:e,lastResetDate:n,needsReset:n!==e,completedTasksCount:T.size,taskAssignmentsCount:Object.keys(C).length}),n!==e&&(T.size>0||Object.keys(C).length>0)){console.log("\ud83c\udf05 [CROSS-DEVICE] NEW DAY DETECTED: Attempting synchronized daily reset");const n="daily_reset_lock_".concat(e),u=localStorage.getItem("deviceId")||"device-".concat(Date.now()),h=Date.now()+3e4;try{var r,s,a,i;if(!0===await(null===(r=(s=t.current).acquireResetLock)||void 0===r?void 0:r.call(s,n,u,h)))console.log("\ud83d\udd12 [CROSS-DEVICE] Reset lock acquired, performing reset"),(await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})])).every((e=>!0===e))?(await t.current.setLastTaskResetDate(e),console.log("\u2705 [CROSS-DEVICE] Daily reset completed successfully"),Re(!0),setTimeout((()=>{Re(!1)}),8e3)):console.error("\u274c [CROSS-DEVICE] AUTOMATIC RESET: Failed to save to Firebase"),await(null===(a=(i=t.current).releaseResetLock)||void 0===a?void 0:a.call(i,n,u)),console.log("\ud83d\udd13 [CROSS-DEVICE] Reset lock released");else console.log("\u23f3 [CROSS-DEVICE] Another device is handling the daily reset, skipping")}catch(c){console.error("\u274c [CROSS-DEVICE] AUTOMATIC RESET: Error during reset:",c);try{var o,l;await(null===(o=(l=t.current).releaseResetLock)||void 0===o?void 0:o.call(l,n,u))}catch(d){console.error("\u274c [CROSS-DEVICE] Failed to release lock after error:",d)}}}})()}),2e3);return()=>clearTimeout(e)}}),[s,i,o.length,T.size,Object.keys(C).length,ce]),(0,e.useEffect)((()=>{const e=async()=>{if(!document.hidden&&!s&&"connected"===i){const e=(0,N.po)(new Date),n=await t.current.getLastTaskResetDate();console.log("\ud83d\udc41\ufe0f [CROSS-DEVICE] App became visible, checking for daily reset:",{today:e,lastResetDate:n,needsReset:n!==e}),n!==e&&(T.size>0||Object.keys(C).length>0)&&setTimeout((async()=>{try{(await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})])).every((e=>!0===e))&&(await t.current.setLastTaskResetDate(e),Re(!0),setTimeout((()=>Re(!1)),8e3))}catch(n){console.error("\u274c [CROSS-DEVICE] VISIBILITY RESET: Failed:",n)}}),1e3)}};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}),[s,i,T.size,Object.keys(C).length,ce]),(0,e.useEffect)((()=>{s||"connected"!==i||console.log("\ud83d\udcca DAILY RESET DEBUG:",{currentDate:(0,N.po)(new Date),lastResetDate:localStorage.getItem("lastTaskResetDate"),completedTasksCount:T.size,taskAssignmentsCount:Object.keys(C).length,isLoading:s,connectionStatus:i,employeeCount:o.length})}),[T.size,Object.keys(C).length,s,i]),(0,e.useEffect)((()=>(window.triggerDailyReset=async()=>{console.log("\ud83e\uddea MANUAL TRIGGER: Forcing daily reset from console");const e=(0,N.po)(new Date);localStorage.setItem("lastTaskResetDate",e);try{const e=await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})]);return console.log("\u2705 Manual trigger results:",e),e}catch(t){return console.error("\u274c Manual trigger failed:",t),!1}},()=>{delete window.triggerDailyReset})),[ce]),(0,k.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,k.jsxs)("div",{className:"bg-white shadow-sm border-b",children:[(0,k.jsxs)("div",{className:"px-4 py-3 flex justify-between items-center",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"WorkVibe"}),(0,k.jsxs)("button",{onClick:()=>ke(!Ne),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 mt-1",children:["Hello, ",ue.name,"!",(0,k.jsxs)("span",{className:"ml-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs font-medium",children:[(null===it||void 0===it?void 0:it.points)||0," pts"]}),(0,k.jsx)(l,{className:"w-4 h-4 ml-1"})]})]}),he&&(0,k.jsx)("div",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full",children:"Admin Mode"})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[he&&(0,k.jsx)("button",{onClick:()=>{ge(),we("mood")},className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg",title:"Logout Admin",children:(0,k.jsx)(c,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>Se(!0),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",title:"Admin Login",children:(0,k.jsx)(d,{className:"w-5 h-5"})})]})]}),Ne&&(0,k.jsxs)("div",{className:"absolute top-16 left-4 bg-white border rounded-lg shadow-lg z-40 w-64",children:[(0,k.jsx)("div",{className:"p-3 border-b bg-gray-50",children:(0,k.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Switch Employee"})}),(0,k.jsx)("div",{className:"max-h-64 overflow-y-auto",children:o.map((e=>(0,k.jsxs)("button",{onClick:()=>(pe(e),ke(!1),void we("mood")),className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center justify-between ".concat(ue.id===e.id?"bg-blue-50 border-r-2 border-blue-500":""),children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat(1===e.mood?"bg-red-500":2===e.mood?"bg-orange-500":3===e.mood?"bg-yellow-500":4===e.mood?"bg-green-500":"bg-blue-500")}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,k.jsxs)("div",{className:"text-xs text-gray-500",children:[e.role," \u2022 ",e.points," pts"]})]})]}),ue.id===e.id&&(0,k.jsx)(u,{className:"w-4 h-4 text-blue-500"})]},e.id)))})]})]}),(0,k.jsx)("div",{className:"bg-white border-b",children:(0,k.jsxs)("div",{className:"flex overflow-x-auto",children:[(0,k.jsxs)("button",{onClick:()=>we("mood"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("mood"===be?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(h,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Mood Tracker"})]}),(0,k.jsxs)("button",{onClick:()=>we("tasks"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("tasks"===be?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(f,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Cleaning Tasks"})]}),(0,k.jsxs)("button",{onClick:()=>we("prep"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("prep"===be?"border-b-2 border-green-500 text-green-600 bg-green-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(m,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Prep List"})]}),(0,k.jsxs)("button",{onClick:()=>we("inventory"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("inventory"===be?"border-b-2 border-orange-500 text-orange-600 bg-orange-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(p,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Restaurant Inventory"})]}),(0,k.jsxs)("button",{onClick:()=>we("store"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("store"===be?"border-b-2 border-purple-500 text-purple-600 bg-purple-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(g,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Store"})]}),he&&(0,k.jsxs)("button",{onClick:()=>we("admin"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("admin"===be?"border-b-2 border-red-500 text-red-600 bg-red-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(d,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Admin Panel"})]}),he&&(0,k.jsxs)("button",{onClick:()=>we("reports"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("reports"===be?"border-b-2 border-orange-500 text-orange-600 bg-orange-50":"text-gray-600 hover:text-gray-800"),children:[(0,k.jsx)(v,{className:"w-5 h-5 mx-auto mb-1"}),(0,k.jsx)("span",{className:"text-sm",children:"Daily Reports"})]})]})}),(0,k.jsxs)("div",{className:"p-4 space-y-6",children:[De&&(0,k.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-full mx-4",children:(0,k.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow-lg backdrop-blur-sm",children:(0,k.jsxs)("div",{className:"flex items-start",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,k.jsxs)("div",{className:"ml-3 flex-1",children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"\ud83c\udf05 New Day, Fresh Start!"}),(0,k.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"All cleaning tasks and assignments have been reset for today. Time to start fresh and earn those points!"})]})]})})}),he&&(0,k.jsx)("div",{className:"fixed bottom-20 right-4 z-50",children:(0,k.jsx)("button",{onClick:st,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full shadow-lg transition-colors text-sm font-medium",title:"Test Daily Reset - Clears both tasks AND assignments (Admin Only)",children:"\ud83e\uddea Test Reset"})}),(0,k.jsx)(Ed,{isLoading:s,lastSync:a,connectionStatus:i,loadFromFirebase:oe,conflictCount:Pe,activeDevices:Me,syncEvents:Fe,deviceCount:ze,isMultiDeviceEnabled:He,toggleMultiDeviceSync:ot,refreshFromAllDevices:lt}),"mood"===be&&(0,k.jsx)(_,{currentUser:ue,employees:o,userMood:xe,setUserMood:ye,setEmployees:Qe,setDailyData:Ze}),"tasks"===be&&(0,k.jsx)(O,{currentUser:ue,tasks:b,employees:o,completedTasks:T,taskAssignments:C,dailyData:S,setCompletedTasks:et,setTaskAssignments:tt,setDailyData:Ze,setEmployees:Qe,saveToFirebase:le}),"prep"===be&&(0,k.jsx)(We,{currentUser:ue,connectionStatus:i,prepItems:j,scheduledPreps:A,prepSelections:I,setPrepItems:K,setScheduledPreps:G,setPrepSelections:$,quickSave:ce}),"inventory"===be&&(0,k.jsx)(xd,{currentUser:ue,connectionStatus:i,inventoryDailyItems:R,inventoryWeeklyItems:P,inventoryMonthlyItems:M,inventoryDatabaseItems:L,inventoryActivityLog:F,inventoryCustomCategories:U,setInventoryDailyItems:Q,setInventoryWeeklyItems:J,setInventoryMonthlyItems:Z,setInventoryDatabaseItems:ne,setInventoryActivityLog:ae,setInventoryCustomCategories:ie,quickSave:ce}),"store"===be&&(0,k.jsx)(H,{currentUser:ue,employees:o,storeItems:Ae,dailyData:S,setEmployees:Qe,setDailyData:Ze,saveToFirebase:le}),"admin"===be&&he&&(0,k.jsx)(me,{employees:o,tasks:b,customRoles:E,storeItems:Ae,prepItems:j,setEmployees:Qe,setTasks:Je,setCustomRoles:nt,setStoreItems:rt,setPrepItems:K,quickSave:ce}),"reports"===be&&he&&(0,k.jsx)(ve,{selectedDate:Ee,setSelectedDate:je,dailyData:S,employees:o,connectionStatus:i})]}),_e&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white rounded-xl p-6 w-80 mx-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,k.jsx)(x,{className:"w-5 h-5 mr-2"}),"Admin Access"]}),(0,k.jsx)("button",{onClick:()=>{Se(!1),Ce("")},className:"text-gray-500 hover:text-gray-700",children:(0,k.jsx)(y,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("input",{type:"password",placeholder:"Enter admin password",value:Te,onChange:e=>Ce(e.target.value),onKeyPress:e=>"Enter"===e.key&&at(),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0}),(0,k.jsx)("button",{onClick:at,className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Login"})]})]})}),(Ne||_e)&&(0,k.jsx)("div",{className:"fixed inset-0 z-30",onClick:()=>{ke(!1),_e||Se(!1)}})]})},Ld=e=>{let{children:t}=e;return console.log("\ud83e\uddea OfflineDetector bypassed for testing environment"),(0,k.jsx)(k.Fragment,{children:t})};const Fd=function(){return(0,k.jsx)("div",{className:"App",children:(0,k.jsx)(Ld,{children:(0,k.jsx)(Md,{})})})};let Ud;function Wd(){const e=document.getElementById("pwa-install-btn");e&&(e.style.display="none")}t.createRoot(document.getElementById("root")).render((0,k.jsx)(e.StrictMode,{children:(0,k.jsx)(Fd,{})})),"serviceWorker"in navigator&&(window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((e=>{console.log("\u2705 PWA Service Worker registered successfully:",e.scope),e.addEventListener("updatefound",(()=>{const t=e.installing;t&&t.addEventListener("statechange",(()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("\ud83d\udd04 New version of WorkVibe available!"),window.confirm("New version of WorkVibe is available! Would you like to update?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload()))}))}))})).catch((e=>{console.warn("\u26a0\ufe0f PWA Service Worker not available (development mode or missing sw.js):",e.message)})),navigator.serviceWorker.addEventListener("message",(e=>{e.data&&"BACKGROUND_SYNC"===e.data.type&&console.log("\ud83d\udd04 Background sync completed")}))})),navigator.serviceWorker.addEventListener("controllerchange",(()=>{console.log("\ud83d\udd04 Service Worker controller changed"),window.location.reload()}))),window.addEventListener("beforeinstallprompt",(e=>{console.log("\ud83d\udcf1 PWA install prompt triggered"),e.preventDefault(),Ud=e,function(){const e=document.getElementById("pwa-install-btn");e&&(e.style.display="block",e.onclick=async()=>{if(Ud){Ud.prompt();const{outcome:e}=await Ud.userChoice;console.log("PWA install prompt: ".concat(e)),Ud=null,Wd()}})}()})),window.addEventListener("appinstalled",(()=>{console.log("\ud83c\udf89 WorkVibe PWA was installed successfully!"),Ud=null,Wd(),window.gtag&&window.gtag("event","pwa_install",{event_category:"engagement",event_label:"WorkVibe PWA Install"})})),window.addEventListener("online",(()=>{console.log("\ud83c\udf10 Back online!")})),window.addEventListener("offline",(()=>{console.log("\ud83d\udcf5 Gone offline")})),document.addEventListener("touchstart",(e=>{e.touches.length>1&&e.preventDefault()}));let zd=0;function Bd(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}document.addEventListener("touchend",(e=>{const t=(new Date).getTime();t-zd<=300&&e.preventDefault(),zd=t}),!1),Bd(),window.addEventListener("resize",Bd),window.addEventListener("orientationchange",(()=>{setTimeout(Bd,100)}))})()})();