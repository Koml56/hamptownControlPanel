/*! For license information please see main.7b9f1509.js.LICENSE.txt */
(()=>{var e={22:(e,t,n)=>{var s=n(635),r=n(581),a=n(336),i=s?s.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?r(e):a(e)}},49:(e,t)=>{"use strict";var n=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var b=v.prototype=new y;b.constructor=v,f(b,x.prototype),b.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,s){var r,a={},i=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)j.call(t,r)&&!k.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=s;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:n,type:e,key:i,ref:o,props:a,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,r,a,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case s:l=!0}}if(l)return i=i(l=e),e=""===a?"."+I(l,0):a,w(i)?(r="",null!=e&&(r=e.replace(S,"$&/")+"/"),T(i,t,r,"",(function(e){return e}))):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(S,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var d=a+I(o=e[c],c);l+=T(o,t,r,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=T(o=o.value,t,r,d=a+I(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function E(e,t,n){if(null==e)return e;var s=[],r=0;return T(e,s,"","",(function(e){return t.call(n,e,r++)})),s}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:E,forEach:function(e,t,n){E(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return E(e,(function(){t++})),t},toArray:function(e){return E(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=r,t.Profiler=i,t.PureComponent=v,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=M,t.cloneElement=function(e,t,s){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),a=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=N.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=s;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},51:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var s=n(526);function r(e,t,n){return(t=(0,s.A)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},119:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},170:(e,t,n)=>{"use strict";n.d(t,{cY:()=>y,FA:()=>D,g:()=>A,gz:()=>K,vA:()=>r,Hk:()=>a,K3:()=>o,u:()=>u,KA:()=>c,Uj:()=>d,gR:()=>U,Fy:()=>w,A4:()=>h,bD:()=>B,dI:()=>Y,T9:()=>x,yU:()=>g,Ku:()=>G,qc:()=>F,zJ:()=>v,Im:()=>q,zW:()=>T,jZ:()=>C,$g:()=>I,lV:()=>S,Cv:()=>O,$L:()=>R,kH:()=>W,gE:()=>b,Am:()=>H,yw:()=>z,OE:()=>$,kj:()=>Q,As:()=>M,P1:()=>k,eX:()=>E});const s={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},r=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+s.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},i=function(e){const t=[];let n=0;for(let s=0;s<e.length;s++){let r=e.charCodeAt(s);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&s+1<e.length&&56320===(64512&e.charCodeAt(s+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++s)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<e.length;r+=3){const t=e[r],a=r+1<e.length,i=a?e[r+1]:0,o=r+2<e.length,l=o?e[r+2]:0,c=t>>2,d=(3&t)<<4|i>>4;let u=(15&i)<<2|l>>6,h=63&l;o||(h=64,a||(u=64)),s.push(n[c],n[d],n[u],n[h])}return s.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,s=0;for(;n<e.length;){const r=e[n++];if(r<128)t[s++]=String.fromCharCode(r);else if(r>191&&r<224){const a=e[n++];t[s++]=String.fromCharCode((31&r)<<6|63&a)}else if(r>239&&r<365){const a=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[s++]=String.fromCharCode(55296+(a>>10)),t[s++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],i=e[n++];t[s++]=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const i=r<e.length?n[e.charAt(r)]:64;++r;const o=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==a||null==i||null==o)throw new l;const c=t<<2|a>>4;if(s.push(c),64!==i){const e=a<<4&240|i>>2;if(s.push(e),64!==o){const e=i<<6&192|o;s.push(e)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){const t=i(e);return o.encodeByteArray(t,!0)},d=function(e){return c(e).replace(/\./g,"")},u=function(e){try{return o.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(e){return m(void 0,e)}function m(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=m(e[n],t[n]));return e}const p=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,f=()=>{try{return p()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},g=e=>{const t=(e=>{var t,n;return null===(n=null===(t=f())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const s=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),s]:[t.substring(0,n),s]},x=()=>{var e;return null===(e=f())||void 0===e?void 0:e.config};class y{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function v(e){return e.endsWith(".cloudworkstations.dev")}async function b(e){return(await fetch(e,{credentials:"include"})).ok}function w(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",s=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(a)),""].join(".")}const j={};let N=!1;function k(e,t){if("undefined"===typeof window||"undefined"===typeof document||!v(window.location.host)||j[e]===t||j[e]||N)return;function n(e){return"__firebase__banner__".concat(e)}j[e]=t;const s="__firebase__banner",r=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(j))j[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function a(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{N=!0,function(){const e=document.getElementById(s);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(s),t=n("text"),i=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=a();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,i,l,n),document.body.appendChild(t)}r?(i.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function _(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function C(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_())}function S(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function I(){return!0===s.NODE_CLIENT||!0===s.NODE_ADMIN}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function E(){return new Promise(((e,t)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class A extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,A.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),s=this.errors[e],r=s?function(e,t){return e.replace(P,((e,n)=>{const s=t[n];return null!=s?String(s):"<".concat(n,"?>")}))}(s,t):"Error",a="".concat(this.serviceName,": ").concat(r," (").concat(n,").");return new A(n,a,t)}}const P=/\{\$([^}]+)}/g;function R(e){return JSON.parse(e)}function M(e){return JSON.stringify(e)}const L=function(e){let t={},n={},s={},r="";try{const a=e.split(".");t=R(u(a[0])||""),n=R(u(a[1])||""),r=a[2],s=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:s,signature:r}},O=function(e){const t=L(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},F=function(e){const t=L(e).claims;return"object"===typeof t&&!0===t.admin};function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function z(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function q(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function W(e,t,n){const s={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=t.call(n,e[r],r,e));return s}function B(e,t){if(e===t)return!0;const n=Object.keys(e),s=Object.keys(t);for(const r of n){if(!s.includes(r))return!1;const n=e[r],a=t[r];if(V(n)&&V(a)){if(!B(n,a))return!1}else if(n!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function V(e){return null!==e&&"object"===typeof e}function H(e){const t=[];for(const[n,s]of Object.entries(e))Array.isArray(s)?s.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}class K{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let d=0;d<16;d++)n[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)n[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const e=n[d-3]^n[d-8]^n[d-14]^n[d-16];n[d]=4294967295&(e<<1|e>>>31)}let s,r,a=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(s=l^i&(o^l),r=1518500249):(s=i^o^l,r=1859775393):d<60?(s=i&o|l&(i|o),r=2400959708):(s=i^o^l,r=3395469782);const e=(a<<5|a>>>27)+s+c+r+n[d]&4294967295;c=l,l=o,o=4294967295&(i<<30|i>>>2),i=a,a=e}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let s=0;const r=this.buf_;let a=this.inbuf_;for(;s<t;){if(0===a)for(;s<=n;)this.compress_(e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[a]=e.charCodeAt(s),++a,++s,a===this.blockSize){this.compress_(r),a=0;break}}else for(;s<t;)if(r[a]=e[s],++a,++s,a===this.blockSize){this.compress_(r),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let s=0;s<5;s++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[s]>>t&255,++n;return e}}function Y(e,t){return"".concat(e," failed: ").concat(t," argument ")}const Q=function(e){const t=[];let n=0;for(let s=0;s<e.length;s++){let a=e.charCodeAt(s);if(a>=55296&&a<=56319){const t=a-55296;s++,r(s<e.length,"Surrogate pair missing trail surrogate.");a=65536+(t<<10)+(e.charCodeAt(s)-56320)}a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):a<65536?(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},$=function(e){let t=0;for(let n=0;n<e.length;n++){const s=e.charCodeAt(n);s<128?t++:s<2048?t+=2:s>=55296&&s<=56319?(t+=4,n++):t+=3}return t};function G(e){return e&&e._delegate?e._delegate:e}},184:(e,t,n)=>{var s=n(22),r=n(248);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==s(e)}},248:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},253:(e,t,n)=>{"use strict";n.d(t,{h1:()=>o,uA:()=>r});var s=n(170);class r{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const a="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new s.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),s=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:s});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&a.resolve(s)}return s}onInit(e,t){var n;const s=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(s,r);const a=this.instances.get(s);return a&&e(a,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(s){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===a?void 0:r),options:n}),this.instances.set(t,s),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch(i){}var r;return s||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.component?this.component.multipleInstances?e:a:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},277:(e,t,n)=>{"use strict";n.d(t,{f:()=>l});var s=n(51),r=n(607),a=n(291),i=n(815),o=n(578);class l{constructor(){this.baseUrl=r.Nd.databaseURL,this.saveQueue=new Set,this.isCurrentlySaving=!1,this.app=(0,i.Wp)(r.Nd),this.db=(0,o.C3)(this.app),this.pendingSaves=new Map,this.lastSaveTimestamps=new Map,this.saveAttempts=new Map}async getLastTaskResetDate(){try{const e=await fetch("".concat(this.baseUrl,"/meta/lastTaskResetDate.json"));if(!e.ok)throw new Error("Failed to fetch lastTaskResetDate");const t=await e.json();return"string"===typeof t?t:null}catch(e){return console.error("\u274c Error fetching lastTaskResetDate:",e),null}}async setLastTaskResetDate(e){try{if(!(await fetch("".concat(this.baseUrl,"/meta/lastTaskResetDate.json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Failed to set lastTaskResetDate");return!0}catch(t){return console.error("\u274c Error setting lastTaskResetDate:",t),!1}}async acquireResetLock(e,t,n){try{const s=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(s.ok){const e=await s.json();if(e&&e.expiry>Date.now())return e.deviceId===t}const r={deviceId:t,expiry:n,timestamp:Date.now()};if(!(await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Failed to acquire lock");const a=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(!a.ok)return!1;const i=await a.json();return i&&i.deviceId===t&&i.expiry===n}catch(s){return console.error("\u274c Error acquiring reset lock:",s),!1}}async releaseResetLock(e,t){try{const n=await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"));if(n.ok){const e=await n.json();if(e&&e.deviceId!==t)return console.warn("\u26a0\ufe0f Attempted to release lock owned by another device"),!1}return(await fetch("".concat(this.baseUrl,"/locks/").concat(e,".json"),{method:"DELETE"})).ok}catch(n){return console.error("\u274c Error releasing reset lock:",n),!1}}async quickSave(e,t){const n=Date.now()-(this.lastSaveTimestamps.get(e)||0);if(n<2e3){console.log("\u23f3 Debouncing rapid save for ".concat(e," (").concat(n,"ms since last save)"));const s=this.pendingSaves.get(e);s&&clearTimeout(s);const r=setTimeout((()=>{this.executeSave(e,t),this.pendingSaves.delete(e)}),1500);return this.pendingSaves.set(e,r),!0}return this.executeSave(e,t)}async executeSave(e,t){console.log("\ud83d\udd25 QuickSave: ".concat(e)),console.log("\ud83d\udd0d Saving ".concat(e," to Firebase:"),this.getDataSummary(e,t));const n=this.saveAttempts.get(e)||0;if(this.saveAttempts.set(e,n+1),n>5)return console.warn("\u26a0\ufe0f Too many save attempts for ".concat(e,", throttling...")),this.saveAttempts.set(e,0),!1;try{const n=await fetch("".concat(this.baseUrl,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Firebase save failed: ".concat(n.status," ").concat(n.statusText));console.log("\ud83d\udd12 Critical save - waiting for confirmation: ".concat(e));if("completedTasks"===e||"taskAssignments"===e){const t=await fetch("".concat(this.baseUrl,"/").concat(e,".json")),n=await t.json();console.log("\ud83d\udd0d Verified data in Firebase after save:",this.getDataSummary(e,n))}return console.log("\u2705 Critical QuickSave completed: ".concat(e)),console.log("\ud83d\udd12 [CRITICAL-SAVE] ".concat(e.charAt(0).toUpperCase()+e.slice(1)," QuickSave confirmed by Firebase.")),this.lastSaveTimestamps.set(e,Date.now()),this.saveAttempts.set(e,0),!0}catch(s){return console.error("\u274c QuickSave failed for ".concat(e,":"),s),!1}}async batchSave(e,t){if(this.isCurrentlySaving)return console.log("\u23f3 Save already in progress, queueing fields:",e),e.forEach((e=>this.saveQueue.add(e))),!0;this.isCurrentlySaving=!0,console.log("\ud83d\udd04 Batch syncing fields:",e);try{const n=e.map((async e=>{const n=this.getFieldData(e,t);return this.quickSave(e,n)})),s=(await Promise.all(n)).every((e=>!0===e));if(s){if(console.log("\u2705 Batch sync completed"),this.saveQueue.size>0){const e=Array.from(this.saveQueue);this.saveQueue.clear(),console.log("\ud83d\udce4 Processing sync queue:",e),setTimeout((()=>{this.batchSave(e,t)}),100)}}else console.error("\u274c Some batch saves failed");return s}catch(n){return console.error("\u274c Batch save failed:",n),!1}finally{this.isCurrentlySaving=!1}}getFieldData(e,t){switch(e){case"employees":return t.employees;case"tasks":return t.tasks;case"dailyData":return t.dailyData;case"completedTasks":return Array.from(t.completedTasks);case"taskAssignments":return t.taskAssignments;case"customRoles":return t.customRoles;case"prepItems":return t.prepItems;case"scheduledPreps":return t.scheduledPreps;case"prepSelections":return t.prepSelections;case"storeItems":return t.storeItems;case"inventoryDailyItems":return t.inventoryDailyItems;case"inventoryWeeklyItems":return t.inventoryWeeklyItems;case"inventoryMonthlyItems":return t.inventoryMonthlyItems;case"inventoryDatabaseItems":return t.inventoryDatabaseItems;case"inventoryActivityLog":return t.inventoryActivityLog;default:return console.warn("Unknown field: ".concat(e)),null}}getDataSummary(e,t){var n,s,r,a;switch(e){case"employees":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,sampleEmployee:(null===t||void 0===t||null===(n=t[0])||void 0===n?void 0:n.name)||"none"};case"tasks":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,sampleTask:(null===t||void 0===t||null===(s=t[0])||void 0===s?void 0:s.task)||"none"};case"dailyData":return{totalDates:Object.keys(t||{}).length,latestDate:Object.keys(t||{}).sort().pop()||"none"};case"completedTasks":return{completedCount:Array.isArray(t)?t.length:(null===t||void 0===t?void 0:t.size)||0};case"taskAssignments":return{totalAssignments:Object.keys(t||{}).length};case"customRoles":return{rolesCount:(null===t||void 0===t?void 0:t.length)||0,roles:t||[]};case"prepItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,samplePrep:(null===t||void 0===t||null===(r=t[0])||void 0===r?void 0:r.name)||"none"};case"scheduledPreps":const e=(new Date).toISOString().split("T")[0],i=(t||[]).filter((t=>t.scheduledDate===e));return{totalCount:(t||[]).length,todayCount:i.length,todayCompletedCount:i.filter((e=>e.completed)).length,sampleTodayPreps:i.slice(0,3).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate})))};case"prepSelections":return{totalSelections:Object.keys(t||{}).length,sampleKeys:Object.keys(t||{}).slice(0,3)};case"storeItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,availableCount:(t||[]).filter((e=>e.available)).length};case"inventoryDailyItems":case"inventoryWeeklyItems":case"inventoryMonthlyItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,criticalCount:(t||[]).filter((e=>e.currentStock<=.5*e.minLevel)).length};case"inventoryDatabaseItems":return{totalCount:(null===t||void 0===t?void 0:t.length)||0,assignedCount:(t||[]).filter((e=>e.isAssigned)).length};case"inventoryActivityLog":return{totalEntries:(null===t||void 0===t?void 0:t.length)||0,latestEntry:(null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.timestamp)||"none"};default:return t}}async loadData(){console.log("\ud83d\udd25 Loading data from Firebase...");try{const[e,t,n,r,i,o,l,c,d,u,h,m,p,f,g]=await Promise.all([fetch("".concat(this.baseUrl,"/employees.json")),fetch("".concat(this.baseUrl,"/tasks.json")),fetch("".concat(this.baseUrl,"/dailyData.json")),fetch("".concat(this.baseUrl,"/completedTasks.json")),fetch("".concat(this.baseUrl,"/taskAssignments.json")),fetch("".concat(this.baseUrl,"/customRoles.json")),fetch("".concat(this.baseUrl,"/prepItems.json")),fetch("".concat(this.baseUrl,"/scheduledPreps.json")),fetch("".concat(this.baseUrl,"/prepSelections.json")),fetch("".concat(this.baseUrl,"/storeItems.json")),fetch("".concat(this.baseUrl,"/inventoryDailyItems.json")),fetch("".concat(this.baseUrl,"/inventoryWeeklyItems.json")),fetch("".concat(this.baseUrl,"/inventoryMonthlyItems.json")),fetch("".concat(this.baseUrl,"/inventoryDatabaseItems.json")),fetch("".concat(this.baseUrl,"/inventoryActivityLog.json"))]),x=await e.json(),y=await t.json(),v=await n.json(),b=await r.json(),w=await i.json(),j=await o.json(),N=await l.json(),k=await c.json(),_=await d.json(),C=await u.json(),S=await h.json(),I=await m.json(),T=await p.json(),E=await f.json(),A=await g.json(),D=x?x.map((e=>(0,s.A)((0,s.A)({},e),{},{points:void 0!==e.points?e.points:0}))):(0,a.PR)(),P=y?y.map((e=>(0,s.A)((0,s.A)({},e),{},{points:void 0!==e.points?e.points:this.getDefaultTaskPoints(e.priority)}))):(0,a.w4)(),R=v?this.migrateDailyData(v):(0,a.tU)();return console.log("\u2705 Firebase: Data loaded and migrated successfully"),console.log("\ud83d\udc65 Employees with points:",D),k&&console.log("\ud83d\udccb Loaded scheduledPreps:",this.getDataSummary("scheduledPreps",k)),{employees:D,tasks:P,dailyData:R,completedTasks:new Set(b||[]),taskAssignments:w||{},customRoles:j||["Cleaner","Manager","Supervisor"],prepItems:N||[],scheduledPreps:k||[],prepSelections:_||{},storeItems:C||[],inventoryDailyItems:S||[],inventoryWeeklyItems:I||[],inventoryMonthlyItems:T||[],inventoryDatabaseItems:E||[],inventoryActivityLog:A||[]}}catch(e){throw console.error("\u274c Firebase connection failed:",e),e}}getDefaultTaskPoints(e){switch(e){case"high":return 10;case"medium":default:return 5;case"low":return 3}}migrateDailyData(e){const t={};return Object.keys(e).forEach((n=>{const s=e[n];t[n]={completedTasks:s.completedTasks||[],employeeMoods:s.employeeMoods||[],purchases:s.purchases||[],totalTasks:s.totalTasks||22,completionRate:s.completionRate||0,totalPointsEarned:s.totalPointsEarned||0,totalPointsSpent:s.totalPointsSpent||0}})),t}async saveData(e){console.log("\ud83d\udd25 Saving all data to Firebase...");if(!await this.batchSave(["employees","tasks","dailyData","completedTasks","taskAssignments","customRoles","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"],e))throw console.error("\u274c Firebase: Some data failed to save"),new Error("Firebase save failed");console.log("\u2705 Firebase: All data saved successfully")}async saveImmediate(e,t,n){console.log("\ud83d\udd25 Immediate save triggered by ".concat(e," change"));const s=await this.quickSave(e,t);return s&&n&&"scheduledPreps"!==e&&setTimeout((()=>{console.log("\ud83d\udd04 Background sync of related fields");const t=this.getRelatedFields(e);t.length>0&&this.batchSave(t,n)}),1e3),s}getRelatedFields(e){switch(e){case"completedTasks":return["employees","dailyData","taskAssignments"];case"employees":return["dailyData"];case"taskAssignments":return["completedTasks"];case"scheduledPreps":return["prepSelections"];case"inventoryDailyItems":case"inventoryWeeklyItems":case"inventoryMonthlyItems":return["inventoryActivityLog"];case"inventoryDatabaseItems":return["inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems"];default:return[]}}onCompletedTasksChange(e){const t=(0,o.KR)(this.db,"completedTasks"),n=(0,o.Zy)(t,(t=>{const n=t.val()||[];e(n)}));return()=>(0,o.AU)(t,"value",n)}onTaskAssignmentsChange(e){const t=(0,o.KR)(this.db,"taskAssignments"),n=(0,o.Zy)(t,(t=>{const n=t.val()||{};e(n)}));return()=>(0,o.AU)(t,"value",n)}}},291:(e,t,n)=>{"use strict";n.d(t,{PR:()=>r,h3:()=>i,tU:()=>o,w4:()=>a});var s=n(867);const r=()=>[{id:1,name:"Luka",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:2,name:"Safi",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:3,name:"Ehsan",mood:3,lastUpdated:"Not updated",role:"Cleaner",lastMoodDate:null,points:0},{id:4,name:"Oleksii",mood:3,lastUpdated:"Not updated",role:"Manager",lastMoodDate:null,points:0}],a=()=>[{id:1,task:"Water all plants",location:"Dining Area",priority:"medium",estimatedTime:"10 min",points:5},{id:2,task:"Refill toilet paper",location:"Restroom",priority:"high",estimatedTime:"5 min",points:8},{id:3,task:"Sweep the floor",location:"Kitchen",priority:"high",estimatedTime:"15 min",points:10},{id:4,task:"Wipe refrigerator surfaces",location:"Kitchen",priority:"medium",estimatedTime:"10 min",points:7},{id:5,task:"Light glass wipe",location:"Kitchen (kylm\xe4vitrini)",priority:"low",estimatedTime:"5 min",points:3},{id:6,task:"Refill takeaway & snack boxes",location:"Kitchen",priority:"medium",estimatedTime:"10 min",points:6},{id:7,task:"Stock napkins",location:"Kitchen",priority:"medium",estimatedTime:"5 min",points:4},{id:8,task:"Wipe and disinfect tables",location:"Dining Area",priority:"high",estimatedTime:"20 min",points:12},{id:9,task:"Clean table legs",location:"Dining Area",priority:"low",estimatedTime:"15 min",points:8},{id:10,task:"Vacuum the floor",location:"Dining Area",priority:"high",estimatedTime:"20 min",points:15},{id:11,task:"Clean sink and mirror",location:"Restroom",priority:"high",estimatedTime:"10 min",points:9},{id:12,task:"Clean inside the toilet",location:"Restroom",priority:"high",estimatedTime:"15 min",points:12},{id:13,task:"Replace towel roll",location:"Restroom",priority:"medium",estimatedTime:"5 min",points:4},{id:14,task:"Final disinfection (POS, Foodora, Wolt)",location:"POS / Front",priority:"high",estimatedTime:"10 min",points:10},{id:15,task:"Sweep the floor",location:"Kitchen (Floor)",priority:"high",estimatedTime:"15 min",points:10},{id:16,task:"Mop the floor (every 2 days)",location:"Kitchen (Floor)",priority:"high",estimatedTime:"20 min",points:15},{id:17,task:"Full grill cleaning",location:"Kitchen",priority:"high",estimatedTime:"45 min",points:25},{id:18,task:"Sanitize all surfaces",location:"Kitchen",priority:"high",estimatedTime:"25 min",points:18},{id:19,task:"Wipe dishwasher surface",location:"Apu-Kitchen",priority:"medium",estimatedTime:"10 min",points:6},{id:20,task:"Replace hood filter (every 3 days)",location:"Kitchen",priority:"medium",estimatedTime:"15 min",points:8},{id:21,task:"Cover all food containers",location:"Storage",priority:"high",estimatedTime:"10 min",points:7},{id:22,task:"Organize containers",location:"Apu-Kitchen",priority:"low",estimatedTime:"15 min",points:5}],i=()=>[{id:1,name:"Free Coffee",description:"Get a free coffee from the kitchen",cost:10,category:"food",icon:"\u2615",available:!0},{id:2,name:"Free Lunch",description:"Get a free meal from the restaurant",cost:50,category:"food",icon:"\ud83c\udf7d\ufe0f",available:!0},{id:3,name:"Free Meal for Friend",description:"Bring a friend for a free meal",cost:80,category:"social",icon:"\ud83d\udc65",available:!0},{id:4,name:"30min Break Extension",description:"Extend your break by 30 minutes",cost:25,category:"break",icon:"\u23f0",available:!0},{id:5,name:"Early Leave (1 hour)",description:"Leave work 1 hour early",cost:60,category:"break",icon:"\ud83d\udeaa",available:!0},{id:6,name:"Free Snack",description:"Get any snack from the kitchen",cost:15,category:"food",icon:"\ud83c\udf7f",available:!0},{id:7,name:"Choose Next Week Schedule",description:"Pick your preferred shifts next week",cost:100,category:"reward",icon:"\ud83d\udcc5",available:!0},{id:8,name:"Team Building Activity",description:"Organize a fun team activity",cost:150,category:"social",icon:"\ud83c\udf89",available:!0},{id:9,name:"Free Dessert",description:"Get any dessert from the menu",cost:20,category:"food",icon:"\ud83c\udf70",available:!0},{id:10,name:"Reserved Parking Spot",description:"Get the best parking spot for a week",cost:40,category:"reward",icon:"\ud83d\ude97",available:!0}],o=()=>{const e=Array.from({length:30},((e,t)=>{const n=new Date;return n.setDate(n.getDate()-t),(0,s.po)(n)})),t={};return e.forEach((e=>{t[e]={completedTasks:[],employeeMoods:[],purchases:[],totalTasks:22,completionRate:0,totalPointsEarned:0,totalPointsSpent:0}})),t}},336:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},340:(e,t,n)=>{"use strict";e.exports=n(761)},345:(e,t,n)=>{"use strict";var s=n(950),r=n(340);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function f(e,t,n,s,r,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function v(e,t,n,s){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:s||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,s){if(null===t||"undefined"===typeof t||function(e,t,n,s){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!s&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,s))return!0;if(s)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,s)&&(n=null),s||null===r?function(e){return!!u.call(p,e)||!u.call(m,e)&&(h.test(e)?p[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,s=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),S=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var L,O=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),a=s.stack.split("\n"),i=r.length-1,o=a.length-1;1<=i&&0<=o&&r[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==a[o]){if(1!==i||1!==o)do{if(i--,0>--o||r[i]!==a[o]){var l="\n"+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function q(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case j:return"Portal";case _:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case E:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){s=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=H(e)?e.checked?"true":"false":e.value),(e=s)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,s=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Z(e,t){J(e,t);var n=V(t.value),s=t.type;if(null!=n)"number"===s?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===s||"reset"===s)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!("submit"!==s&&"reset"!==s||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(s&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ae(e,t){var n=V(t.value),s=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=s&&(e.defaultValue=""+s)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,s){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var s=0===n.indexOf("--"),r=fe(n,t[n],s);"float"===n&&(n="cssFloat"),s?e.setProperty(n,r):e[n]=r}}Object.keys(me).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]}))}));var xe=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,Ne=null,ke=null;function _e(e){if(e=vr(e)){if("function"!==typeof je)throw Error(a(280));var t=e.stateNode;t&&(t=wr(t),je(e.stateNode,e.type,t))}}function Ce(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function Se(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ie(e,t){return e(t)}function Te(){}var Ee=!1;function Ae(e,t,n){if(Ee)return e(t,n);Ee=!0;try{return Ie(e,t,n)}finally{Ee=!1,(null!==Ne||null!==ke)&&(Te(),Se())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var s=wr(n);if(null===s)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Pe=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Pe=!1}function Me(e,t,n,s,r,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Le=!1,Oe=null,Fe=!1,Ue=null,ze={onError:function(e){Le=!0,Oe=e}};function qe(e,t,n,s,r,a,i,o,l){Le=!1,Oe=null,Me.apply(ze,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(We(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(s=r.return)){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Ve(r),e;if(i===s)return Ve(r),t;i=i.sibling}throw Error(a(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,s=i;break}if(l===s){o=!0,s=r,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,s=r;break}if(l===s){o=!0,s=i,n=r;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==s)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ye=r.unstable_scheduleCallback,Qe=r.unstable_cancelCallback,$e=r.unstable_shouldYield,Ge=r.unstable_requestPaint,Je=r.unstable_now,Ze=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,st=r.unstable_IdlePriority,rt=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var s=0,r=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~r;0!==o?s=ut(o):0!==(a&=i)&&(s=ut(a))}else 0!==(i=n&~r)?s=ut(i):0!==a&&(s=ut(a));if(0===s)return 0;if(0!==t&&t!==s&&0===(t&r)&&((r=s&-s)>=(a=t&-t)||16===r&&0!==(4194240&a)))return t;if(0!==(4&s)&&(s|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=s;0<t;)r=1<<(n=31-it(t)),s|=e[n],t&=~r;return s}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-it(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,jt,Nt,kt,_t,Ct=!1,St=[],It=null,Tt=null,Et=null,At=new Map,Dt=new Map,Pt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Et=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,n,s,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=vr(t))&&jt(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ot(e){var t=yr(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void _t(e.priority,(function(){Nt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vr(n))&&jt(t),e.blockedOn=n,!1;var s=new(n=e.nativeEvent).constructor(n.type,n);be=s,n.target.dispatchEvent(s),be=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function zt(){Ct=!1,null!==It&&Ft(It)&&(It=null),null!==Tt&&Ft(Tt)&&(Tt=null),null!==Et&&Ft(Et)&&(Et=null),At.forEach(Ut),Dt.forEach(Ut)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zt)))}function Wt(e){function t(t){return qt(t,e)}if(0<St.length){qt(St[0],e);for(var n=1;n<St.length;n++){var s=St[n];s.blockedOn===e&&(s.blockedOn=null)}}for(null!==It&&qt(It,e),null!==Tt&&qt(Tt,e),null!==Et&&qt(Et,e),At.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(s=Pt[n]).blockedOn===e&&(s.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Pt.shift()}var Bt=b.ReactCurrentBatchConfig,Vt=!0;function Ht(e,t,n,s){var r=vt,a=Bt.transition;Bt.transition=null;try{vt=1,Yt(e,t,n,s)}finally{vt=r,Bt.transition=a}}function Kt(e,t,n,s){var r=vt,a=Bt.transition;Bt.transition=null;try{vt=4,Yt(e,t,n,s)}finally{vt=r,Bt.transition=a}}function Yt(e,t,n,s){if(Vt){var r=$t(e,t,n,s);if(null===r)Vs(e,t,s,Qt,n),Mt(e,s);else if(function(e,t,n,s,r){switch(t){case"focusin":return It=Lt(It,e,t,n,s,r),!0;case"dragenter":return Tt=Lt(Tt,e,t,n,s,r),!0;case"mouseover":return Et=Lt(Et,e,t,n,s,r),!0;case"pointerover":var a=r.pointerId;return At.set(a,Lt(At.get(a)||null,e,t,n,s,r)),!0;case"gotpointercapture":return a=r.pointerId,Dt.set(a,Lt(Dt.get(a)||null,e,t,n,s,r)),!0}return!1}(r,e,t,n,s))s.stopPropagation();else if(Mt(e,s),4&t&&-1<Rt.indexOf(e)){for(;null!==r;){var a=vr(r);if(null!==a&&wt(a),null===(a=$t(e,t,n,s))&&Vs(e,t,s,Qt,n),a===r)break;r=a}null!==r&&s.stopPropagation()}else Vs(e,t,s,null,n)}}var Qt=null;function $t(e,t,n,s){if(Qt=null,null!==(e=yr(e=we(s))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case st:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Zt,s=n.length,r="value"in Jt?Jt.value:Jt.textContent,a=r.length;for(e=0;e<s&&n[e]===r[e];e++);var i=s-e;for(t=1;t<=i&&n[s-t]===r[a-t];t++);return Xt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function sn(){return!1}function rn(e){function t(t,n,s,r,a){for(var i in this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=O({},cn,{view:0,detail:0}),hn=rn(un),mn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=rn(mn),fn=rn(O({},mn,{dataTransfer:0})),gn=rn(O({},un,{relatedTarget:0})),xn=rn(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=rn(yn),bn=rn(O({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function _n(){return kn}var Cn=O({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=rn(Cn),In=rn(O({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=rn(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),En=rn(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=O({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=rn(An),Pn=[9,13,27,32],Rn=d&&"CompositionEvent"in window,Mn=null;d&&"documentMode"in document&&(Mn=document.documentMode);var Ln=d&&"TextEvent"in window&&!Mn,On=d&&(!Rn||Mn&&8<Mn&&11>=Mn),Fn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Hn(e,t,n,s){Ce(s),0<(t=Ks(t,"onChange")).length&&(n=new dn("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Kn=null,Yn=null;function Qn(e){Fs(e,0)}function $n(e){if(Y(br(e)))return e}function Gn(e,t){if("change"===e)return t}var Jn=!1;if(d){var Zn;if(d){var Xn="oninput"in document;if(!Xn){var es=document.createElement("div");es.setAttribute("oninput","return;"),Xn="function"===typeof es.oninput}Zn=Xn}else Zn=!1;Jn=Zn&&(!document.documentMode||9<document.documentMode)}function ts(){Kn&&(Kn.detachEvent("onpropertychange",ns),Yn=Kn=null)}function ns(e){if("value"===e.propertyName&&$n(Yn)){var t=[];Hn(t,Yn,e,we(e)),Ae(Qn,t)}}function ss(e,t,n){"focusin"===e?(ts(),Yn=n,(Kn=t).attachEvent("onpropertychange",ns)):"focusout"===e&&ts()}function rs(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Yn)}function as(e,t){if("click"===e)return $n(t)}function is(e,t){if("input"===e||"change"===e)return $n(t)}var os="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ls(e,t){if(os(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!u.call(t,r)||!os(e[r],t[r]))return!1}return!0}function cs(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ds(e,t){var n,s=cs(e);for(e=0;s;){if(3===s.nodeType){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=cs(s)}}function us(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?us(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hs(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(s){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function ms(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ps(e){var t=hs(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&us(n.ownerDocument.documentElement,n)){if(null!==s&&ms(n))if(t=s.start,void 0===(e=s.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,a=Math.min(s.start,r);s=void 0===s.end?a:Math.min(s.end,r),!e.extend&&a>s&&(r=s,s=a,a=r),r=ds(n,a);var i=ds(n,s);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fs=d&&"documentMode"in document&&11>=document.documentMode,gs=null,xs=null,ys=null,vs=!1;function bs(e,t,n){var s=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vs||null==gs||gs!==Q(s)||("selectionStart"in(s=gs)&&ms(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},ys&&ls(ys,s)||(ys=s,0<(s=Ks(xs,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=gs)))}function ws(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var js={animationend:ws("Animation","AnimationEnd"),animationiteration:ws("Animation","AnimationIteration"),animationstart:ws("Animation","AnimationStart"),transitionend:ws("Transition","TransitionEnd")},Ns={},ks={};function _s(e){if(Ns[e])return Ns[e];if(!js[e])return e;var t,n=js[e];for(t in n)if(n.hasOwnProperty(t)&&t in ks)return Ns[e]=n[t];return e}d&&(ks=document.createElement("div").style,"AnimationEvent"in window||(delete js.animationend.animation,delete js.animationiteration.animation,delete js.animationstart.animation),"TransitionEvent"in window||delete js.transitionend.transition);var Cs=_s("animationend"),Ss=_s("animationiteration"),Is=_s("animationstart"),Ts=_s("transitionend"),Es=new Map,As="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(e,t){Es.set(e,t),l(t,[e])}for(var Ps=0;Ps<As.length;Ps++){var Rs=As[Ps];Ds(Rs.toLowerCase(),"on"+(Rs[0].toUpperCase()+Rs.slice(1)))}Ds(Cs,"onAnimationEnd"),Ds(Ss,"onAnimationIteration"),Ds(Is,"onAnimationStart"),Ds("dblclick","onDoubleClick"),Ds("focusin","onFocus"),Ds("focusout","onBlur"),Ds(Ts,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ls=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function Os(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,s,r,i,o,l,c){if(qe.apply(this,arguments),Le){if(!Le)throw Error(a(198));var d=Oe;Le=!1,Oe=null,Fe||(Fe=!0,Ue=d)}}(s,t,void 0,e),e.currentTarget=null}function Fs(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var o=s[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&r.isPropagationStopped())break e;Os(r,o,c),a=l}else for(i=0;i<s.length;i++){if(l=(o=s[i]).instance,c=o.currentTarget,o=o.listener,l!==a&&r.isPropagationStopped())break e;Os(r,o,c),a=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Us(e,t){var n=t[fr];void 0===n&&(n=t[fr]=new Set);var s=e+"__bubble";n.has(s)||(Bs(t,e,2,!1),n.add(s))}function zs(e,t,n){var s=0;t&&(s|=4),Bs(n,e,s,t)}var qs="_reactListening"+Math.random().toString(36).slice(2);function Ws(e){if(!e[qs]){e[qs]=!0,i.forEach((function(t){"selectionchange"!==t&&(Ls.has(t)||zs(t,!1,e),zs(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qs]||(t[qs]=!0,zs("selectionchange",!1,t))}}function Bs(e,t,n,s){switch(Gt(t)){case 1:var r=Ht;break;case 4:r=Kt;break;default:r=Yt}n=r.bind(null,t,n,e),r=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),s?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vs(e,t,n,s,r){var a=s;if(0===(1&t)&&0===(2&t)&&null!==s)e:for(;;){if(null===s)return;var i=s.tag;if(3===i||4===i){var o=s.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===i)for(i=s.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;i=i.return}for(;null!==o;){if(null===(i=yr(o)))return;if(5===(l=i.tag)||6===l){s=a=i;continue e}o=o.parentNode}}s=s.return}Ae((function(){var s=a,r=we(n),i=[];e:{var o=Es.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Cs:case Ss:case Is:l=xn;break;case Ts:l=En;break;case"scroll":l=hn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var m,p=s;null!==p;){var f=(m=p).stateNode;if(5===m.tag&&null!==f&&(m=f,null!==h&&(null!=(f=De(p,h))&&d.push(Hs(p,f,m)))),u)break;p=p.return}0<d.length&&(o=new l(o,c,null,n,r),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=s,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=s),l!==c)){if(d=pn,f="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=In,f="onPointerLeave",h="onPointerEnter",p="pointer"),u=null==l?o:br(l),m=null==c?o:br(c),(o=new d(f,p+"leave",l,n,r)).target=u,o.relatedTarget=m,f=null,yr(r)===s&&((d=new d(h,p+"enter",c,n,r)).target=m,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,p=0,m=d=l;m;m=Ys(m))p++;for(m=0,f=h;f;f=Ys(f))m++;for(;0<p-m;)d=Ys(d),p--;for(;0<m-p;)h=Ys(h),m--;for(;p--;){if(d===h||null!==h&&d===h.alternate)break e;d=Ys(d),h=Ys(h)}d=null}else d=null;null!==l&&Qs(i,o,l,d,!1),null!==c&&null!==u&&Qs(i,u,c,d,!0)}if("select"===(l=(o=s?br(s):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Gn;else if(Vn(o))if(Jn)g=is;else{g=rs;var x=ss}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=as);switch(g&&(g=g(e,s))?Hn(i,g,n,r):(x&&x(e,o,s),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=s?br(s):window,e){case"focusin":(Vn(x)||"true"===x.contentEditable)&&(gs=x,xs=s,ys=null);break;case"focusout":ys=xs=gs=null;break;case"mousedown":vs=!0;break;case"contextmenu":case"mouseup":case"dragend":vs=!1,bs(i,n,r);break;case"selectionchange":if(fs)break;case"keydown":case"keyup":bs(i,n,r)}var y;if(Rn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Wn?zn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(On&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Wn&&(y=en()):(Zt="value"in(Jt=r)?Jt.value:Jt.textContent,Wn=!0)),0<(x=Ks(s,v)).length&&(v=new bn(v,e,null,n,r),i.push({event:v,listeners:x}),y?v.data=y:null!==(y=qn(n))&&(v.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),Xt=Zt=Jt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(s=Ks(s,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),i.push({event:r,listeners:s}),r.data=y))}Fs(i,t)}))}function Hs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ks(e,t){for(var n=t+"Capture",s=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=De(e,n))&&s.unshift(Hs(e,a,r)),null!=(a=De(e,t))&&s.push(Hs(e,a,r))),e=e.return}return s}function Ys(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qs(e,t,n,s,r){for(var a=t._reactName,i=[];null!==n&&n!==s;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===s)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=De(n,a))&&i.unshift(Hs(n,l,o)):r||null!=(l=De(n,a))&&i.push(Hs(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var $s=/\r\n?/g,Gs=/\u0000|\uFFFD/g;function Js(e){return("string"===typeof e?e:""+e).replace($s,"\n").replace(Gs,"")}function Zs(e,t,n){if(t=Js(t),Js(e)!==t&&n)throw Error(a(425))}function Xs(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,ir="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(or)}:sr;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===s)return e.removeChild(r),void Wt(t);s--}else"$"!==n&&"$?"!==n&&"$!"!==n||s++;n=r}while(n);Wt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),hr="__reactFiber$"+ur,mr="__reactProps$"+ur,pr="__reactContainer$"+ur,fr="__reactEvents$"+ur,gr="__reactListeners$"+ur,xr="__reactHandles$"+ur;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[hr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function vr(e){return!(e=e[hr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wr(e){return e[mr]||null}var jr=[],Nr=-1;function kr(e){return{current:e}}function _r(e){0>Nr||(e.current=jr[Nr],jr[Nr]=null,Nr--)}function Cr(e,t){Nr++,jr[Nr]=e.current,e.current=t}var Sr={},Ir=kr(Sr),Tr=kr(!1),Er=Sr;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Sr;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in n)a[r]=t[r];return s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pr(){_r(Tr),_r(Ir)}function Rr(e,t,n){if(Ir.current!==Sr)throw Error(a(168));Cr(Ir,t),Cr(Tr,n)}function Mr(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,"function"!==typeof s.getChildContext)return n;for(var r in s=s.getChildContext())if(!(r in t))throw Error(a(108,B(e)||"Unknown",r));return O({},n,s)}function Lr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sr,Er=Ir.current,Cr(Ir,e),Cr(Tr,Tr.current),!0}function Or(e,t,n){var s=e.stateNode;if(!s)throw Error(a(169));n?(e=Mr(e,t,Er),s.__reactInternalMemoizedMergedChildContext=e,_r(Tr),_r(Ir),Cr(Ir,e)):_r(Tr),Cr(Tr,n)}var Fr=null,Ur=!1,zr=!1;function qr(e){null===Fr?Fr=[e]:Fr.push(e)}function Wr(){if(!zr&&null!==Fr){zr=!0;var e=0,t=vt;try{var n=Fr;for(vt=1;e<n.length;e++){var s=n[e];do{s=s(!0)}while(null!==s)}Fr=null,Ur=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),Ye(Xe,Wr),r}finally{vt=t,zr=!1}}return null}var Br=[],Vr=0,Hr=null,Kr=0,Yr=[],Qr=0,$r=null,Gr=1,Jr="";function Zr(e,t){Br[Vr++]=Kr,Br[Vr++]=Hr,Hr=e,Kr=t}function Xr(e,t,n){Yr[Qr++]=Gr,Yr[Qr++]=Jr,Yr[Qr++]=$r,$r=e;var s=Gr;e=Jr;var r=32-it(s)-1;s&=~(1<<r),n+=1;var a=32-it(t)+r;if(30<a){var i=r-r%5;a=(s&(1<<i)-1).toString(32),s>>=i,r-=i,Gr=1<<32-it(t)+r|n<<r|s,Jr=a+e}else Gr=1<<a|n<<r|s,Jr=e}function ea(e){null!==e.return&&(Zr(e,1),Xr(e,1,0))}function ta(e){for(;e===Hr;)Hr=Br[--Vr],Br[Vr]=null,Kr=Br[--Vr],Br[Vr]=null;for(;e===$r;)$r=Yr[--Qr],Yr[Qr]=null,Jr=Yr[--Qr],Yr[Qr]=null,Gr=Yr[--Qr],Yr[Qr]=null}var na=null,sa=null,ra=!1,aa=null;function ia(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,sa=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,sa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$r?{id:Gr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,sa=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ra){var t=sa;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cr(n.nextSibling);var s=na;t&&oa(e,t)?ia(s,n):(e.flags=-4097&e.flags|2,ra=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ra=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!ra)return da(e),ra=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=sa)){if(la(e))throw ha(),Error(a(418));for(;t;)ia(e,t),t=cr(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){sa=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}sa=null}}else sa=na?cr(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=sa;e;)e=cr(e.nextSibling)}function ma(){sa=na=null,ra=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var fa=b.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var s=n.stateNode}if(!s)throw Error(a(147,e));var r=s,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function xa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ya(e){return(0,e._init)(e._payload)}function va(e){function t(t,n){if(e){var s=t.deletions;null===s?(t.deletions=[n],t.flags|=16):s.push(n)}}function n(n,s){if(!e)return null;for(;null!==s;)t(n,s),s=s.sibling;return null}function s(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function i(t,n,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<n?(t.flags|=2,n):s:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,s){return null===t||6!==t.tag?((t=Oc(n,e.mode,s)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,s){var a=n.type;return a===N?u(e,t,n.props.children,s,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&ya(a)===t.type)?((s=r(t,n.props)).ref=ga(e,t,n),s.return=e,s):((s=Rc(n.type,n.key,n.props,null,e.mode,s)).ref=ga(e,t,n),s.return=e,s)}function d(e,t,n,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,s)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,s,a){return null===t||7!==t.tag?((t=Mc(n,e.mode,s,a)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mc(t,e.mode,n,null)).return=e,t;xa(e,t)}return null}function m(e,t,n,s){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(e,t,n,s):null;case j:return n.key===r?d(e,t,n,s):null;case D:return m(e,t,(r=n._init)(n._payload),s)}if(te(n)||M(n))return null!==r?null:u(e,t,n,s,null);xa(e,n)}return null}function p(e,t,n,s,r){if("string"===typeof s&&""!==s||"number"===typeof s)return l(t,e=e.get(n)||null,""+s,r);if("object"===typeof s&&null!==s){switch(s.$$typeof){case w:return c(t,e=e.get(null===s.key?n:s.key)||null,s,r);case j:return d(t,e=e.get(null===s.key?n:s.key)||null,s,r);case D:return p(e,t,n,(0,s._init)(s._payload),r)}if(te(s)||M(s))return u(t,e=e.get(n)||null,s,r,null);xa(t,s)}return null}function f(r,a,o,l){for(var c=null,d=null,u=a,f=a=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var x=m(r,u,o[f],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(r,u),a=i(x,a,f),null===d?c=x:d.sibling=x,d=x,u=g}if(f===o.length)return n(r,u),ra&&Zr(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(r,o[f],l))&&(a=i(u,a,f),null===d?c=u:d.sibling=u,d=u);return ra&&Zr(r,f),c}for(u=s(r,u);f<o.length;f++)null!==(g=p(u,r,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),a=i(g,a,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(r,e)})),ra&&Zr(r,f),c}function g(r,o,l,c){var d=M(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,f=o,g=o=0,x=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var v=m(r,f,y.value,c);if(null===v){null===f&&(f=x);break}e&&f&&null===v.alternate&&t(r,f),o=i(v,o,g),null===u?d=v:u.sibling=v,u=v,f=x}if(y.done)return n(r,f),ra&&Zr(r,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=h(r,y.value,c))&&(o=i(y,o,g),null===u?d=y:u.sibling=y,u=y);return ra&&Zr(r,g),d}for(f=s(r,f);!y.done;g++,y=l.next())null!==(y=p(f,r,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),o=i(y,o,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(r,e)})),ra&&Zr(r,g),d}return function e(s,a,i,l){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=a;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){n(s,d.sibling),(a=r(d,i.props.children)).return=s,s=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ya(c)===d.type){n(s,d.sibling),(a=r(d,i.props)).ref=ga(s,d,i),a.return=s,s=a;break e}n(s,d);break}t(s,d),d=d.sibling}i.type===N?((a=Mc(i.props.children,s.mode,l,i.key)).return=s,s=a):((l=Rc(i.type,i.key,i.props,null,s.mode,l)).ref=ga(s,a,i),l.return=s,s=l)}return o(s);case j:e:{for(d=i.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(s,a.sibling),(a=r(a,i.children||[])).return=s,s=a;break e}n(s,a);break}t(s,a),a=a.sibling}(a=Fc(i,s.mode,l)).return=s,s=a}return o(s);case D:return e(s,a,(d=i._init)(i._payload),l)}if(te(i))return f(s,a,i,l);if(M(i))return g(s,a,i,l);xa(s,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(s,a.sibling),(a=r(a,i)).return=s,s=a):(n(s,a),(a=Oc(i,s.mode,l)).return=s,s=a),o(s)):n(s,a)}}var ba=va(!0),wa=va(!1),ja=kr(null),Na=null,ka=null,_a=null;function Ca(){_a=ka=Na=null}function Sa(e){var t=ja.current;_r(ja),e._currentValue=t}function Ia(e,t,n){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){Na=e,_a=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vo=!0),e.firstContext=null)}function Ea(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===Na)throw Error(a(308));ka=e,Na.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Aa=null;function Da(e){null===Aa?Aa=[e]:Aa.push(e)}function Pa(e,t,n,s){var r=t.interleaved;return null===r?(n.next=n,Da(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ra(e,s)}function Ra(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ma=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,0!==(2&Il)){var r=s.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),s.pending=t,Ra(e,n)}return null===(r=s.interleaved)?(t.next=t,Da(s)):(t.next=r.next,r.next=t),s.interleaved=t,Ra(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,yt(e,n)}}function qa(e,t){var n=e.updateQueue,s=e.alternate;if(null!==s&&n===(s=s.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?r=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?r=a=t:a=a.next=t}else r=a=t;return n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:s.shared,effects:s.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wa(e,t,n,s){var r=e.updateQueue;Ma=!1;var a=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=r.baseState;for(i=0,d=c=l=null,o=a;;){var h=o.lane,m=o.eventTime;if((s&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,f=o;switch(h=t,m=n,f.tag){case 1:if("function"===typeof(p=f.payload)){u=p.call(m,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=f.payload)?p.call(m,u,h):p)||void 0===h)break e;u=O({},u,h);break e;case 2:Ma=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=m,l=u):d=d.next=m,i|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Ll|=i,e.lanes=i,e.memoizedState=u}}function Ba(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var s=e[t],r=s.callback;if(null!==r){if(s.callback=null,s=n,"function"!==typeof r)throw Error(a(191,r));r.call(s)}}}var Va={},Ha=kr(Va),Ka=kr(Va),Ya=kr(Va);function Qa(e){if(e===Va)throw Error(a(174));return e}function $a(e,t){switch(Cr(Ya,t),Cr(Ka,e),Cr(Ha,Va),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_r(Ha),Cr(Ha,t)}function Ga(){_r(Ha),_r(Ka),_r(Ya)}function Ja(e){Qa(Ya.current);var t=Qa(Ha.current),n=le(t,e.type);t!==n&&(Cr(Ka,e),Cr(Ha,n))}function Za(e){Ka.current===e&&(_r(Ha),_r(Ka))}var Xa=kr(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var si=b.ReactCurrentDispatcher,ri=b.ReactCurrentBatchConfig,ai=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function mi(){throw Error(a(321))}function pi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!os(e[n],t[n]))return!1;return!0}function fi(e,t,n,s,r,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,si.current=null===e||null===e.memoizedState?Zi:Xi,e=n(s,r),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(a(301));i+=1,li=oi=null,t.updateQueue=null,si.current=eo,e=n(s,r)}while(di)}if(si.current=Ji,t=null!==oi&&null!==oi.next,ai=0,li=oi=ii=null,ci=!1,t)throw Error(a(300));return e}function gi(){var e=0!==ui;return ui=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function yi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function vi(e,t){return"function"===typeof t?t(e):t}function bi(e){var t=yi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var s=oi,r=s.baseQueue,i=n.pending;if(null!==i){if(null!==r){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(null!==r){i=r.next,s=s.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((ai&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=s):c=c.next=h,ii.lanes|=u,Ll|=u}d=d.next}while(null!==d&&d!==i);null===c?o=s:c.next=l,os(s,t.memoizedState)||(vo=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=c,n.lastRenderedState=s}if(null!==(e=n.interleaved)){r=e;do{i=r.lane,ii.lanes|=i,Ll|=i,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=yi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{i=e(i,o.action),o=o.next}while(o!==r);os(i,t.memoizedState)||(vo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,s]}function ji(){}function Ni(e,t){var n=ii,s=yi(),r=t(),i=!os(s.memoizedState,r);if(i&&(s.memoizedState=r,vo=!0),s=s.queue,Mi(Ci.bind(null,n,s,e),[e]),s.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ei(9,_i.bind(null,n,s,r,t),void 0,null),null===Tl)throw Error(a(349));0!==(30&ai)||ki(n,t,r)}return r}function ki(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _i(e,t,n,s){t.value=n,t.getSnapshot=s,Si(t)&&Ii(e)}function Ci(e,t,n){return n((function(){Si(t)&&Ii(e)}))}function Si(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!os(e,n)}catch(s){return!0}}function Ii(e){var t=Ra(e,1);null!==t&&nc(t,e,1,-1)}function Ti(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:e},t.queue=e,e=e.dispatch=Yi.bind(null,ii,e),[t.memoizedState,e]}function Ei(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function Ai(){return yi().memoizedState}function Di(e,t,n,s){var r=xi();ii.flags|=e,r.memoizedState=Ei(1|t,n,void 0,void 0===s?null:s)}function Pi(e,t,n,s){var r=yi();s=void 0===s?null:s;var a=void 0;if(null!==oi){var i=oi.memoizedState;if(a=i.destroy,null!==s&&pi(s,i.deps))return void(r.memoizedState=Ei(t,n,a,s))}ii.flags|=e,r.memoizedState=Ei(1|t,n,a,s)}function Ri(e,t){return Di(8390656,8,e,t)}function Mi(e,t){return Pi(2048,8,e,t)}function Li(e,t){return Pi(4,2,e,t)}function Oi(e,t){return Pi(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4,4,Fi.bind(null,t,e),n)}function zi(){}function qi(e,t){var n=yi();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&pi(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Wi(e,t){var n=yi();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&pi(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Bi(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,vo=!0),e.memoizedState=n):(os(n,t)||(n=ft(),ii.lanes|=n,Ll|=n,e.baseState=!0),t)}function Vi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var s=ri.transition;ri.transition={};try{e(!1),t()}finally{vt=n,ri.transition=s}}function Hi(){return yi().memoizedState}function Ki(e,t,n){var s=tc(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Qi(e))$i(t,n);else if(null!==(n=Pa(e,t,n,s))){nc(n,e,s,ec()),Gi(n,t,s)}}function Yi(e,t,n){var s=tc(e),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qi(e))$i(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=a(i,n);if(r.hasEagerState=!0,r.eagerState=o,os(o,i)){var l=t.interleaved;return null===l?(r.next=r,Da(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Pa(e,t,r,s))&&(nc(n,e,s,r=ec()),Gi(n,t,s))}}function Qi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function $i(e,t){di=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gi(e,t,n){if(0!==(4194240&n)){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Ji={readContext:Ea,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},Zi={readContext:Ea,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:Ea,useEffect:Ri,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Di(4194308,4,Fi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=xi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=xi();return t=void 0!==n?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ti,useDebugValue:zi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=Vi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=ii,r=xi();if(ra){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Tl)throw Error(a(349));0!==(30&ai)||ki(s,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Ri(Ci.bind(null,s,i,e),[e]),s.flags|=2048,Ei(9,_i.bind(null,s,i,n,t),void 0,null),n},useId:function(){var e=xi(),t=Tl.identifierPrefix;if(ra){var n=Jr;t=":"+t+"R"+(n=(Gr&~(1<<32-it(Gr)-1)).toString(32)+n),0<(n=ui++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Xi={readContext:Ea,useCallback:qi,useContext:Ea,useEffect:Mi,useImperativeHandle:Ui,useInsertionEffect:Li,useLayoutEffect:Oi,useMemo:Wi,useReducer:bi,useRef:Ai,useState:function(){return bi(vi)},useDebugValue:zi,useDeferredValue:function(e){return Bi(yi(),oi.memoizedState,e)},useTransition:function(){return[bi(vi)[0],yi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1},eo={readContext:Ea,useCallback:qi,useContext:Ea,useEffect:Mi,useImperativeHandle:Ui,useInsertionEffect:Li,useLayoutEffect:Oi,useMemo:Wi,useReducer:wi,useRef:Ai,useState:function(){return wi(vi)},useDebugValue:zi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:Bi(t,oi.memoizedState,e)},useTransition:function(){return[wi(vi)[0],yi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,s){n=null===(n=n(s,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var so={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=ec(),r=tc(e),a=Fa(s,r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,r))&&(nc(t,e,r,s),za(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=ec(),r=tc(e),a=Fa(s,r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,r))&&(nc(t,e,r,s),za(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),s=tc(e),r=Fa(n,s);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ua(e,r,s))&&(nc(t,e,s,n),za(t,e,s))}};function ro(e,t,n,s,r,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!ls(n,s)||!ls(r,a))}function ao(e,t,n){var s=!1,r=Sr,a=t.contextType;return"object"===typeof a&&null!==a?a=Ea(a):(r=Dr(t)?Er:Ir.current,a=(s=null!==(s=t.contextTypes)&&void 0!==s)?Ar(e,r):Sr),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,n,s){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,s),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,s){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},La(e);var a=t.contextType;"object"===typeof a&&null!==a?r.context=Ea(a):(a=Dr(t)?Er:Ir.current,r.context=Ar(e,a)),r.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&so.enqueueReplaceState(r,r.state,null),Wa(e,n,r,s),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",s=t;do{n+=q(s),s=s.return}while(s);var r=n}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Vl||(Vl=!0,Hl=s),uo(0,t)},n}function po(e,t,n){(n=Fa(-1,n)).tag=3;var s=e.type.getDerivedStateFromError;if("function"===typeof s){var r=t.value;n.payload=function(){return s(r)},n.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof s&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var s=e.pingCache;if(null===s){s=e.pingCache=new ho;var r=new Set;s.set(t,r)}else void 0===(r=s.get(t))&&(r=new Set,s.set(t,r));r.has(n)||(r.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,n,s,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var yo=b.ReactCurrentOwner,vo=!1;function bo(e,t,n,s){t.child=null===e?wa(t,null,n,s):ba(t,e.child,n,s)}function wo(e,t,n,s,r){n=n.render;var a=t.ref;return Ta(t,r),s=fi(e,t,n,s,a,r),n=gi(),null===e||vo?(ra&&n&&ea(t),t.flags|=1,bo(e,t,s,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vo(e,t,r))}function jo(e,t,n,s,r){if(null===e){var a=n.type;return"function"!==typeof a||Dc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,s,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,No(e,t,a,s,r))}if(a=e.child,0===(e.lanes&r)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:ls)(i,s)&&e.ref===t.ref)return Vo(e,t,r)}return t.flags|=1,(e=Pc(a,s)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,s,r){if(null!==e){var a=e.memoizedProps;if(ls(a,s)&&e.ref===t.ref){if(vo=!1,t.pendingProps=s=a,0===(e.lanes&r))return t.lanes=e.lanes,Vo(e,t,r);0!==(131072&e.flags)&&(vo=!0)}}return Co(e,t,n,s,r)}function ko(e,t,n){var s=t.pendingProps,r=s.children,a=null!==e?e.memoizedState:null;if("hidden"===s.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Pl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=null!==a?a.baseLanes:n,Cr(Pl,Dl),Dl|=s}else null!==a?(s=a.baseLanes|n,t.memoizedState=null):s=n,Cr(Pl,Dl),Dl|=s;return bo(e,t,r,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,s,r){var a=Dr(n)?Er:Ir.current;return a=Ar(t,a),Ta(t,r),n=fi(e,t,n,s,a,r),s=gi(),null===e||vo?(ra&&s&&ea(t),t.flags|=1,bo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vo(e,t,r))}function So(e,t,n,s,r){if(Dr(n)){var a=!0;Lr(t)}else a=!1;if(Ta(t,r),null===t.stateNode)Bo(e,t),ao(t,n,s),oo(t,n,s,r),s=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ea(c):c=Ar(t,c=Dr(n)?Er:Ir.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==s||l!==c)&&io(t,i,s,c),Ma=!1;var h=t.memoizedState;i.state=h,Wa(t,s,i,r),l=t.memoizedState,o!==s||h!==l||Tr.current||Ma?("function"===typeof d&&(no(t,n,d,s),l=t.memoizedState),(o=Ma||ro(t,n,o,s,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=l),i.props=s,i.state=l,i.context=c,s=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,Oa(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ea(l):l=Ar(t,l=Dr(n)?Er:Ir.current);var m=n.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,s,l),Ma=!1,h=t.memoizedState,i.state=h,Wa(t,s,i,r);var p=t.memoizedState;o!==u||h!==p||Tr.current||Ma?("function"===typeof m&&(no(t,n,m,s),p=t.memoizedState),(c=Ma||ro(t,n,c,s,h,p,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(s,p,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(s,p,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),i.props=s,i.state=p,i.context=l,s=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Io(e,t,n,s,a,r)}function Io(e,t,n,s,r,a){_o(e,t);var i=0!==(128&t.flags);if(!s&&!i)return r&&Or(t,n,!1),Vo(e,t,a);s=t.stateNode,yo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:s.render();return t.flags|=1,null!==e&&i?(t.child=ba(t,e.child,null,a),t.child=ba(t,null,o,a)):bo(e,t,o,a),t.memoizedState=s.state,r&&Or(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Rr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Rr(0,t.context,!1),$a(e,t.containerInfo)}function Eo(e,t,n,s,r){return ma(),pa(r),t.flags|=256,bo(e,t,n,s),t.child}var Ao,Do,Po,Ro,Mo={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,n){var s,r=t.pendingProps,i=Xa.current,o=!1,l=0!==(128&t.flags);if((s=l)||(s=(null===e||null!==e.memoizedState)&&0!==(2&i)),s?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Cr(Xa,1&i),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,r,0,null),e=Mc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(n),t.memoizedState=Mo,e):Fo(t,l));if(null!==(i=e.memoizedState)&&null!==(s=i.dehydrated))return function(e,t,n,s,r,i,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,s=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=s.fallback,r=t.mode,s=Lc({mode:"visible",children:s.children},r,0,null),(i=Mc(i,r,o,null)).flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,0!==(1&t.mode)&&ba(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Mo,i);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===r.data){if(s=r.nextSibling&&r.nextSibling.dataset)var l=s.dgst;return s=l,Uo(e,t,o,s=co(i=Error(a(419)),s,void 0))}if(l=0!==(o&e.childLanes),vo||l){if(null!==(s=Tl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(s.suspendedLanes|o))?0:r)&&r!==i.retryLane&&(i.retryLane=r,Ra(e,r),nc(s,e,r,-1))}return fc(),Uo(e,t,o,s=co(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,sa=cr(r.nextSibling),na=t,ra=!0,aa=null,null!==e&&(Yr[Qr++]=Gr,Yr[Qr++]=Jr,Yr[Qr++]=$r,Gr=e.id,Jr=e.overflow,$r=t),t=Fo(t,s.children),t.flags|=4096,t)}(e,t,l,r,s,i,n);if(o){o=r.fallback,l=t.mode,s=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==i?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Pc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==s?o=Pc(s,o):(o=Mc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,r}return e=(o=e.child).sibling,r=Pc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fo(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,s){return null!==s&&pa(s),ba(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),Ia(e.return,t,n)}function qo(e,t,n,s,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=r)}function Wo(e,t,n){var s=t.pendingProps,r=s.revealOrder,a=s.tail;if(bo(e,t,s.children,n),0!==(2&(s=Xa.current)))s=1&s|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Cr(Xa,s),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),qo(t,!1,r,n,a);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ei(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}qo(t,!0,n,null,a);break;case"together":qo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!ra)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;null!==n;)null!==n.alternate&&(s=n),n=n.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,s|=14680064&r.subtreeFlags,s|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Yo(e,t,n){var s=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Dr(t.type)&&Pr(),Ko(t),null;case 3:return s=t.stateNode,Ga(),_r(Tr),_r(Ir),ni(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ic(aa),aa=null))),Do(e,t),Ko(t),null;case 5:Za(t);var r=Qa(Ya.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,s,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=Qa(Ha.current),ua(t)){s=t.stateNode,n=t.type;var i=t.memoizedProps;switch(s[hr]=t,s[mr]=i,e=0!==(1&t.mode),n){case"dialog":Us("cancel",s),Us("close",s);break;case"iframe":case"object":case"embed":Us("load",s);break;case"video":case"audio":for(r=0;r<Ms.length;r++)Us(Ms[r],s);break;case"source":Us("error",s);break;case"img":case"image":case"link":Us("error",s),Us("load",s);break;case"details":Us("toggle",s);break;case"input":G(s,i),Us("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Us("invalid",s);break;case"textarea":re(s,i),Us("invalid",s)}for(var l in ye(n,i),r=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?s.textContent!==c&&(!0!==i.suppressHydrationWarning&&Zs(s.textContent,c,e),r=["children",c]):"number"===typeof c&&s.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Zs(s.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Us("scroll",s)}switch(n){case"input":K(s),X(s,i,!0);break;case"textarea":K(s),ie(s);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(s.onclick=Xs)}s=r,t.updateQueue=s,null!==s&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof s.is?e=l.createElement(n,{is:s.is}):(e=l.createElement(n),"select"===n&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,n),e[hr]=t,e[mr]=s,Ao(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,s),n){case"dialog":Us("cancel",e),Us("close",e),r=s;break;case"iframe":case"object":case"embed":Us("load",e),r=s;break;case"video":case"audio":for(r=0;r<Ms.length;r++)Us(Ms[r],e);r=s;break;case"source":Us("error",e),r=s;break;case"img":case"image":case"link":Us("error",e),Us("load",e),r=s;break;case"details":Us("toggle",e),r=s;break;case"input":G(e,s),r=$(e,s),Us("invalid",e);break;case"option":default:r=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},r=O({},s,{value:void 0}),Us("invalid",e);break;case"textarea":re(e,s),r=se(e,s),Us("invalid",e)}for(i in ye(n,r),c=r)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Us("scroll",e):null!=d&&v(e,i,d,l))}switch(n){case"input":K(e),X(e,s,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=s.value&&e.setAttribute("value",""+V(s.value));break;case"select":e.multiple=!!s.multiple,null!=(i=s.value)?ne(e,!!s.multiple,i,!1):null!=s.defaultValue&&ne(e,!!s.multiple,s.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Xs)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,s);else{if("string"!==typeof s&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ya.current),Qa(Ha.current),ua(t)){if(s=t.stateNode,n=t.memoizedProps,s[hr]=t,(i=s.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Zs(s.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zs(s.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(s=(9===n.nodeType?n:n.ownerDocument).createTextNode(s))[hr]=t,t.stateNode=s}return Ko(t),null;case 13:if(_r(Xa),s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ra&&null!==sa&&0!==(1&t.mode)&&0===(128&t.flags))ha(),ma(),t.flags|=98560,i=!1;else if(i=ua(t),null!==s&&null!==s.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[hr]=t}else ma(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),i=!1}else null!==aa&&(ic(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((s=null!==s)!==(null!==e&&null!==e.memoizedState)&&s&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Xa.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ga(),Do(e,t),null===e&&Ws(t.stateNode.containerInfo),Ko(t),null;case 10:return Sa(t.type._context),Ko(t),null;case 19:if(_r(Xa),null===(i=t.memoizedState))return Ko(t),null;if(s=0!==(128&t.flags),null===(l=i.rendering))if(s)Ho(i,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Ho(i,!1),null!==(s=l.updateQueue)&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;null!==n;)e=s,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cr(Xa,1&Xa.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Wl&&(t.flags|=128,s=!0,Ho(i,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=ei(l))){if(t.flags|=128,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!ra)return Ko(t),null}else 2*Je()-i.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,s=!0,Ho(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,n=Xa.current,Cr(Xa,s?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return uc(),s=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==s&&(t.flags|=8192),s&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qo(e,t){switch(ta(t),t.tag){case 1:return Dr(t.type)&&Pr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ga(),_r(Tr),_r(Ir),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Za(t),null;case 13:if(_r(Xa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ma()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _r(Xa),null;case 4:return Ga(),null;case 10:return Sa(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ao=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Po=function(e,t,n,s){var r=e.memoizedProps;if(r!==s){e=t.stateNode,Qa(Ha.current);var a,i=null;switch(n){case"input":r=$(e,r),s=$(e,s),i=[];break;case"select":r=O({},r,{value:void 0}),s=O({},s,{value:void 0}),i=[];break;case"textarea":r=se(e,r),s=se(e,s),i=[];break;default:"function"!==typeof r.onClick&&"function"===typeof s.onClick&&(e.onclick=Xs)}for(d in ye(n,s),n=null,r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=null!=r?r[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Us("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Ro=function(e,t,n,s){n!==s&&(t.flags|=4)};var $o=!1,Go=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function Xo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(s){kc(e,t,s)}else n.current=null}function el(e,t,n){try{n()}catch(s){kc(e,t,s)}}var tl=!1;function nl(e,t,n){var s=t.updateQueue;if(null!==(s=null!==s?s.lastEffect:null)){var r=s=s.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&el(t,n,a)}r=r.next}while(r!==s)}}function sl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[mr],delete t[fr],delete t[gr],delete t[xr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xs));else if(4!==s&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==s&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:Go||Xo(n,t);case 6:var s=dl,r=ul;dl=null,hl(e,t,n),ul=r,null!==(dl=s)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Wt(e)):lr(dl,n.stateNode));break;case 4:s=dl,r=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=s,ul=r;break;case 0:case 11:case 14:case 15:if(!Go&&(null!==(s=n.updateQueue)&&null!==(s=s.lastEffect))){r=s=s.next;do{var a=r,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&el(n,t,i),r=r.next}while(r!==s)}hl(e,t,n);break;case 1:if(!Go&&(Xo(n,t),"function"===typeof(s=n.stateNode).componentWillUnmount))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(o){kc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Go=(s=Go)||null!==n.memoizedState,hl(e,t,n),Go=s):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var s=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(s,s))}))}}function fl(e,t){var n=t.deletions;if(null!==n)for(var s=0;s<n.length;s++){var r=n[s];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(a(160));ml(i,o,r),dl=null,ul=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){kc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),xl(e),4&s){try{nl(3,e,e.return),sl(3,e)}catch(g){kc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:fl(t,e),xl(e),512&s&&null!==n&&Xo(n,n.return);break;case 5:if(fl(t,e),xl(e),512&s&&null!==n&&Xo(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){kc(e,e.return,g)}}if(4&s&&null!=(r=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(r,i),ve(l,o);var d=ve(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(r,h):"dangerouslySetInnerHTML"===u?ue(r,h):"children"===u?he(r,h):v(r,u,h,d)}switch(l){case"input":Z(r,i);break;case"textarea":ae(r,i);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;null!=p?ne(r,!!i.multiple,p,!1):m!==!!i.multiple&&(null!=i.defaultValue?ne(r,!!i.multiple,i.defaultValue,!0):ne(r,!!i.multiple,i.multiple?[]:"",!1))}r[mr]=i}catch(g){kc(e,e.return,g)}}break;case 6:if(fl(t,e),xl(e),4&s){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(g){kc(e,e.return,g)}}break;case 3:if(fl(t,e),xl(e),4&s&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:fl(t,e),xl(e);break;case 13:fl(t,e),xl(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(ql=Je())),4&s&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Go=(d=Go)||u,fl(t,e),Go=d):fl(t,e),xl(e),8192&s){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Zo=e,u=e.child;null!==u;){for(h=Zo=u;null!==Zo;){switch(p=(m=Zo).child,m.tag){case 0:case 11:case 14:case 15:nl(4,m,m.return);break;case 1:Xo(m,m.return);var f=m.stateNode;if("function"===typeof f.componentWillUnmount){s=m,n=m.return;try{t=s,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){kc(s,n,g)}}break;case 5:Xo(m,m.return);break;case 22:if(null!==m.memoizedState){wl(h);continue}}null!==p?(p.return=m,Zo=p):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{r=h.stateNode,d?"function"===typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),xl(e),4&s&&pl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var s=n;break e}n=n.return}throw Error(a(160))}switch(s.tag){case 5:var r=s.stateNode;32&s.flags&&(he(r,""),s.flags&=-33),cl(e,ol(e),r);break;case 3:case 4:var i=s.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(a(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Zo=e,vl(e,t,n)}function vl(e,t,n){for(var s=0!==(1&e.mode);null!==Zo;){var r=Zo,a=r.child;if(22===r.tag&&s){var i=null!==r.memoizedState||$o;if(!i){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Go;o=$o;var c=Go;if($o=i,(Go=l)&&!c)for(Zo=r;null!==Zo;)l=(i=Zo).child,22===i.tag&&null!==i.memoizedState?jl(r):null!==l?(l.return=i,Zo=l):jl(r);for(;null!==a;)Zo=a,vl(a,t,n),a=a.sibling;Zo=r,$o=o,Go=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==a?(a.return=r,Zo=a):bl(e)}}function bl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Go||sl(5,t);break;case 1:var s=t.stateNode;if(4&t.flags&&!Go)if(null===n)s.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ba(t,i,s);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ba(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(a(163))}Go||512&t.flags&&rl(t)}catch(m){kc(t,t.return,m)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function wl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function jl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sl(4,t)}catch(l){kc(t,n,l)}break;case 1:var s=t.stateNode;if("function"===typeof s.componentDidMount){var r=t.return;try{s.componentDidMount()}catch(l){kc(t,r,l)}}var a=t.return;try{rl(t)}catch(l){kc(t,a,l)}break;case 5:var i=t.return;try{rl(t)}catch(l){kc(t,i,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var Nl,kl=Math.ceil,_l=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Sl=b.ReactCurrentBatchConfig,Il=0,Tl=null,El=null,Al=0,Dl=0,Pl=kr(0),Rl=0,Ml=null,Ll=0,Ol=0,Fl=0,Ul=null,zl=null,ql=0,Wl=1/0,Bl=null,Vl=!1,Hl=null,Kl=null,Yl=!1,Ql=null,$l=0,Gl=0,Jl=null,Zl=-1,Xl=0;function ec(){return 0!==(6&Il)?Je():-1!==Zl?Zl:Zl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Al?Al&-Al:null!==fa.transition?(0===Xl&&(Xl=ft()),Xl):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function nc(e,t,n,s){if(50<Gl)throw Gl=0,Jl=null,Error(a(185));xt(e,n,s),0!==(2&Il)&&e===Tl||(e===Tl&&(0===(2&Il)&&(Ol|=n),4===Rl&&oc(e,Al)),sc(e,s),1===n&&0===Il&&0===(1&t.mode)&&(Wl=Je()+500,Ur&&Wr()))}function sc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),o=1<<i,l=r[i];-1===l?0!==(o&n)&&0===(o&s)||(r[i]=mt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var s=ht(e,e===Tl?Al:0);if(0===s)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ur=!0,qr(e)}(lc.bind(null,e)):qr(lc.bind(null,e)),ir((function(){0===(6&Il)&&Wr()})),n=null;else{switch(bt(s)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=st}n=Tc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Zl=-1,Xl=0,0!==(6&Il))throw Error(a(327));var n=e.callbackNode;if(jc()&&e.callbackNode!==n)return null;var s=ht(e,e===Tl?Al:0);if(0===s)return null;if(0!==(30&s)||0!==(s&e.expiredLanes)||t)t=gc(e,s);else{t=s;var r=Il;Il|=2;var i=pc();for(Tl===e&&Al===t||(Bl=null,Wl=Je()+500,hc(e,t));;)try{yc();break}catch(l){mc(e,l)}Ca(),_l.current=i,Il=r,null!==El?t=0:(Tl=null,Al=0,t=Rl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(s=r,t=ac(e,r))),1===t)throw n=Ml,hc(e,0),oc(e,s),sc(e,Je()),n;if(6===t)oc(e,s);else{if(r=e.current.alternate,0===(30&s)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var s=0;s<n.length;s++){var r=n[s],a=r.getSnapshot;r=r.value;try{if(!os(a(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,s))&&(0!==(i=pt(e))&&(s=i,t=ac(e,i))),1===t))throw n=Ml,hc(e,0),oc(e,s),sc(e,Je()),n;switch(e.finishedWork=r,e.finishedLanes=s,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,zl,Bl);break;case 3:if(oc(e,s),(130023424&s)===s&&10<(t=ql+500-Je())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&s)!==s){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=sr(wc.bind(null,e,zl,Bl),t);break}wc(e,zl,Bl);break;case 4:if(oc(e,s),(4194240&s)===s)break;for(t=e.eventTimes,r=-1;0<s;){var o=31-it(s);i=1<<o,(o=t[o])>r&&(r=o),s&=~i}if(s=r,10<(s=(120>(s=Je()-s)?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*kl(s/1960))-s)){e.timeoutHandle=sr(wc.bind(null,e,zl,Bl),s);break}wc(e,zl,Bl);break;default:throw Error(a(329))}}}return sc(e,Je()),e.callbackNode===n?rc.bind(null,e):null}function ac(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Fl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),s=1<<n;e[n]=-1,t&=~s}}function lc(e){if(0!==(6&Il))throw Error(a(327));jc();var t=ht(e,0);if(0===(1&t))return sc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var s=pt(e);0!==s&&(t=s,n=ac(e,s))}if(1===n)throw n=Ml,hc(e,0),oc(e,t),sc(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Bl),sc(e,Je()),null}function cc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(Wl=Je()+500,Ur&&Wr())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Il)&&jc();var t=Il;Il|=1;var n=Sl.transition,s=vt;try{if(Sl.transition=null,vt=1,e)return e()}finally{vt=s,Sl.transition=n,0===(6&(Il=t))&&Wr()}}function uc(){Dl=Pl.current,_r(Pl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==El)for(n=El.return;null!==n;){var s=n;switch(ta(s),s.tag){case 1:null!==(s=s.type.childContextTypes)&&void 0!==s&&Pr();break;case 3:Ga(),_r(Tr),_r(Ir),ni();break;case 5:Za(s);break;case 4:Ga();break;case 13:case 19:_r(Xa);break;case 10:Sa(s.type._context);break;case 22:case 23:uc()}n=n.return}if(Tl=e,El=e=Pc(e.current,null),Al=Dl=t,Rl=0,Ml=null,Fl=Ol=Ll=0,zl=Ul=null,null!==Aa){for(t=0;t<Aa.length;t++)if(null!==(s=(n=Aa[t]).interleaved)){n.interleaved=null;var r=s.next,a=n.pending;if(null!==a){var i=a.next;a.next=r,s.next=i}n.pending=s}Aa=null}return e}function mc(e,t){for(;;){var n=El;try{if(Ca(),si.current=Ji,ci){for(var s=ii.memoizedState;null!==s;){var r=s.queue;null!==r&&(r.pending=null),s=s.next}ci=!1}if(ai=0,li=oi=ii=null,di=!1,ui=0,Cl.current=null,null===n||null===n.return){Rl=1,Ml=t,El=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,xo(p,o,l,0,t),1&p.mode&&fo(i,d,t),c=d;var f=(t=p).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(i,d,t),fc();break e}c=Error(a(426))}else if(ra&&1&l.mode){var x=go(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),pa(lo(c,l));break e}}i=c=lo(c,l),4!==Rl&&(Rl=2),null===Ul?Ul=[i]:Ul.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,qa(i,mo(0,c,t));break e;case 1:l=c;var y=i.type,v=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Kl||!Kl.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,qa(i,po(i,l,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(b){t=b,El===n&&null!==n&&(El=n=n.return);continue}break}}function pc(){var e=_l.current;return _l.current=Ji,null===e?Ji:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Tl||0===(268435455&Ll)&&0===(268435455&Ol)||oc(Tl,Al)}function gc(e,t){var n=Il;Il|=2;var s=pc();for(Tl===e&&Al===t||(Bl=null,hc(e,t));;)try{xc();break}catch(r){mc(e,r)}if(Ca(),Il=n,_l.current=s,null!==El)throw Error(a(261));return Tl=null,Al=0,Rl}function xc(){for(;null!==El;)vc(El)}function yc(){for(;null!==El&&!$e();)vc(El)}function vc(e){var t=Nl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bc(e):El=t,Cl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Yo(n,t,Dl)))return void(El=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(El=n);if(null===e)return Rl=6,void(El=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(El=t);El=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var s=vt,r=Sl.transition;try{Sl.transition=null,vt=1,function(e,t,n,s){do{jc()}while(null!==Ql);if(0!==(6&Il))throw Error(a(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-it(n),a=1<<r;t[r]=0,s[r]=-1,e[r]=-1,n&=~a}}(e,i),e===Tl&&(El=Tl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Tc(tt,(function(){return jc(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Sl.transition,Sl.transition=null;var o=vt;vt=1;var l=Il;Il|=4,Cl.current=null,function(e,t){if(er=Vt,ms(e=hs())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(s&&0!==s.rangeCount){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==i||0!==s&&3!==h.nodeType||(c=o+s),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===n&&++d===r&&(l=o),m===i&&++u===s&&(c=o),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Vt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}f=tl,tl=!1}(e,n),gl(n,e),ps(tr),Vt=!!er,tr=er=null,e.current=n,yl(n,e,r),Ge(),Il=l,vt=o,Sl.transition=i}else e.current=n;if(Yl&&(Yl=!1,Ql=e,$l=r),i=e.pendingLanes,0===i&&(Kl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sc(e,Je()),null!==t)for(s=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Vl)throw Vl=!1,e=Hl,Hl=null,e;0!==(1&$l)&&0!==e.tag&&jc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Gl++:(Gl=0,Jl=e):Gl=0,Wr()}(e,t,n,s)}finally{Sl.transition=r,vt=s}return null}function jc(){if(null!==Ql){var e=bt($l),t=Sl.transition,n=vt;try{if(Sl.transition=null,vt=16>e?16:e,null===Ql)var s=!1;else{if(e=Ql,Ql=null,$l=0,0!==(6&Il))throw Error(a(331));var r=Il;for(Il|=4,Zo=e.current;null!==Zo;){var i=Zo,o=i.child;if(0!==(16&Zo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Zo=d;null!==Zo;){var u=Zo;switch(u.tag){case 0:case 11:case 15:nl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Zo=h;else for(;null!==Zo;){var m=(u=Zo).sibling,p=u.return;if(al(u),u===d){Zo=null;break}if(null!==m){m.return=p,Zo=m;break}Zo=p}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Zo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(i=Zo).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Zo=y;break e}Zo=i.return}}var v=e.current;for(Zo=v;null!==Zo;){var b=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Zo=b;else e:for(o=v;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:sl(9,l)}}catch(j){kc(l,l.return,j)}if(l===o){Zo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zo=w;break e}Zo=l.return}}if(Il=r,Wr(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(rt,e)}catch(j){}s=!0}return s}finally{vt=n,Sl.transition=t}}return!1}function Nc(e,t,n){e=Ua(e,t=mo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),sc(e,t))}function kc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var s=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof s.componentDidCatch&&(null===Kl||!Kl.has(s))){t=Ua(t,e=po(t,e=lo(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),sc(t,e));break}}t=t.return}}function _c(e,t,n){var s=e.pingCache;null!==s&&s.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Al&n)===n&&(4===Rl||3===Rl&&(130023424&Al)===Al&&500>Je()-ql?hc(e,0):Fl|=n),sc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Ra(e,t))&&(xt(e,t,n),sc(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(a(314))}null!==s&&s.delete(t),Cc(e,n)}function Tc(e,t){return Ye(e,t)}function Ec(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,s){return new Ec(e,t,n,s)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,s,r,i){var o=2;if(s=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Mc(n.children,r,i,t);case k:o=8,r|=8;break;case _:return(e=Ac(12,n,t,2|r)).elementType=_,e.lanes=i,e;case T:return(e=Ac(13,n,t,r)).elementType=T,e.lanes=i,e;case E:return(e=Ac(19,n,t,r)).elementType=E,e.lanes=i,e;case P:return Lc(n,r,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case S:o=9;break e;case I:o=11;break e;case A:o=14;break e;case D:o=16,s=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ac(o,n,t,r)).elementType=e,t.type=s,t.lanes=i,t}function Mc(e,t,n,s){return(e=Ac(7,e,s,t)).lanes=n,e}function Lc(e,t,n,s){return(e=Ac(22,e,s,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,s,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,s,r,a,i,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ac(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function qc(e){if(!e)return Sr;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Dr(n))return Mr(e,n,t)}return t}function Wc(e,t,n,s,r,a,i,o,l){return(e=zc(n,s,!0,e,0,a,0,o,l)).context=qc(null),n=e.current,(a=Fa(s=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,r),e.current.lanes=r,xt(e,r,s),sc(e,s),e}function Bc(e,t,n,s){var r=t.current,a=ec(),i=tc(r);return n=qc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,i)).payload={element:e},null!==(s=void 0===s?null:s)&&(t.callback=s),null!==(e=Ua(r,t,i))&&(nc(e,r,i,a),za(e,r,i)),i}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Tr.current)vo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vo=!1,function(e,t,n){switch(t.tag){case 3:To(t),ma();break;case 5:Ja(t);break;case 1:Dr(t.type)&&Lr(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,r=t.memoizedProps.value;Cr(ja,s._currentValue),s._currentValue=r;break;case 13:if(null!==(s=t.memoizedState))return null!==s.dehydrated?(Cr(Xa,1&Xa.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Oo(e,t,n):(Cr(Xa,1&Xa.current),null!==(e=Vo(e,t,n))?e.sibling:null);Cr(Xa,1&Xa.current);break;case 19:if(s=0!==(n&t.childLanes),0!==(128&e.flags)){if(s)return Wo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(Xa,Xa.current),s)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Vo(e,t,n)}(e,t,n);vo=0!==(131072&e.flags)}else vo=!1,ra&&0!==(1048576&t.flags)&&Xr(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Bo(e,t),e=t.pendingProps;var r=Ar(t,Ir.current);Ta(t,n),r=fi(null,t,s,e,r,n);var i=gi();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(s)?(i=!0,Lr(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,La(t),r.updater=so,t.stateNode=r,r._reactInternals=t,oo(t,s,e,n),t=Io(null,t,s,!0,i,n)):(t.tag=0,ra&&i&&ea(t),bo(null,t,r,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Bo(e,t),e=t.pendingProps,s=(r=s._init)(s._payload),t.type=s,r=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===A)return 14}return 2}(s),e=to(s,e),r){case 0:t=Co(null,t,s,e,n);break e;case 1:t=So(null,t,s,e,n);break e;case 11:t=wo(null,t,s,e,n);break e;case 14:t=jo(null,t,s,to(s.type,e),n);break e}throw Error(a(306,s,""))}return t;case 0:return s=t.type,r=t.pendingProps,Co(e,t,s,r=t.elementType===s?r:to(s,r),n);case 1:return s=t.type,r=t.pendingProps,So(e,t,s,r=t.elementType===s?r:to(s,r),n);case 3:e:{if(To(t),null===e)throw Error(a(387));s=t.pendingProps,r=(i=t.memoizedState).element,Oa(e,t),Wa(t,s,null,n);var o=t.memoizedState;if(s=o.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Eo(e,t,s,n,r=lo(Error(a(423)),t));break e}if(s!==r){t=Eo(e,t,s,n,r=lo(Error(a(424)),t));break e}for(sa=cr(t.stateNode.containerInfo.firstChild),na=t,ra=!0,aa=null,n=wa(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ma(),s===r){t=Vo(e,t,n);break e}bo(e,t,s,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),s=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,o=r.children,nr(s,r)?o=null:null!==i&&nr(s,i)&&(t.flags|=32),_o(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Oo(e,t,n);case 4:return $a(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=ba(t,null,s,n):bo(e,t,s,n),t.child;case 11:return s=t.type,r=t.pendingProps,wo(e,t,s,r=t.elementType===s?r:to(s,r),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,Cr(ja,s._currentValue),s._currentValue=o,null!==i)if(os(i.value,o)){if(i.children===r.children&&!Tr.current){t=Vo(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===s){if(1===i.tag){(c=Fa(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ia(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ia(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}bo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,s=t.pendingProps.children,Ta(t,n),s=s(r=Ea(r)),t.flags|=1,bo(e,t,s,n),t.child;case 14:return r=to(s=t.type,t.pendingProps),jo(e,t,s,r=to(s.type,r),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:to(s,r),Bo(e,t),t.tag=1,Dr(s)?(e=!0,Lr(t)):e=!1,Ta(t,n),ao(t,s,r),oo(t,s,r,n),Io(null,t,s,!0,e,n);case 19:return Wo(e,t,n);case 22:return ko(e,t,n)}throw Error(a(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function Xc(e,t,n,s,r){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof r){var o=r;r=function(){var e=Vc(i);o.call(e)}}Bc(t,i,e,r)}else i=function(e,t,n,s,r){if(r){if("function"===typeof s){var a=s;s=function(){var e=Vc(i);a.call(e)}}var i=Wc(t,s,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[pr]=i.current,Ws(8===e.nodeType?e.parentNode:e),dc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof s){var o=s;s=function(){var e=Vc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pr]=l.current,Ws(8===e.nodeType?e.parentNode:e),dc((function(){Bc(t,l,n,s)})),l}(n,t,e,r,s);return Vc(i)}$c.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Bc(e,t,null,null)},$c.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Bc(null,e,null,null)})),t[pr]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),sc(t,Je()),0===(6&Il)&&(Wl=Je()+500,Wr()))}break;case 13:dc((function(){var t=Ra(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Kc(e,1)}},jt=function(e){if(13===e.tag){var t=Ra(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ra(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},kt=function(){return vt},_t=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},je=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=wr(s);if(!r)throw Error(a(90));Y(s),Z(s,r)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cc,Te=dc;var ed={usingClientEntryPoint:!1,Events:[vr,br,wr,Ce,Se,cc]},td={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{rt=sd.inject(nd),at=sd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(a(200));return function(e,t,n){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==s?null:""+s,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(a(299));var n=!1,s="",r=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,s,r),e[pr]=t.current,Ws(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return Xc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(a(405));var s=null!=n&&n.hydratedSources||null,r=!1,i="",o=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,r,0,i,o),e[pr]=t.current,Ws(e),s)for(e=0;e<s.length;e++)r=(r=(n=s[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new $c(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return Xc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){Xc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Xc(e,t,n,!1,s)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{"use strict";var s=n(119);t.createRoot=s.createRoot,t.hydrateRoot=s.hydrateRoot},378:(e,t,n)=>{var s=n(759);e.exports=function(){return s.Date.now()}},414:(e,t,n)=>{"use strict";e.exports=n(654)},491:(e,t,n)=>{var s=n(567),r=n(378),a=n(588),i=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,d,u,h,m,p=0,f=!1,g=!1,x=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,s=c;return l=c=void 0,p=t,u=e.apply(s,n)}function v(e){var n=e-m;return void 0===m||n>=t||n<0||g&&e-p>=d}function b(){var e=r();if(v(e))return w(e);h=setTimeout(b,function(e){var n=t-(e-m);return g?o(n,d-(e-p)):n}(e))}function w(e){return h=void 0,x&&l?y(e):(l=c=void 0,u)}function j(){var e=r(),n=v(e);if(l=arguments,c=this,m=e,n){if(void 0===h)return function(e){return p=e,h=setTimeout(b,t),f?y(e):u}(m);if(g)return clearTimeout(h),h=setTimeout(b,t),y(m)}return void 0===h&&(h=setTimeout(b,t)),u}return t=a(t)||0,s(n)&&(f=!!n.leading,d=(g="maxWait"in n)?i(a(n.maxWait)||0,t):d,x="trailing"in n?!!n.trailing:x),j.cancel=function(){void 0!==h&&clearTimeout(h),p=0,l=m=c=h=void 0},j.flush=function(){return void 0===h?u:w(r())},j}},526:(e,t,n)=>{"use strict";function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function r(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}n.d(t,{A:()=>r})},567:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},578:(e,t,n)=>{"use strict";n.d(t,{C3:()=>Cr,AU:()=>wr,Zy:()=>br,KR:()=>fr});var s=n(913),r=n(253),a=n(170),i=n(624);const o="@firebase/database",l="1.0.19";let c="";function d(e){c=e}class u{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,a.As)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,a.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class h{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,a.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const m=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new u(t)}}catch(t){}return new h},p=m("localStorage"),f=m("sessionStorage"),g=new i.Vy("@firebase/database"),x=function(){let e=1;return function(){return e++}}(),y=function(e){const t=(0,a.kj)(e),n=new a.gz;n.update(t);const s=n.digest();return a.K3.encodeByteArray(s)},v=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=v.apply(null,n):e+="object"===typeof n?(0,a.As)(n):n,e+=" "}return e};let b=null,w=!0;const j=function(e,t){(0,a.vA)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(g.logLevel=i.$b.VERBOSE,b=g.log.bind(g),t&&f.set("logging_enabled",!0)):"function"===typeof e?b=e:(b=null,f.remove("logging_enabled"))},N=function(){if(!0===w&&(w=!1,null===b&&!0===f.get("logging_enabled")&&j(!0)),b){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=v.apply(null,t);b(s)}},k=function(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];N(e,...n)}},_=function(){const e="FIREBASE INTERNAL ERROR: "+v(...arguments);g.error(e)},C=function(){const e="FIREBASE FATAL ERROR: ".concat(v(...arguments));throw g.error(e),new Error(e)},S=function(){const e="FIREBASE WARNING: "+v(...arguments);g.warn(e)},I=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},T="[MIN_NAME]",E="[MAX_NAME]",A=function(e,t){if(e===t)return 0;if(e===T||t===E)return-1;if(t===T||e===E)return 1;{const n=U(e),s=U(t);return null!==n?null!==s?n-s===0?e.length-t.length:n-s:-1:null!==s?1:e<t?-1:1}},D=function(e,t){return e===t?0:e<t?-1:1},P=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,a.As)(t))},R=function(e){if("object"!==typeof e||null===e)return(0,a.As)(e);const t=[];for(const s in e)t.push(s);t.sort();let n="{";for(let s=0;s<t.length;s++)0!==s&&(n+=","),n+=(0,a.As)(t[s]),n+=":",n+=R(e[t[s]]);return n+="}",n},M=function(e,t){const n=e.length;if(n<=t)return[e];const s=[];for(let r=0;r<n;r+=t)r+t>n?s.push(e.substring(r,n)):s.push(e.substring(r,r+t));return s};function L(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const O=function(e){(0,a.vA)(!I(e),"Invalid JSON number");const t=1023;let n,s,r,i,o;0===e?(s=0,r=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),t),s=i+t,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(s=0,r=Math.round(e/Math.pow(2,-1074))));const l=[];for(o=52;o;o-=1)l.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(n?1:0),l.reverse();const c=l.join("");let d="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),d+=e}return d.toLowerCase()};const F=new RegExp("^-?(0*)\\d{1,10}$"),U=function(e){if(F.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z=function(e){try{e()}catch(t){setTimeout((()=>{const e=t.stack||"";throw S("Exception was thrown by user callback.",e),t}),Math.floor(0))}},q=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class W{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,(0,s.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){S('Provided AppCheck credentials for the app named "'.concat(this.appName,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class B{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(N("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(e)}}class V{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}V.OWNER="owner";const H="5",K=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Y="ac",Q="websocket",$="long_polling";class G{constructor(e,t,n,s){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;this.secure=t,this.namespace=n,this.webSocketOnly=s,this.nodeAdmin=r,this.persistenceKey=a,this.includeNamespaceInQueryParams=i,this.isUsingEmulator=o,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=p.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&p.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function J(e,t,n){let s;if((0,a.vA)("string"===typeof t,"typeof type must == string"),(0,a.vA)("object"===typeof n,"typeof params must == object"),t===Q)s=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==$)throw new Error("Unknown connection type: "+t);s=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return L(n,((e,t)=>{r.push(e+"="+t)})),s+r.join("&")}class Z{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,a.A4)(this.counters_)}}const X={},ee={};function te(e){const t=e.toString();return X[t]||(X[t]=new Z),X[t]}class ne{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const se="start";class re{constructor(e,t,n,s,r,a,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=s,this.authToken=r,this.transportSessionId=a,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=k(e),this.stats_=te(t),this.urlFn=e=>(this.appCheckToken&&(e[Y]=this.appCheckToken),J(t,$,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ne(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if((0,a.$g)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ae((function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];const[r,a,i,o,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===se)n.id=a,n.password=i;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];const[r,a]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,a)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[se]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=H,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Y]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&K.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){re.forceAllow_=!0}static forceDisallow(){re.forceDisallow_=!0}static isAvailable(){return!(0,a.$g)()&&(!!re.forceAllow_||!re.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,a.KA)(t),s=M(n,1840);for(let r=0;r<s.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,a.$g)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,a.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ae{constructor(e,t,n,s){if(this.onDisconnect=n,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,a.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=x(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ae.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const s="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(r){N("frame writing exception"),r.stack&&N(r.stack),N(r)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||N("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",s=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+s+"="+e.seg+"&ts"+s+"="+e.ts+"&d"+s+"="+e.d,s++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(s),n()}))}addTag(e,t){(0,a.$g)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{N("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let ie=null;"undefined"!==typeof MozWebSocket?ie=MozWebSocket:"undefined"!==typeof WebSocket&&(ie=WebSocket);class oe{constructor(e,t,n,s,r,a,i){this.connId=e,this.applicationId=n,this.appCheckToken=s,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=k(this.connId),this.stats_=te(t),this.connURL=oe.connectionURL_(t,a,i,s,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,s,r){const i={};return i.v=H,!(0,a.$g)()&&"undefined"!==typeof location&&location.hostname&&K.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),s&&(i[Y]=s),r&&(i.p=r),J(e,Q,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,p.set("previous_websocket_failure",!0);try{let e;if((0,a.$g)()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(H,"/").concat(c,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},s=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;s&&(e.proxy={origin:s})}this.mySock=new ie(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){oe.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ie&&!oe.forceDisallow_}static previouslyFailed(){return p.isInMemoryStorage||!0===p.get("previous_websocket_failure")}markConnectionHealthy(){p.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,a.$L)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,a.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=M(t,16384);n.length>1&&this.sendString_(String(n.length));for(let s=0;s<n.length;s++)this.sendString_(n[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}oe.responsesRequiredToBeHealthy=2,oe.healthyTimeout=3e4;class le{static get ALL_TRANSPORTS(){return[re,oe]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=oe&&oe.isAvailable();let n=t&&!oe.previouslyFailed();if(e.webSocketOnly&&(t||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[oe];else{const e=this.transports_=[];for(const t of le.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);le.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}le.globalTransportInitialized_=!1;class ce{constructor(e,t,n,s,r,a,i,o,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=s,this.authToken_=r,this.onMessage_=a,this.onReady_=i,this.onDisconnect_=o,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=k("c:"+this.id+":"),this.transportManager_=new le(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=q((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=P("t",e),n=P("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=P("t",e),n=P("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=P("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?_("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),H!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),q((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):q((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(p.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class de{put(e,t,n,s){}merge(e,t,n,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class ue{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,a.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const s=this.getInitialEvent(e);s&&t.apply(n,s)}off(e,t,n){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let r=0;r<s.length;r++)if(s[r].callback===t&&(!n||n===s[r].context))return void s.splice(r,1)}validateEventType_(e){(0,a.vA)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class he extends ue{static getInstance(){return new he}constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,a.jZ)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}getInitialEvent(e){return(0,a.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class me{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function pe(){return new me("")}function fe(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ge(e){return e.pieces_.length-e.pieceNum_}function xe(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new me(e.pieces_,t)}function ye(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function ve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function be(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new me(t,0)}function we(e,t){const n=[];for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);if(t instanceof me)for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new me(n,0)}function je(e){return e.pieceNum_>=e.pieces_.length}function Ne(e,t){const n=fe(e),s=fe(t);if(null===n)return t;if(n===s)return Ne(xe(e),xe(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function ke(e,t){if(ge(e)!==ge(t))return!1;for(let n=e.pieceNum_,s=t.pieceNum_;n<=e.pieces_.length;n++,s++)if(e.pieces_[n]!==t.pieces_[s])return!1;return!0}function _e(e,t){let n=e.pieceNum_,s=t.pieceNum_;if(ge(e)>ge(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[s])return!1;++n,++s}return!0}class Ce{constructor(e,t){this.errorPrefix_=t,this.parts_=ve(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,a.OE)(this.parts_[n]);Se(this)}}function Se(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ie(e))}function Ie(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Te extends ue{static getInstance(){return new Te}constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}getInitialEvent(e){return(0,a.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ee=1e3;class Ae extends de{constructor(e,t,n,s,r,i,o,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=s,this.onServerInfoUpdate_=r,this.authTokenProvider_=i,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=Ae.nextPersistentConnectionId_++,this.log_=k("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ee,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,a.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Te.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&he.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const s=++this.requestNumber_,r={r:s,a:e,b:t};this.log_((0,a.As)(r)),(0,a.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[s]=n)}get(e){this.initConnection_();const t=new a.cY,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,n,s){this.initConnection_();const r=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+r),this.listens.has(i)||this.listens.set(i,new Map),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,a.vA)(!this.listens.get(i).has(r),"listen() called twice for same path/queryId.");const o={onComplete:s,hashFn:t,query:e,tag:n};this.listens.get(i).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+n+" for "+s);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const a=r.d,i=r.s;Ae.warnOnListenWarnings_(a,t);(this.listens.get(n)&&this.listens.get(n).get(s))===e&&(this.log_("listen response",r),"ok"!==i&&this.removeListen_(n,s),e.onComplete&&e.onComplete(i,a))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&(0,a.gR)(e,"w")){const n=(0,a.yw)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();S("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,a.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,a.Cv)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,s=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,s))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+s),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,s)&&this.connected_&&this.sendUnlisten_(n,s,e._queryObject,t)}sendUnlisten_(e,t,n,s){this.log_("Unlisten on "+e+" for "+t);const r={p:e};s&&(r.q=n,r.t=s),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,s){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{s&&setTimeout((()=>{s(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,s){this.putInternal("p",e,t,n,s)}merge(e,t,n,s){this.putInternal("m",e,t,n,s)}putInternal(e,t,n,s,r){this.initConnection_();const a={p:t,d:n};void 0!==r&&(a.h=r),this.outstandingPuts_.push({action:e,request:a,onComplete:s}),this.outstandingPutCount_++;const i=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(i):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,a.As)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):_("Unrecognized action received from server: "+(0,a.As)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,a.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ee,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ee,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ee),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ae.nextConnectionId_++,r=this.lastSessionId;let i=!1,o=null;const l=function(){o?o.close():(i=!0,n())},c=function(e){(0,a.vA)(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:l,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);i?N("getToken() completed but was canceled"):(N("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new ce(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{S(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(_){this.log_("Failed to get token: "+_),i||(this.repoInfo_.nodeAdmin&&S(_),l())}}}interrupt(e){N("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){N("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,a.Im)(this.interruptReasons_)&&(this.reconnectDelay_=Ee,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>R(e))).join("$"):"default";const s=this.removeListen_(e,n);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const n=new me(e).toString();let s;if(this.listens.has(n)){const e=this.listens.get(n);s=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else s=void 0;return s}onAuthRevoked_(e,t){N("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){N("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,a.$g)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+c.replace(/\./g,"-")]=1,(0,a.jZ)()?e["framework.cordova"]=1:(0,a.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=he.getInstance().currentlyOnline();return(0,a.Im)(this.interruptReasons_)&&e}}Ae.nextPersistentConnectionId_=0,Ae.nextConnectionId_=0;class De{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new De(e,t)}}class Pe{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new De(T,e),s=new De(T,t);return 0!==this.compare(n,s)}minPost(){return De.MIN}}let Re;class Me extends Pe{static get __EMPTY_NODE(){return Re}static set __EMPTY_NODE(e){Re=e}compare(e,t){return A(e.name,t.name)}isDefinedOn(e){throw(0,a.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return De.MIN}maxPost(){return new De(E,Re)}makePost(e,t){return(0,a.vA)("string"===typeof e,"KeyIndex indexValue must always be a string."),new De(e,Re)}toString(){return".key"}}const Le=new Me;class Oe{constructor(e,t,n,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=s,this.resultGenerator_=r,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,s&&(a*=-1),a<0)e=this.isReverse_?e.left:e.right;else{if(0===a){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Fe{constructor(e,t,n,s,r){this.key=e,this.value=t,this.color=null!=n?n:Fe.RED,this.left=null!=s?s:Ue.EMPTY_NODE,this.right=null!=r?r:Ue.EMPTY_NODE}copy(e,t,n,s,r){return new Fe(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,n),null):0===r?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ue.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,s;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Ue.EMPTY_NODE;s=n.right.min_(),n=n.copy(s.key,s.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Fe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Fe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Fe.RED=!0,Fe.BLACK=!1;class Ue{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Ue(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Fe.BLACK,null,null))}remove(e){return new Ue(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fe.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,s=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return s?s.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(s=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Oe(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Oe(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Oe(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Oe(this.root_,null,this.comparator_,!0,e)}}function ze(e,t){return A(e.name,t.name)}function qe(e,t){return A(e,t)}let We;Ue.EMPTY_NODE=new class{copy(e,t,n,s,r){return this}insert(e,t,n){return new Fe(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Be=function(e){return"number"===typeof e?"number:"+O(e):"string:"+e},Ve=function(e){if(e.isLeafNode()){const t=e.val();(0,a.vA)("string"===typeof t||"number"===typeof t||"object"===typeof t&&(0,a.gR)(t,".sv"),"Priority must be a string or number.")}else(0,a.vA)(e===We||e.isEmpty(),"priority of unexpected type.");(0,a.vA)(e===We||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let He,Ke,Ye;class Qe{static set __childrenNodeConstructor(e){He=e}static get __childrenNodeConstructor(){return He}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qe.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,a.vA)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ve(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Qe(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Qe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return je(e)?this:".priority"===fe(e)?this.priorityNode_:Qe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Qe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=fe(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,a.vA)(".priority"!==n||1===ge(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Qe.__childrenNodeConstructor.EMPTY_NODE.updateChild(xe(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Be(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?O(this.value_):this.value_,this.lazyHash_=y(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Qe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Qe.__childrenNodeConstructor?-1:((0,a.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,s=Qe.VALUE_TYPE_ORDER.indexOf(t),r=Qe.VALUE_TYPE_ORDER.indexOf(n);return(0,a.vA)(s>=0,"Unknown leaf type: "+t),(0,a.vA)(r>=0,"Unknown leaf type: "+n),s===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Qe.VALUE_TYPE_ORDER=["object","boolean","number","string"];const $e=new class extends Pe{compare(e,t){const n=e.node.getPriority(),s=t.node.getPriority(),r=n.compareTo(s);return 0===r?A(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return De.MIN}maxPost(){return new De(E,new Qe("[PRIORITY-POST]",Ye))}makePost(e,t){const n=Ke(e);return new De(t,new Qe("[PRIORITY-POST]",n))}toString(){return".priority"}},Ge=Math.log(2);class Je{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Ge,10)),this.current_=this.count-1;const n=(s=this.count,parseInt(Array(s+1).join("1"),2));var s;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ze=function(e,t,n,s){e.sort(t);const r=function(t,s){const a=s-t;let i,o;if(0===a)return null;if(1===a)return i=e[t],o=n?n(i):i,new Fe(o,i.node,Fe.BLACK,null,null);{const l=parseInt(a/2,10)+t,c=r(t,l),d=r(l+1,s);return i=e[l],o=n?n(i):i,new Fe(o,i.node,Fe.BLACK,c,d)}},a=function(t){let s=null,a=null,i=e.length;const o=function(t,s){const a=i-t,o=i;i-=t;const c=r(a+1,o),d=e[a],u=n?n(d):d;l(new Fe(u,d.node,s,null,c))},l=function(e){s?(s.left=e,s=e):(a=e,s=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),s=Math.pow(2,t.count-(e+1));n?o(s,Fe.BLACK):(o(s,Fe.BLACK),o(s,Fe.RED))}return a}(new Je(e.length));return new Ue(s||t,a)};let Xe;const et={};class tt{static get Default(){return(0,a.vA)(et&&$e,"ChildrenNode.ts has not been loaded"),Xe=Xe||new tt({".priority":et},{".priority":$e}),Xe}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=(0,a.yw)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ue?t:null}hasIndex(e){return(0,a.gR)(this.indexSet_,e.toString())}addIndex(e,t){(0,a.vA)(e!==Le,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let s=!1;const r=t.getIterator(De.Wrap);let i,o=r.getNext();for(;o;)s=s||e.isDefinedOn(o.node),n.push(o),o=r.getNext();i=s?Ze(n,e.getCompare()):et;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const d=Object.assign({},this.indexes_);return d[l]=i,new tt(d,c)}addToIndexes(e,t){const n=(0,a.kH)(this.indexes_,((n,s)=>{const r=(0,a.yw)(this.indexSet_,s);if((0,a.vA)(r,"Missing index implementation for "+s),n===et){if(r.isDefinedOn(e.node)){const n=[],s=t.getIterator(De.Wrap);let a=s.getNext();for(;a;)a.name!==e.name&&n.push(a),a=s.getNext();return n.push(e),Ze(n,r.getCompare())}return et}{const s=t.get(e.name);let r=n;return s&&(r=r.remove(new De(e.name,s))),r.insert(e,e.node)}}));return new tt(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,a.kH)(this.indexes_,(n=>{if(n===et)return n;{const s=t.get(e.name);return s?n.remove(new De(e.name,s)):n}}));return new tt(n,this.indexSet_)}}let nt;class st{static get EMPTY_NODE(){return nt||(nt=new st(new Ue(qe),null,tt.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ve(this.priorityNode_),this.children_.isEmpty()&&(0,a.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||nt}updatePriority(e){return this.children_.isEmpty()?this:new st(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?nt:t}}getChild(e){const t=fe(e);return null===t?this:this.getImmediateChild(t).getChild(xe(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,a.vA)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new De(e,t);let s,r;t.isEmpty()?(s=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(s=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const a=s.isEmpty()?nt:this.priorityNode_;return new st(s,a,r)}}updateChild(e,t){const n=fe(e);if(null===n)return t;{(0,a.vA)(".priority"!==fe(e)||1===ge(e),".priority must be the last token in a path");const s=this.getImmediateChild(n).updateChild(xe(e),t);return this.updateImmediateChild(n,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,s=0,r=!0;if(this.forEachChild($e,((a,i)=>{t[a]=i.val(e),n++,r&&st.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):r=!1})),!e&&r&&s<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Be(this.getPriority().val())+":"),this.forEachChild($e,((t,n)=>{const s=n.hash();""!==s&&(e+=":"+t+":"+s)})),this.lazyHash_=""===e?"":y(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const s=this.resolveIndex_(n);if(s){const n=s.getPredecessorKey(new De(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new De(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new De(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,De.Wrap);let s=n.peek();for(;null!=s&&t.compare(s,e)<0;)n.getNext(),s=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,De.Wrap);let s=n.peek();for(;null!=s&&t.compare(s,e)>0;)n.getNext(),s=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rt?-1:0}withIndex(e){if(e===Le||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new st(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Le||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator($e),n=t.getIterator($e);let s=e.getNext(),r=n.getNext();for(;s&&r;){if(s.name!==r.name||!s.node.equals(r.node))return!1;s=e.getNext(),r=n.getNext()}return null===s&&null===r}return!1}return!1}}resolveIndex_(e){return e===Le?null:this.indexMap_.get(e.toString())}}st.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const rt=new class extends st{constructor(){super(new Ue(qe),st.EMPTY_NODE,tt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return st.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(De,{MIN:{value:new De(T,st.EMPTY_NODE)},MAX:{value:new De(E,rt)}}),Me.__EMPTY_NODE=st.EMPTY_NODE,Qe.__childrenNodeConstructor=st,We=rt,function(e){Ye=e}(rt);function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return st.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),(0,a.vA)(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Qe(e,at(t))}if(e instanceof Array){let n=st.EMPTY_NODE;return L(e,((t,s)=>{if((0,a.gR)(e,t)&&"."!==t.substring(0,1)){const e=at(s);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(at(t))}{const n=[];let s=!1;if(L(e,((e,t)=>{if("."!==e.substring(0,1)){const r=at(t);r.isEmpty()||(s=s||!r.getPriority().isEmpty(),n.push(new De(e,r)))}})),0===n.length)return st.EMPTY_NODE;const r=Ze(n,ze,(e=>e.name),qe);if(s){const e=Ze(n,$e.getCompare());return new st(r,at(t),new tt({".priority":e},{".priority":$e}))}return new st(r,at(t),tt.Default)}}!function(e){Ke=e}(at);class it extends Pe{constructor(e){super(),this.indexPath_=e,(0,a.vA)(!je(e)&&".priority"!==fe(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),s=this.extractChild(t.node),r=n.compareTo(s);return 0===r?A(e.name,t.name):r}makePost(e,t){const n=at(e),s=st.EMPTY_NODE.updateChild(this.indexPath_,n);return new De(t,s)}maxPost(){const e=st.EMPTY_NODE.updateChild(this.indexPath_,rt);return new De(E,e)}toString(){return ve(this.indexPath_,0).join("/")}}const ot=new class extends Pe{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?A(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return De.MIN}maxPost(){return De.MAX}makePost(e,t){const n=at(e);return new De(t,n)}toString(){return".value"}};function lt(e){return{type:"value",snapshotNode:e}}function ct(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ut(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class ht{constructor(e){this.index_=e}updateChild(e,t,n,s,r,i){(0,a.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(s).equals(n.getChild(s))&&o.isEmpty()===n.isEmpty()?e:(null!=i&&(n.isEmpty()?e.hasChild(t)?i.trackChildChange(dt(t,o)):(0,a.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?i.trackChildChange(ct(t,n)):i.trackChildChange(ut(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild($e,((e,s)=>{t.hasChild(e)||n.trackChildChange(dt(e,s))})),t.isLeafNode()||t.forEachChild($e,((t,s)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(s)||n.trackChildChange(ut(t,s,r))}else n.trackChildChange(ct(t,s))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?st.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class mt{constructor(e){this.indexedFilter_=new ht(e.getIndex()),this.index_=e.getIndex(),this.startPost_=mt.getStartPost_(e),this.endPost_=mt.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,s,r,a){return this.matches(new De(t,n))||(n=st.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,s,r,a)}updateFullNode(e,t,n){t.isLeafNode()&&(t=st.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(st.EMPTY_NODE);const r=this;return t.forEachChild($e,((e,t)=>{r.matches(new De(e,t))||(s=s.updateImmediateChild(e,st.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,s,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class pt{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new mt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,s,r,a){return this.rangedFilter_.matches(new De(t,n))||(n=st.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,s,r,a):this.fullLimitUpdateChild_(e,t,n,r,a)}updateFullNode(e,t,n){let s;if(t.isLeafNode()||t.isEmpty())s=st.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;s=st.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;s=s.updateImmediateChild(t.name,t.node),n++}}}else{let e;s=t.withIndex(this.index_),s=s.updatePriority(st.EMPTY_NODE),e=this.reverse_?s.getReverseIterator(this.index_):s.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:s=s.updateImmediateChild(t.name,st.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,s,r){let i;if(this.reverse_){const e=this.index_.getCompare();i=(t,n)=>e(n,t)}else i=this.index_.getCompare();const o=e;(0,a.vA)(o.numChildren()===this.limit_,"");const l=new De(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(o.hasChild(t)){const e=o.getImmediateChild(t);let a=s.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=a&&(a.name===t||o.hasChild(a.name));)a=s.getChildAfterChild(this.index_,a,this.reverse_);const u=null==a?1:i(a,l);if(d&&!n.isEmpty()&&u>=0)return null!=r&&r.trackChildChange(ut(t,n,e)),o.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(dt(t,e));const n=o.updateImmediateChild(t,st.EMPTY_NODE);return null!=a&&this.rangedFilter_.matches(a)?(null!=r&&r.trackChildChange(ct(a.name,a.node)),n.updateImmediateChild(a.name,a.node)):n}}return n.isEmpty()?e:d&&i(c,l)>=0?(null!=r&&(r.trackChildChange(dt(c.name,c.node)),r.trackChildChange(ct(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,st.EMPTY_NODE)):e}}class ft{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:T}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:E}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,a.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new ft;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function gt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===$e?n="$priority":e.index_===ot?n="$value":e.index_===Le?n="$key":((0,a.vA)(e.index_ instanceof it,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,a.As)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=(0,a.As)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+(0,a.As)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=(0,a.As)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+(0,a.As)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function xt(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==$e&&(t.i=e.index_.toString()),t}class yt extends de{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,a.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=s,this.log_=k("p:rest:"),this.listens_={}}listen(e,t,n,s){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const i=yt.getListenId_(e,n),o={};this.listens_[i]=o;const l=gt(e._queryParams);this.restRequest_(r+".json",l,((e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(r,l,!1,n),(0,a.yw)(this.listens_,i)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",s(t,null)}}))}unlisten(e,t){const n=yt.getListenId_(e,t);delete this.listens_[n]}get(e){const t=gt(e._queryParams),n=e._path.toString(),s=new a.cY;return this.restRequest_(n+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),s.resolve(r)):s.reject(new Error(r))})),s.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((s=>{let[r,i]=s;r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,a.Am)(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(n&&4===l.readyState){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let t=null;if(l.status>=200&&l.status<300){try{t=(0,a.$L)(l.responseText)}catch(e){S("Failed to parse JSON response for "+o+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&S("Got unsuccessful REST response for "+o+" Status: "+l.status),n(l.status);n=null}},l.open("GET",o,!0),l.send()}))}}class vt{constructor(){this.rootNode_=st.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function bt(){return{value:null,children:new Map}}function wt(e,t,n){if(je(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const s=fe(t);e.children.has(s)||e.children.set(s,bt());wt(e.children.get(s),t=xe(t),n)}}function jt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,s)=>{jt(s,new me(t.toString()+"/"+e),n)}))}class Nt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&L(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class kt{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Nt(e);const n=1e4+2e4*Math.random();q(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;L(e,((e,s)=>{s>0&&(0,a.gR)(this.statsToReport_,e)&&(t[e]=s,n=!0)})),n&&this.server_.reportStats(t),q(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var _t;function Ct(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(_t||(_t={}));class St{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=_t.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(je(this.path)){if(null!=this.affectedTree.value)return(0,a.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new me(e));return new St(pe(),t,this.revert)}}return(0,a.vA)(fe(this.path)===e,"operationForChild called for unrelated child."),new St(xe(this.path),this.affectedTree,this.revert)}}class It{constructor(e,t){this.source=e,this.path=t,this.type=_t.LISTEN_COMPLETE}operationForChild(e){return je(this.path)?new It(this.source,pe()):new It(this.source,xe(this.path))}}class Tt{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=_t.OVERWRITE}operationForChild(e){return je(this.path)?new Tt(this.source,pe(),this.snap.getImmediateChild(e)):new Tt(this.source,xe(this.path),this.snap)}}class Et{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=_t.MERGE}operationForChild(e){if(je(this.path)){const t=this.children.subtree(new me(e));return t.isEmpty()?null:t.value?new Tt(this.source,pe(),t.value):new Et(this.source,pe(),t)}return(0,a.vA)(fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Et(this.source,xe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class At{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(je(e))return this.isFullyInitialized()&&!this.filtered_;const t=fe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Dt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Pt(e,t,n,s,r,i){const o=s.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw(0,a.Hk)("Should only compare child_ events.");const s=new De(t.childName,t.snapshotNode),r=new De(n.childName,n.snapshotNode);return e.index_.compare(s,r)}(e,t,n))),o.forEach((n=>{const s=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,i);r.forEach((r=>{r.respondsTo(n.type)&&t.push(r.createEvent(s,e.query_))}))}))}function Rt(e,t){return{eventCache:e,serverCache:t}}function Mt(e,t,n,s){return Rt(new At(t,n,s),e.serverCache)}function Lt(e,t,n,s){return Rt(e.eventCache,new At(t,n,s))}function Ot(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ft(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Ut;class zt{static fromObject(e){let t=new zt(null);return L(e,((e,n)=>{t=t.set(new me(e),n)})),t}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Ut||(Ut=new Ue(D)),Ut);this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:pe(),value:this.value};if(je(e))return null;{const n=fe(e),s=this.children.get(n);if(null!==s){const r=s.findRootMostMatchingPathAndValue(xe(e),t);if(null!=r){return{path:we(new me(n),r.path),value:r.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(je(e))return this;{const t=fe(e),n=this.children.get(t);return null!==n?n.subtree(xe(e)):new zt(null)}}set(e,t){if(je(e))return new zt(t,this.children);{const n=fe(e),s=(this.children.get(n)||new zt(null)).set(xe(e),t),r=this.children.insert(n,s);return new zt(this.value,r)}}remove(e){if(je(e))return this.children.isEmpty()?new zt(null):new zt(null,this.children);{const t=fe(e),n=this.children.get(t);if(n){const s=n.remove(xe(e));let r;return r=s.isEmpty()?this.children.remove(t):this.children.insert(t,s),null===this.value&&r.isEmpty()?new zt(null):new zt(this.value,r)}return this}}get(e){if(je(e))return this.value;{const t=fe(e),n=this.children.get(t);return n?n.get(xe(e)):null}}setTree(e,t){if(je(e))return t;{const n=fe(e),s=(this.children.get(n)||new zt(null)).setTree(xe(e),t);let r;return r=s.isEmpty()?this.children.remove(n):this.children.insert(n,s),new zt(this.value,r)}}fold(e){return this.fold_(pe(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((s,r)=>{n[s]=r.fold_(we(e,s),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,pe(),t)}findOnPath_(e,t,n){const s=!!this.value&&n(t,this.value);if(s)return s;if(je(e))return null;{const s=fe(e),r=this.children.get(s);return r?r.findOnPath_(xe(e),we(t,s),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,pe(),t)}foreachOnPath_(e,t,n){if(je(e))return this;{this.value&&n(t,this.value);const s=fe(e),r=this.children.get(s);return r?r.foreachOnPath_(xe(e),we(t,s),n):new zt(null)}}foreach(e){this.foreach_(pe(),e)}foreach_(e,t){this.children.inorderTraversal(((n,s)=>{s.foreach_(we(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class qt{constructor(e){this.writeTree_=e}static empty(){return new qt(new zt(null))}}function Wt(e,t,n){if(je(t))return new qt(new zt(n));{const s=e.writeTree_.findRootMostValueAndPath(t);if(null!=s){const r=s.path;let a=s.value;const i=Ne(r,t);return a=a.updateChild(i,n),new qt(e.writeTree_.set(r,a))}{const s=new zt(n),r=e.writeTree_.setTree(t,s);return new qt(r)}}}function Bt(e,t,n){let s=e;return L(n,((e,n)=>{s=Wt(s,we(t,e),n)})),s}function Vt(e,t){if(je(t))return qt.empty();{const n=e.writeTree_.setTree(t,new zt(null));return new qt(n)}}function Ht(e,t){return null!=Kt(e,t)}function Kt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Ne(n.path,t)):null}function Yt(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild($e,((e,n)=>{t.push(new De(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new De(e,n.value))})),t}function Qt(e,t){if(je(t))return e;{const n=Kt(e,t);return new qt(null!=n?new zt(n):e.writeTree_.subtree(t))}}function $t(e){return e.writeTree_.isEmpty()}function Gt(e,t){return Jt(pe(),e.writeTree_,t)}function Jt(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let s=null;return t.children.inorderTraversal(((t,r)=>{".priority"===t?((0,a.vA)(null!==r.value,"Priority writes must always be leaf nodes"),s=r.value):n=Jt(we(e,t),r,n)})),n.getChild(e).isEmpty()||null===s||(n=n.updateChild(we(e,".priority"),s)),n}}function Zt(e,t){return hn(t,e)}function Xt(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));(0,a.vA)(n>=0,"removeWrite called with nonexistent writeId.");const s=e.allWrites[n];e.allWrites.splice(n,1);let r=s.visible,i=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&en(t,s.path)?r=!1:_e(s.path,t.path)&&(i=!0)),o--}if(r){if(i)return function(e){e.visibleWrites=nn(e.allWrites,tn,pe()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(s.snap)e.visibleWrites=Vt(e.visibleWrites,s.path);else{L(s.children,(t=>{e.visibleWrites=Vt(e.visibleWrites,we(s.path,t))}))}return!0}return!1}function en(e,t){if(e.snap)return _e(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&_e(we(e.path,n),t))return!0;return!1}function tn(e){return e.visible}function nn(e,t,n){let s=qt.empty();for(let r=0;r<e.length;++r){const i=e[r];if(t(i)){const e=i.path;let t;if(i.snap)_e(n,e)?(t=Ne(n,e),s=Wt(s,t,i.snap)):_e(e,n)&&(t=Ne(e,n),s=Wt(s,pe(),i.snap.getChild(t)));else{if(!i.children)throw(0,a.Hk)("WriteRecord should have .snap or .children");if(_e(n,e))t=Ne(n,e),s=Bt(s,t,i.children);else if(_e(e,n))if(t=Ne(e,n),je(t))s=Bt(s,pe(),i.children);else{const e=(0,a.yw)(i.children,fe(t));if(e){const n=e.getChild(xe(t));s=Wt(s,pe(),n)}}}}}return s}function sn(e,t,n,s,r){if(s||r){const a=Qt(e.visibleWrites,t);if(!r&&$t(a))return n;if(r||null!=n||Ht(a,pe())){const a=function(e){return(e.visible||r)&&(!s||!~s.indexOf(e.writeId))&&(_e(e.path,t)||_e(t,e.path))};return Gt(nn(e.allWrites,a,t),n||st.EMPTY_NODE)}return null}{const s=Kt(e.visibleWrites,t);if(null!=s)return s;{const s=Qt(e.visibleWrites,t);if($t(s))return n;if(null!=n||Ht(s,pe())){return Gt(s,n||st.EMPTY_NODE)}return null}}}function rn(e,t,n,s){return sn(e.writeTree,e.treePath,t,n,s)}function an(e,t){return function(e,t,n){let s=st.EMPTY_NODE;const r=Kt(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild($e,((e,t)=>{s=s.updateImmediateChild(e,t)})),s;if(n){const r=Qt(e.visibleWrites,t);return n.forEachChild($e,((e,t)=>{const n=Gt(Qt(r,new me(e)),t);s=s.updateImmediateChild(e,n)})),Yt(r).forEach((e=>{s=s.updateImmediateChild(e.name,e.node)})),s}return Yt(Qt(e.visibleWrites,t)).forEach((e=>{s=s.updateImmediateChild(e.name,e.node)})),s}(e.writeTree,e.treePath,t)}function on(e,t,n,s){return function(e,t,n,s,r){(0,a.vA)(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=we(t,n);if(Ht(e.visibleWrites,i))return null;{const t=Qt(e.visibleWrites,i);return $t(t)?r.getChild(n):Gt(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,s)}function ln(e,t){return function(e,t){return Kt(e.visibleWrites,t)}(e.writeTree,we(e.treePath,t))}function cn(e,t,n,s,r,a){return function(e,t,n,s,r,a,i){let o;const l=Qt(e.visibleWrites,t),c=Kt(l,pe());if(null!=c)o=c;else{if(null==n)return[];o=Gt(l,n)}if(o=o.withIndex(i),o.isEmpty()||o.isLeafNode())return[];{const e=[],t=i.getCompare(),n=a?o.getReverseIteratorFrom(s,i):o.getIteratorFrom(s,i);let l=n.getNext();for(;l&&e.length<r;)0!==t(l,s)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,s,r,a)}function dn(e,t,n){return function(e,t,n,s){const r=we(t,n),a=Kt(e.visibleWrites,r);if(null!=a)return a;if(s.isCompleteForChild(n))return Gt(Qt(e.visibleWrites,r),s.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function un(e,t){return hn(we(e.treePath,t),e.writeTree)}function hn(e,t){return{treePath:e,writeTree:t}}class mn{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,a.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,a.vA)(".priority"!==n,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(n);if(s){const r=s.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,ut(n,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,dt(n,s.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,ct(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw(0,a.Hk)("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(n,ut(n,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const pn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class fn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new At(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const s=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ft(this.viewCache_),r=cn(this.writes_,s,t,1,n,e);return 0===r.length?null:r[0]}}function gn(e,t,n,s,r){const i=new mn;let o,l;if(n.type===_t.OVERWRITE){const c=n;c.source.fromUser?o=vn(e,t,c.path,c.snap,s,r,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered()&&!je(c.path),o=yn(e,t,c.path,c.snap,s,r,l,i))}else if(n.type===_t.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,s,r,a,i){let o=t;return s.foreach(((s,l)=>{const c=we(n,s);bn(t,fe(c))&&(o=vn(e,o,c,l,r,a,i))})),s.foreach(((s,l)=>{const c=we(n,s);bn(t,fe(c))||(o=vn(e,o,c,l,r,a,i))})),o}(e,t,c.path,c.children,s,r,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered(),o=jn(e,t,c.path,c.children,s,r,l,i))}else if(n.type===_t.ACK_USER_WRITE){const l=n;o=l.revert?function(e,t,n,s,r,i){let o;if(null!=ln(s,n))return t;{const l=new fn(s,t,r),c=t.eventCache.getNode();let d;if(je(n)||".priority"===fe(n)){let n;if(t.serverCache.isFullyInitialized())n=rn(s,Ft(t));else{const e=t.serverCache.getNode();(0,a.vA)(e instanceof st,"serverChildren would be complete if leaf node"),n=an(s,e)}d=e.filter.updateFullNode(c,n,i)}else{const r=fe(n);let a=dn(s,r,t.serverCache);null==a&&t.serverCache.isCompleteForChild(r)&&(a=c.getImmediateChild(r)),d=null!=a?e.filter.updateChild(c,r,a,xe(n),l,i):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(c,r,st.EMPTY_NODE,xe(n),l,i):c,d.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=rn(s,Ft(t)),o.isLeafNode()&&(d=e.filter.updateFullNode(d,o,i)))}return o=t.serverCache.isFullyInitialized()||null!=ln(s,pe()),Mt(t,d,o,e.filter.filtersNodes())}}(e,t,l.path,s,r,i):function(e,t,n,s,r,a,i){if(null!=ln(r,n))return t;const o=t.serverCache.isFiltered(),l=t.serverCache;if(null!=s.value){if(je(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return yn(e,t,n,l.getNode().getChild(n),r,a,o,i);if(je(n)){let s=new zt(null);return l.getNode().forEachChild(Le,((e,t)=>{s=s.set(new me(e),t)})),jn(e,t,n,s,r,a,o,i)}return t}{let c=new zt(null);return s.foreach(((e,t)=>{const s=we(n,e);l.isCompleteForPath(s)&&(c=c.set(e,l.getNode().getChild(s)))})),jn(e,t,n,c,r,a,o,i)}}(e,t,l.path,l.affectedTree,s,r,i)}else{if(n.type!==_t.LISTEN_COMPLETE)throw(0,a.Hk)("Unknown operation type: "+n.type);o=function(e,t,n,s,r){const a=t.serverCache,i=Lt(t,a.getNode(),a.isFullyInitialized()||je(n),a.isFiltered());return xn(e,i,n,s,pn,r)}(e,t,n.path,s,i)}const c=i.getChanges();return function(e,t,n){const s=t.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),a=Ot(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!s.getNode().equals(a)||!s.getNode().getPriority().equals(a.getPriority()))&&n.push(lt(Ot(t)))}}(t,o,c),{viewCache:o,changes:c}}function xn(e,t,n,s,r,i){const o=t.eventCache;if(null!=ln(s,n))return t;{let l,c;if(je(n))if((0,a.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ft(t),r=an(s,n instanceof st?n:st.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),r,i)}else{const n=rn(s,Ft(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,i)}else{const d=fe(n);if(".priority"===d){(0,a.vA)(1===ge(n),"Can't have a priority with additional path components");const r=o.getNode();c=t.serverCache.getNode();const i=on(s,n,r,c);l=null!=i?e.filter.updatePriority(r,i):o.getNode()}else{const a=xe(n);let u;if(o.isCompleteForChild(d)){c=t.serverCache.getNode();const e=on(s,n,o.getNode(),c);u=null!=e?o.getNode().getImmediateChild(d).updateChild(a,e):o.getNode().getImmediateChild(d)}else u=dn(s,d,t.serverCache);l=null!=u?e.filter.updateChild(o.getNode(),d,u,a,r,i):o.getNode()}}return Mt(t,l,o.isFullyInitialized()||je(n),e.filter.filtersNodes())}}function yn(e,t,n,s,r,a,i,o){const l=t.serverCache;let c;const d=i?e.filter:e.filter.getIndexedFilter();if(je(n))c=d.updateFullNode(l.getNode(),s,null);else if(d.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,s);c=d.updateFullNode(l.getNode(),e,null)}else{const e=fe(n);if(!l.isCompleteForPath(n)&&ge(n)>1)return t;const r=xe(n),a=l.getNode().getImmediateChild(e).updateChild(r,s);c=".priority"===e?d.updatePriority(l.getNode(),a):d.updateChild(l.getNode(),e,a,r,pn,null)}const u=Lt(t,c,l.isFullyInitialized()||je(n),d.filtersNodes());return xn(e,u,n,r,new fn(r,u,a),o)}function vn(e,t,n,s,r,a,i){const o=t.eventCache;let l,c;const d=new fn(r,t,a);if(je(n))c=e.filter.updateFullNode(t.eventCache.getNode(),s,i),l=Mt(t,c,!0,e.filter.filtersNodes());else{const r=fe(n);if(".priority"===r)c=e.filter.updatePriority(t.eventCache.getNode(),s),l=Mt(t,c,o.isFullyInitialized(),o.isFiltered());else{const a=xe(n),c=o.getNode().getImmediateChild(r);let u;if(je(a))u=s;else{const e=d.getCompleteChild(r);u=null!=e?".priority"===ye(a)&&e.getChild(be(a)).isEmpty()?e:e.updateChild(a,s):st.EMPTY_NODE}if(c.equals(u))l=t;else{l=Mt(t,e.filter.updateChild(o.getNode(),r,u,a,d,i),o.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function bn(e,t){return e.eventCache.isCompleteForChild(t)}function wn(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function jn(e,t,n,s,r,a,i,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=je(n)?s:new zt(null).setTree(n,s);const d=t.serverCache.getNode();return l.children.inorderTraversal(((n,s)=>{if(d.hasChild(n)){const l=wn(0,t.serverCache.getNode().getImmediateChild(n),s);c=yn(e,c,new me(n),l,r,a,i,o)}})),l.children.inorderTraversal(((n,s)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===s.value;if(!d.hasChild(n)&&!l){const l=wn(0,t.serverCache.getNode().getImmediateChild(n),s);c=yn(e,c,new me(n),l,r,a,i,o)}})),c}class Nn{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,s=new ht(n.getIndex()),r=(a=n).loadsAllData()?new ht(a.getIndex()):a.hasLimit()?new pt(a):new mt(a);var a;this.processor_=function(e){return{filter:e}}(r);const i=t.serverCache,o=t.eventCache,l=s.updateFullNode(st.EMPTY_NODE,i.getNode(),null),c=r.updateFullNode(st.EMPTY_NODE,o.getNode(),null),d=new At(l,i.isFullyInitialized(),s.filtersNodes()),u=new At(c,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=Rt(u,d),this.eventGenerator_=new Dt(this.query_)}get query(){return this.query_}}function kn(e,t){const n=Ft(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!je(t)&&!n.getImmediateChild(fe(t)).isEmpty())?n.getChild(t):null}function _n(e){return 0===e.eventRegistrations_.length}function Cn(e,t,n){const s=[];if(n){(0,a.vA)(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,r);t&&s.push(t)}))}if(t){let n=[];for(let s=0;s<e.eventRegistrations_.length;++s){const r=e.eventRegistrations_[s];if(r.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(s+1));break}}else n.push(r)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return s}function Sn(e,t,n,s){t.type===_t.MERGE&&null!==t.source.queryId&&((0,a.vA)(Ft(e.viewCache_),"We should always have a full cache before handling merges"),(0,a.vA)(Ot(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,i=gn(e.processor_,r,t,n,s);var o,l;return o=e.processor_,l=i.viewCache,(0,a.vA)(l.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),(0,a.vA)(l.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),(0,a.vA)(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=i.viewCache,In(e,i.changes,i.viewCache.eventCache.getNode(),null)}function In(e,t,n,s){const r=s?[s]:e.eventRegistrations_;return function(e,t,n,s){const r=[],a=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Pt(e,r,"child_removed",t,s,n),Pt(e,r,"child_added",t,s,n),Pt(e,r,"child_moved",a,s,n),Pt(e,r,"child_changed",t,s,n),Pt(e,r,"value",t,s,n),r}(e.eventGenerator_,t,n,r)}let Tn,En;class An{constructor(){this.views=new Map}}function Dn(e,t,n,s){const r=t.source.queryId;if(null!==r){const i=e.views.get(r);return(0,a.vA)(null!=i,"SyncTree gave us an op for an invalid query."),Sn(i,t,n,s)}{let r=[];for(const a of e.views.values())r=r.concat(Sn(a,t,n,s));return r}}function Pn(e,t,n,s,r){const a=t._queryIdentifier,i=e.views.get(a);if(!i){let e=rn(n,r?s:null),a=!1;e?a=!0:s instanceof st?(e=an(n,s),a=!1):(e=st.EMPTY_NODE,a=!1);const i=Rt(new At(e,a,!1),new At(s,r,!1));return new Nn(t,i)}return i}function Rn(e,t,n,s,r,a){const i=Pn(e,t,s,r,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,i),function(e,t){e.eventRegistrations_.push(t)}(i,n),function(e,t){const n=e.viewCache_.eventCache,s=[];n.getNode().isLeafNode()||n.getNode().forEachChild($e,((e,t)=>{s.push(ct(e,t))}));return n.isFullyInitialized()&&s.push(lt(n.getNode())),In(e,s,n.getNode(),t)}(i,n)}function Mn(e,t,n,s){const r=t._queryIdentifier,i=[];let o=[];const l=zn(e);if("default"===r)for(const[a,c]of e.views.entries())o=o.concat(Cn(c,n,s)),_n(c)&&(e.views.delete(a),c.query._queryParams.loadsAllData()||i.push(c.query));else{const t=e.views.get(r);t&&(o=o.concat(Cn(t,n,s)),_n(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||i.push(t.query)))}return l&&!zn(e)&&i.push(new((0,a.vA)(Tn,"Reference.ts has not been loaded"),Tn)(t._repo,t._path)),{removed:i,events:o}}function Ln(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function On(e,t){let n=null;for(const s of e.views.values())n=n||kn(s,t);return n}function Fn(e,t){if(t._queryParams.loadsAllData())return qn(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Un(e,t){return null!=Fn(e,t)}function zn(e){return null!=qn(e)}function qn(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Wn=1;class Bn{constructor(e){this.listenProvider_=e,this.syncPointTree_=new zt(null),this.pendingWriteTree_={visibleWrites:qt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Vn(e,t,n,s,r){return function(e,t,n,s,r){(0,a.vA)(s>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:s,visible:r}),r&&(e.visibleWrites=Wt(e.visibleWrites,t,n)),e.lastWriteId=s}(e.pendingWriteTree_,t,n,s,r),r?Jn(e,new Tt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Hn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=function(e,t){for(let n=0;n<e.allWrites.length;n++){const s=e.allWrites[n];if(s.writeId===t)return s}return null}(e.pendingWriteTree_,t);if(Xt(e.pendingWriteTree_,t)){let t=new zt(null);return null!=s.snap?t=t.set(pe(),!0):L(s.children,(e=>{t=t.set(new me(e),!0)})),Jn(e,new St(s.path,t,n))}return[]}function Kn(e,t,n){return Jn(e,new Tt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Yn(e,t,n,s){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=t._path,i=e.syncPointTree_.get(a);let o=[];if(i&&("default"===t._queryIdentifier||Un(i,t))){const l=Mn(i,t,n,s);0===i.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(a));const c=l.removed;if(o=l.events,!r){const n=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),r=e.syncPointTree_.findOnPath(a,((e,t)=>zn(t)));if(n&&!r){const t=e.syncPointTree_.subtree(a);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&zn(t)){return[qn(t)]}{let e=[];return t&&(e=Ln(t)),L(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const s=n[t],r=s.query,a=es(e,s);e.listenProvider_.startListening(is(r),ts(e,r),a.hashFn,a.onComplete)}}}if(!r&&c.length>0&&!s)if(n){const n=null;e.listenProvider_.stopListening(is(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(ns(t));e.listenProvider_.stopListening(is(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const s=t[n];if(!s._queryParams.loadsAllData()){const t=ns(s),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function Qn(e,t,n,s){const r=ss(e,s);if(null!=r){const s=rs(r),a=s.path,i=s.queryId,o=Ne(a,t);return as(e,a,new Tt(Ct(i),o,n))}return[]}function $n(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t._path;let i=null,o=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=Ne(e,r);i=i||On(t,n),o=o||zn(t)}));let l,c=e.syncPointTree_.get(r);if(c?(o=o||zn(c),i=i||On(c,pe())):(c=new An,e.syncPointTree_=e.syncPointTree_.set(r,c)),null!=i)l=!0;else{l=!1,i=st.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=On(t,pe());n&&(i=i.updateImmediateChild(e,n))}))}const d=Un(c,t);if(!d&&!t._queryParams.loadsAllData()){const n=ns(t);(0,a.vA)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const s=Wn++;e.queryToTagMap.set(n,s),e.tagToQueryMap.set(s,n)}let u=Rn(c,t,n,Zt(e.pendingWriteTree_,r),i,l);if(!d&&!o&&!s){const n=Fn(c,t);u=u.concat(function(e,t,n){const s=t._path,r=ts(e,t),i=es(e,n),o=e.listenProvider_.startListening(is(t),r,i.hashFn,i.onComplete),l=e.syncPointTree_.subtree(s);if(r)(0,a.vA)(!zn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold(((e,t,n)=>{if(!je(e)&&t&&zn(t))return[qn(t).query];{let e=[];return t&&(e=e.concat(Ln(t).map((e=>e.query)))),L(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const s=t[n];e.listenProvider_.stopListening(is(s),ts(e,s))}}return o}(e,t,n))}return u}function Gn(e,t,n){const s=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,n)=>{const s=On(n,Ne(e,t));if(s)return s}));return sn(s,t,r,n,!0)}function Jn(e,t){return Zn(t,e.syncPointTree_,null,Zt(e.pendingWriteTree_,pe()))}function Zn(e,t,n,s){if(je(e.path))return Xn(e,t,n,s);{const r=t.get(pe());null==n&&null!=r&&(n=On(r,pe()));let a=[];const i=fe(e.path),o=e.operationForChild(i),l=t.children.get(i);if(l&&o){const e=n?n.getImmediateChild(i):null,t=un(s,i);a=a.concat(Zn(o,l,e,t))}return r&&(a=a.concat(Dn(r,e,s,n))),a}}function Xn(e,t,n,s){const r=t.get(pe());null==n&&null!=r&&(n=On(r,pe()));let a=[];return t.children.inorderTraversal(((t,r)=>{const i=n?n.getImmediateChild(t):null,o=un(s,t),l=e.operationForChild(t);l&&(a=a.concat(Xn(l,r,i,o)))})),r&&(a=a.concat(Dn(r,e,s,n))),a}function es(e,t){const n=t.query,s=ts(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||st.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return s?function(e,t,n){const s=ss(e,n);if(s){const n=rs(s),r=n.path,a=n.queryId,i=Ne(r,t);return as(e,r,new It(Ct(a),i))}return[]}(e,n._path,s):function(e,t){return Jn(e,new It({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const s=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const s=new Error(e+" at "+t._path.toString()+": "+n);return s.code=e.toUpperCase(),s}(t,n);return Yn(e,n,null,s)}}}}function ts(e,t){const n=ns(t);return e.queryToTagMap.get(n)}function ns(e){return e._path.toString()+"$"+e._queryIdentifier}function ss(e,t){return e.tagToQueryMap.get(t)}function rs(e){const t=e.indexOf("$");return(0,a.vA)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new me(e.substr(0,t))}}function as(e,t,n){const s=e.syncPointTree_.get(t);(0,a.vA)(s,"Missing sync point for query tag that we're tracking");return Dn(s,n,Zt(e.pendingWriteTree_,t),null)}function is(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,a.vA)(En,"Reference.ts has not been loaded"),En)(e._repo,e._path):e}class os{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new os(t)}node(){return this.node_}}class ls{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=we(this.path_,e);return new ls(this.syncTree_,t)}node(){return Gn(this.syncTree_,this.path_)}}const cs=function(e,t,n){return e&&"object"===typeof e?((0,a.vA)(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?ds(e[".sv"],t,n):"object"===typeof e[".sv"]?us(e[".sv"],t):void(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},ds=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,a.vA)(!1,"Unexpected server value: "+e)},us=function(e,t,n){e.hasOwnProperty("increment")||(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const s=e.increment;"number"!==typeof s&&(0,a.vA)(!1,"Unexpected increment value: "+s);const r=t.node();if((0,a.vA)(null!==r&&"undefined"!==typeof r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const i=r.getValue();return"number"!==typeof i?s:i+s},hs=function(e,t,n,s){return ps(t,new ls(n,e),s)},ms=function(e,t,n){return ps(e,new os(t),n)};function ps(e,t,n){const s=e.getPriority().val(),r=cs(s,t.getImmediateChild(".priority"),n);let a;if(e.isLeafNode()){const s=e,a=cs(s.getValue(),t,n);return a!==s.getValue()||r!==s.getPriority().val()?new Qe(a,at(r)):e}{const s=e;return a=s,r!==s.getPriority().val()&&(a=a.updatePriority(new Qe(r))),s.forEachChild($e,((e,s)=>{const r=ps(s,t.getImmediateChild(e),n);r!==s&&(a=a.updateImmediateChild(e,r))})),a}}class fs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function gs(e,t){let n=t instanceof me?t:new me(t),s=e,r=fe(n);for(;null!==r;){const e=(0,a.yw)(s.node.children,r)||{children:{},childCount:0};s=new fs(r,s,e),n=xe(n),r=fe(n)}return s}function xs(e){return e.node.value}function ys(e,t){e.node.value=t,Ns(e)}function vs(e){return e.node.childCount>0}function bs(e,t){L(e.node.children,((n,s)=>{t(new fs(n,e,s))}))}function ws(e,t,n,s){n&&!s&&t(e),bs(e,(e=>{ws(e,t,!0,s)})),n&&s&&t(e)}function js(e){return new me(null===e.parent?e.name:js(e.parent)+"/"+e.name)}function Ns(e){null!==e.parent&&function(e,t,n){const s=function(e){return void 0===xs(e)&&!vs(e)}(n),r=(0,a.gR)(e.node.children,t);s&&r?(delete e.node.children[t],e.node.childCount--,Ns(e)):s||r||(e.node.children[t]=n.node,e.node.childCount++,Ns(e))}(e.parent,e.name,e)}const ks=/[\[\].#$\/\u0000-\u001F\u007F]/,_s=/[\[\].#$\u0000-\u001F\u007F]/,Cs=10485760,Ss=function(e){return"string"===typeof e&&0!==e.length&&!ks.test(e)},Is=function(e){return"string"===typeof e&&0!==e.length&&!_s.test(e)},Ts=function(e,t,n){const s=n instanceof me?new Ce(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ie(s));if("function"===typeof t)throw new Error(e+"contains a function "+Ie(s)+" with contents = "+t.toString());if(I(t))throw new Error(e+"contains "+t.toString()+" "+Ie(s));if("string"===typeof t&&t.length>Cs/3&&(0,a.OE)(t)>Cs)throw new Error(e+"contains a string greater than "+Cs+" utf8 bytes "+Ie(s)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,r=!1;if(L(t,((t,i)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!Ss(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ie(s)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,a.OE)(t),Se(e)}(s,t),Ts(e,i,s),function(e){const t=e.parts_.pop();e.byteLength_-=(0,a.OE)(t),e.parts_.length>0&&(e.byteLength_-=1)}(s)})),n&&r)throw new Error(e+' contains ".value" child '+Ie(s)+" in addition to actual children.")}},Es=function(e,t,n,s){if((!s||void 0!==n)&&!Is(n))throw new Error((0,a.dI)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},As=function(e,t,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Es(e,t,n,s)},Ds=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ss(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Is(e)}(n))throw new Error((0,a.dI)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Ps{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Rs(e,t){let n=null;for(let s=0;s<t.length;s++){const r=t[s],a=r.getPath();null===n||ke(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(r)}n&&e.eventLists_.push(n)}function Ms(e,t,n){Rs(e,n),Os(e,(e=>ke(e,t)))}function Ls(e,t,n){Rs(e,n),Os(e,(e=>_e(e,t)||_e(t,e)))}function Os(e,t){e.recursionDepth_++;let n=!0;for(let s=0;s<e.eventLists_.length;s++){const r=e.eventLists_[s];if(r){t(r.path)?(Fs(e.eventLists_[s]),e.eventLists_[s]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Fs(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const s=n.getEventRunner();b&&N("event: "+n.toString()),z(s)}}}const Us="repo_interrupt";class zs{constructor(e,t,n,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ps,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=bt(),this.transactionQueueTree_=new fs,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function qs(e,t,n){if(e.stats_=te(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new yt(e.repoInfo_,((t,n,s,r)=>{Vs(e,t,n,s,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Hs(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,a.As)(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}e.persistentConnection_=new Ae(e.repoInfo_,t,((t,n,s,r)=>{Vs(e,t,n,s,r)}),(t=>{Hs(e,t)}),(t=>{!function(e,t){L(t,((t,n)=>{Ks(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return ee[n]||(ee[n]=t()),ee[n]}(e.repoInfo_,(()=>new kt(e.stats_,e.server_))),e.infoData_=new vt,e.infoSyncTree_=new Bn({startListening:(t,n,s,r)=>{let a=[];const i=e.infoData_.getNode(t._path);return i.isEmpty()||(a=Kn(e.infoSyncTree_,t._path,i),setTimeout((()=>{r("ok")}),0)),a},stopListening:()=>{}}),Ks(e,"connected",!1),e.serverSyncTree_=new Bn({startListening:(t,n,s,r)=>(e.server_.listen(t,s,n,((n,s)=>{const a=r(n,s);Ls(e.eventQueue_,t._path,a)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Ws(e){const t=e.infoData_.getNode(new me(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Bs(e){return(t=(t={timestamp:Ws(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Vs(e,t,n,s,r){e.dataUpdateCount++;const i=new me(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(s){const t=(0,a.kH)(n,(e=>at(e)));o=function(e,t,n,s){const r=ss(e,s);if(r){const s=rs(r),a=s.path,i=s.queryId,o=Ne(a,t),l=zt.fromObject(n);return as(e,a,new Et(Ct(i),o,l))}return[]}(e.serverSyncTree_,i,t,r)}else{const t=at(n);o=Qn(e.serverSyncTree_,i,t,r)}else if(s){const t=(0,a.kH)(n,(e=>at(e)));o=function(e,t,n){const s=zt.fromObject(n);return Jn(e,new Et({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,s))}(e.serverSyncTree_,i,t)}else{const t=at(n);o=Kn(e.serverSyncTree_,i,t)}let l=i;o.length>0&&(l=Xs(e,i)),Ls(e.eventQueue_,l,o)}function Hs(e,t){Ks(e,"connected",t),!1===t&&function(e){Gs(e,"onDisconnectEvents");const t=Bs(e),n=bt();jt(e.onDisconnect_,pe(),((s,r)=>{const a=hs(s,r,e.serverSyncTree_,t);wt(n,s,a)}));let s=[];jt(n,pe(),((t,n)=>{s=s.concat(Kn(e.serverSyncTree_,t,n));const r=rr(e,t);Xs(e,r)})),e.onDisconnect_=bt(),Ls(e.eventQueue_,pe(),s)}(e)}function Ks(e,t,n){const s=new me("/.info/"+t),r=at(n);e.infoData_.updateSnapshot(s,r);const a=Kn(e.infoSyncTree_,s,r);Ls(e.eventQueue_,s,a)}function Ys(e){return e.nextWriteId_++}function Qs(e,t,n){let s;s=".info"===fe(t._path)?Yn(e.infoSyncTree_,t,n):Yn(e.serverSyncTree_,t,n),Ms(e.eventQueue_,t._path,s)}function $s(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Us)}function Gs(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];N(t,...s)}function Js(e,t,n){return Gn(e.serverSyncTree_,t,n)||st.EMPTY_NODE}function Zs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||sr(e,t),xs(t)){const n=tr(e,t);(0,a.vA)(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const s=n.map((e=>e.currentWriteId)),r=Js(e,t,s);let i=r;const o=r.hash();for(let d=0;d<n.length;d++){const e=n[d];(0,a.vA)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const s=Ne(t,e.path);i=i.updateChild(s,e.currentOutputSnapshotRaw)}const l=i.val(!0),c=t;e.server_.put(c.toString(),l,(s=>{Gs(e,"transaction put response",{path:c.toString(),status:s});let r=[];if("ok"===s){const s=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(Hn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&s.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();sr(e,gs(e.transactionQueueTree_,t)),Zs(e,e.transactionQueueTree_),Ls(e.eventQueue_,t,r);for(let e=0;e<s.length;e++)z(s[e])}else{if("datastale"===s)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{S("transaction at "+c.toString()+" failed: "+s);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=s}Xs(e,t)}}),o)}(e,js(t),n)}else vs(t)&&bs(t,(t=>{Zs(e,t)}))}function Xs(e,t){const n=er(e,t),s=js(n);return function(e,t,n){if(0===t.length)return;const s=[];let r=[];const i=t.filter((e=>0===e.status)),o=i.map((e=>e.currentWriteId));for(let c=0;c<t.length;c++){const i=t[c],d=Ne(n,i.path);let u,h=!1;if((0,a.vA)(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===i.status)h=!0,u=i.abortReason,r=r.concat(Hn(e.serverSyncTree_,i.currentWriteId,!0));else if(0===i.status)if(i.retryCount>=25)h=!0,u="maxretry",r=r.concat(Hn(e.serverSyncTree_,i.currentWriteId,!0));else{const n=Js(e,i.path,o);i.currentInputSnapshot=n;const s=t[c].update(n.val());if(void 0!==s){Ts("transaction failed: Data returned ",s,i.path);let t=at(s);"object"===typeof s&&null!=s&&(0,a.gR)(s,".priority")||(t=t.updatePriority(n.getPriority()));const l=i.currentWriteId,c=Bs(e),d=ms(t,n,c);i.currentOutputSnapshotRaw=t,i.currentOutputSnapshotResolved=d,i.currentWriteId=Ys(e),o.splice(o.indexOf(l),1),r=r.concat(Vn(e.serverSyncTree_,i.path,d,i.currentWriteId,i.applyLocally)),r=r.concat(Hn(e.serverSyncTree_,l,!0))}else h=!0,u="nodata",r=r.concat(Hn(e.serverSyncTree_,i.currentWriteId,!0))}Ls(e.eventQueue_,n,r),r=[],h&&(t[c].status=2,l=t[c].unwatcher,setTimeout(l,Math.floor(0)),t[c].onComplete&&("nodata"===u?s.push((()=>t[c].onComplete(null,!1,t[c].currentInputSnapshot))):s.push((()=>t[c].onComplete(new Error(u),!1,null)))))}var l;sr(e,e.transactionQueueTree_);for(let a=0;a<s.length;a++)z(s[a]);Zs(e,e.transactionQueueTree_)}(e,tr(e,n),s),s}function er(e,t){let n,s=e.transactionQueueTree_;for(n=fe(t);null!==n&&void 0===xs(s);)s=gs(s,n),n=fe(t=xe(t));return s}function tr(e,t){const n=[];return nr(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function nr(e,t,n){const s=xs(t);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);bs(t,(t=>{nr(e,t,n)}))}function sr(e,t){const n=xs(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,ys(t,n.length>0?n:void 0)}bs(t,(t=>{sr(e,t)}))}function rr(e,t){const n=js(er(e,t)),s=gs(e.transactionQueueTree_,t);return function(e,t,n){let s=n?e:e.parent;for(;null!==s;){if(t(s))return!0;s=s.parent}}(s,(t=>{ar(e,t)})),ar(e,s),ws(s,(t=>{ar(e,t)})),n}function ar(e,t){const n=xs(t);if(n){const s=[];let r=[],i=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,a.vA)(i===t-1,"All SENT items should be at beginning of queue."),i=t,n[t].status=3,n[t].abortReason="set"):((0,a.vA)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(Hn(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&s.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===i?ys(t,void 0):n.length=i+1,Ls(e.eventQueue_,js(t),r);for(let e=0;e<s.length;e++)z(s[e])}}const ir=function(e,t){const n=or(e),s=n.namespace;"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),s&&"undefined"!==s||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new G(n.host,n.secure,s,r,t,"",s!==n.subdomain),path:new me(n.pathString)}},or=function(e){let t="",n="",s="",r="",a="",i=!0,o="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let d=e.indexOf("/");-1===d&&(d=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(d,u)),d<u&&(r=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(s){}t+="/"+e}return t}(e.substring(d,u)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const s=n.split("=");2===s.length?t[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):S("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,u)));c=t.indexOf(":"),c>=0?(i="https"===o||"wss"===o,l=parseInt(t.substring(c+1),10)):c=t.length;const m=t.slice(0,c);if("localhost"===m.toLowerCase())n="localhost";else if(m.split(".").length<=2)n=m;else{const e=t.indexOf(".");s=t.substring(0,e).toLowerCase(),n=t.substring(e+1),a=s}"ns"in h&&(a=h.ns)}return{host:t,port:l,domain:n,subdomain:s,secure:i,scheme:o,pathString:r,namespace:a}},lr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class cr{constructor(e,t,n,s){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=s}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,a.As)(this.snapshot.exportVal())}}class dr{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ur{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,a.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class hr{constructor(e,t,n,s){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=s}get key(){return je(this._path)?null:ye(this._path)}get ref(){return new mr(this._repo,this._path)}get _queryIdentifier(){const e=xt(this._queryParams),t=R(e);return"{}"===t?"default":t}get _queryObject(){return xt(this._queryParams)}isEqual(e){if(!((e=(0,a.Ku)(e))instanceof hr))return!1;const t=this._repo===e._repo,n=ke(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&n&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class mr extends hr{constructor(e,t){super(e,t,new ft,!1)}get parent(){const e=be(this._path);return null===e?null:new mr(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class pr{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new me(e),n=gr(this.ref,e);return new pr(this._node.getChild(t),n,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new pr(n,gr(this.ref,t),$e))))}hasChild(e){const t=new me(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function fr(e,t){return(e=(0,a.Ku)(e))._checkNotDeleted("ref"),void 0!==t?gr(e._root,t):e._root}function gr(e,t){return null===fe((e=(0,a.Ku)(e))._path)?As("child","path",t,!1):Es("child","path",t,!1),new mr(e._repo,we(e._path,t))}class xr{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new cr("value",this,new pr(e.snapshotNode,new mr(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new dr(this,e,t):null}matches(e){return e instanceof xr&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class yr{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new dr(this,e,t):null}createEvent(e,t){(0,a.vA)(null!=e.childName,"Child events should have a childName.");const n=gr(new mr(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new cr(e.type,this,new pr(e.snapshotNode,n,s),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof yr&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function vr(e,t,n,s,r){let a;if("object"===typeof s&&(a=void 0,r=s),"function"===typeof s&&(a=s),r&&r.onlyOnce){const t=n,s=(n,s)=>{Qs(e._repo,e,o),t(n,s)};s.userCallback=n.userCallback,s.context=n.context,n=s}const i=new ur(n,a||void 0),o="value"===t?new xr(i):new yr(t,i);return function(e,t,n){let s;s=".info"===fe(t._path)?$n(e.infoSyncTree_,t,n):$n(e.serverSyncTree_,t,n),Ms(e.eventQueue_,t._path,s)}(e._repo,e,o),()=>Qs(e._repo,e,o)}function br(e,t,n,s){return vr(e,"value",t,n,s)}function wr(e,t,n){let s=null;const r=n?new ur(n):null;"value"===t?s=new xr(r):t&&(s=new yr(t,r)),Qs(e._repo,e,s)}!function(e){(0,a.vA)(!Tn,"__referenceConstructor has already been defined"),Tn=e}(mr),function(e){(0,a.vA)(!En,"__referenceConstructor has already been defined"),En=e}(mr);const jr={};let Nr=!1;function kr(e,t,n,s,r){let a=s||e.options.databaseURL;void 0===a&&(e.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),N("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let i,o,l=ir(a,r),c=l.repoInfo;"undefined"!==typeof process&&(o={NODE_ENV:"production",PUBLIC_URL:"/hamptownControlPanel",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),o?(i=!0,a="http://".concat(o,"?ns=").concat(c.namespace),l=ir(a,r),c=l.repoInfo):i=!l.repoInfo.secure;const d=r&&i?new V(V.OWNER):new B(e.name,e.options,t);Ds("Invalid Firebase Database URL",l),je(l.path)||C("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(e,t,n,s){let r=jr[t.name];r||(r={},jr[t.name]=r);let a=r[e.toURLString()];a&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new zs(e,Nr,n,s),r[e.toURLString()]=a,a}(c,e,d,new W(e,n));return new _r(u,e)}class _r{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(qs(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mr(this._repo,pe())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=jr[t];n&&n[e.key]===e||C("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),$s(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&C("Cannot call "+e+" on a deleted database.")}}function Cr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Sx)(),t=arguments.length>1?arguments[1]:void 0;const n=(0,s.j6)(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(0,a.yU)("database");e&&function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=(0,a.Ku)(e),e._checkNotDeleted("useEmulator");const r="".concat(t,":").concat(n),i=e._repoInternal;if(e._instanceStarted){if(r===e._repoInternal.repoInfo_.host&&(0,a.bD)(s,i.repoInfo_.emulatorOptions))return;C("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&C('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new V(V.OWNER);else if(s.mockUserToken){const t="string"===typeof s.mockUserToken?s.mockUserToken:(0,a.Fy)(s.mockUserToken,e.app.options.projectId);o=new V(t)}(0,a.zJ)(t)&&((0,a.gE)(t),(0,a.P1)("Database",!0));!function(e,t,n,s){const r=t.lastIndexOf(":"),i=t.substring(0,r),o=(0,a.zJ)(i);e.repoInfo_=new G(t,o,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(e.authTokenProvider_=s)}(i,r,s,o)}(n,...e)}return n}Ae.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ae.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Sr;d(s.MF),(0,s.om)(new r.uA("database",((e,t)=>{let{instanceIdentifier:n}=t;return kr(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(o,l,Sr),(0,s.KO)(o,l,"esm2017")},581:(e,t,n)=>{var s=n(635),r=Object.prototype,a=r.hasOwnProperty,i=r.toString,o=s?s.toStringTag:void 0;e.exports=function(e){var t=a.call(e,o),n=e[o];try{e[o]=void 0;var s=!0}catch(l){}var r=i.call(e);return s&&(t?e[o]=n:delete e[o]),r}},588:(e,t,n)=>{var s=n(914),r=n(567),a=n(184),i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var n=o.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):i.test(e)?NaN:+e}},607:(e,t,n)=>{"use strict";n.d(t,{DQ:()=>l,Nd:()=>s,Sh:()=>o,Ur:()=>a,_M:()=>i,qw:()=>r});const s={apiKey:"AIzaSyBBWLn8mFblzOqtbfaGS52aDhFWixSEn0Y",authDomain:"hamptown-panel.firebaseapp.com",databaseURL:"https://hamptown-panel-default-rtdb.firebaseio.com",projectId:"hamptown-panel",storageBucket:"hamptown-panel.firebasestorage.app",messagingSenderId:"937251959184",appId:"1:937251959184:web:b1afb3ed1eecd52fdcc315",measurementId:"G-50NK2PWM7E"},r="6969",a=["\ud83d\ude2b","\ud83d\ude14","\ud83d\ude10","\ud83d\ude0a","\ud83e\udd29"],i=["Terrible","Poor","Okay","Good","Excellent"],o={high:"border-red-400",medium:"border-yellow-400",low:"border-green-400"},l=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500"]},624:(e,t,n)=>{"use strict";n.d(t,{$b:()=>r,Vy:()=>c});const s=[];var r;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(r={}));const a={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},i=r.INFO,o={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),s=o[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];console[s]("[".concat(n,"]  ").concat(e.name,":"),...a)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=l,this._userLogHandler=null,s.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},635:(e,t,n)=>{var s=n(759).Symbol;e.exports=s},654:(e,t,n)=>{"use strict";var s=n(950),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var s,a={},c=null,d=null;for(s in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,s)&&!l.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:r,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},658:(e,t,n)=>{var s="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=s},759:(e,t,n)=>{var s=n(658),r="object"==typeof self&&self&&self.Object===Object&&self,a=s||r||Function("return this")();e.exports=a},761:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var s=n-1>>>1,r=e[s];if(!(0<a(r,t)))break e;e[s]=t,e[n]=r,n=s}}function s(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var s=0,r=e.length,i=r>>>1;s<i;){var o=2*(s+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<r&&0>a(d,l)?(e[s]=d,e[c]=n,s=c):(e[s]=l,e[o]=n,s=o);else{if(!(c<r&&0>a(d,n)))break e;e[s]=d,e[c]=n,s=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=s(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=s(d)}}function w(e){if(g=!1,b(e),!f)if(null!==s(c))f=!0,P(j);else{var t=s(d);null!==t&&R(w,t.startTime-e)}}function j(e,n){f=!1,g&&(g=!1,y(C),C=-1),p=!0;var a=m;try{for(b(n),h=s(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===s(c)&&r(c),b(n)}else r(c);h=s(c)}if(null!==h)var l=!0;else{var u=s(d);null!==u&&R(w,u.startTime-n),l=!1}return l}finally{h=null,m=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,_=null,C=-1,S=5,I=-1;function T(){return!(t.unstable_now()-I<S)}function E(){if(null!==_){var e=t.unstable_now();I=e;var n=!0;try{n=_(!0,e)}finally{n?N():(k=!1,_=null)}}else k=!1}if("function"===typeof v)N=function(){v(E)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=E,N=function(){D.postMessage(null)}}else N=function(){x(E,0)};function P(e){_=e,k||(k=!0,N())}function R(e,n){C=x((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,P(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,r,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>i?(e.sortIndex=a,n(d,e),null===s(c)&&e===s(d)&&(g?(y(C),C=-1):g=!0,R(w,a-i))):(e.sortIndex=o,n(c,e),f||p||(f=!0,P(j))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},798:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},815:(e,t,n)=>{"use strict";n.d(t,{Wp:()=>s.Wp});var s=n(913);(0,s.KO)("firebase","11.9.1","app")},867:(e,t,n)=>{"use strict";n.d(t,{eX:()=>i,po:()=>r,zQ:()=>a});var s=n(607);const r=e=>"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),a=e=>s.DQ[e-1]||"bg-gray-500",i=e=>s.Sh[e]},913:(e,t,n)=>{"use strict";n.d(t,{MF:()=>ue,j6:()=>ie,xZ:()=>oe,om:()=>ae,Sx:()=>me,Wp:()=>he,KO:()=>pe});var s=n(253),r=n(624),a=n(170),i=n(51);let o,l;const c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,m=new WeakMap;let p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return x(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.apply(y(this),n),x(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return x(e.apply(y(this),n))}:function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];const a=e.call(y(this),t,...s);return u.set(a,t.sort?t.sort():[t]),x(a)}}function g(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(d.has(e))return;const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),s()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)}));d.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,p):e);var t}function x(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(x(e.result)),s()},a=()=>{n(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&c.set(t,e)})).catch((()=>{})),m.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),m.set(t,e)),t}const y=e=>m.get(e);const v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function j(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,r=b.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!r&&!v.includes(n))return;const a=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return s&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),r&&t.done]))[0]};return w.set(t,a),a}p=(e=>(0,i.A)((0,i.A)({},e),{},{get:(t,n,s)=>j(t,n)||e.get(t,n,s),has:(t,n)=>!!j(t,n)||e.has(t,n)}))(p);class N{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const k="@firebase/app",_="0.13.1",C=new r.Vy("@firebase/app"),S="@firebase/app-compat",I="@firebase/analytics-compat",T="@firebase/analytics",E="@firebase/app-check-compat",A="@firebase/app-check",D="@firebase/auth",P="@firebase/auth-compat",R="@firebase/database",M="@firebase/data-connect",L="@firebase/database-compat",O="@firebase/functions",F="@firebase/functions-compat",U="@firebase/installations",z="@firebase/installations-compat",q="@firebase/messaging",W="@firebase/messaging-compat",B="@firebase/performance",V="@firebase/performance-compat",H="@firebase/remote-config",K="@firebase/remote-config-compat",Y="@firebase/storage",Q="@firebase/storage-compat",$="@firebase/firestore",G="@firebase/ai",J="@firebase/firestore-compat",Z="firebase",X="[DEFAULT]",ee={[k]:"fire-core",[S]:"fire-core-compat",[T]:"fire-analytics",[I]:"fire-analytics-compat",[A]:"fire-app-check",[E]:"fire-app-check-compat",[D]:"fire-auth",[P]:"fire-auth-compat",[R]:"fire-rtdb",[M]:"fire-data-connect",[L]:"fire-rtdb-compat",[O]:"fire-fn",[F]:"fire-fn-compat",[U]:"fire-iid",[z]:"fire-iid-compat",[q]:"fire-fcm",[W]:"fire-fcm-compat",[B]:"fire-perf",[V]:"fire-perf-compat",[H]:"fire-rc",[K]:"fire-rc-compat",[Y]:"fire-gcs",[Q]:"fire-gcs-compat",[$]:"fire-fst",[J]:"fire-fst-compat",[G]:"fire-vertex","fire-js":"fire-js",[Z]:"fire-js-all"},te=new Map,ne=new Map,se=new Map;function re(e,t){try{e.container.addComponent(t)}catch(n){C.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ae(e){const t=e.name;if(se.has(t))return C.debug("There were multiple attempts to register component ".concat(t,".")),!1;se.set(t,e);for(const n of te.values())re(n,e);for(const n of ne.values())re(n,e);return!0}function ie(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return null!==e&&void 0!==e&&void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new a.FA("app","Firebase",le);class de{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const ue="11.9.0";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:X,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw ce.create("bad-app-name",{appName:String(i)});if(n||(n=(0,a.T9)()),!n)throw ce.create("no-options");const o=te.get(i);if(o){if((0,a.bD)(n,o.options)&&(0,a.bD)(r,o.config))return o;throw ce.create("duplicate-app",{appName:i})}const l=new s.h1(i);for(const s of se.values())l.addComponent(s);const c=new de(n,r,l);return te.set(i,c),c}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X;const t=te.get(e);if(!t&&e===X&&(0,a.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function pe(e,t,n){var r;let a=null!==(r=ee[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));const i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void C.warn(e.join(" "))}ae(new s.uA("".concat(a,"-version"),(()=>({library:a,version:t})),"VERSION"))}const fe="firebase-heartbeat-store";let ge=null;function xe(){return ge||(ge=function(e,t){let{blocked:n,upgrade:s,blocking:r,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=x(i);return s&&i.addEventListener("upgradeneeded",(e=>{s(x(i.result),e.oldVersion,e.newVersion,x(i.transaction),e)})),n&&i.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(fe)}catch(n){console.warn(n)}}}).catch((e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})}))),ge}async function ye(e,t){try{const n=(await xe()).transaction(fe,"readwrite"),s=n.objectStore(fe);await s.put(t,ve(e)),await n.done}catch(n){if(n instanceof a.g)C.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});C.warn(e.message)}}}function ve(e){return"".concat(e.name,"!").concat(e.options.appId)}class be{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new je(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=we();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some((e=>e.date===s)))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let s=1;s<e.length;s++)e[s].date<n&&(n=e[s].date,t=s);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){C.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:s}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let s=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Ne(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Ne(n)>t){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),r=(0,a.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return C.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class je{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await xe()).transaction(fe),n=await t.objectStore(fe).get(ve(e));return await t.done,n}catch(t){if(t instanceof a.g)C.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});C.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ne(e){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ke;ke="",ae(new s.uA("platform-logger",(e=>new N(e)),"PRIVATE")),ae(new s.uA("heartbeat",(e=>new be(e)),"PRIVATE")),pe(k,_,ke),pe(k,_,"esm2017"),pe("fire-js","")},914:(e,t,n)=>{var s=n(798),r=/^\s+/;e.exports=function(e){return e?e.slice(0,s(e)+1).replace(r,""):e}},950:(e,t,n)=>{"use strict";e.exports=n(49)}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(950),t=n(352),s=n(51);function r(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;n[s]=e[s]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const i=["color","size","strokeWidth","absoluteStrokeWidth","className","children"],o=(t,n)=>{const o=(0,e.forwardRef)(((o,l)=>{let{color:c="currentColor",size:d=24,strokeWidth:u=2,absoluteStrokeWidth:h,className:m="",children:p}=o,f=r(o,i);return(0,e.createElement)("svg",(0,s.A)((0,s.A)({ref:l},a),{},{width:d,height:d,stroke:c,strokeWidth:h?24*Number(u)/Number(d):u,className:["lucide","lucide-".concat((g=t,g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim())),m].join(" ")},f),[...n.map((t=>{let[n,s]=t;return(0,e.createElement)(n,s)})),...Array.isArray(p)?p:[p]]);var g}));return o.displayName="".concat(t),o},l=o("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=o("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),d=o("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),u=o("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),h=o("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),m=o("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),p=o("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),f=o("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]),g=o("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),x=o("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),y=o("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),v=o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),b=o("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var w=n(607),j=n(867);var N=n(414);const k=e=>{let{currentUser:t,employees:n,userMood:r,setUserMood:a,setEmployees:i,setDailyData:o}=e;const l=(e=>(e.reduce(((e,t)=>e+t.mood),0)/e.length).toFixed(1))(n),c=((e,t)=>{const n=new Date,s=(0,j.po)(n),r=t.find((t=>t.id===e));return!r||r.lastMoodDate!==s})(t.id,n),d=((e,t)=>{const n=t.find((t=>t.id===e));if(!n||!n.lastMoodDate)return"";const s=new Date,r=(0,j.po)(s);return n.lastMoodDate===r?"You can update your mood again tomorrow!":""})(t.id,n),u=e=>{const r=((e,t,n,r,a)=>{const i=new Date,o=(0,j.po)(i),l=n.find((e=>e.id===t));if(l&&l.lastMoodDate===o)return alert("You have already updated your mood today! Come back tomorrow \ud83d\ude0a"),!1;r((n=>n.map((n=>n.id===t?(0,s.A)((0,s.A)({},n),{},{mood:e,lastUpdated:"Just now",lastMoodDate:o}):n))));const c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"});return a((n=>{const r=n[o]||{completedTasks:[],employeeMoods:[],totalTasks:22,completionRate:0},a=Array.isArray(r.employeeMoods)?r.employeeMoods:[],i={employeeId:t,mood:e,updatedAt:c};return(0,s.A)((0,s.A)({},n),{},{[o]:(0,s.A)((0,s.A)({},r),{},{employeeMoods:[...a.filter((e=>e.employeeId!==t)),i]})})})),!0})(e,t.id,n,i,o);r&&a(e)};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,N.jsxs)("div",{className:"text-center mb-6",children:[(0,N.jsx)("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:l}),(0,N.jsx)("div",{className:"text-lg text-gray-600 mb-4",children:"Team Average Mood"}),(0,N.jsx)("div",{className:"flex justify-center space-x-2",children:[1,2,3,4,5].map((e=>(0,N.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e<=Math.round(Number(l))?"bg-blue-500":"bg-gray-200")},e)))})]})}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:"How are you feeling today?"}),c?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4,5].map((e=>(0,N.jsxs)("button",{onClick:()=>u(e),className:"flex flex-col items-center p-3 rounded-xl transition-all hover:scale-105 ".concat(r===e?"bg-blue-100 scale-110":"hover:bg-gray-50"),children:[(0,N.jsx)("div",{className:"text-2xl mb-1",children:w.Ur[e-1]}),(0,N.jsx)("div",{className:"text-xs text-gray-600",children:w._M[e-1]})]},e)))}),(0,N.jsx)("div",{className:"text-center text-sm text-gray-500",children:"Select how you're feeling today"})]}):(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)("div",{className:"text-6xl mb-4",children:w.Ur[r-1]}),(0,N.jsxs)("div",{className:"text-lg font-medium text-gray-700 mb-2",children:["Today's Mood: ",w._M[r-1]]}),(0,N.jsx)("div",{className:"text-sm text-gray-500 mb-4",children:d}),(0,N.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,N.jsx)("div",{className:"text-sm text-blue-700",children:"\u2728 You've already shared your mood today! Your well-being matters to us."})})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)(b,{className:"w-5 h-5 mr-2"}),"Team Mood"]}),(0,N.jsx)("div",{className:"space-y-3",children:n.map((e=>(0,N.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat((0,j.zQ)(e.mood))}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:[e.lastUpdated,e.lastMoodDate===(0,j.po)(new Date)&&(0,N.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs",children:"Today"})]})]})]}),(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),(0,N.jsxs)("span",{className:"text-sm text-gray-600",children:[e.mood,"/5"]})]})]},e.id)))})]})]})},_=o("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),C=new Map,S=new Map,I=e=>{const t=C.get(e);t&&(clearTimeout(t),C.delete(e))},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const n=S.get(e)||0,s=Date.now();return s-n<t?(console.warn("\u26a0\ufe0f Task operation debounced for task ".concat(e," - too rapid")),!1):(S.set(e,s),!0)},E=(e,t,n,r,a,i)=>{const o=new Date,l=(0,j.po)(o),c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),d={taskId:e,employeeId:t,completedAt:c,taskName:n,date:l,pointsEarned:r};i((t=>{const n=t[l]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:a.length,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},r=[...(Array.isArray(n.completedTasks)?n.completedTasks:[]).filter((t=>t.taskId!==e)),d],i=Math.round(r.length/a.length*100),o=r.reduce(((e,t)=>e+(t.pointsEarned||0)),0);return(0,s.A)((0,s.A)({},t),{},{[l]:(0,s.A)((0,s.A)({},n),{},{completedTasks:r,totalTasks:a.length,completionRate:i,totalPointsEarned:o})})})),console.log("\ud83d\udcca Task completion logged (replacing any previous completion):",d)},A=(e,t,n)=>{n((n=>n.map((n=>n.id===e?(0,s.A)((0,s.A)({},n),{},{points:n.points+t}):n))))},D=(e,t,n)=>{const s=t[e];return n.find((e=>e.id===s))},P=(e,t,n,r,a,i,o,l,c,d,u,h)=>{if(!T(e,1e3))return;I(e);const m=r.has(e),p=new Set(r),f=i.find((t=>t.id===e)),g=D(e,a,o);if(f){if(m)console.log("\ud83d\udd04 Uncompleting task: ".concat(f.task)),p.delete(e),c((t=>{const n=(0,s.A)({},t);return delete n[e],n})),g&&(((e,t,n)=>{n((n=>n.map((n=>n.id===e?(0,s.A)((0,s.A)({},n),{},{points:Math.max(0,n.points-t)}):n))))})(g.id,f.points,u),console.log("\ud83d\udcc9 Deducted ".concat(f.points," points from ").concat(g.name," for uncompleting task"))),((e,t,n)=>{const r=new Date,a=(0,j.po)(r);n((n=>{const r=n[a]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:t.length,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},i=(Array.isArray(r.completedTasks)?r.completedTasks:[]).filter((t=>t.taskId!==e)),o=Math.round(i.length/t.length*100),l=i.reduce(((e,t)=>e+(t.pointsEarned||0)),0);return(0,s.A)((0,s.A)({},n),{},{[a]:(0,s.A)((0,s.A)({},r),{},{completedTasks:i,totalTasks:t.length,completionRate:o,totalPointsEarned:l})})})),console.log("\ud83d\uddd1\ufe0f Task completion removed from daily data:",e)})(e,i,d);else{console.log("\u2705 Completing task: ".concat(f.task));const r=t||(null===g||void 0===g?void 0:g.id)||n;t?c((n=>(0,s.A)((0,s.A)({},n),{},{[e]:t}))):g||c((t=>(0,s.A)((0,s.A)({},t),{},{[e]:n}))),p.add(e),A(r,f.points,u),E(e,r,f.task,f.points,i,d),console.log("\ud83d\udcc8 Awarded ".concat(f.points," points to employee ").concat(r," for completing task"))}if(l(p),h){console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save taskAssignments:",a),console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save completedTasks:",Array.from(p)),I(e);const t=setTimeout((()=>{console.log("\u23f0 Executing debounced save for task:",e),h(),C.delete(e)}),500);C.set(e,t)}}else console.error("Task not found:",e)},R=(e,t,n,r,a,i,o,l,c,d)=>{if(!T(e,800))return;const u=a.find((t=>t.id===e)),h=D(e,r,i),m=i.find((e=>e.id===t));if(u&&m)if(n.has(e)&&(null===h||void 0===h?void 0:h.id)!==t){if(console.log("\ud83d\udd04 Reassigning completed task from ".concat((null===h||void 0===h?void 0:h.name)||"unassigned"," to ").concat(m.name)),h?((e,t,n,r)=>{r((r=>r.map((r=>r.id===e?(0,s.A)((0,s.A)({},r),{},{points:Math.max(0,r.points-n)}):r.id===t?(0,s.A)((0,s.A)({},r),{},{points:r.points+n}):r)))),console.log("\ud83d\udcb0 Transferred ".concat(n," points from employee ").concat(e," to ").concat(t))})(h.id,t,u.points,c):A(t,u.points,c),o((n=>(0,s.A)((0,s.A)({},n),{},{[e]:t}))),E(e,t,u.task,u.points,a,l),d){console.log("\ud83d\udd25 Debounced save triggered by task reassignment"),I(e);const t=setTimeout((()=>{console.log("\u23f0 Executing debounced reassignment save for task:",e),d(),C.delete(e)}),600);C.set(e,t)}}else o((n=>(0,s.A)((0,s.A)({},n),{},{[e]:t})));else console.error("Task or new employee not found")},M=t=>{var n,r;let{currentUser:a,tasks:i,employees:o,completedTasks:l,taskAssignments:c,dailyData:d,setCompletedTasks:h,setTaskAssignments:p,setDailyData:f,setEmployees:g,saveToFirebase:x}=t;(0,e.useEffect)((()=>{console.log("\ud83d\udccb TaskManager - completedTasks updated:",{size:l.size,tasks:Array.from(l),timestamp:(new Date).toLocaleTimeString()})}),[l]);const y=(e,t)=>{l.has(e)?R(e,t,l,c,i,o,p,f,g,x):((e,t,n)=>{n((n=>(0,s.A)((0,s.A)({},n),{},{[e]:t})))})(e,t,p)},v=o.find((e=>e.id===a.id)),w=d[(0,j.po)(new Date)],k=(null===w||void 0===w||null===(n=w.completedTasks)||void 0===n||null===(r=n.filter((e=>e.employeeId===a.id)))||void 0===r?void 0:r.reduce(((e,t)=>e+(t.pointsEarned||0)),0))||0;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,N.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 text-center border border-green-200",children:[(0,N.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-1",children:l.size}),(0,N.jsx)("div",{className:"text-sm font-medium text-green-700",children:"Completed"})]}),(0,N.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4 text-center border border-orange-200",children:[(0,N.jsx)("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:i.length-l.size}),(0,N.jsx)("div",{className:"text-sm font-medium text-orange-700",children:"Pending"})]}),(0,N.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 text-center border border-purple-200",children:[(0,N.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:(null===v||void 0===v?void 0:v.points)||0}),(0,N.jsx)("div",{className:"text-sm font-medium text-purple-700",children:"Your Points"})]})]}),(0,N.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-4 mb-6 text-white",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-lg font-semibold",children:"Today's Points"}),(0,N.jsxs)("div",{className:"text-2xl font-bold",children:[k," pts earned"]})]}),(0,N.jsx)(_,{className:"w-8 h-8 opacity-80"})]})}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)(m,{className:"w-5 h-5 mr-2"}),"Cleaning Tasks"]}),(0,N.jsx)("div",{className:"space-y-4",children:i.map((e=>{const t=D(e.id,c,o),n=l.has(e.id);return(0,N.jsxs)("div",{className:"border rounded-lg p-4 ".concat((0,j.eX)(e.priority)," ").concat(n?"bg-green-50":"bg-white"),children:[(0,N.jsxs)("div",{className:"flex items-start justify-between",children:[(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsx)("div",{className:"font-medium ".concat(n?"line-through text-gray-500":"text-gray-800"),children:e.task}),(0,N.jsxs)("div",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-sm font-medium",children:[(0,N.jsx)(_,{className:"w-3 h-3 mr-1"}),e.points," pts"]})]}),(0,N.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["\ud83d\udccd ",e.location]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,N.jsxs)("div",{className:"text-xs px-2 py-1 rounded-full inline-block ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.priority," priority"]}),(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:["\u23f1\ufe0f ",e.estimatedTime]})]})]}),(0,N.jsx)("button",{onClick:()=>{return t=e.id,void P(t,n,a.id,l,c,i,o,h,p,f,g,x);var t,n},className:"ml-3 p-2 rounded-full ".concat(n?"bg-green-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"),children:(0,N.jsx)(u,{className:"w-4 h-4"})})]}),(0,N.jsxs)("div",{className:"mt-3",children:[t&&(0,N.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[(0,N.jsx)(b,{className:"w-4 h-4 mr-1"}),"Assigned to: ",(0,N.jsx)("span",{className:"font-medium ml-1",children:t.name}),n&&(0,N.jsxs)("span",{className:"ml-2 text-green-600 font-medium",children:["(+",e.points," pts earned!)"]})]}),!t&&(0,N.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:n?"Reassign to:":"Assign to:"}),(0,N.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map((s=>(0,N.jsxs)("button",{onClick:()=>y(e.id,s.id),className:"text-xs px-3 py-1 rounded-full transition-colors ".concat((null===t||void 0===t?void 0:t.id)===s.id?"bg-blue-500 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"),title:n&&(null===t||void 0===t?void 0:t.id)!==s.id?"Transfer ".concat(e.points," points from ").concat((null===t||void 0===t?void 0:t.name)||"unassigned"," to ").concat(s.name):"Assign task to ".concat(s.name),children:[s.name,(0,N.jsxs)("span",{className:"ml-1 text-purple-600 font-medium",children:["(",s.points,"pts)"]}),n&&(null===t||void 0===t?void 0:t.id)!==s.id&&(0,N.jsx)("span",{className:"ml-1",children:"\ud83d\udd04"})]},s.id)))}),n&&(0,N.jsxs)("div",{className:"mt-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["\ud83d\udca1 Tip: Click another employee's name to transfer the ",e.points," points to them"]})]})]},e.id)}))})]})]})},L=o("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),O=o("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),F=o("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),U=o("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),z=o("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),q=o("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),W=(e,t)=>e.points>=t.cost&&t.available,B=t=>{var n;let{currentUser:r,employees:a,storeItems:i,dailyData:o,setEmployees:l,setDailyData:c,saveToFirebase:d}=t;const[u,h]=(0,e.useState)("all"),[m,p]=(0,e.useState)(!1),f=a.find((e=>e.id===r.id)),g=((e,t)=>{const n=t.find((t=>t.id===e));return(null===n||void 0===n?void 0:n.points)||0})(r.id,a),x=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;const s=[],r=new Date;for(let a=0;a<n;a++){const n=new Date(r);n.setDate(n.getDate()-a);const i=t[(0,j.po)(n)];if(null!==i&&void 0!==i&&i.purchases){const t=i.purchases.filter((t=>t.employeeId===e));s.push(...t)}}return s.sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))}(r.id,o),y=(e=>[...e].sort(((e,t)=>t.points-e.points)).slice(0,10))(a),v=[{id:"all",name:"All Items",icon:"\ud83d\udecd\ufe0f"},{id:"food",name:"Food & Drinks",icon:"\ud83c\udf7d\ufe0f"},{id:"break",name:"Time Off",icon:"\u23f0"},{id:"reward",name:"Rewards",icon:"\ud83c\udf81"},{id:"social",name:"Social",icon:"\ud83d\udc65"}],w="all"===u?i:i.filter((e=>e.category===u)),k=e=>{if(!f)return;const t=((e,t,n,r,a)=>{const i=n.find((t=>t.id===e));if(!i)return alert("Employee with id ".concat(e," not found")),!1;if(!W(i,t))return alert("Insufficient points! You need ".concat(t.cost," points but only have ").concat(i.points,".")),!1;const o=new Date,l=(0,j.po)(o),c=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"});r((n=>n.map((n=>n.id===e?(0,s.A)((0,s.A)({},n),{},{points:n.points-t.cost}):n))));const d={id:Date.now(),employeeId:e,itemId:t.id,itemName:t.name,cost:t.cost,purchasedAt:c,date:l,status:"pending"};return a((e=>{const n=e[l]||{completedTasks:[],employeeMoods:[],purchases:[],totalTasks:22,completionRate:0,totalPointsEarned:0,totalPointsSpent:0},r=Array.isArray(n.purchases)?[...n.purchases,d]:[d],a=(n.totalPointsSpent||0)+t.cost;return(0,s.A)((0,s.A)({},e),{},{[l]:(0,s.A)((0,s.A)({},n),{},{purchases:r,totalPointsSpent:a})})})),console.log("\ud83d\uded2 Purchase logged:",d),!0})(r.id,e,a,l,c);t&&alert("\ud83c\udf89 Successfully purchased: ".concat(e.name,"! Check with your manager to redeem."))};e.useEffect((()=>{o&&Object.keys(o).length>0&&d()}),[o,d]);const C=e=>{switch(e){case"food":return(0,N.jsx)(L,{className:"w-4 h-4"});case"break":return(0,N.jsx)(O,{className:"w-4 h-4"});case"reward":return(0,N.jsx)(F,{className:"w-4 h-4"});case"social":return(0,N.jsx)(b,{className:"w-4 h-4"});default:return(0,N.jsx)(_,{className:"w-4 h-4"})}};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-sm p-6 text-white",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h2",{className:"text-2xl font-bold",children:"Your Points"}),(0,N.jsx)("div",{className:"text-4xl font-bold mt-2",children:g}),(0,N.jsx)("div",{className:"text-purple-100 text-sm",children:"Available to spend"})]}),(0,N.jsx)("div",{className:"text-6xl opacity-50",children:"\ud83d\udc8e"})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-purple-400",children:[(0,N.jsxs)("button",{onClick:()=>p(!m),className:"flex items-center bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors",children:[(0,N.jsx)(U,{className:"w-4 h-4 mr-2"}),"Purchase History"]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsx)("div",{className:"text-sm text-purple-100",children:"Your Rank"}),(0,N.jsxs)("div",{className:"font-bold",children:["#",y.findIndex((e=>e.id===r.id))+1||"Unranked"]})]})]})]}),m&&(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recent Purchases"}),x.length>0?(0,N.jsx)("div",{className:"space-y-3",children:x.slice(0,10).map((e=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"text-lg mr-3",children:"\ud83d\uded2"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.itemName}),(0,N.jsxs)("div",{className:"text-sm text-gray-500",children:[e.date," at ",e.purchasedAt]})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsxs)("div",{className:"font-bold text-purple-600",children:["-",e.cost," pts"]}),(0,N.jsx)("div",{className:"text-xs px-2 py-1 rounded-full ".concat("pending"===e.status?"bg-yellow-100 text-yellow-700":"approved"===e.status?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:e.status})]})]},e.id)))}):(0,N.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No purchases yet. Start earning points by completing tasks!"})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Store Categories"}),(0,N.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map((e=>(0,N.jsxs)("button",{onClick:()=>h(e.id),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(u===e.id?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,N.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)(z,{className:"w-5 h-5 mr-2"}),"all"===u?"All Items":null===(n=v.find((e=>e.id===u)))||void 0===n?void 0:n.name]}),(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((e=>{const t=!!f&&W(f,e);return(0,N.jsxs)("div",{className:"border rounded-lg p-4 transition-all ".concat(t?"border-green-200 hover:border-green-300 hover:shadow-md":"border-gray-200 opacity-60"),children:[(0,N.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,N.jsx)("div",{className:"text-3xl",children:e.icon}),(0,N.jsx)("div",{className:"flex items-center",children:C(e.category)})]}),(0,N.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:e.name}),(0,N.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"text-lg font-bold text-purple-600",children:[e.cost," pts"]}),(0,N.jsx)("button",{onClick:()=>k(e),disabled:!t||!e.available,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(t&&e.available?"bg-purple-500 text-white hover:bg-purple-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:e.available?t?"Purchase":"Need more points":"Unavailable"})]}),!t&&e.available&&(0,N.jsxs)("div",{className:"mt-2 text-xs text-red-500",children:["Need ",e.cost-g," more points"]})]},e.id)}))}),0===w.length&&(0,N.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No items available in this category"})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)(q,{className:"w-5 h-5 mr-2"}),"Points Leaderboard"]}),(0,N.jsx)("div",{className:"space-y-3",children:y.map(((e,t)=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg ".concat(e.id===r.id?"bg-purple-50 border border-purple-200":"bg-gray-50"),children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-3 ".concat(0===t?"bg-yellow-400 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 text-gray-600"),children:t+1}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"font-medium text-gray-800",children:[e.name,e.id===r.id&&(0,N.jsx)("span",{className:"ml-2 text-purple-600 text-sm",children:"(You)"})]}),(0,N.jsx)("div",{className:"text-sm text-gray-500",children:e.role})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsxs)("div",{className:"font-bold text-purple-600",children:[e.points," pts"]}),0===t&&(0,N.jsx)("div",{className:"text-xs text-yellow-600",children:"\ud83d\udc51 Top Performer"})]})]},e.id)))})]})]})};var V=n(526);const H=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),K=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Y=o("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Q=o("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),$=o("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),G=o("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);class J{constructor(e){this.clock={},e&&(this.clock=(0,s.A)({},e))}increment(e){this.clock[e]||(this.clock[e]=0),this.clock[e]++}update(e){for(const[t,n]of Object.entries(e))(!this.clock[t]||this.clock[t]<n)&&(this.clock[t]=n)}compare(e){let t=!1,n=!1,s=!0;const r=new Set([...Object.keys(this.clock),...Object.keys(e)]);for(const o of r){const r=this.clock[o]||0,a=e[o]||0;r<a?(t=!0,s=!1):r>a&&(n=!0,s=!1)}if(s)return"concurrent";if(t&&!n)return"before";if(!t&&n)return"after";const a=Object.values(this.clock).reduce(((e,t)=>e+t),0),i=Object.values(e).reduce(((e,t)=>e+t),0);return a>i?"after":a<i?"before":"concurrent"}merge(e){const t=(0,s.A)({},this.clock);for(const[n,s]of Object.entries(e))t[n]=Math.max(t[n]||0,s);return t}getClock(){return(0,s.A)({},this.clock)}}class Z{constructor(e,t){this.deviceId=void 0,this.vectorClock=void 0,this.deviceId=e,this.vectorClock=new J(t)}createOperation(e,t,n){this.vectorClock.increment(this.deviceId);return{id:"".concat(this.deviceId,"-").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8)),type:e,payload:t,timestamp:Date.now(),deviceId:this.deviceId,vectorClock:this.vectorClock.getClock(),targetField:n,version:this.vectorClock.getClock()[this.deviceId]||0}}applyOperation(e,t){if("tasks"===e.targetField)switch(e.type){case"ADD_TASK":return(0,s.A)((0,s.A)({},t),{},{tasks:[...t.tasks,e.payload]});case"COMPLETE_TASK":return(0,s.A)((0,s.A)({},t),{},{tasks:t.tasks.map((t=>t.id===e.payload.id?(0,s.A)((0,s.A)({},t),{},{completed:!0}):t))});case"DELETE_ITEM":return(0,s.A)((0,s.A)({},t),{},{tasks:t.tasks.filter((t=>t.id!==e.payload.id))});default:return t}if("employees"===e.targetField)switch(e.type){case"UPDATE_EMPLOYEE":return(0,s.A)((0,s.A)({},t),{},{employees:t.employees.map((t=>t.id===e.payload.id?(0,s.A)((0,s.A)({},t),e.payload):t))});case"DELETE_ITEM":return(0,s.A)((0,s.A)({},t),{},{employees:t.employees.filter((t=>t.id!==e.payload.id))});default:return t}return t}resolveConflicts(e){const t=new Map;for(const n of e){const e="".concat(n.targetField,":").concat(n.payload.id||n.id);if(t.has(e)){const s=t.get(e),r=new J(s.vectorClock).compare(n.vectorClock);("before"===r||"concurrent"===r&&n.timestamp>s.timestamp)&&t.set(e,n)}else t.set(e,n)}return Array.from(t.values())}rollbackOperations(e,t){let n=(0,s.A)({},t);for(const r of e)if("tasks"===r.targetField)switch(r.type){case"ADD_TASK":n.tasks=n.tasks.filter((e=>e.id!==r.payload.id));break;case"COMPLETE_TASK":n.tasks=n.tasks.map((e=>e.id===r.payload.id?(0,s.A)((0,s.A)({},e),{},{completed:!1}):e));break;case"DELETE_ITEM":n.tasks=[...n.tasks,r.payload]}return n}}const X=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})()),ee=new class{constructor(){this.queue=[],this.db=null,this.dbName="SyncOfflineQueue",this.storeName="operations",this._lastLogTime=null,this.initDB()}initDB(){const e=indexedDB.open(this.dbName,1);e.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:"id"})},e.onsuccess=()=>{this.db=e.result,this.loadQueueFromDB()},e.onerror=()=>{console.error("OfflineQueue: Failed to open IndexedDB")}}loadQueueFromDB(){if(!this.db)return;const e=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).getAll();e.onsuccess=()=>{this.queue=e.result||[]}}enqueue(e){this.queue.push(e),this.saveOperationToDB(e)}saveOperationToDB(e){if(!this.db)return;this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).put(e)}saveQueueToDB(){if(!this.db)return;const e=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName);e.clear().onsuccess=()=>{for(const t of this.queue)e.put(t)}}compactOperationLog(){const e=new Map;for(const t of this.queue){const n="".concat(t.targetField,":").concat(t.payload.id||t.id);e.set(n,t)}this.queue=Array.from(e.values()),this.saveQueueToDB()}cleanExpiredOperations(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6048e5;const t=Date.now();this.queue=this.queue.filter((n=>t-n.timestamp<e)),this.saveQueueToDB()}async processQueue(e){this.compactOperationLog(),this.cleanExpiredOperations();const t=this.queue.filter((e=>"COMPLETE_TASK"===e.type)),n=this.queue.filter((e=>"ADD_TASK"===e.type||"UPDATE_EMPLOYEE"===e.type)),s=this.queue.filter((e=>"DELETE_ITEM"===e.type));for(const r of t)await e(r),this.removeOperationFromDB(r.id);n.length&&await Promise.all(n.map((async t=>{await e(t),this.removeOperationFromDB(t.id)}))),s.forEach(((t,n)=>{setTimeout((async()=>{await e(t),this.removeOperationFromDB(t.id)}),1e3*n)})),this.loadQueueFromDB()}removeAppliedOperations(e){this.queue=this.queue.filter((t=>!e.includes(t.id))),this.saveQueueToDB()}removeOperationFromDB(e){if(!this.db)return;this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(e),this.queue=this.queue.filter((t=>t.id!==e))}prioritizeOperations(){return[...this.queue.filter((e=>"COMPLETE_TASK"===e.type)),...this.queue.filter((e=>"ADD_TASK"===e.type||"UPDATE_EMPLOYEE"===e.type)),...this.queue.filter((e=>"DELETE_ITEM"===e.type))]}resolveQueueConflicts(){}logThrottled(e){(!this._lastLogTime||Date.now()-this._lastLogTime>2e3)&&(console.log("[OfflineQueue]",e),this._lastLogTime=Date.now())}monitorPerformance(e,t){const n=performance.now();t();const s=performance.now()-n;s>100&&this.logThrottled("\u26a0\ufe0f ".concat(e," took ").concat(Math.round(s),"ms"))}};function te(e,t){return X.applyOperation(t,{tasks:e}).tasks}const ne=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());function se(e,t){return ne.applyOperation(t,{employees:e}).employees}new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());const re=new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());function ae(e,t){return re.applyOperation(t,{storeItems:e}).storeItems}new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());new Z((()=>{let e=localStorage.getItem("deviceId");return e||(e="dev-"+Math.random().toString(36).slice(2,10),localStorage.setItem("deviceId",e)),e})());const ie=(e,t,n,s,r,a)=>{if(e.trim()){const o={id:Math.max(...n.map((e=>e.id)),0)+1,name:e.trim(),mood:3,lastUpdated:"Just added",role:t,lastMoodDate:null,points:0},l=(i=o,ne.createOperation("UPDATE_EMPLOYEE",i,"employees"));s((e=>se(e,l))),r(""),a("Cleaner")}var i},oe=(e,t)=>{window.confirm("Are you sure you want to remove this employee?")&&t((t=>{const n=function(e,t){const n=e.find((e=>e.id===t));if(!n)throw new Error("Employee not found");return ne.createOperation("DELETE_ITEM",n,"employees")}(t,e);return se(t,n)}))},le=(e,t,n,r)=>{r((r=>{const a=function(e,t,n,r){const a=e.find((e=>e.id===t));if(!a)throw new Error("Employee not found");const i=(0,s.A)((0,s.A)({},a),{},{[n]:r});return ne.createOperation("UPDATE_EMPLOYEE",i,"employees")}(r,e,t,n);return se(r,a)}))},ce=(e,t,n,r)=>{r((r=>{const a=function(e,t,n,r){const a=e.find((e=>e.id===t));if(!a)throw new Error("Task not found");const i=(0,s.A)((0,s.A)({},a),{},{[n]:r});return X.createOperation("ADD_TASK",i,"tasks")}(r,e,t,n);return te(r,a)}))},de=(e,t)=>{window.confirm("Are you sure you want to remove this task?")&&t((t=>{const n=function(e,t){const n=e.find((e=>e.id===t));if(!n)throw new Error("Task not found");return X.createOperation("DELETE_ITEM",n,"tasks")}(t,e);return te(t,n)}))};var ue=n(491),he=n.n(ue);const me=t=>{let{employees:n,tasks:a,customRoles:i,storeItems:o,prepItems:l,setEmployees:c,setTasks:u,setCustomRoles:h,setStoreItems:f,setPrepItems:x,quickSave:y}=t;const[v,w]=(0,e.useState)(!1),[k,C]=(0,e.useState)(!1),[S,I]=(0,e.useState)(!1),[T,E]=(0,e.useState)(""),[A,D]=(0,e.useState)("Cleaner"),[P,R]=(0,e.useState)(""),[M,L]=(0,e.useState)(null),[F,U]=(0,e.useState)(null),[z,q]=(0,e.useState)(null),[W,B]=(0,e.useState)(null),[J,Z]=(0,e.useState)(null),[X,te]=(0,e.useState)(""),[ne,se]=(0,e.useState)(""),[ue,me]=(0,e.useState)(""),[pe,fe]=(0,e.useState)("food"),[ge,xe]=(0,e.useState)("\ud83c\udf81"),[ye,ve]=(0,e.useState)(""),[be,we]=(0,e.useState)("majoneesit"),[je,Ne]=(0,e.useState)(""),[ke,_e]=(0,e.useState)(""),[Ce,Se]=(0,e.useState)(!1),[Ie,Te]=(0,e.useState)({ingredients:"",instructions:""}),Ee=[{id:"majoneesit",name:"Majoneesit",icon:"\ud83e\udd44"},{id:"proteiinit",name:"Proteiinit",icon:"\ud83e\udd69"},{id:"kasvikset",name:"Kasvikset",icon:"\ud83e\udd57"},{id:"marinointi",name:"Marinointi & pikkel\xf6inti",icon:"\ud83e\udd52"},{id:"kastikkeet",name:"Kastikkeet",icon:"\ud83e\uddc2"},{id:"muut",name:"Muut",icon:"\ud83d\udd27"}],[Ae,De]=(0,e.useState)([]),Pe=()=>{((e,t,n,s)=>{e.trim()&&!t.includes(e.trim())&&(n((t=>[...t,e.trim()])),s(""))})(P,i,h,R)},Re=(e,t,n)=>{!function(e,t,n,r,a){const i=e.find((e=>e.id===t));if(!i)throw new Error("StoreItem not found");const o=(0,s.A)((0,s.A)({},i),{},{[n]:r}),l=re.createOperation("ADD_TASK",o,"storeItems");ee.enqueue(l),a((e=>ae(e,l)))}(o,e,t,n,f)},Me=e=>{!function(e,t,n){const s=e.find((e=>e.id===t));if(!s)throw new Error("StoreItem not found");const r=re.createOperation("DELETE_ITEM",s,"storeItems");ee.enqueue(r),n((e=>ae(e,r)))}(o,e,f)},Le=(e,t,n)=>{x((r=>r.map((r=>r.id===e?(0,s.A)((0,s.A)({},r),{},{[t]:n}):r))))},Oe=(e,t,n)=>{x((r=>r.map((r=>r.id===e?(0,s.A)((0,s.A)({},r),{},{recipe:r.recipe?(0,s.A)((0,s.A)({},r.recipe),{},{[t]:n}):{ingredients:"",instructions:"",[t]:n}}):r))))},Fe=(e,t,n)=>{const s=l.find((t=>t.id===e));if(null===s||void 0===s||!s.recipe)return;const r=document.getElementById("".concat(t,"-").concat(e));if(!r)return;const a=r.selectionStart,i=r.selectionEnd,o=s.recipe[t],c=o.substring(0,a),d=o.substring(a,i),u=o.substring(i);let h="";switch(n){case"bold":h=c+"**"+d+"**"+u;break;case"italic":h=c+"*"+d+"*"+u;break;case"bullet":h=c+"\n\u2022 "+u;break;case"number":h=c+"\n1. "+u;break;default:return}Oe(e,t,h)},[Ue,ze]=(0,e.useState)({}),qe=e.useCallback(he()(((e,t,n)=>{ce(e,t,n,u),ze((t=>{const{[e]:n}=t;return r(t,[e].map(V.A))}))}),800),[u]),We=(e,t,n)=>{ze((r=>(0,s.A)((0,s.A)({},r),{},{[e]:(0,s.A)((0,s.A)({},r[e]),{},{[t]:n})}))),qe(e,t,n)},Be=(e,t)=>{var n,s;return null!==(n=null===(s=Ue[e.id])||void 0===s?void 0:s[t])&&void 0!==n?n:e[t]},Ve=(e,t,n)=>{De((r=>r.map((r=>r.id===e?(0,s.A)((0,s.A)({},r),{},{[t]:n}):r))))};return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(v?"p-6":"p-2"),children:[(0,N.jsxs)("button",{onClick:()=>w(!v),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(v?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(d,{className:"mr-2 ".concat(v?"w-5 h-5":"w-4 h-4")}),"Role Management"]}),(0,N.jsx)("span",{className:"transition-transform ".concat(v?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),v&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Role"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("input",{type:"text",placeholder:"Role name",value:P,onChange:e=>R(e.target.value),onKeyPress:e=>"Enter"===e.key&&Pe(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,N.jsx)("button",{onClick:Pe,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center",children:(0,N.jsx)(H,{className:"w-4 h-4"})})]})]}),(0,N.jsx)("div",{className:"space-y-2",children:i.map((e=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,N.jsx)("span",{className:"font-medium text-gray-700",children:e}),(0,N.jsx)("button",{onClick:()=>((e,t,n)=>{const s=t.filter((t=>t.role===e));s.length>0?alert('Cannot remove role "'.concat(e,'" - ').concat(s.length," employee(s) are using it.")):window.confirm('Are you sure you want to remove the role "'.concat(e,'"?'))&&n((t=>t.filter((t=>t!==e))))})(e,n,h),className:"p-1 text-red-600 hover:text-red-800",title:"Remove role",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]},e)))})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(k?"p-6":"p-2"),children:[(0,N.jsxs)("button",{onClick:()=>C(!k),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(k?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(g,{className:"mr-2 ".concat(k?"w-5 h-5":"w-4 h-4")}),"Store Management"]}),(0,N.jsx)("span",{className:"transition-transform ".concat(k?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),k&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Store Item"}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),(0,N.jsx)("input",{type:"text",placeholder:"e.g., Free Coffee",value:X,onChange:e=>te(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost (Points)"}),(0,N.jsx)("input",{type:"number",min:"1",placeholder:"10",value:ue,onChange:e=>me(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,N.jsxs)("select",{value:pe,onChange:e=>fe(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,N.jsx)("option",{value:"food",children:"Food & Drinks"}),(0,N.jsx)("option",{value:"break",children:"Time Off"}),(0,N.jsx)("option",{value:"reward",children:"Rewards"}),(0,N.jsx)("option",{value:"social",children:"Social"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icon"}),(0,N.jsx)("input",{type:"text",placeholder:"\ud83c\udf81",value:ge,onChange:e=>xe(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,N.jsxs)("div",{className:"md:col-span-2",children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,N.jsx)("input",{type:"text",placeholder:"e.g., Get a free coffee from the kitchen",value:ne,onChange:e=>se(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,N.jsx)("div",{className:"md:col-span-2",children:(0,N.jsxs)("button",{onClick:()=>{if(X.trim()&&ne.trim()&&ue.trim()){const e={id:Math.max(...o.map((e=>e.id)),0)+1,name:X.trim(),description:ne.trim(),cost:parseInt(ue)||10,category:pe,icon:ge,available:!0};!function(e,t,n){const s=re.createOperation("ADD_TASK",n,"storeItems");ee.enqueue(s),t((e=>ae(e,s)))}(0,f,e),te(""),se(""),me(""),fe("food"),xe("\ud83c\udf81")}},className:"w-full bg-purple-500 text-white py-2 px-4 rounded-lg hover:bg-purple-600 flex items-center justify-center",children:[(0,N.jsx)(Y,{className:"w-4 h-4 mr-2"}),"Add Store Item"]})})]})]}),(0,N.jsxs)("div",{className:"space-y-3",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700",children:"Current Store Items"}),o.map((e=>(0,N.jsxs)("div",{className:"border rounded-lg p-4 bg-white",children:[(0,N.jsxs)("div",{className:"flex items-start justify-between",children:[(0,N.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Name"}),z===e.id?(0,N.jsx)("input",{type:"text",value:e.name,onChange:t=>Re(e.id,"name",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsxs)("div",{className:"font-medium text-gray-800 flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:e.icon}),e.name]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Cost"}),z===e.id?(0,N.jsx)("input",{type:"number",min:"1",value:e.cost,onChange:t=>Re(e.id,"cost",parseInt(t.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(_,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,N.jsxs)("span",{className:"font-medium text-purple-600",children:[e.cost," pts"]})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),z===e.id?(0,N.jsxs)("select",{value:e.category,onChange:t=>Re(e.id,"category",t.target.value),className:"w-full px-2 py-1 border rounded text-sm",children:[(0,N.jsx)("option",{value:"food",children:"Food & Drinks"}),(0,N.jsx)("option",{value:"break",children:"Time Off"}),(0,N.jsx)("option",{value:"reward",children:"Rewards"}),(0,N.jsx)("option",{value:"social",children:"Social"})]}):(0,N.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("food"===e.category?"bg-orange-100 text-orange-700":"break"===e.category?"bg-blue-100 text-blue-700":"reward"===e.category?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"),children:e.category})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),(0,N.jsx)("button",{onClick:()=>Re(e.id,"available",!e.available),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.available?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.available?"Available":"Unavailable"})]})]}),(0,N.jsxs)("div",{className:"flex gap-2 ml-4",children:[z===e.id?(0,N.jsx)("button",{onClick:()=>q(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,N.jsx)(Q,{className:"w-4 h-4"})}):(0,N.jsx)("button",{onClick:()=>q(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>Me(e.id),className:"p-1 text-red-600 hover:text-red-800",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})]}),(0,N.jsxs)("div",{className:"mt-3",children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Description"}),z===e.id?(0,N.jsx)("input",{type:"text",value:e.description,onChange:t=>Re(e.id,"description",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),z===e.id&&(0,N.jsxs)("div",{className:"mt-2",children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Icon"}),(0,N.jsx)("input",{type:"text",value:e.icon,onChange:t=>Re(e.id,"icon",t.target.value),className:"w-20 px-2 py-1 border rounded text-sm",placeholder:"\ud83c\udf81"})]})]},e.id))),0===o.length&&(0,N.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No store items yet. Add your first item above!"})]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 ".concat(S?"p-6":"p-2"),children:[(0,N.jsxs)("button",{onClick:()=>I(!S),className:"w-full flex items-center justify-between hover:text-gray-600 ".concat(S?"text-lg font-semibold text-gray-800 mb-4":"text-sm font-medium text-gray-700 py-1"),children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(p,{className:"mr-2 ".concat(S?"w-5 h-5":"w-4 h-4")}),"Prep List Management"]}),(0,N.jsx)("span",{className:"transition-transform ".concat(S?"text-xl rotate-180":"text-sm"),children:"\u25bc"})]}),S&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Prep Item"}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prep Name"}),(0,N.jsx)("input",{type:"text",placeholder:"e.g., Valkosipulimajoneesi",value:ye,onChange:e=>ve(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,N.jsx)("select",{value:be,onChange:e=>we(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:Ee.map((e=>(0,N.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id)))})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Time"}),(0,N.jsx)("input",{type:"text",placeholder:"e.g., 15 min",value:je,onChange:e=>Ne(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency (days)"}),(0,N.jsx)("input",{type:"number",min:"1",max:"30",placeholder:"3",value:ke,onChange:e=>_e(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),(0,N.jsx)("div",{className:"md:col-span-2",children:(0,N.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[(0,N.jsx)("input",{type:"checkbox",checked:Ce,onChange:e=>Se(e.target.checked),className:"rounded border-gray-300 text-green-500 focus:ring-green-500"}),(0,N.jsx)("span",{children:"Include Recipe"})]})}),Ce&&(0,N.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredients"}),(0,N.jsx)("textarea",{value:Ie.ingredients,onChange:e=>Te((t=>(0,s.A)((0,s.A)({},t),{},{ingredients:e.target.value}))),placeholder:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),(0,N.jsx)("textarea",{value:Ie.instructions,onChange:e=>Te((t=>(0,s.A)((0,s.A)({},t),{},{instructions:e.target.value}))),placeholder:"1. **Sekoita**: Yhdist\xe4 majoneesi ja valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm"})]})]}),(0,N.jsx)("div",{className:"md:col-span-2",children:(0,N.jsxs)("button",{onClick:async()=>{if(ye.trim()&&je.trim()&&ke.trim()){const e={id:Math.max(...l.map((e=>e.id)),0)+1,name:ye.trim(),category:be,estimatedTime:je.trim(),isCustom:!0,hasRecipe:Ce,frequency:parseInt(ke)||1,recipe:Ce?Ie:null};x((t=>{const n=[...t,e];return y("prepItems",n),n})),ve(""),we("majoneesit"),Ne(""),_e(""),Se(!1),Te({ingredients:"",instructions:""})}},className:"w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 flex items-center justify-center",children:[(0,N.jsx)(p,{className:"w-4 h-4 mr-2"}),"Add Prep Item"]})})]})]}),(0,N.jsxs)("div",{className:"space-y-3",children:[(0,N.jsxs)("h4",{className:"font-medium text-gray-700",children:["Current Prep Items (",l.length,")"]}),l.map((e=>{var t,n;const r=Ee.find((t=>t.id===e.category));return(0,N.jsxs)("div",{className:"border rounded-lg p-4 bg-white",children:[(0,N.jsxs)("div",{className:"flex items-start justify-between",children:[(0,N.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Name"}),W===e.id?(0,N.jsx)("input",{type:"text",value:e.name,onChange:t=>Le(e.id,"name",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsxs)("div",{className:"font-medium text-gray-800 flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:null===r||void 0===r?void 0:r.icon}),e.name]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),W===e.id?(0,N.jsx)("select",{value:e.category,onChange:t=>Le(e.id,"category",t.target.value),className:"w-full px-2 py-1 border rounded text-sm",children:Ee.map((e=>(0,N.jsx)("option",{value:e.id,children:e.name},e.id)))}):(0,N.jsx)("span",{className:"text-sm text-gray-600",children:null===r||void 0===r?void 0:r.name})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Time"}),W===e.id?(0,N.jsx)("input",{type:"text",value:e.estimatedTime,onChange:t=>Le(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,N.jsx)(O,{className:"w-3 h-3 mr-1"}),e.estimatedTime]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Frequency"}),W===e.id?(0,N.jsx)("input",{type:"number",min:"1",max:"30",value:e.frequency,onChange:t=>Le(e.id,"frequency",parseInt(t.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm"}):(0,N.jsxs)("span",{className:"text-sm text-gray-600",children:["Every ",e.frequency," days"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Recipe"}),(0,N.jsx)("div",{className:"flex items-center space-x-2",children:(0,N.jsx)("button",{onClick:()=>Le(e.id,"hasRecipe",!e.hasRecipe),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.hasRecipe?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.hasRecipe?"\ud83d\udcd6 Has Recipe":"No Recipe"})})]})]}),(0,N.jsxs)("div",{className:"flex gap-2 ml-4",children:[W===e.id?(0,N.jsx)("button",{onClick:()=>{return t=e.id,x((e=>{const n=e.map((e=>e.id===t?(0,s.A)({},e):e));return y("prepItems",n),n})),B(null),void Z(null);var t},className:"p-1 text-green-600 hover:text-green-800",children:(0,N.jsx)(Q,{className:"w-4 h-4"})}):(0,N.jsx)("button",{onClick:()=>{e.hasRecipe?(Z(J===e.id?null:e.id),B(e.id)):B(e.id)},className:"p-1 text-blue-600 hover:text-blue-800",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to remove this prep item?")&&x((e=>{const n=e.filter((e=>e.id!==t));return y("prepItems",n),n})));var t},className:"p-1 text-red-600 hover:text-red-800",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})]}),J===e.id&&e.hasRecipe&&(0,N.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,N.jsx)("h5",{className:"font-medium text-gray-700 mb-3",children:"Recipe Editor"}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredients"}),(0,N.jsxs)("div",{className:"mb-2 flex space-x-2",children:[(0,N.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","bold"),className:"px-2 py-1 bg-gray-100 rounded text-sm font-bold hover:bg-gray-200",children:"B"}),(0,N.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","italic"),className:"px-2 py-1 bg-gray-100 rounded text-sm italic hover:bg-gray-200",children:"I"}),(0,N.jsx)("button",{onClick:()=>Fe(e.id,"ingredients","bullet"),className:"px-2 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:"\u2022"})]}),(0,N.jsx)("textarea",{id:"ingredients-".concat(e.id),value:(null===(t=e.recipe)||void 0===t?void 0:t.ingredients)||"",onChange:t=>Oe(e.id,"ingredients",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm",placeholder:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),(0,N.jsxs)("div",{className:"mb-2 flex space-x-2",children:[(0,N.jsx)("button",{onClick:()=>Fe(e.id,"instructions","bold"),className:"px-2 py-1 bg-gray-100 rounded text-sm font-bold hover:bg-gray-200",children:"B"}),(0,N.jsx)("button",{onClick:()=>Fe(e.id,"instructions","italic"),className:"px-2 py-1 bg-gray-100 rounded text-sm italic hover:bg-gray-200",children:"I"}),(0,N.jsx)("button",{onClick:()=>Fe(e.id,"instructions","number"),className:"px-2 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:"1."})]}),(0,N.jsx)("textarea",{id:"instructions-".concat(e.id),value:(null===(n=e.recipe)||void 0===n?void 0:n.instructions)||"",onChange:t=>Oe(e.id,"instructions",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 h-24 font-mono text-sm",placeholder:"1. **Sekoita**: Yhdist\xe4 majoneesi ja valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu"})]})]})]})]},e.id)})),0===l.length&&(0,N.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No prep items yet. Add your first prep item above!"})]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)(b,{className:"w-5 h-5 mr-2"}),"Employee Management"]}),(0,N.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Add New Employee"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("input",{type:"text",placeholder:"Employee name",value:T,onChange:e=>E(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,N.jsx)("select",{value:A,onChange:e=>D(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:i.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))}),(0,N.jsx)("button",{onClick:()=>{ie(T,A,n,c,E,D)},className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center",children:(0,N.jsx)(G,{className:"w-4 h-4"})})]})]}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full border-collapse",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"bg-gray-50",children:[(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Name"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Role"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Points"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Mood"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Last Updated"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"Actions"})]})}),(0,N.jsx)("tbody",{children:n.map((e=>(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:M===e.id?(0,N.jsx)("input",{type:"text",value:e.name,onChange:t=>le(e.id,"name",t.target.value,c),className:"w-full px-2 py-1 border rounded"}):e.name}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:M===e.id?(0,N.jsx)("select",{value:e.role,onChange:t=>le(e.id,"role",t.target.value,c),className:"w-full px-2 py-1 border rounded",children:i.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))}):e.role}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(_,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,N.jsx)("span",{className:"font-medium text-purple-600",children:e.points})]})}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat((0,j.zQ)(e.mood))}),e.mood,"/5"]})}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2 text-sm text-gray-600",children:e.lastUpdated}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex gap-2 justify-center",children:[M===e.id?(0,N.jsx)("button",{onClick:()=>L(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,N.jsx)(Q,{className:"w-4 h-4"})}):(0,N.jsx)("button",{onClick:()=>L(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>oe(e.id,c),className:"p-1 text-red-600 hover:text-red-800",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})})]},e.id)))})]})})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,N.jsx)(m,{className:"w-5 h-5 mr-2"}),"Task Management"]}),(0,N.jsxs)("button",{onClick:()=>{const e=Math.max(0,...a.map((e=>e.id)),...Ae.map((e=>e.id)))+1,t={id:e,task:"",location:"",priority:"medium",estimatedTime:"",points:5};De((e=>[...e,t])),U(e)},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center",children:[(0,N.jsx)(H,{className:"w-4 h-4 mr-2"}),"Add Task"]})]}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full border-collapse",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"bg-gray-50",children:[(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Task"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Location"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Priority"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Points"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Est. Time"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"Actions"})]})}),(0,N.jsxs)("tbody",{children:[Ae.map((e=>(0,N.jsxs)("tr",{className:"hover:bg-yellow-50",children:[(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsx)("input",{type:"text",value:e.task,onChange:t=>Ve(e.id,"task",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsx)("input",{type:"text",value:e.location,onChange:t=>Ve(e.id,"location",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsxs)("select",{value:e.priority,onChange:t=>Ve(e.id,"priority",t.target.value),className:"w-full px-2 py-1 border rounded",children:[(0,N.jsx)("option",{value:"low",children:"Low"}),(0,N.jsx)("option",{value:"medium",children:"Medium"}),(0,N.jsx)("option",{value:"high",children:"High"})]})}),(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsx)("input",{type:"number",min:"1",max:"100",value:e.points,onChange:t=>Ve(e.id,"points",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsx)("input",{type:"text",value:e.estimatedTime,onChange:t=>Ve(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded"})}),(0,N.jsx)("td",{className:"border border-yellow-300 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,N.jsx)("button",{onClick:()=>(e=>{const t=Ae.find((t=>t.id===e));t&&(u((e=>[...e,t])),De((t=>t.filter((t=>t.id!==e)))),U(null))})(e.id),className:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",title:"Save Task",children:(0,N.jsx)(Q,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>{return t=e.id,De((e=>e.filter((e=>e.id!==t)))),void U(null);var t},className:"px-2 py-1 bg-gray-400 text-white rounded hover:bg-gray-600",title:"Cancel",children:"\u2715"})]})})]},e.id))),a.map((e=>(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,N.jsx)("input",{type:"text",value:Be(e,"task"),onChange:t=>We(e.id,"task",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.task}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,N.jsx)("input",{type:"text",value:Be(e,"location"),onChange:t=>We(e.id,"location",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.location}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,N.jsxs)("select",{value:e.priority,onChange:t=>ce(e.id,"priority",t.target.value,u),className:"w-full px-2 py-1 border rounded",children:[(0,N.jsx)("option",{value:"low",children:"Low"}),(0,N.jsx)("option",{value:"medium",children:"Medium"}),(0,N.jsx)("option",{value:"high",children:"High"})]}):(0,N.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.priority})}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,N.jsx)("input",{type:"number",min:"1",max:"100",value:e.points,onChange:t=>ce(e.id,"points",t.target.value,u),className:"w-full px-2 py-1 border rounded"}):(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(_,{className:"w-3 h-3 text-purple-500 mr-1"}),(0,N.jsx)("span",{className:"font-medium text-purple-600",children:e.points})]})}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:F===e.id?(0,N.jsx)("input",{type:"text",value:Be(e,"estimatedTime"),onChange:t=>We(e.id,"estimatedTime",t.target.value),className:"w-full px-2 py-1 border rounded"}):e.estimatedTime}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex gap-2 justify-center",children:[F===e.id?(0,N.jsx)("button",{onClick:()=>U(null),className:"p-1 text-green-600 hover:text-green-800",children:(0,N.jsx)(Q,{className:"w-4 h-4"})}):(0,N.jsx)("button",{onClick:()=>U(e.id),className:"p-1 text-blue-600 hover:text-blue-800",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>de(e.id,u),className:"p-1 text-red-600 hover:text-red-800",title:"Delete Task",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})})]},e.id)))]})]})})]})]})},pe=o("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),fe=o("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ge=e=>{var t,n,s,r;let{selectedDate:a,setSelectedDate:i,dailyData:o,employees:l,connectionStatus:c}=e;const d=o[a];return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,N.jsx)(pe,{className:"w-5 h-5 mr-2"}),"Daily Reports (Firebase Storage)"]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===c?"bg-green-500":"bg-red-500")}),(0,N.jsx)("span",{className:"text-xs text-gray-600",children:"connected"===c?"Live Data":"Offline"}),(0,N.jsx)("input",{type:"date",value:a,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"}),(0,N.jsxs)("button",{className:"px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 flex items-center",children:[(0,N.jsx)(fe,{className:"w-4 h-4 mr-1"}),"Export"]})]})]}),d?(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,N.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null===(t=d.completedTasks)||void 0===t?void 0:t.length)||0}),(0,N.jsx)("div",{className:"text-sm text-blue-700",children:"Tasks Completed"})]}),(0,N.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,N.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[d.completionRate||0,"%"]}),(0,N.jsx)("div",{className:"text-sm text-green-700",children:"Completion Rate"})]}),(0,N.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(null===(n=d.employeeMoods)||void 0===n?void 0:n.length)||0}),(0,N.jsx)("div",{className:"text-sm text-orange-700",children:"Mood Updates"})]})]}):(0,N.jsxs)("div",{className:"text-center py-8 text-gray-500",children:["No data available for ",a]})]}),(null===d||void 0===d?void 0:d.completedTasks)&&(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Task Completions"}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full border-collapse",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"bg-gray-50",children:[(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Time"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Task"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Employee"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Status"})]})}),(0,N.jsx)("tbody",{children:d.completedTasks.map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.completedAt}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.taskName}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"Completed"})})]},t)}))})]})})]}),(null===d||void 0===d?void 0:d.employeeMoods)&&(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Mood Updates"}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full border-collapse",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"bg-gray-50",children:[(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Time"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Employee"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Mood"}),(0,N.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Rating"})]})}),(0,N.jsx)("tbody",{children:d.employeeMoods.map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.updatedAt}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,N.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),w._M[e.mood-1]]})}),(0,N.jsxs)("td",{className:"border border-gray-200 px-4 py-2",children:[e.mood,"/5"]})]},t)}))})]})})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"30-Day Overview"}),(0,N.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,N.jsx)("div",{className:"text-sm font-medium text-gray-600 mb-1",children:(new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,N.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>(0,N.jsx)("div",{className:"text-xs font-medium text-gray-500 text-center",children:e},e))),(()=>{const e=new Date,t=[],n=new Date(e.getFullYear(),e.getMonth(),1);for(let r=0;r<n.getDay();r++)t.push((0,N.jsx)("div",{className:"p-2"},"empty-".concat(r)));const s=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();for(let r=1;r<=s;r++){const n=new Date(e.getFullYear(),e.getMonth(),r),s=(0,j.po)(n),l=o[s]||{},c=(null===l||void 0===l?void 0:l.completionRate)||0,d=Math.floor((e.getTime()-n.getTime())/864e5);d>=0&&d<30?t.push((0,N.jsx)("div",{className:"p-2 rounded text-xs cursor-pointer transition-colors ".concat(s===a?"bg-purple-500 text-white":c>=80?"bg-green-100 text-green-700 hover:bg-green-200":c>=50?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":c>0?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"),onClick:()=>i(s),title:"".concat(n.toLocaleDateString("en-US",{month:"short"})," ").concat(n.getDate(),": ").concat(c,"% completion"),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{className:"font-medium",children:n.getDate()}),(0,N.jsxs)("span",{children:[c,"%"]})]})},s)):t.push((0,N.jsx)("div",{className:"p-2 rounded text-xs text-gray-300",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:n.getDate()}),(0,N.jsx)("span",{children:"-"})]})},"disabled-".concat(r)))}return t})()]})]}),(0,N.jsxs)("div",{className:"mt-4 flex justify-center space-x-4 text-xs",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-green-100 rounded mr-1"}),"80%+ completion"]}),(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-yellow-100 rounded mr-1"}),"50-79% completion"]}),(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-red-100 rounded mr-1"}),"Below 50%"]})]})]}),d&&(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Daily Summary - ",new Date(a).toLocaleDateString()]}),(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,N.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[(0,N.jsx)("div",{className:"text-xl font-bold text-blue-600",children:(null===(s=d.completedTasks)||void 0===s?void 0:s.length)||0}),(0,N.jsx)("div",{className:"text-sm text-blue-700",children:"Tasks Done"})]}),(0,N.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[(0,N.jsxs)("div",{className:"text-xl font-bold text-green-600",children:[d.completionRate||0,"%"]}),(0,N.jsx)("div",{className:"text-sm text-green-700",children:"Completion"})]}),(0,N.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[(0,N.jsx)("div",{className:"text-xl font-bold text-purple-600",children:(null===(r=d.employeeMoods)||void 0===r?void 0:r.length)||0}),(0,N.jsx)("div",{className:"text-sm text-purple-700",children:"Mood Updates"})]})]}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full border-collapse border border-gray-200",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"bg-gray-50",children:[(0,N.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Time"}),(0,N.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Employee"}),(0,N.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Action"}),(0,N.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-left text-sm font-medium",children:"Details"})]})}),(0,N.jsxs)("tbody",{children:[(d.completedTasks||[]).map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.completedAt}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2",children:(0,N.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"\u2713 Task Completed"})}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.taskName})]},"task-".concat(t))})),(d.employeeMoods||[]).map(((e,t)=>{const n=l.find((t=>t.id===e.employeeId));return(0,N.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.updatedAt}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:(null===n||void 0===n?void 0:n.name)||"Unknown"}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2",children:(0,N.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:"\ud83d\ude0a Mood Update"})}),(0,N.jsx)("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:w.Ur[e.mood-1]}),w._M[e.mood-1]," (",e.mood,"/5)"]})})]},"mood-".concat(t))})),(!d.completedTasks||0===d.completedTasks.length)&&(!d.employeeMoods||0===d.employeeMoods.length)&&(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:4,className:"border border-gray-200 px-3 py-8 text-center text-gray-500",children:"No activity recorded for this date"})})]})]})})]})]})},xe=o("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ye=[{id:"all",name:"All Items",icon:"\ud83c\udf7d\ufe0f"},{id:"majoneesit",name:"Majoneesit",icon:"\ud83e\udd44"},{id:"proteiinit",name:"Proteiinit",icon:"\ud83e\udd69"},{id:"kasvikset",name:"Kasvikset",icon:"\ud83e\udd57"},{id:"marinointi",name:"Marinointi & pikkel\xf6inti",icon:"\ud83e\udd52"},{id:"kastikkeet",name:"Kastikkeet",icon:"\ud83e\uddc2"},{id:"muut",name:"Muut",icon:"\ud83d\udd27"}],ve=[{id:"morning",name:"Morning (6-10 AM)",icon:"\ud83c\udf05"},{id:"midday",name:"Mid-day (10 AM-2 PM)",icon:"\u2600\ufe0f"},{id:"afternoon",name:"Afternoon (2-6 PM)",icon:"\ud83c\udf24\ufe0f"},{id:"evening",name:"Evening (6-10 PM)",icon:"\ud83c\udf06"}],be=[{id:"low",name:"Low",color:"bg-green-100 text-green-700",icon:"\ud83d\udfe2"},{id:"medium",name:"Medium",color:"bg-yellow-100 text-yellow-700",icon:"\ud83d\udfe1"},{id:"high",name:"High",color:"bg-red-100 text-red-700",icon:"\ud83d\udd34"}],we=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(s)},je=e=>e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br/>"),Ne=(e,t)=>"".concat(we(e),"-").concat(t),ke=()=>Date.now()+Math.random(),_e=o("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Ce=t=>{let{scheduledPreps:n,onToggleCompletion:s,onShowRecipe:r}=t;const[a,i]=(0,e.useState)(new Set),o=we(new Date),l=n.filter((e=>e.scheduledDate===o));e.useEffect((()=>{console.log("\ud83d\udd0d TodayView Debug Info:",{todayDateString:o,totalScheduledPreps:n.length,todayScheduledPreps:l.length,allScheduledDates:Array.from(new Set(n.map((e=>e.scheduledDate)))).sort(),sampleTodayPreps:l.slice(0,3).map((e=>({id:e.id,name:e.name,scheduledDate:e.scheduledDate,completed:e.completed})))})}),[o,n.length,l.length]);const c=l.filter((e=>e.completed)).length,d=l.length,h=e=>{var t;const n=be.find((t=>t.id===e.priority)),o=a.has(e.id);return(0,N.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg transition-all ".concat(o?"bg-blue-50 border-blue-200":"hover:bg-gray-50"),children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3 select-none",children:[(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(a.has(e))console.log("\u23f3 Completion toggle already in progress for prep:",e);else{i((t=>new Set(t).add(e)));try{console.log("\ud83d\udd04 TodayView: Toggling completion for prep:",e),await s(e),console.log("\u2705 TodayView: Completion toggle finished for prep:",e)}catch(t){console.error("\u274c TodayView: Completion toggle failed for prep:",e,t)}finally{i((t=>{const n=new Set(t);return n.delete(e),n}))}}})(e.id)},disabled:o,className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ".concat(e.completed?"bg-green-500 border-green-500":o?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-green-500"," ").concat(o?"cursor-wait":"cursor-pointer"," disabled:cursor-wait"),title:o?"Saving...":e.completed?"Mark as incomplete":"Mark as complete",children:o?(0,N.jsx)(_e,{className:"w-4 h-4 text-blue-500 animate-spin"}):e.completed?(0,N.jsx)(u,{className:"w-4 h-4 text-white"}):null}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("div",{className:"font-medium flex items-center space-x-2 transition-all ".concat(e.completed?"line-through text-gray-500":"text-gray-800"),children:[(0,N.jsx)("span",{children:e.name}),e.hasRecipe&&e.recipe&&(0,N.jsx)("button",{onClick:()=>r(e.recipe,e.name),className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"}),o&&(0,N.jsx)("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:"Saving..."})]}),(0,N.jsxs)("div",{className:"text-sm text-gray-600",children:[e.estimatedTime," \u2022 ",e.category,e.timeSlot&&(0,N.jsxs)(N.Fragment,{children:[" "," \u2022 ",(null===(t=ve.find((t=>t.id===e.timeSlot)))||void 0===t?void 0:t.name)||e.timeSlot]})]})]})]}),(0,N.jsx)("div",{className:"flex items-center space-x-2",children:(0,N.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===n||void 0===n?void 0:n.color)||"bg-gray-100 text-gray-700"),children:(null===n||void 0===n?void 0:n.name)||"Medium"})})]},e.id)};return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Today's Progress"}),(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,N.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:d}),(0,N.jsx)("div",{className:"text-sm text-blue-700",children:"Total Preps"})]}),(0,N.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-green-600",children:c}),(0,N.jsx)("div",{className:"text-sm text-green-700",children:"Completed"})]}),(0,N.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[(0,N.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[d>0?Math.round(c/d*100):0,"%"]}),(0,N.jsx)("div",{className:"text-sm text-purple-700",children:"Complete"})]})]}),d>0&&(0,N.jsxs)("div",{className:"mt-4",children:[(0,N.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,N.jsx)("span",{children:"Progress"}),(0,N.jsxs)("span",{children:[c," of ",d," tasks"]})]}),(0,N.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,N.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(d>0?c/d*100:0,"%")}})})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Today's Prep Tasks"}),a.size>0&&(0,N.jsxs)("div",{className:"flex items-center text-blue-600 text-sm",children:[(0,N.jsx)(_e,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving ",a.size," change",1!==a.size?"s":"","..."]})]}),0===l.length?(0,N.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,N.jsx)(p,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,N.jsx)("p",{className:"text-lg mb-2",children:"No prep tasks scheduled for today"}),(0,N.jsx)("p",{className:"text-sm",children:'Use the "Plan Preps" tab to schedule tasks.'})]}):(0,N.jsxs)("div",{className:"space-y-4",children:[ve.map((e=>{const t=l.filter((t=>t.timeSlot===e.id));if(0===t.length)return null;const n=t.filter((e=>e.completed)).length;return(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,N.jsxs)("h4",{className:"font-medium text-gray-700 flex items-center",children:[(0,N.jsx)("span",{className:"mr-2",children:e.icon}),e.name]}),(0,N.jsxs)("span",{className:"text-sm text-gray-500",children:[n,"/",t.length," completed"]})]}),(0,N.jsx)("div",{className:"space-y-3",children:t.map(h)})]},e.id)})),(()=>{const e=l.filter((e=>""===e.timeSlot));if(0===e.length)return null;const t=e.filter((e=>e.completed)).length;return(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 flex items-center",children:"\ud83d\udd50 Anytime"}),(0,N.jsxs)("span",{className:"text-sm text-gray-500",children:[t,"/",e.length," completed"]})]}),(0,N.jsx)("div",{className:"space-y-3",children:e.map(h)})]})})()]})]}),d>0&&c===d&&(0,N.jsxs)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 rounded-xl p-6 text-white text-center",children:[(0,N.jsx)("div",{className:"text-3xl mb-2",children:"\ud83c\udf89"}),(0,N.jsx)("h3",{className:"text-xl font-bold mb-1",children:"All Done!"}),(0,N.jsxs)("p",{className:"text-green-100",children:["Great job! You've completed all ",d," prep tasks for today."]})]})]})},Se=t=>{let{scheduledPreps:n,currentDate:s,setCurrentDate:r,selectedDate:a,setSelectedDate:i,setActiveView:o,onToggleCompletion:l,onShowRecipe:c}=t;const[d,h]=(0,e.useState)(null),m=()=>{const e=[];for(let t=0;t<7;t++){const n=new Date(s);n.setDate(s.getDate()+t),e.push(n)}return e};return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n          .priority-glow {\n            position: relative;\n            z-index: 0;\n            font-weight: 600;\n            border-radius: 0.25rem;\n            padding: 0.125rem 0.25rem;\n          }\n          .priority-glow::before {\n            content: "";\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            width: 110%;\n            height: 2em;\n            transform: translate(-50%, -50%);\n            border-radius: 0.375rem;\n            filter: blur(6px);\n            z-index: -1;\n            opacity: 0.3;\n          }\n          .priority-low {\n            color: #047857;\n          }\n          .priority-low::before {\n            box-shadow: 0 0 8px 4px rgba(5, 150, 105, 0.4);\n          }\n          .priority-medium {\n            color: #92400e;\n          }\n          .priority-medium::before {\n            box-shadow: 0 0 8px 4px rgba(202, 138, 4, 0.4);\n          }\n          .priority-high {\n            color: #b91c1c;\n          }\n          .priority-high::before {\n            box-shadow: 0 0 8px 4px rgba(185, 28, 28, 0.4);\n          }\n        '}}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Week Overview"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("button",{onClick:()=>{const e=new Date(s);e.setDate(e.getDate()-7),r(e)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"\u2190 Previous Week"}),(0,N.jsx)("button",{onClick:()=>{const e=new Date(s);e.setDate(e.getDate()+7),r(e)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"Next Week \u2192"})]})]}),(0,N.jsx)("div",{className:"space-y-3",children:m().map(((e,t)=>{const s=n.filter((t=>t.scheduledDate===we(e))),r=s.filter((e=>e.completed)).length,m=we(e)===we(new Date),p=we(e)===we(a),f=d===we(e);return(0,N.jsxs)("div",{className:"border rounded-xl transition-all duration-500 ease-in-out overflow-hidden ".concat(f?"bg-gray-50":"bg-white hover:bg-gray-50"," ").concat(m?"ring-2 ring-blue-500":p&&!f?"ring-2 ring-purple-500":f?"ring-2 ring-green-500 shadow-lg":"hover:shadow-md"),children:[(0,N.jsxs)("div",{className:"flex items-center cursor-pointer transition-all duration-300 ".concat(f?"p-4 bg-white border-b":"p-4"),onClick:()=>{h(f?null:we(e))},children:[(0,N.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)("div",{className:"font-medium text-gray-800 text-sm",children:e.toLocaleDateString("en-US",{weekday:"short"})}),(0,N.jsx)("div",{className:"text-2xl font-bold ".concat(m?"text-blue-600":p&&!f?"text-purple-600":f?"text-green-600":"text-gray-600"),children:e.getDate()}),m&&(0,N.jsx)("div",{className:"text-xs text-blue-600 font-medium",children:"Today"}),p&&!m&&!f&&(0,N.jsx)("div",{className:"text-xs text-purple-600 font-medium",children:"Selected"}),f&&(0,N.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Expanded"})]}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsxs)("div",{className:"text-sm text-gray-600",children:[r,"/",s.length," tasks"]}),s.length>0&&(0,N.jsx)("div",{className:"flex-1 max-w-32",children:(0,N.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,N.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(r===s.length?"bg-green-500":r>0?"bg-yellow-500":"bg-gray-300"),style:{width:"".concat(r/s.length*100,"%")}})})})]}),!f&&s.length>0&&(0,N.jsxs)("div",{className:"text-xs mt-1",children:[s.slice(0,2).map(((e,t)=>(0,N.jsxs)("span",{className:"priority-glow priority-".concat(e.priority," ").concat(t>0?"ml-1":""),children:[e.name,t<Math.min(s.length,2)-1&&", "]},e.id))),s.length>2&&(0,N.jsxs)("span",{className:"text-gray-500 ml-1",children:["+",s.length-2," more"]})]}),!f&&0===s.length&&(0,N.jsx)("div",{className:"text-xs text-gray-400 mt-1 italic",children:"No preps scheduled"})]})]}),(0,N.jsx)("div",{className:"transform transition-transform duration-300 ".concat(f?"rotate-180":"rotate-0"),children:(0,N.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,N.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,N.jsx)("div",{className:"transition-all duration-500 ease-in-out overflow-hidden ".concat(f?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:f&&(0,N.jsx)("div",{className:"p-4 space-y-3 overflow-y-auto max-h-80",children:0===s.length?(0,N.jsxs)("div",{className:"text-center py-8",children:[(0,N.jsx)("div",{className:"text-gray-400 text-sm",children:"No prep tasks scheduled"}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e),o("plan")},className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"Plan Preps for This Day"})]}):(0,N.jsxs)(N.Fragment,{children:[(()=>{const e=s.filter((e=>""===e.timeSlot)),t=ve.map((e=>({slot:e,preps:s.filter((t=>t.timeSlot===e.id))}))).filter((e=>e.preps.length>0));return(0,N.jsxs)(N.Fragment,{children:[t.map((e=>{let{slot:t,preps:n}=e;return(0,N.jsxs)("div",{children:[(0,N.jsxs)("h5",{className:"font-medium text-gray-700 text-sm mb-2 flex items-center",children:[(0,N.jsx)("span",{className:"mr-2",children:t.icon}),t.name]}),(0,N.jsx)("div",{className:"space-y-2",children:n.map((e=>{const t=be.find((t=>t.id===e.priority));return(0,N.jsx)("div",{className:"p-3 rounded-lg border-l-4 transition-colors ".concat(e.completed?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:bg-gray-50"),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(e.completed?"bg-green-500 border-green-500":"border-gray-300 hover:border-green-500"),children:e.completed&&(0,N.jsx)(u,{className:"w-3 h-3 text-white"})}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"font-medium text-sm flex items-center space-x-2 priority-glow priority-".concat(e.priority," ").concat(e.completed?"line-through opacity-60":""),children:[(0,N.jsx)("span",{children:e.name}),e.hasRecipe&&(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),e.recipe&&c(e.recipe,e.name)},className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6"})]}),(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:[e.estimatedTime," \u2022 ",e.category]})]})]}),(0,N.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-700"),children:(null===t||void 0===t?void 0:t.name)||"Medium"})]})},e.id)}))})]},t.id)})),e.length>0&&(0,N.jsxs)("div",{children:[(0,N.jsx)("h5",{className:"font-medium text-gray-700 text-sm mb-2 flex items-center",children:"\ud83d\udd50 Anytime"}),(0,N.jsx)("div",{className:"space-y-2",children:e.map((e=>{const t=be.find((t=>t.id===e.priority));return(0,N.jsx)("div",{className:"p-3 rounded-lg border-l-4 transition-colors ".concat(e.completed?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:bg-gray-50"),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(e.completed?"bg-green-500 border-green-500":"border-gray-300 hover:border-green-500"),children:e.completed&&(0,N.jsx)(u,{className:"w-3 h-3 text-white"})}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"font-medium text-sm flex items-center space-x-2 priority-glow priority-".concat(e.priority," ").concat(e.completed?"line-through opacity-60":""),children:[(0,N.jsx)("span",{children:e.name}),e.hasRecipe&&(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),e.recipe&&c(e.recipe,e.name)},className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6"})]}),(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:[e.estimatedTime," \u2022 ",e.category]})]})]}),(0,N.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat((null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-700"),children:(null===t||void 0===t?void 0:t.name)||"Medium"})]})},e.id)}))})]})]})})(),(0,N.jsxs)("div",{className:"flex gap-2 pt-2 border-t",children:[(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e),o("plan")},className:"flex-1 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"Edit Preps"}),(0,N.jsx)("button",{onClick:e=>{e.stopPropagation(),h(null)},className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm",children:"Collapse"})]})]})})})]},t)}))}),(0,N.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[(0,N.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[(0,N.jsx)("div",{className:"text-xl font-bold text-blue-600",children:m().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===we(t))).length),0)}),(0,N.jsx)("div",{className:"text-sm text-blue-700",children:"Total Tasks This Week"})]}),(0,N.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[(0,N.jsx)("div",{className:"text-xl font-bold text-green-600",children:m().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===we(t)&&e.completed)).length),0)}),(0,N.jsx)("div",{className:"text-sm text-green-700",children:"Completed"})]}),(0,N.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[(0,N.jsxs)("div",{className:"text-xl font-bold text-purple-600",children:[(()=>{const e=m().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===we(t))).length),0),t=m().reduce(((e,t)=>e+n.filter((e=>e.scheduledDate===we(t)&&e.completed)).length),0);return e>0?Math.round(t/e*100):0})(),"%"]}),(0,N.jsx)("div",{className:"text-sm text-purple-700",children:"Week Progress"})]})]})]})]})},Ie=e=>{var t,n,s;let{prep:r,isSelected:a,selection:i,showPriorityOptions:o,showTimeOptions:l,assignmentStep:c,onToggleSelection:d,onUpdateSelection:h,onShowPriorityOptions:m,onShowRecipe:p,onSave:f,context:g="main"}=e;const x="suggested"===g?"suggested-".concat(r.id):r.id;return(0,N.jsx)("div",{className:"border rounded-lg p-4 transition-colors ".concat(a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,N.jsx)("div",{className:"flex items-center justify-between",children:(0,N.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[(0,N.jsx)("button",{onClick:()=>d(r),className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ".concat(a?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-blue-500"),children:a&&(0,N.jsx)(u,{className:"w-4 h-4 text-white"})}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("h4",{className:"font-medium ".concat(a?"text-blue-900":"text-gray-800"),children:r.name}),r.hasRecipe&&r.recipe&&(0,N.jsx)("button",{onClick:()=>p(r.recipe,r.name),className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"})]}),(0,N.jsxs)("p",{className:"text-sm text-gray-600 flex items-center space-x-2",children:[(0,N.jsx)("span",{children:r.estimatedTime}),(0,N.jsx)("span",{children:"\u2022"}),(0,N.jsx)("span",{children:r.category}),(0,N.jsx)("span",{children:"\u2022"}),(0,N.jsxs)("span",{children:["Every ",r.frequency," days"]}),r.isCustom&&(0,N.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-xs",children:"Custom"})]}),(0,N.jsx)("div",{className:"mt-2",children:(0,N.jsxs)("div",{className:"relative w-2/3",children:[(0,N.jsx)("button",{onClick:()=>{m(o===x?null:x)},className:"w-full px-2 py-1 rounded text-xs transition-colors ".concat(a?(null===(t=be.find((e=>e.id===i.priority)))||void 0===t?void 0:t.color)+" font-medium":"timeSlot"===c[r.id]?"bg-green-100 text-green-700 font-medium":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:a?"".concat(null===(n=be.find((e=>e.id===i.priority)))||void 0===n?void 0:n.name," Priority").concat(i.timeSlot?" \u2022 ".concat(null===(s=ve.find((e=>e.id===i.timeSlot)))||void 0===s?void 0:s.name):" \u2022 Anytime"):"timeSlot"===c[r.id]?"Now choose time slot":"Click to assign priority & time"}),o===x&&(0,N.jsx)("div",{className:"dropdown-container soft-dropdown absolute top-full left-0 mt-2 rounded-xl p-3 z-20 w-full min-w-64 max-w-xs",children:(0,N.jsx)("div",{className:"space-y-3",children:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,N.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Choose Priority Level"]}),(0,N.jsx)("div",{className:"space-y-2",children:be.map((e=>(0,N.jsx)("button",{onClick:()=>h(r,"priority",e.id,g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 ".concat(e.color),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{className:"text-xs opacity-70",children:e.icon})]})},e.id)))})]})})}),l===x&&(0,N.jsx)("div",{className:"dropdown-container soft-dropdown absolute top-full left-0 mt-2 rounded-xl p-3 z-20 w-full min-w-64 max-w-sm",children:(0,N.jsx)("div",{className:"space-y-3",children:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,N.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Choose Time Slot"]}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)("button",{onClick:()=>h(r,"timeSlot","",g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-gray-50 text-gray-700 hover:bg-gray-100",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"Anytime"}),(0,N.jsx)("span",{className:"text-xs opacity-70",children:"\ud83d\udd50"})]})}),ve.map((e=>(0,N.jsx)("button",{onClick:()=>h(r,"timeSlot",e.id,g),className:"soft-button w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-blue-50 text-blue-700 hover:bg-blue-100",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{className:"text-xs opacity-70",children:e.icon})]})},e.id)))]})]})})})]})})]})]})})})},Te=e=>{let{isOpen:t,recipe:n,recipeName:s,onClose:r}=e;return t&&n?(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,N.jsx)(p,{className:"w-5 h-5 text-green-600"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:s}),(0,N.jsx)("p",{className:"text-sm text-gray-600",children:"Recipe Details"})]})]}),(0,N.jsx)("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"p-6 space-y-6",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("h4",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[(0,N.jsx)("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm mr-2",children:"\ud83e\udd44"}),"Ingredients"]}),(0,N.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,N.jsx)("div",{className:"whitespace-pre-wrap text-gray-700",dangerouslySetInnerHTML:{__html:je(n.ingredients)}})})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("h4",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[(0,N.jsx)("span",{className:"w-6 h-6 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm mr-2",children:"\ud83d\udcdd"}),"Instructions"]}),(0,N.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,N.jsx)("div",{className:"whitespace-pre-wrap text-gray-700",dangerouslySetInnerHTML:{__html:je(n.instructions)}})})]})]}),(0,N.jsx)("div",{className:"flex justify-end p-6 border-t bg-gray-50",children:(0,N.jsx)("button",{onClick:r,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Close Recipe"})})]})}):null},Ee=o("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),Ae=o("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),De=o("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Pe=o("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Re=o("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Me=o("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Le=o("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),Oe=o("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Fe=t=>{let{currentDate:n,selectedDate:s,prepItems:r,scheduledPreps:a,prepSelections:i,selectedCategory:o,searchQuery:l,onToggleSelection:c,onUpdateSelection:d,onShowRecipe:u,showPriorityOptions:m,showTimeOptions:p,assignmentStep:f,onShowPriorityOptions:g,onResetWorkflow:x}=t;const[y,v]=(0,e.useState)(!0),[b,w]=(0,e.useState)("smart"),[j,k]=(0,e.useState)(5),[C,S]=(0,e.useState)(!1),[I,T]=(0,e.useState)([]),[E,A]=(0,e.useState)(!1);(0,e.useEffect)((()=>{const e=()=>{var e,t,n;const s=document.querySelector(".bg-red-100.text-red-700"),r=s&&(null===(e=s.textContent)||void 0===e?void 0:e.includes("Admin Mode")),a=document.querySelector(".bg-white.border-b"),i=a&&((null===(t=a.textContent)||void 0===t?void 0:t.includes("Admin Panel"))||(null===(n=a.textContent)||void 0===n?void 0:n.includes("Daily Reports"))),o=document.querySelector('[title="Logout Admin"]'),l=r||i||!!o;A(l),l!==E&&console.log("\ud83d\udd27 Prep Suggestions: Admin mode detected:",{hasAdminBadge:!!r,hasAdminTabs:!!i,hasLogoutButton:!!o,isAdmin:l})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[E]);const D=[{id:"low",name:"Low",color:"bg-green-100 text-green-700",icon:"\ud83d\udfe2"},{id:"medium",name:"Medium",color:"bg-yellow-100 text-yellow-700",icon:"\ud83d\udfe1"},{id:"high",name:"High",color:"bg-red-100 text-red-700",icon:"\ud83d\udd34"}],P=[{id:"morning",name:"Morning (6-10 AM)",icon:"\ud83c\udf05"},{id:"midday",name:"Mid-day (10 AM-2 PM)",icon:"\u2600\ufe0f"},{id:"afternoon",name:"Afternoon (2-6 PM)",icon:"\ud83c\udf24\ufe0f"},{id:"evening",name:"Evening (6-10 PM)",icon:"\ud83c\udf06"}],R=e=>{switch(e){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},M=e=>{switch(e){case"critical":return"bg-red-600";case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},L=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(s)},O=e=>{var t;const n="".concat(L(s),"-").concat(e.id);return(null===(t=i[n])||void 0===t?void 0:t.selected)||!1},F=(0,e.useMemo)((()=>{const e=L(n),t=L(s);return r.filter((e=>{const n="all"===o||e.category===o,s=""===l||e.name.toLowerCase().includes(l.toLowerCase())||e.category.toLowerCase().includes(l.toLowerCase()),r=a.some((n=>n.prepId===e.id&&n.scheduledDate===t));return n&&s&&!r})).map((t=>{var n;const s=a.filter((e=>e.prepId===t.id&&e.completed)).sort(((e,t)=>new Date(t.scheduledDate).getTime()-new Date(e.scheduledDate).getTime())),r=null===(n=s[0])||void 0===n?void 0:n.scheduledDate,i=r?Math.floor((new Date(e).getTime()-new Date(r).getTime())/864e5):999,{learnedFreq:o,confidence:l,dayPatterns:c}=((e,t)=>{if(t.length<2)return{learnedFreq:0,confidence:0,dayPatterns:{}};const n=[],s={};for(let i=0;i<t.length-1;i++){const e=Math.floor((new Date(t[i].scheduledDate).getTime()-new Date(t[i+1].scheduledDate).getTime())/864e5);n.push(e)}t.forEach((e=>{const t=new Date(e.scheduledDate).toLocaleDateString("en-US",{weekday:"long"});s[t]=(s[t]||0)+1}));const r=n.reduce(((e,t)=>e+t),0)/n.length,a=100*(1/(1+n.reduce(((e,t)=>e+Math.pow(t-r,2)),0)/n.length/r)*.7+.3*Math.min(t.length/10,1));return{learnedFreq:Math.round(10*r)/10,confidence:Math.round(a),dayPatterns:s}})(t.id,s),d=l>60&&o>0?o:t.frequency;if(E&&o>0&&Math.abs(o-t.frequency)>.5){const e={prepId:t.id,prepName:t.name,timestamp:(new Date).toISOString(),recommendedFreq:t.frequency,learnedFreq:o,reason:"Pattern analysis from ".concat(s.length," completions"),confidence:l,dataPoints:s.length};T((n=>n.some((e=>e.prepId===t.id&&Math.abs(new Date(e.timestamp).getTime()-(new Date).getTime())<6e4))?n:[e,...n.slice(0,49)]))}const u=a.filter((e=>e.prepId===t.id)).length,h=u>0?s.length/u*100:0,m=d,p=i-m;let f,g=0,x="",y="",v="medium",b="morning";return 999===i?(f="high",g=90,x="Never prepared before",y="\u2753",v="high"):p>m?(f="critical",g=100+p,x="".concat(Math.round(p)," days overdue"),y="\ud83d\udea8",v="high",b="morning"):p>0?(f="high",g=70+p,x="".concat(Math.round(p)," ").concat(1===Math.round(p)?"day":"days"," overdue"),y="\u26a0\ufe0f",v="high"):i>=m-1?(f="medium",g=m-i+50,x="Due soon",y="\u23f0",v="medium"):h<60?(f="medium",g=60-h+40,x="Low completion rate (".concat(Math.round(h),"%)"),y="\ud83d\udcc9",v="medium"):l>60&&Math.abs(o-t.frequency)>1?(f="low",g=35,x="Frequency analysis suggests ".concat(Math.round(o)," days"),y="\ud83d\udd0d",v="low",b="afternoon"):(f="low",g=20,x="Routine preparation",y="\u2728",v="low",b="afternoon"),d<=2&&(g+=15),t.hasRecipe&&(g+=10),"majoneesit"===t.category||"kastikkeet"===t.category?b="morning":"proteiinit"===t.category?b="midday":"kasvikset"===t.category?b="afternoon":"marinointi"===t.category&&(b="morning"),{prep:t,reason:x,urgency:f,lastCompleted:r,daysSinceLastPrep:i,suggestedPriority:v,suggestedTimeSlot:b,icon:y,score:g,completionRate:h,avgDaysBetween:o,learnedFrequency:o,frequencyConfidence:l,dayPatterns:c}})).filter((e=>"overdue"===b?"critical"===e.urgency||"high"===e.urgency:"smart"!==b||e.score>=30)).sort(((e,t)=>t.score-e.score)).slice(0,j)}),[r,a,n,s,o,l,b,j,E]);return 0===F.length?null:(0,N.jsxs)("div",{className:"mb-6 rounded-xl overflow-hidden shadow-sm border border-orange-200",children:[(0,N.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 p-4 border-b border-orange-200",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("button",{onClick:()=>v(!y),className:"flex items-center space-x-3 text-left hover:text-orange-600 transition-colors group",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)(Ee,{className:"w-5 h-5 text-orange-600"}),(0,N.jsxs)("h4",{className:"font-semibold text-orange-800",children:["Smart Prep Suggestions",E&&(0,N.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full",children:"ADMIN"})]}),(0,N.jsx)("span",{className:"bg-orange-200 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:F.length})]}),(0,N.jsx)("span",{className:"transform transition-transform duration-200 ".concat(y?"rotate-180":"rotate-0"),children:(0,N.jsx)("svg",{className:"w-4 h-4 text-orange-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,N.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),y&&(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[E&&(0,N.jsxs)("button",{onClick:()=>S(!C),className:"flex items-center space-x-1 px-3 py-1 bg-purple-200 text-purple-800 rounded-lg hover:bg-purple-300 transition-colors text-xs font-medium",title:"View AI Learning Log",children:[(0,N.jsx)(Ae,{className:"w-3 h-3"}),(0,N.jsx)("span",{children:"Learning Log"})]}),(0,N.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"text-xs bg-white border border-orange-300 rounded-lg px-2 py-1 text-orange-700 focus:ring-2 focus:ring-orange-500",children:[(0,N.jsx)("option",{value:"smart",children:"Smart"}),(0,N.jsx)("option",{value:"overdue",children:"Overdue Only"}),(0,N.jsx)("option",{value:"all",children:"All"})]}),(0,N.jsxs)("button",{onClick:()=>{F.slice(0,3).forEach((e=>{let{prep:t,suggestedPriority:n,suggestedTimeSlot:s}=e;O(t)||(c(t),setTimeout((()=>{d(t,"priority",n,"suggested"),setTimeout((()=>{d(t,"timeSlot",s,"suggested")}),100)}),100))}))},className:"flex items-center space-x-1 px-3 py-1 bg-orange-200 text-orange-800 rounded-lg hover:bg-orange-300 transition-colors text-xs font-medium",title:"Auto-apply top 3 suggestions",children:[(0,N.jsx)(De,{className:"w-3 h-3"}),(0,N.jsx)("span",{children:"Auto-Apply"})]})]})]}),y&&(0,N.jsx)("div",{className:"mt-2 text-xs text-orange-700",children:(0,N.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,N.jsx)(Pe,{className:"w-3 h-3"}),(0,N.jsxs)("span",{children:["AI-powered suggestions with hybrid frequency learning from ",a.filter((e=>e.completed)).length," completions"]})]})})]}),E&&C&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,N.jsx)(Re,{className:"w-5 h-5 text-purple-600"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"AI Learning Log"}),(0,N.jsx)("p",{className:"text-sm text-gray-600",children:"Frequency optimization analysis"})]})]}),(0,N.jsx)("button",{onClick:()=>S(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"\u2715"})]}),(0,N.jsx)("div",{className:"p-6",children:0===I.length?(0,N.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,N.jsx)(Re,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,N.jsx)("p",{children:"No learning data yet. AI will start analyzing patterns as you complete more preps."})]}):(0,N.jsx)("div",{className:"space-y-4",children:I.map(((e,t)=>(0,N.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-800",children:e.prepName}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.confidence>80?"bg-green-100 text-green-700":e.confidence>60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.confidence,"% confidence"]}),(0,N.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Recommended:"}),(0,N.jsxs)("div",{className:"font-medium",children:["Every ",e.recommendedFreq," days"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"text-gray-600",children:"AI Learned:"}),(0,N.jsxs)("div",{className:"font-medium text-blue-600",children:["Every ",e.learnedFreq," days"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Data Points:"}),(0,N.jsxs)("div",{className:"font-medium",children:[e.dataPoints," completions"]})]})]}),(0,N.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:e.reason})]},t)))})})]})}),y&&(0,N.jsxs)("div",{className:"bg-white p-4 space-y-3",children:[F.map((e=>{var t,n,r,a;let{prep:o,reason:l,urgency:h,daysSinceLastPrep:y,icon:v,score:b,completionRate:w,suggestedPriority:j,suggestedTimeSlot:k,learnedFrequency:C,frequencyConfidence:S}=e;const I=O(o),T=(e=>{const t="".concat(L(s),"-").concat(e.id);return i[t]||{priority:"medium",timeSlot:"",selected:!1}})(o),A={low:"text-blue-800",medium:"text-yellow-800",high:"text-orange-800",critical:"text-red-800"};return(0,N.jsx)("div",{className:"rounded-lg border-2 transition-all duration-200 hover:shadow-md ".concat(I?"border-green-400 bg-green-50 shadow-sm":{low:"border-blue-300 bg-blue-50",medium:"border-yellow-300 bg-yellow-50",high:"border-orange-400 bg-orange-50",critical:"border-red-400 bg-red-50"}[h]),children:(0,N.jsx)("div",{className:"p-3 md:p-4",children:(0,N.jsxs)("div",{className:"space-y-3 md:space-y-0 md:flex md:items-center md:justify-between",children:[(0,N.jsxs)("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-0.5",children:[(0,N.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(I?R(T.priority):M(h))}),(0,N.jsx)("button",{onClick:()=>c(o),className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ".concat(I?"bg-green-500 border-green-500":"critical"===h?"border-red-400 hover:border-red-500":"high"===h?"border-orange-400 hover:border-orange-500":"border-gray-400 hover:border-gray-500"),children:I&&(0,N.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,N.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),(0,N.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsx)("h5",{className:"font-semibold text-base md:text-lg ".concat(I?"text-green-900":A[h]),children:o.name}),o.hasRecipe&&(0,N.jsx)("button",{onClick:()=>o.recipe&&u(o.recipe,o.name),className:"flex-shrink-0 text-sm bg-green-100 text-green-700 px-2 py-1 rounded-full hover:bg-green-200 transition-colors",children:"\ud83d\udcd6 Recipe"})]}),(0,N.jsxs)("div",{className:"text-sm text-gray-600 space-y-1 md:space-y-0",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("span",{className:"font-medium",children:o.estimatedTime}),(0,N.jsx)("span",{children:"\u2022"}),(0,N.jsx)("span",{className:"capitalize",children:o.category}),(0,N.jsx)("span",{children:"\u2022"}),(0,N.jsxs)("span",{children:["Every ",o.frequency," days"]})]}),C>0&&S>60&&(0,N.jsxs)("div",{className:"text-blue-600 text-xs",children:["AI learned: Every ",C," days (",S,"% confidence)"]})]}),(0,N.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,N.jsx)("div",{className:"text-sm font-medium ".concat(A[h]),children:l}),y<999&&(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:["Last done: ",y," days ago"]}),w>0&&(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:[Math.round(w),"% completion rate",E&&" (Score: ".concat(b,")")]})]})]})]}),(0,N.jsx)("div",{className:"md:flex-shrink-0 md:ml-4",children:(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)("button",{onClick:()=>{m==="suggested-".concat(o.id)?x():g("suggested-".concat(o.id))},className:"w-full md:w-auto px-4 py-2 md:py-1.5 rounded-lg text-sm transition-colors font-medium ".concat(I?(null===(t=D.find((e=>e.id===T.priority)))||void 0===t?void 0:t.color)+" shadow-sm":"timeSlot"===f[o.id]?"bg-green-100 text-green-700 shadow-sm":"critical"===h?"bg-red-100 text-red-700 hover:bg-red-200":"high"===h?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:I?"".concat(null===(n=D.find((e=>e.id===T.priority)))||void 0===n?void 0:n.name).concat(T.timeSlot?" \u2022 ".concat(null===(r=P.find((e=>e.id===T.timeSlot)))||void 0===r?void 0:r.name.split(" ")[0]):" \u2022 Anytime"):"timeSlot"===f[o.id]?"Choose Time Slot":"Assign ".concat(j.charAt(0).toUpperCase()+j.slice(1)," Priority")}),m==="suggested-".concat(o.id)&&(0,N.jsx)("div",{className:"dropdown-container absolute top-full right-0 mt-2 rounded-xl p-3 z-20 w-52 backdrop-filter backdrop-blur-lg bg-white/95 border border-white/30 shadow-xl",children:(0,N.jsx)("div",{className:"space-y-3",children:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,N.jsx)(Me,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,N.jsx)("span",{children:"Choose Priority"}),(0,N.jsxs)("span",{className:"ml-auto text-xs text-green-600",children:["Suggested: ",j]})]}),(0,N.jsx)("div",{className:"space-y-2",children:D.map((e=>(0,N.jsx)("button",{onClick:()=>d(o,"priority",e.id,"suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 backdrop-filter backdrop-blur-sm border border-white/20 ".concat(e.color," ").concat(e.id===j?"ring-2 ring-green-400":""),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,N.jsx)("span",{className:"text-xs opacity-70",children:e.icon}),e.id===j&&(0,N.jsx)(_,{className:"w-3 h-3 text-green-500"})]})]})},e.id)))})]})})}),p==="suggested-".concat(o.id)&&(0,N.jsx)("div",{className:"dropdown-container absolute top-full right-0 mt-2 rounded-xl p-3 z-20 w-64 backdrop-filter backdrop-blur-lg bg-white/95 border border-white/30 shadow-xl",children:(0,N.jsx)("div",{className:"space-y-3",children:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,N.jsx)(Le,{className:"w-4 h-4 mr-2 text-green-500"}),(0,N.jsx)("span",{children:"Choose Time Slot"}),(0,N.jsxs)("span",{className:"ml-auto text-xs text-green-600",children:["Suggested: ",null===(a=P.find((e=>e.id===k)))||void 0===a?void 0:a.name.split(" ")[0]]})]}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)("button",{onClick:()=>d(o,"timeSlot","","suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-gray-50 text-gray-700 hover:bg-gray-100 backdrop-filter backdrop-blur-sm border border-white/20",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"Anytime"}),(0,N.jsx)("span",{className:"text-xs opacity-70",children:"\ud83d\udd50"})]})}),P.map((e=>(0,N.jsx)("button",{onClick:()=>d(o,"timeSlot",e.id,"suggested"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 bg-blue-50 text-blue-700 hover:bg-blue-100 backdrop-filter backdrop-blur-sm border border-white/20 ".concat(e.id===k?"ring-2 ring-green-400":""),children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:e.name.split(" ")[0]}),(0,N.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,N.jsx)("span",{className:"text-xs opacity-70",children:e.icon}),e.id===k&&(0,N.jsx)(_,{className:"w-3 h-3 text-green-500"})]})]})},e.id)))]})]})})})]})})]})})},"suggested-".concat(o.id))})),(0,N.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,N.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,N.jsx)(Ee,{className:"w-3 h-3"}),(0,N.jsx)("span",{children:"Hybrid frequency learning"})]}),(0,N.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,N.jsx)(h,{className:"w-3 h-3"}),(0,N.jsxs)("span",{children:["Based on ",a.filter((e=>e.completed)).length," completions"]})]}),E&&(0,N.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,N.jsx)(Oe,{className:"w-3 h-3"}),(0,N.jsx)("span",{children:"Admin mode active"})]})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("span",{children:"Show:"}),(0,N.jsxs)("select",{value:j,onChange:e=>k(Number(e.target.value)),className:"bg-transparent border border-gray-300 rounded px-2 py-1 text-xs",children:[(0,N.jsx)("option",{value:3,children:"3"}),(0,N.jsx)("option",{value:5,children:"5"}),(0,N.jsx)("option",{value:10,children:"10"})]})]})]})})]})]})},Ue=t=>{let{currentUser:n,connectionStatus:r,prepItems:a,scheduledPreps:i,prepSelections:o,setPrepItems:l,setScheduledPreps:c,setPrepSelections:d,quickSave:h}=t;const[m,f]=(0,e.useState)("today"),[g,x]=(0,e.useState)((()=>new Date)),[y,w]=(0,e.useState)(new Date),[j,k]=(0,e.useState)(!1),[_,C]=(0,e.useState)(""),[S,I]=(0,e.useState)("all"),[T,E]=(0,e.useState)(!1),[A,D]=(0,e.useState)(""),[P,R]=(0,e.useState)(!1),[M,L]=(0,e.useState)({ingredients:"",instructions:""}),[O,F]=(0,e.useState)(!1),[U,z]=(0,e.useState)(null),[q,W]=(0,e.useState)(""),[B,V]=(0,e.useState)(null),[K,Y]=(0,e.useState)(null),[Q,$]=(0,e.useState)({}),[G,J]=(0,e.useState)(!0),[Z,X]=(0,e.useState)(0),[ee,te]=(0,e.useState)(!1),[ne,se]=(0,e.useState)(!1),[re,ae]=(0,e.useState)(!1);(0,e.useEffect)((()=>{const e=()=>{var e,t,n;const s=document.querySelector(".bg-red-100.text-red-700"),r=s&&(null===(e=s.textContent)||void 0===e?void 0:e.includes("Admin Mode")),a=document.querySelector(".bg-white.border-b"),i=a&&((null===(t=a.textContent)||void 0===t?void 0:t.includes("Admin Panel"))||(null===(n=a.textContent)||void 0===n?void 0:n.includes("Daily Reports"))),o=document.querySelector('[title="Logout Admin"]'),l=r||i||!!o;ae(l),l!==re&&console.log("\ud83d\udd27 Admin mode detected:",{hasAdminBadge:!!r,hasAdminTabs:!!i,hasLogoutButton:!!o,isAdmin:l})};e();const t=setInterval(e,500);return()=>clearInterval(t)}),[re]),(0,e.useEffect)((()=>{if(0===a.length){const e=[{id:1,name:"Valkosipulimajoneesi",category:"majoneesit",estimatedTime:"15 min",isCustom:!1,hasRecipe:!0,frequency:3,recipe:{ingredients:"\u2022 **1 cup** majoneesi\n\u2022 **3-4** valkosipulin kyntt\xe4, hienoksi hakattuna\n\u2022 **1 rkl** sitruunamehua\n\u2022 **Suolaa** ja **mustapippuria** maun mukaan",instructions:"1. **Sekoita**: Yhdist\xe4 majoneesi ja hienonnettu valkosipuli\n2. **Mausta**: Lis\xe4\xe4 sitruunamehu, suola ja pippuri\n3. **Anna maustua**: Anna seisoa j\xe4\xe4kaapissa v\xe4hint\xe4\xe4n 30 minuuttia\n4. **Tarkista maku**: S\xe4\xe4d\xe4 mausteita tarpeen mukaan"}},{id:2,name:"Chilimajoneesi",category:"majoneesit",estimatedTime:"10 min",isCustom:!1,hasRecipe:!0,frequency:4,recipe:{ingredients:"\u2022 **1 cup** majoneesi\n\u2022 **2-3 rkl** sriracha-kastiketta\n\u2022 **1 tl** hunajaa\n\u2022 **1 tl** limemehua",instructions:"1. **Yhdist\xe4**: Sekoita majoneesi ja sriracha-kastike\n2. **Makeutus**: Lis\xe4\xe4 hunaja ja limemehu\n3. **Sekoita hyvin**: Varmista tasainen sekoitus\n4. **Maista ja s\xe4\xe4d\xe4**: Lis\xe4\xe4 chilimakua tai hunajaa tarpeen mukaan"}},{id:3,name:"Kev\xe4tsipulimajoneesi",category:"majoneesit",estimatedTime:"10 min",isCustom:!1,hasRecipe:!1,frequency:3,recipe:null},{id:4,name:"Bad Santa -majoneesi",category:"majoneesit",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:5,name:"Manse-majoneesi",category:"majoneesit",estimatedTime:"12 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:6,name:"Marinoitu kana",category:"proteiinit",estimatedTime:"30 min",isCustom:!1,hasRecipe:!0,frequency:2,recipe:{ingredients:"\u2022 **4** kananfileet\xe4\n\u2022 **1/4 cup** oliivi\xf6ljy\xe4\n\u2022 **2 rkl** sitruunamehua\n\u2022 **3** valkosipulin kyntt\xe4, murskattuna\n\u2022 **1 tl** kuivattuja yrttej\xe4\n\u2022 **Suolaa** ja **pippuria**",instructions:"1. **Valmista marinade**: Sekoita \xf6ljy, sitruunamehu, valkosipuli ja yrtit\n2. **Mausta kana**: Hiero kanaan suolaa ja pippuria\n3. **Marinoi**: Laita kana marinadiin 2-4 tunniksi\n4. **Huoneenl\xe4mp\xf6**: Anna tulla huoneenl\xe4mp\xf6\xf6n ennen kypsennyst\xe4"}},{id:7,name:"Lihapullat",category:"proteiinit",estimatedTime:"45 min",isCustom:!1,hasRecipe:!0,frequency:3,recipe:{ingredients:"\u2022 **500g** jauhelihaa\n\u2022 **1** sipuli, hienoksi hakattuna\n\u2022 **1** muna\n\u2022 **1/2 cup** korppujauhoja\n\u2022 **Suolaa**, **pippuria**, **mausteet**",instructions:"1. **Sekoita**: Yhdist\xe4 kaikki ainekset kulhossa\n2. **Muotoile**: Tee tasakokoisia palloja\n3. **Kypsenn\xe4**: Paista pannulla tai uunissa\n4. **Valmista**: Kypsyys 65\xb0C sis\xe4l\xe4mp\xf6tila"}},{id:8,name:"Tuoreet tomaatit (leikattu)",category:"kasvikset",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:1,recipe:null},{id:9,name:"Kev\xe4tsipuli",category:"kasvikset",estimatedTime:"10 min",isCustom:!1,hasRecipe:!1,frequency:2,recipe:null},{id:10,name:"Marinoitu punasipuli",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!0,frequency:4,recipe:{ingredients:"\u2022 **2** punasipulia, ohuksi viipaloiduna\n\u2022 **1/2 cup** valkoviinietikkaa\n\u2022 **2 rkl** sokeria\n\u2022 **1 tl** suolaa\n\u2022 **1** laakerinlehti",instructions:"1. **Liuota**: Sekoita etikka, sokeri ja suola\n2. **Sipulit**: Laita viipaloidut sipulit kulhoon\n3. **Kaada liuos**: Kaada kuuma liuos sipulien p\xe4\xe4lle\n4. **Anna marinoitua**: V\xe4hint\xe4\xe4n 30 minuuttia ennen k\xe4ytt\xf6\xe4"}},{id:11,name:"Pikkel\xf6ity punasipuli",category:"marinointi",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:12,name:"Pikkel\xf6ity tomaatti",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:13,name:"Pikkel\xf6ity kurkku",category:"marinointi",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:4,recipe:null},{id:14,name:"Paholaisen hillo",category:"marinointi",estimatedTime:"30 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:15,name:"Hapan omena -hillo",category:"marinointi",estimatedTime:"35 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:16,name:"Marinoitu punakaali",category:"marinointi",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:17,name:"Konjakki-sinappi",category:"kastikkeet",estimatedTime:"15 min",isCustom:!1,hasRecipe:!0,frequency:6,recipe:{ingredients:"\u2022 **1/2 cup** dijon-sinappia\n\u2022 **3 rkl** konjakkia\n\u2022 **1 rkl** hunajaa\n\u2022 **1 tl** valkosipulijauhetta",instructions:"1. **Sekoita**: Yhdist\xe4 sinappi ja konjakki\n2. **Makeutus**: Lis\xe4\xe4 hunaja ja valkosipulijauhe\n3. **Sekoita hyvin**: Varmista tasainen sekoitus\n4. **Anna vet\xe4yty\xe4**: S\xe4ilyt\xe4 j\xe4\xe4kaapissa k\xe4ytt\xf6\xf6n asti"}},{id:18,name:"BBQ-hunaja-sinappi",category:"kastikkeet",estimatedTime:"12 min",isCustom:!1,hasRecipe:!1,frequency:5,recipe:null},{id:19,name:"T\xe4yt\xe4 kylm\xe4vitriini",category:"muut",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:1,recipe:null},{id:20,name:"Vaihda \xf6ljy",category:"muut",estimatedTime:"15 min",isCustom:!1,hasRecipe:!1,frequency:7,recipe:null},{id:21,name:"Asiakasjuomakaappi kuntoon",category:"muut",estimatedTime:"25 min",isCustom:!1,hasRecipe:!1,frequency:2,recipe:null},{id:22,name:"Alkoholijuomakaappi kuntoon",category:"muut",estimatedTime:"20 min",isCustom:!1,hasRecipe:!1,frequency:3,recipe:null},{id:23,name:"Keit\xe4 smash-perunat",category:"muut",estimatedTime:"45 min",isCustom:!1,hasRecipe:!0,frequency:2,recipe:{ingredients:"\u2022 **1kg** pieni\xe4 perunoita\n\u2022 **Suolaa** keitinveteen\n\u2022 **Oliivi\xf6ljy\xe4**\n\u2022 **Rosmariinia**\n\u2022 **Merisuolaa**\n\u2022 **Mustapippuria**",instructions:"1. **Keit\xe4**: Keit\xe4 perunat kuoressa suolavedess\xe4 kypsiksi\n2. **Valuta**: Anna valua ja j\xe4\xe4hty\xe4 hieman\n3. **Smash**: Litist\xe4 perunat haarukalla kevyesti\n4. **Paista**: Paista uunissa 200\xb0C \xf6ljyss\xe4 ja mausteissa kultaisiksi"}}];l((()=>e)),h("prepItems",e)}}),[a.length,l,h]),(0,e.useEffect)((()=>{if(i.length>0&&!ee){console.log("\ud83d\udd04 Auto-saving scheduledPreps due to state change");const e=setTimeout((()=>{h("scheduledPreps",i).then((()=>{console.log("\u2705 ScheduledPreps auto-save completed")})).catch((e=>{console.error("\u274c ScheduledPreps auto-save failed:",e)}))}),300);return()=>clearTimeout(e)}}),[i,h,ee]),(0,e.useEffect)((()=>{const e=localStorage.getItem("lastPrepMoveCheck"),t=we(new Date);e!==t&&((()=>{const e=new Date,t=new Date(e);t.setDate(t.getDate()-1);const n=we(e),r=we(t),a=i.filter((e=>e.scheduledDate===r&&!e.completed));if(a.length>0){console.log("\ud83d\udd04 Moving ".concat(a.length," incomplete preps from ").concat(r," to ").concat(n)),X(a.length),setTimeout((()=>X(0)),8e3);const t=a.map((e=>(0,s.A)((0,s.A)({},e),{},{id:ke(),scheduledDate:n})));c((e=>[...e.filter((e=>!(e.scheduledDate===r&&!e.completed))),...t]));const i={};a.forEach((t=>{const n=Ne(e,t.prepId);i[n]={priority:t.priority,timeSlot:t.timeSlot,selected:!0}})),d((e=>(0,s.A)((0,s.A)({},e),i)))}})(),localStorage.setItem("lastPrepMoveCheck",t))}),[i,d,c]);const ie=async e=>{if(console.log("\ud83d\udd04 Toggling prep completion for ID:",e),ee)console.log("\u23f3 Save in progress, skipping...");else{te(!0),se(!0);try{const t=i.find((t=>t.id===e));if(!t)return void console.error("\u274c Prep item not found:",e);const n=!t.completed;console.log("\ud83d\udccb ".concat(t.name,": ").concat(t.completed?"COMPLETED":"PENDING"," \u2192 ").concat(n?"COMPLETED":"PENDING")),console.log("\ud83d\udee1\ufe0f SYNC PAUSED during save operation");const r=i.map((t=>t.id===e?(0,s.A)((0,s.A)({},t),{},{completed:n}):t)),a=we(new Date),o=r.filter((e=>e.scheduledDate===a)),l=o.filter((e=>e.completed));console.log("\ud83d\udce4 About to save scheduledPreps:",{totalCount:r.length,todayCount:o.length,todayCompletedCount:l.length,updatedItem:{id:e,name:t.name,completed:n,scheduledDate:t.scheduledDate}}),c((()=>r)),console.log("\ud83d\udd25 Saving prep completion to Firebase...");await h("scheduledPreps",r)?(console.log("\u2705 Prep completion saved successfully"),setTimeout((async()=>{se(!1),console.log("\ud83d\udd04 SYNC RESUMED after save completion");try{const t=await fetch("https://hamptown-panel-default-rtdb.firebaseio.com/scheduledPreps.json"),s=await t.json();if(s){const t=s.filter((e=>e.scheduledDate===a)),r=t.filter((e=>!0===e.completed)),i=s.find((t=>t.id===e));console.log("\ud83d\udd0d Firebase verification after save:",{firebaseTotalCount:s.length,firebaseTodayCount:t.length,firebaseTodayCompleted:r.length,firebaseUpdatedItem:i?{id:i.id,name:i.name,completed:i.completed,scheduledDate:i.scheduledDate}:"NOT FOUND"}),i&&i.completed===n?console.log("\u2705 Save verification passed"):console.error("\u274c SAVE VERIFICATION FAILED! Item not found or completion status mismatch")}else console.error("\u274c No data found in Firebase during verification")}catch(t){console.warn("\u26a0\ufe0f Failed to verify save:",t)}}),3e3)):(console.error("\u274c Failed to save prep completion to Firebase"),c((()=>i)),se(!1))}catch(t){console.error("\u274c Error toggling prep completion:",t),c((()=>i)),se(!1)}finally{te(!1)}}},oe=e=>{var t;const n=Ne(g,e.id);return(null===(t=o[n])||void 0===t?void 0:t.selected)||!1},le=e=>{const t=Ne(g,e.id);return o[t]||{priority:"medium",timeSlot:"",selected:!1}},ce=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";const a=Ne(g,e.id),l=o[a]||{priority:"medium",timeSlot:"",selected:!1};if("priority"===t){d((e=>(0,s.A)((0,s.A)({},e),{},{[a]:(0,s.A)((0,s.A)({},e[a]),{},{priority:n,selected:l.selected})}))),$((t=>(0,s.A)((0,s.A)({},t),{},{[e.id]:"timeSlot"}))),V(null);const t="suggested"===r?"suggested-".concat(e.id):e.id;Y(t)}else if("timeSlot"===t){const t={priority:l.priority,timeSlot:n,selected:!0};d((e=>(0,s.A)((0,s.A)({},e),{},{[a]:t})));if(i.find((t=>t.prepId===e.id&&t.scheduledDate===we(g))))c((r=>r.map((r=>r.prepId===e.id&&r.scheduledDate===we(g)?(0,s.A)((0,s.A)({},r),{},{priority:t.priority,timeSlot:n}):r))));else{const s={id:ke(),prepId:e.id,name:e.name,category:e.category,estimatedTime:e.estimatedTime,isCustom:e.isCustom,hasRecipe:e.hasRecipe,recipe:e.recipe,scheduledDate:we(g),priority:t.priority,timeSlot:n,completed:!1,assignedTo:null,notes:""};c((e=>[...e,s]))}$((t=>(0,s.A)((0,s.A)({},t),{},{[e.id]:null}))),V(null),Y(null)}},de=()=>{V(null),Y(null),$({})};(0,e.useEffect)((()=>{const e=e=>{e.target.closest(".dropdown-container")||de()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const ue=(e,t)=>{z(e),W(t),F(!0)},he=e=>{var t;const n=Ne(g,e.id);if(null===(t=o[n])||void 0===t?void 0:t.selected)d((e=>{const t=(0,s.A)({},e);return delete t[n],t})),c((t=>t.filter((t=>!(t.prepId===e.id&&t.scheduledDate===we(g))))));else{const t=i.find((t=>t.prepId===e.id&&t.scheduledDate===we(g)));if(t)d((e=>(0,s.A)((0,s.A)({},e),{},{[n]:{priority:t.priority,timeSlot:t.timeSlot,selected:!0}})));else{const t={priority:"medium",timeSlot:"",selected:!0};d((e=>(0,s.A)((0,s.A)({},e),{},{[n]:t})));const r={id:ke(),prepId:e.id,name:e.name,category:e.category,estimatedTime:e.estimatedTime,isCustom:e.isCustom,hasRecipe:e.hasRecipe,recipe:e.recipe,scheduledDate:we(g),priority:"medium",timeSlot:"",completed:!1,assignedTo:null,notes:""};c((e=>[...e,r]))}}},me=a.filter((e=>{const t="all"===S||e.category===S,n=""===A||e.name.toLowerCase().includes(A.toLowerCase())||e.category.toLowerCase().includes(A.toLowerCase());return t&&n}));return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n.priority-glow {\n  position: relative;\n  z-index: 0;\n  font-weight: 600;\n  border-radius: 0.25rem;\n  padding: 0.125rem 0.25rem;\n}\n.priority-glow::before {\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 110%;\n  height: 2em;\n  transform: translate(-50%, -50%);\n  border-radius: 0.375rem;\n  filter: blur(6px);\n  z-index: -1;\n  opacity: 0.3;\n}\n.priority-low {\n  color: #047857;\n}\n.priority-low::before {\n  box-shadow: 0 0 8px 4px rgba(5, 150, 105, 0.4);\n}\n.priority-medium {\n  color: #92400e;\n}\n.priority-medium::before {\n  box-shadow: 0 0 8px 4px rgba(202, 138, 4, 0.4);\n}\n.priority-high {\n  color: #b91c1c;\n}\n.priority-high::before {\n  box-shadow: 0 0 8px 4px rgba(185, 28, 28, 0.4);\n}\n\n.soft-dropdown {\n  backdrop-filter: blur(16px);\n  background: rgba(255, 255, 255, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15),\n              0 0 0 1px rgba(255, 255, 255, 0.05),\n              inset 0 1px 0 rgba(255, 255, 255, 0.1);\n}\n\n.soft-button {\n  backdrop-filter: blur(8px);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),\n              inset 0 1px 0 rgba(255, 255, 255, 0.1);\n}\n\n.soft-button:hover {\n  backdrop-filter: blur(12px);\n  box-shadow: 0 8px 15px -3px rgba(0, 0, 0, 0.1),\n              inset 0 1px 0 rgba(255, 255, 255, 0.2);\n}\n'}}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(p,{className:"w-8 h-8 text-blue-600 mr-3"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Prep List Manager"}),(0,N.jsx)("p",{className:"text-gray-600",children:"Plan and track kitchen preparation tasks"})]})]}),(0,N.jsx)("div",{className:"flex items-center space-x-2"})]}),(0,N.jsxs)("div",{className:"flex space-x-2",children:[(0,N.jsxs)("button",{onClick:()=>f("today"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("today"===m?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,N.jsx)(u,{className:"w-4 h-4 mr-2"}),"Today's Preps"]}),(0,N.jsxs)("button",{onClick:()=>f("plan"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("plan"===m?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,N.jsx)(pe,{className:"w-4 h-4 mr-2"}),"Plan Preps"]}),(0,N.jsxs)("button",{onClick:()=>f("week"),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat("week"===m?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,N.jsx)(b,{className:"w-4 h-4 mr-2"}),"Week View"]})]})]}),Z>0&&(0,N.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"flex-shrink-0",children:(0,N.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,N.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,N.jsxs)("div",{className:"ml-3 flex-1",children:[(0,N.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"\ud83d\udcc5 Prep items moved to today"}),(0,N.jsxs)("div",{className:"mt-1 text-sm text-blue-600",children:[Z," incomplete prep",Z>1?"s":""," from yesterday ",Z>1?"have":"has"," been automatically moved to today's schedule."]})]}),(0,N.jsx)("div",{className:"flex-shrink-0",children:(0,N.jsx)("button",{onClick:()=>X(0),className:"text-blue-400 hover:text-blue-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})})]})}),"today"===m&&(0,N.jsxs)(N.Fragment,{children:[!!re&&(0,N.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsxs)("h4",{className:"font-medium text-blue-800",children:["\ud83d\udd0d Debug Info ",re?"(Admin Mode Active)":"(Development Mode)"]}),(0,N.jsxs)("div",{className:"flex gap-2",children:[!1,(0,N.jsx)("button",{onClick:async()=>{console.log("\ud83d\udd04 Manual Firebase check triggered");try{const e=await fetch("https://hamptown-panel-default-rtdb.firebaseio.com/scheduledPreps.json"),t=await e.json(),n=we(new Date),s=t?t.filter((e=>e.scheduledDate===n)):[];console.log("\ud83d\udd0d Manual Firebase check result:",{firebaseHasData:!!t,firebaseTotalCount:t?t.length:0,firebaseTodayCount:s.length,firebaseTodayCompleted:s.filter((e=>!0===e.completed)).length,localTodayCount:i.filter((e=>e.scheduledDate===n)).length,firebaseSample:s.slice(0,3)}),alert("Firebase Check:\nTotal: ".concat(t?t.length:0,"\nToday: ").concat(s.length,"\nCompleted: ").concat(s.filter((e=>!0===e.completed)).length))}catch(e){console.error("\u274c Manual Firebase check failed:",e),alert("Firebase check failed - see console")}},className:"px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600",children:"Check Firebase"}),(0,N.jsx)("button",{onClick:()=>{console.log("\ud83d\udd04 Manual reload triggered"),window.location.reload()},className:"px-3 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:"Force Reload"})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-blue-700",children:"Today's Date"}),(0,N.jsx)("div",{className:"text-blue-600",children:we(new Date)})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-blue-700",children:"Total Scheduled"}),(0,N.jsx)("div",{className:"text-blue-600",children:i.length})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-blue-700",children:"Today's Preps"}),(0,N.jsx)("div",{className:"text-blue-600",children:i.filter((e=>e.scheduledDate===we(new Date))).length})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-blue-700",children:"Connection"}),(0,N.jsx)("div",{className:"connected"===r?"text-green-600":"text-red-600",children:r})]})]}),(0,N.jsxs)("div",{className:"mt-3",children:[(0,N.jsx)("div",{className:"font-medium text-blue-700 mb-1",children:"All Scheduled Dates:"}),(0,N.jsx)("div",{className:"text-blue-600 text-xs",children:Array.from(new Set(i.map((e=>e.scheduledDate)))).sort().join(", ")||"None"})]}),i.length>0&&(0,N.jsxs)("div",{className:"mt-2",children:[(0,N.jsx)("div",{className:"font-medium text-blue-700 mb-1",children:"Sample Preps:"}),(0,N.jsx)("div",{className:"text-blue-600 text-xs",children:i.slice(0,3).map((e=>"".concat(e.name," (").concat(e.scheduledDate,")").concat(e.completed?" \u2705":" \u23f3"))).join(" | ")})]})]}),(0,N.jsx)(Ce,{scheduledPreps:i,onToggleCompletion:ie,onShowRecipe:ue})]}),"plan"===m&&(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Select Date to Plan"}),(0,N.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,N.jsx)("input",{type:"date",value:we(g),onChange:e=>x(new Date(e.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),(0,N.jsxs)("div",{className:"text-gray-600",children:["Planning for: ",(0,N.jsx)("strong",{children:(fe=g,fe.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Choose Prep Items"}),(0,N.jsxs)("button",{onClick:()=>E(!T),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(T?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),children:[(0,N.jsx)(xe,{className:"w-4 h-4 mr-2"}),"Search"]})]}),T&&(0,N.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)(xe,{className:"w-5 h-5 text-gray-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search prep items...",value:A,onChange:e=>D(e.target.value),className:"flex-1 px-3 py-2 border-0 bg-transparent focus:outline-none",autoFocus:!0}),A&&(0,N.jsx)("button",{onClick:()=>D(""),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-4 h-4"})})]})}),(0,N.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:ye.map((e=>(0,N.jsxs)("button",{onClick:()=>I(e.id),className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(S===e.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,N.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))}),(0,N.jsx)(Fe,{currentDate:y,selectedDate:g,prepItems:a,scheduledPreps:i,prepSelections:o,selectedCategory:S,searchQuery:A,onToggleSelection:he,onUpdateSelection:ce,onShowRecipe:ue,showPriorityOptions:B,showTimeOptions:K,assignmentStep:Q,onShowPriorityOptions:V,onResetWorkflow:de}),(0,N.jsx)("div",{className:"space-y-3",children:me.map((e=>(0,N.jsx)(Ie,{prep:e,isSelected:oe(e),selection:le(e),showPriorityOptions:B,showTimeOptions:K,assignmentStep:Q,onToggleSelection:he,onUpdateSelection:ce,onShowPriorityOptions:V,onShowRecipe:ue,onSave:(e,t)=>{console.log("Save clicked for prep:",e,t)},context:"main"},e.id)))}),(0,N.jsx)("div",{className:"mt-6 pt-6 border-t",children:j?(0,N.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,N.jsx)("h4",{className:"font-medium text-gray-800 mb-4",children:"Add Custom Prep"}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prep Name"}),(0,N.jsx)("input",{type:"text",value:_,onChange:e=>C(e.target.value),placeholder:"e.g., Prep special sauce",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,N.jsx)("select",{value:"all"===S?"majoneesit":S,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:ye.slice(1).map((e=>(0,N.jsx)("option",{value:e.id,children:e.name},e.id)))})]})]}),(0,N.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,N.jsx)("button",{onClick:()=>{if(!_.trim())return;const e={id:Date.now(),name:_.trim(),category:"all"===S?"majoneesit":S,estimatedTime:"20 min",isCustom:!0,hasRecipe:P,frequency:2,recipe:P?{ingredients:M.ingredients,instructions:M.instructions}:null};l((t=>[...t,e])),C(""),k(!1),R(!1),L({ingredients:"",instructions:""}),I("majoneesit"),he(e)},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Add Prep"}),(0,N.jsx)("button",{onClick:()=>{k(!1),C(""),R(!1),L({ingredients:"",instructions:""}),I("majoneesit")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):(0,N.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center px-4 py-2 border border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:text-blue-500 transition-colors",children:[(0,N.jsx)(H,{className:"w-4 h-4 mr-2"}),"Add Custom Prep Item"]})})]})]}),"week"===m&&(0,N.jsx)(Se,{scheduledPreps:i,currentDate:y,setCurrentDate:w,selectedDate:g,setSelectedDate:x,setActiveView:f,onToggleCompletion:ie,onShowRecipe:ue}),(0,N.jsx)(Te,{isOpen:O,recipe:U,recipeName:q,onClose:()=>F(!1)})]});var fe},ze=o("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),qe=o("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),We=o("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Be=o("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),Ve=(e,t)=>{if(!e)return"\u2753";if(t){const n=t.find((t=>t.name===e||t.id===e));if(n)return n.icon}switch(e){case"produce":return"\ud83e\udd6c";case"meat":return"\ud83e\udd69";case"dairy":return"\ud83e\udd5b";case"bread":return"\ud83c\udf5e";case"beverages":return"\ud83e\udd64";case"cooking":return"\ud83e\uded2";case"baking":case"grains":return"\ud83c\udf3e";case"cleaning":return"\ud83e\uddfd";case"supplies":case"packaging":return"\ud83d\udce6";case"tukku":return"\ud83c\udfea";case"uncategorized":return"\u2753";default:return"\ud83d\udccb"}},He=e=>0===e.currentStock||e.currentStock<=.5*e.minLevel?{status:"critical",color:"red"}:e.currentStock<=e.minLevel?{status:"low",color:"yellow"}:{status:"normal",color:"green"},Ke=e=>{if("undefined"===typeof window)return;if(!document.getElementById("toastContainer")){const e=document.createElement("div");e.id="toastContainer",e.className="fixed top-4 right-4 z-50 space-y-2",document.body.appendChild(e)}const t=document.getElementById("toastContainer"),n=document.createElement("div");n.className="toast bg-white/90 backdrop-blur-sm text-black p-3 mb-2 rounded-lg shadow-lg border transform transition-all duration-300 translate-x-0 opacity-100",n.textContent=e,t.appendChild(n),requestAnimationFrame((()=>{n.classList.add("animate-slide-in")})),setTimeout((()=>{n.classList.add("opacity-0","translate-x-full"),n.addEventListener("transitionend",(()=>{n.parentNode&&n.remove()}))}),3e3)};let Ye=0;const Qe=()=>{Ye>=1e5&&(Ye=0);return 1e5*Math.floor(Date.now()/1e3)+ ++Ye},$e=[{id:"produce",name:"Produce",icon:"\ud83e\udd6c",color:"#10B981"},{id:"meat",name:"Meat & Fish",icon:"\ud83e\udd69",color:"#EF4444"},{id:"dairy",name:"Dairy",icon:"\ud83e\udd5b",color:"#3B82F6"},{id:"bread",name:"Bread & Bakery",icon:"\ud83c\udf5e",color:"#F59E0B"},{id:"beverages",name:"Beverages",icon:"\ud83e\udd64",color:"#8B5CF6"},{id:"cooking",name:"Cooking Ingredients",icon:"\ud83e\uded2",color:"#F97316"},{id:"baking",name:"Baking Supplies",icon:"\ud83c\udf3e",color:"#D97706"},{id:"grains",name:"Grains & Rice",icon:"\ud83c\udf3e",color:"#F59E0B"},{id:"cleaning",name:"Cleaning Supplies",icon:"\ud83e\uddfd",color:"#6B7280"},{id:"supplies",name:"General Supplies",icon:"\ud83d\udce6",color:"#6B7280"},{id:"packaging",name:"Packaging",icon:"\ud83d\udce6",color:"#6B7280"},{id:"tukku",name:"Tukku (Wholesale)",icon:"\ud83c\udfea",color:"#4F46E5"}],Ge=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...$e.map((e=>({value:e.id,label:"".concat(e.icon," ").concat(e.name),icon:e.icon,isCustom:!1}))),...e.map((e=>({value:e.id,label:"".concat(e.icon," ").concat(e.name),icon:e.icon,isCustom:!0})))]},Je=(0,e.createContext)(void 0),Ze=()=>{const t=(0,e.useContext)(Je);if(!t)throw new Error("useInventory must be used within an InventoryProvider");return t},Xe=t=>{let{children:n,inventoryDailyItems:r,inventoryWeeklyItems:a,inventoryMonthlyItems:i,inventoryDatabaseItems:o,inventoryActivityLog:l,inventoryCustomCategories:c,setInventoryDailyItems:d,setInventoryWeeklyItems:u,setInventoryMonthlyItems:h,setInventoryDatabaseItems:m,setInventoryActivityLog:p,setInventoryCustomCategories:f,quickSave:g}=t;const x=r,y=a,v=i,b=o,w=l,j=c,[k,_]=(0,e.useState)(new Set),[C,S]=(0,e.useState)("daily"),I=(0,e.useCallback)((e=>{switch(e){case"daily":return x;case"weekly":return y;case"monthly":return v;default:return[]}}),[x,y,v]),T=(0,e.useCallback)(((e,t)=>{switch(e){case"daily":d(t),g("inventoryDailyItems",t);break;case"weekly":u(t),g("inventoryWeeklyItems",t);break;case"monthly":h(t),g("inventoryMonthlyItems",t)}}),[d,u,h,g]),E=(0,e.useCallback)((e=>{const t=[(0,s.A)((0,s.A)({},e),{},{id:Qe(),timestamp:(new Date).toLocaleString()}),...w];p(t),g("inventoryActivityLog",t)}),[w,p,g]),A=(0,e.useCallback)(((e,t,n,r,a)=>{const i=I(n),o=i.find((t=>t.id.toString()===e.toString()));if(!o)return void Ke("Item not found!");const l=o.currentStock,c=i.map((n=>n.id.toString()===e.toString()?(0,s.A)((0,s.A)({},n),{},{currentStock:t,lastUsed:(new Date).toISOString().split("T")[0]}):n));T(n,c),E({type:"count_update",item:o.name,quantity:t,unit:o.unit,employee:r,notes:a||"Count updated from ".concat(l," to ").concat(t)}),Ke("Successfully updated ".concat(o.name," count to ").concat(t," ").concat(o.unit,"!"))}),[E]),D=(0,e.useCallback)(((e,t,n,r,a,i)=>{const o=I(r),l=o.find((t=>t.id.toString()===e.toString()));if(!l)return void Ke("Item not found!");if(t>l.currentStock)return void Ke("Waste amount cannot exceed current stock!");const c=o.map((n=>n.id.toString()===e.toString()?(0,s.A)((0,s.A)({},n),{},{currentStock:n.currentStock-t}):n));T(r,c),E({type:"waste",item:l.name,quantity:t,unit:l.unit,employee:a,notes:i||"Waste reported: ".concat(n),reason:n}),Ke("Successfully reported waste of ".concat(t," ").concat(l.unit," ").concat(l.name,"!"))}),[E]),P=(0,e.useCallback)((e=>{console.log("Importing items:",e.length);const t=new Set(b.map((e=>e.id))),n=new Set,s=e.filter((e=>((t.has(e.id)||n.has(e.id))&&(console.warn("Duplicate ID detected, generating new ID for:",e.name),e.id=Qe()),n.add(e.id),!0)));console.log("Filtered unique items:",s.length);const r=[...b,...s];m(r),g("inventoryDatabaseItems",r),Ke("Imported ".concat(s.length," items to database")),E({type:"import",item:"Excel Import",quantity:s.length,unit:"items",employee:"System"})}),[b,m,g,E]),R=(0,e.useCallback)((e=>{const t=(0,s.A)((0,s.A)({},e),{},{id:Qe(),frequency:"database",isAssigned:!1}),n=[...b,t];m(n),g("inventoryDatabaseItems",n),Ke("Item added to database successfully"),E({type:"manual_add",item:e.name,quantity:1,unit:"item",employee:"Current User"})}),[b,m,g,E]),M=(0,e.useCallback)(((e,t,n,r,a)=>{const i=b.filter((t=>e.includes(t.id)));if(0===i.length)return void Ke("No items found to assign");const o=["daily","weekly","monthly"],l={};o.forEach((e=>{l[e]=I(e)}));const c=[];i.forEach((e=>{if(e.isAssigned){if(o.forEach((i=>{l[i].filter((t=>t.databaseId===e.id)).length>0&&(l[i]=i===t?l[i].map((t=>t.databaseId===e.id?(0,s.A)((0,s.A)({},t),{},{category:n,minLevel:r,currentStock:a,lastUsed:(new Date).toISOString().split("T")[0]}):t)):l[i].filter((t=>t.databaseId!==e.id)))})),e.assignedTo!==t){const t={id:Qe(),name:e.name,category:n,currentStock:a,minLevel:r,unit:e.unit||"pieces",lastUsed:(new Date).toISOString().split("T")[0],cost:e.cost||0,ean:e.ean||"",databaseId:e.id};c.push(t)}}else{const t={id:Qe(),name:e.name,category:n,currentStock:a,minLevel:r,unit:e.unit||"pieces",lastUsed:(new Date).toISOString().split("T")[0],cost:e.cost||0,ean:e.ean||"",databaseId:e.id};c.push(t)}})),c.length>0&&(l[t]=[...l[t],...c]),o.forEach((e=>{const t=I(e);l[e].length===t.length&&JSON.stringify(l[e])===JSON.stringify(t)||T(e,l[e])}));const d=b.map((r=>e.includes(r.id)?(0,s.A)((0,s.A)({},r),{},{isAssigned:!0,assignedTo:t,assignedCategory:n,assignedDate:(new Date).toISOString().split("T")[0]}):r));m(d),g("inventoryDatabaseItems",d),_(new Set),Ke("Successfully ".concat(i.some((e=>e.isAssigned))?"updated":"assigned"," ").concat(i.length," items to ").concat(t," - ").concat(n)),E({type:"manual_add",item:"".concat(i.length," items"),quantity:i.length,unit:"items",employee:"Current User",notes:"".concat(i.some((e=>e.isAssigned))?"Updated assignment to":"Assigned to"," ").concat(t," - ").concat(n)})}),[b,E,I,T,m,g]),L=(0,e.useCallback)((e=>{const t=b.find((t=>t.id===e));if(!t)return void Ke("Database item not found!");if(!t.isAssigned)return void Ke("Item is not currently assigned!");["daily","weekly","monthly"].forEach((t=>{const n=I(t),s=n.filter((t=>t.databaseId!==e));s.length!==n.length&&(T(t,s),console.log("Removed ".concat(n.length-s.length," duplicate(s) from ").concat(t)))}));const n=b.map((t=>t.id===e?(0,s.A)((0,s.A)({},t),{},{isAssigned:!1,assignedTo:void 0,assignedCategory:void 0,assignedDate:void 0}):t));m(n),g("inventoryDatabaseItems",n),Ke("Successfully unassigned ".concat(t.name," from inventory (removed all duplicates)"))}),[b]),O=(0,e.useCallback)((e=>{if(0===e.length)return;const t={};["daily","weekly","monthly"].forEach((n=>{const s=I(n).filter((t=>!e.includes(t.databaseId||"")));t[n]=s})),t.daily.length!==x.length&&d(t.daily),t.weekly.length!==y.length&&u(t.weekly),t.monthly.length!==v.length&&h(t.monthly);const n=b.filter((t=>!e.includes(t.id)));m(n);const s=[];t.daily.length!==x.length&&s.push(g("inventoryDailyItems",t.daily)),t.weekly.length!==y.length&&s.push(g("inventoryWeeklyItems",t.weekly)),t.monthly.length!==v.length&&s.push(g("inventoryMonthlyItems",t.monthly)),s.push(g("inventoryDatabaseItems",n)),Promise.allSettled(s).then((()=>{console.log("\u2705 All delete operations saved successfully")})).catch((e=>{console.warn("\u26a0\ufe0f Some delete operations failed to save:",e)})),_(new Set),Ke("Deleted ".concat(e.length," items from database"))}),[b,x.length,y.length,v.length,m,d,u,h,g]),F=(0,e.useCallback)((e=>{_((t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}))}),[]),U=(0,e.useCallback)((e=>{_((t=>{const n=new Set(t);return e.forEach((e=>n.add(e))),n}))}),[]),z=(0,e.useCallback)((()=>{_(new Set)}),[]),q=(0,e.useCallback)((()=>{let e=0;const t=new Set,n=b.map((n=>{if(t.has(n.id)){console.warn("Duplicate database ID detected:",n.id,"for item:",n.name);const r=Qe();return console.log("Assigned new ID:",r),e++,t.add(r),(0,s.A)((0,s.A)({},n),{},{id:r})}return t.add(n.id),n}));e>0&&(m(n),g("inventoryDatabaseItems",n)),["daily","weekly","monthly"].forEach((t=>{const n=I(t),s=new Set,r=n.filter((t=>t.databaseId&&s.has(t.databaseId)?(e++,!1):(t.databaseId&&s.add(t.databaseId),!0)));r.length!==n.length&&(T(t,r),console.log("Cleaned ".concat(n.length-r.length," duplicates from ").concat(t)))})),Ke(e>0?"Cleaned up ".concat(e," duplicate items from database and inventory"):"No duplicate items found")}),[b,m,g,I,T]),W=(0,e.useCallback)((e=>{S(e),_(new Set)}),[]),B=(0,e.useCallback)((e=>{const t=(0,s.A)((0,s.A)({},e),{},{id:Qe().toString(),createdAt:(new Date).toISOString(),isDefault:!1}),n=[...j,t];f(n),g("inventoryCustomCategories",n),Ke('Custom category "'.concat(e.name,'" created successfully')),E({type:"manual_add",item:"Custom Category: ".concat(e.name),quantity:1,unit:"category",employee:"Current User"})}),[j,f,g,E]),V=(0,e.useCallback)(((e,t)=>{const n=j.map((n=>n.id===e?t:n));f(n),g("inventoryCustomCategories",n),Ke('Category "'.concat(t.name,'" updated successfully'))}),[j,f,g]),H=(0,e.useCallback)((e=>{const t=j.find((t=>t.id===e));if(!t)return void Ke("Category not found");const n=j.filter((t=>t.id!==e));f(n),g("inventoryCustomCategories",n),Ke('Category "'.concat(t.name,'" deleted successfully')),E({type:"manual_add",item:"Deleted Category: ".concat(t.name),quantity:1,unit:"category",employee:"Current User"})}),[j,f,g,E]),K={dailyItems:x,weeklyItems:y,monthlyItems:v,databaseItems:b,activityLog:w,customCategories:j,selectedItems:k,currentTab:C,setDailyItems:d,setWeeklyItems:u,setMonthlyItems:h,setDatabaseItems:m,setActivityLog:p,setCustomCategories:f,addActivityEntry:E,updateItemStock:A,reportWaste:D,importFromExcel:P,addManualItem:R,assignToCategory:M,unassignFromCategory:L,cleanupDuplicates:q,deleteItems:O,toggleItemSelection:F,selectMultipleItems:U,clearSelection:z,switchTab:W,addCustomCategory:B,updateCustomCategory:V,deleteCustomCategory:H};return(0,N.jsx)(Je.Provider,{value:K,children:n})},et=o("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),tt=o("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),nt=o("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),st=t=>{let{onClose:n}=t;const{importFromExcel:s}=Ze(),[r,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1);(0,e.useEffect)((()=>{(async()=>{if(window.XLSX)u(!0);else{m(!0);try{const e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",e.async=!0,await new Promise(((t,n)=>{e.onload=t,e.onerror=n,document.head.appendChild(e)})),u(!0),console.log("SheetJS loaded successfully")}catch(e){console.error("Failed to load SheetJS:",e),Ke("Failed to load Excel parser. Please try refreshing the page.")}finally{m(!1)}}})()}),[]);const p=()=>{c(!1),o([])};return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 mx-4 ".concat(l?"max-w-4xl w-full max-h-[90vh] overflow-y-auto":"max-w-md w-full"),children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:l?"Preview Import Data":"Import Items from Excel"}),(0,N.jsx)("button",{onClick:l?p:n,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),l?(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)("div",{className:"flex items-center justify-between",children:(0,N.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,N.jsx)(We,{className:"w-5 h-5 mr-2"}),(0,N.jsxs)("span",{className:"font-medium",children:[i.length," items ready to import"]})]})}),(0,N.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto",children:[(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.slice(0,20).map(((e,t)=>(0,N.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,N.jsx)("div",{className:"font-medium text-sm text-gray-800 truncate",title:e.name,children:e.name}),(0,N.jsxs)("div",{className:"text-xs text-gray-500 space-y-1 mt-1",children:[e.ean&&(0,N.jsxs)("div",{children:["EAN: ",e.ean]}),e.unit&&(0,N.jsxs)("div",{children:["Unit: ",e.unit]}),e.cost&&e.cost>0&&(0,N.jsxs)("div",{children:["Price: \u20ac",e.cost.toFixed(2)]}),e.costWithTax&&e.costWithTax>0&&(0,N.jsxs)("div",{children:["Price (tax): \u20ac",e.costWithTax.toFixed(2)]})]})]},e.id)))}),i.length>20&&(0,N.jsxs)("div",{className:"text-center text-sm text-gray-500 mt-3",children:["... and ",i.length-20," more items"]})]}),(0,N.jsxs)("div",{className:"flex gap-4",children:[(0,N.jsxs)("button",{onClick:()=>{0!==i.length&&(s(i),Ke("Successfully imported ".concat(i.length," items!")),n())},className:"flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors",children:["Import ",i.length," Items"]}),(0,N.jsx)("button",{onClick:p,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):(0,N.jsxs)("div",{className:"space-y-4",children:[h&&(0,N.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),(0,N.jsx)("span",{className:"text-blue-700",children:"Loading Excel parser..."})]})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File"}),(0,N.jsx)("input",{type:"file",accept:".xls,.xlsx,.csv",onChange:async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)if(d){a(!0);try{console.log("Processing file:",n.name,"Type:",n.type,"Size:",n.size);const e=[".xls",".xlsx",".csv"],t=n.name.toLowerCase().substring(n.name.lastIndexOf("."));if(!e.includes(t))throw new Error("Invalid file type: ".concat(t,". Please use .xls, .xlsx, or .csv files."));if(n.size>10485760)throw new Error("File size too large. Please use files smaller than 10MB.");const s=await n.arrayBuffer();console.log("File loaded, size:",s.byteLength,"bytes");const r=window.XLSX.read(s,{type:"array",cellStyles:!0,cellFormulas:!1,cellDates:!0,cellNF:!1,sheetStubs:!1});if(console.log("Workbook loaded, sheets:",r.SheetNames),0===r.SheetNames.length)throw new Error("No sheets found in the Excel file");const a=r.SheetNames[0],i=r.Sheets[a];console.log("Processing sheet:",a);const l=window.XLSX.utils.sheet_to_json(i,{header:1,defval:null,blankrows:!1,raw:!1});if(console.log("Raw JSON data sample:",l.slice(0,3)),!l||0===l.length)throw new Error("Sheet appears to be empty");const d=(e=>{if(e.length<2)throw new Error("File appears to be empty or invalid");const t=e[0];console.log("Header row:",t);const n=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("tuotenimi")||t.includes("name")||t.includes("nimi")||t.includes("product")||t.includes("catentdesc")})),s=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("ean")||t.includes("barcode")})),r=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return"pmy"===t||t.includes("unit")||t.includes("yksikk\xf6")||t.includes("baseunit")||"baseunit_size"===t})),a=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("hinta veroton")||t.includes("price")&&!t.includes("tax")||t.includes("veroton")})),i=t.findIndex((e=>{if(!e)return!1;const t=e.toString().toLowerCase().trim();return t.includes("hinta verollinen")||t.includes("pricetax")||t.includes("hinta")&&t.includes("verollinen")}));if(console.log("Column mapping:",{nameIdx:n>=0?t[n]:"Not found",eanIdx:s>=0?t[s]:"Not found",unitIdx:r>=0?t[r]:"Not found",priceIdx:a>=0?t[a]:"Not found",priceTaxIdx:i>=0?t[i]:"Not found"}),-1===n)throw new Error('Could not find product name column. Expected columns containing "tuotenimi", "name", "nimi", or "product".');const o=e.slice(1).filter((e=>e&&e[n]&&e[n].toString().trim().length>0));console.log("Found ".concat(o.length," valid data rows out of ").concat(e.length-1," total rows"));const l=o.map(((e,t)=>{var o,l,c;return{id:Qe(),name:(null===(o=e[n])||void 0===o?void 0:o.toString().trim())||"",ean:-1!==s&&(null===(l=e[s])||void 0===l?void 0:l.toString().trim())||"",unit:-1!==r&&(null===(c=e[r])||void 0===c?void 0:c.toString().trim())||"",cost:-1!==a&&parseFloat(e[a])||0,costWithTax:-1!==i&&parseFloat(e[i])||0,type:"",frequency:"database"}})).filter((e=>e.name.length>0));return console.log("Successfully parsed ".concat(l.length," items")),l})(l);if(0===d.length)throw new Error("No valid items found in the file. Please check that your file has a header row and product names.");o(d),c(!0),Ke("Found ".concat(d.length," items. Review before importing."))}catch(s){console.error("Excel parsing error:",s);const e=s instanceof Error?s.message:"Unknown error occurred";Ke("Error reading file: "+e)}finally{a(!1),e.target.value=""}}else Ke("Excel parser is still loading. Please wait a moment and try again.")},disabled:r||!d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"}),(0,N.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Supports .xls, .xlsx, and .csv files (max 10MB)"})]}),(0,N.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,N.jsxs)("h4",{className:"font-medium text-blue-800 mb-2 flex items-center",children:[(0,N.jsx)(nt,{className:"w-4 h-4 mr-1"}),"Expected Excel Format:"]}),(0,N.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,N.jsxs)("li",{children:["\u2022 ",(0,N.jsx)("strong",{children:"Product Name:"})," tuotenimi, name, nimi, product"]}),(0,N.jsxs)("li",{children:["\u2022 ",(0,N.jsx)("strong",{children:"EAN Code:"})," ean, barcode"]}),(0,N.jsxs)("li",{children:["\u2022 ",(0,N.jsx)("strong",{children:"Unit:"})," PMY, unit, yksikk\xf6, baseunit_size"]}),(0,N.jsxs)("li",{children:["\u2022 ",(0,N.jsx)("strong",{children:"Price (excl. tax):"})," hinta veroton, price"]}),(0,N.jsxs)("li",{children:["\u2022 ",(0,N.jsx)("strong",{children:"Price (incl. tax):"})," hinta verollinen, pricetax"]})]}),(0,N.jsxs)("button",{onClick:()=>{const e=[["tuotenimi","ean","PMY","hinta veroton","hinta verollinen"],["Sample Product 1","1234567890123","kg","10.50","12.60"],["Sample Product 2","2345678901234","pcs","5.25","6.30"],["Sample Product 3","3456789012345","liters","8.75","10.50"]].map((e=>e.join(","))).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download="sample_inventory.csv",s.click(),window.URL.revokeObjectURL(n)},className:"mt-2 text-xs text-blue-600 hover:text-blue-800 flex items-center",children:[(0,N.jsx)(fe,{className:"w-3 h-3 mr-1"}),"Download sample file"]})]}),r&&(0,N.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,N.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,N.jsx)("span",{className:"ml-2 text-gray-600",children:"Processing file..."})]})]}),!l&&(0,N.jsx)("div",{className:"flex gap-4 mt-6",children:(0,N.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})},rt=t=>{let{onClose:n}=t;const{addManualItem:r,customCategories:a}=Ze(),[i,o]=(0,e.useState)({name:"",ean:"",unit:"",cost:"",costWithTax:"",type:""}),l=Ge(a);return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Add Manual Item"}),(0,N.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name"}),(0,N.jsx)("input",{type:"text",placeholder:"Enter product name",value:i.name,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{name:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EAN Code (Optional)"}),(0,N.jsx)("input",{type:"text",placeholder:"Enter EAN code",value:i.ean,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{ean:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),(0,N.jsx)("input",{type:"text",placeholder:"e.g., kg, pieces, bottles",value:i.unit,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{unit:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (excl. tax)"}),(0,N.jsx)("input",{type:"number",step:"0.01",placeholder:"0.00",value:i.cost,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{cost:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (incl. tax)"}),(0,N.jsx)("input",{type:"number",step:"0.01",placeholder:"0.00",value:i.costWithTax,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{costWithTax:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),(0,N.jsxs)("select",{value:i.type,onChange:e=>o((t=>(0,s.A)((0,s.A)({},t),{},{type:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"",children:"Select type..."}),l.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))]})]})]}),(0,N.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,N.jsx)("button",{onClick:()=>{if(!i.name.trim())return void Ke("Please enter a product name");const e={name:i.name.trim(),ean:i.ean.trim(),unit:i.unit.trim(),cost:parseFloat(i.cost)||0,costWithTax:parseFloat(i.costWithTax)||0,type:i.type};r(e),n()},className:"flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Add to Database"}),(0,N.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},at=t=>{let{onClose:n,preSelectedFrequency:s}=t;const{databaseItems:r,selectedItems:a,customCategories:i,assignToCategory:o}=Ze(),[l,c]=(0,e.useState)(s||"daily"),[d,u]=(0,e.useState)("produce"),[h,m]=(0,e.useState)(5),[p,f]=(0,e.useState)(0),g=r.filter((e=>a.has(e.id))),x=Ge(i);return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Assign Category and Settings"}),(0,N.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-4",children:[!s&&(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),(0,N.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"daily",children:"\ud83d\udd25 Daily Items"}),(0,N.jsx)("option",{value:"weekly",children:"\ud83d\udcc5 Weekly Items"}),(0,N.jsx)("option",{value:"monthly",children:"\ud83d\udce6 Monthly Items"})]})]}),s&&(0,N.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Selected Frequency:"}),(0,N.jsxs)("div",{className:"text-lg font-semibold text-blue-700",children:["daily"===s&&"\ud83d\udd25 Daily Items","weekly"===s&&"\ud83d\udcc5 Weekly Items","monthly"===s&&"\ud83d\udce6 Monthly Items"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,N.jsx)("select",{value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:x.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Stock Level"}),(0,N.jsx)("input",{type:"number",min:"0",value:h,onChange:e=>m(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Stock"}),(0,N.jsx)("input",{type:"number",min:"0",value:p,onChange:e=>f(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,N.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Items to assign:"}),(0,N.jsx)("div",{className:"text-sm text-blue-700 max-h-32 overflow-y-auto",children:g.map((e=>(0,N.jsxs)("div",{className:"py-1",children:["\u2022 ",e.name]},e.id)))})]})]}),(0,N.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,N.jsx)("button",{onClick:()=>{o(Array.from(a),l,d,h,p),n()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Assign Category"}),(0,N.jsx)("button",{onClick:n,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},it=t=>{let{onClose:n}=t;const{customCategories:r,addCustomCategory:a,updateCustomCategory:i,deleteCustomCategory:o}=Ze(),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)({name:"",icon:"\ud83d\udce6",color:"#3B82F6"}),p=()=>{m({name:"",icon:"\ud83d\udce6",color:"#3B82F6"}),u(null),c(!1)};return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,N.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,N.jsx)(tt,{className:"w-6 h-6 mr-2 text-blue-600"}),"Category Editor"]}),(0,N.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-6 h-6"})})]}),(0,N.jsxs)("div",{className:"mb-6",children:[(0,N.jsx)("h4",{className:"text-lg font-medium text-gray-700 mb-3",children:"Default Categories"}),(0,N.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:$e.map((e=>(0,N.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200 relative group",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsx)("div",{className:"text-xs text-gray-500",children:"Built-in"})]})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between opacity-0 group-hover:opacity-100 transition-opacity mt-2",children:[(0,N.jsx)("button",{onClick:()=>(e=>{u({id:"default_".concat(e.id),name:e.name,icon:e.icon,color:e.color,createdAt:(new Date).toISOString(),isDefault:!0}),m({name:e.name,icon:e.icon,color:e.color}),c(!0)})(e),className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit category",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>(e=>{window.confirm('Are you sure you want to remove the "'.concat(e.name,'" category? This will create a custom override.'))&&(a({name:"REMOVED_".concat(e.name),icon:"\u274c",color:"#EF4444"}),alert("Default category marked as removed. You can restore it by editing the custom categories."))})(e),className:"text-red-600 hover:text-red-800 p-1",title:"Remove category",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})]},e.id)))})]}),(0,N.jsxs)("div",{className:"mb-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,N.jsx)("h4",{className:"text-lg font-medium text-gray-700",children:"Custom Categories"}),(0,N.jsxs)("button",{onClick:()=>c(!0),className:"bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center text-sm",children:[(0,N.jsx)(H,{className:"w-4 h-4 mr-1"}),"Add Category"]})]}),0===r.length?(0,N.jsxs)("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[(0,N.jsx)(tt,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),(0,N.jsx)("p",{className:"font-medium",children:"No custom categories yet"}),(0,N.jsx)("p",{className:"text-sm",children:"Create your first custom category to get started"})]}):(0,N.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:r.map((e=>(0,N.jsxs)("div",{className:"bg-white p-3 rounded-lg border-2 border-gray-200 relative group",children:[(0,N.jsxs)("div",{className:"flex items-center mb-2",children:[(0,N.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsx)("div",{className:"text-xs text-gray-500",children:"Custom"})]})]}),(0,N.jsx)("div",{className:"w-full h-2 rounded-full mb-2",style:{backgroundColor:e.color}}),(0,N.jsxs)("div",{className:"flex items-center justify-between opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,N.jsx)("button",{onClick:()=>(e=>{u(e),m({name:e.name,icon:e.icon,color:e.color}),c(!0)})(e),className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit category",children:(0,N.jsx)($,{className:"w-4 h-4"})}),(0,N.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to delete this category? This action cannot be undone.")&&o(t));var t},className:"text-red-600 hover:text-red-800 p-1",title:"Delete category",children:(0,N.jsx)(K,{className:"w-4 h-4"})})]})]},e.id)))})]}),l&&(0,N.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,N.jsx)("h5",{className:"font-medium text-blue-800 mb-3",children:d?d.id.startsWith("default_")?"Create Custom Override":"Edit Category":"Add New Category"}),(0,N.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h.name.trim()&&(d?d.id.startsWith("default_")?a({name:h.name.trim(),icon:h.icon,color:h.color}):i(d.id,(0,s.A)((0,s.A)({},d),{},{name:h.name.trim(),icon:h.icon,color:h.color})):a({name:h.name.trim(),icon:h.icon,color:h.color}),p())},className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name"}),(0,N.jsx)("input",{type:"text",value:h.name,onChange:e=>m((0,s.A)((0,s.A)({},h),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter category name...",required:!0})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,N.jsx)("input",{type:"text",value:h.icon,onChange:e=>m((0,s.A)((0,s.A)({},h),{},{icon:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-20 text-center text-lg"}),(0,N.jsx)("span",{className:"text-sm text-gray-500",children:"Or choose from common icons:"})]}),(0,N.jsx)("div",{className:"grid grid-cols-7 gap-2",children:["\ud83d\udce6","\ud83e\udd6c","\ud83e\udd69","\ud83e\udd5b","\ud83c\udf5e","\ud83e\udd64","\ud83e\uddfd","\ud83c\udf7d\ufe0f","\ud83d\udd27","\ud83c\udfa8","\ud83c\udff7\ufe0f","\u2b50","\ud83c\udfaf","\ud83d\udca1"].map((e=>(0,N.jsx)("button",{type:"button",onClick:()=>m((0,s.A)((0,s.A)({},h),{},{icon:e})),className:"p-2 text-xl border rounded-lg hover:bg-gray-100 ".concat(h.icon===e?"border-blue-500 bg-blue-50":"border-gray-300"),children:e},e)))})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,N.jsx)("input",{type:"color",value:h.color,onChange:e=>m((0,s.A)((0,s.A)({},h),{},{color:e.target.value})),className:"w-12 h-10 border border-gray-300 rounded-lg cursor-pointer"}),(0,N.jsx)("input",{type:"text",value:h.color,onChange:e=>m((0,s.A)((0,s.A)({},h),{},{color:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 flex-1",placeholder:"#3B82F6"})]}),(0,N.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["#3B82F6","#10B981","#EF4444","#F59E0B","#8B5CF6","#F97316","#6B7280","#EC4899","#14B8A6","#84CC16"].map((e=>(0,N.jsx)("button",{type:"button",onClick:()=>m((0,s.A)((0,s.A)({},h),{},{color:e})),className:"w-full h-8 rounded-lg border-2 ".concat(h.color===e?"border-gray-800":"border-gray-300"),style:{backgroundColor:e}},e)))})]}),(0,N.jsxs)("div",{className:"flex gap-3",children:[(0,N.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:d?d.id.startsWith("default_")?"Create Override":"Update Category":"Add Category"}),(0,N.jsx)("button",{type:"button",onClick:p,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]}),(0,N.jsx)("div",{className:"flex justify-end",children:(0,N.jsx)("button",{onClick:n,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})]})})},ot=e=>{let{onAssignCategory:t,onDelete:n}=e;const{selectedItems:s,clearSelection:r}=Ze();return 0===s.size?null:(0,N.jsx)("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-1/2 md:right-auto md:transform md:-translate-x-1/2",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border p-4 w-full md:min-w-96 md:w-auto",children:[(0,N.jsxs)("div",{className:"block md:hidden space-y-3",children:[(0,N.jsx)("div",{className:"text-center",children:(0,N.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[s.size," items selected"]})}),(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,N.jsx)("button",{onClick:()=>t("daily"),className:"bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition-colors flex items-center justify-center",children:"\ud83d\udd25 Daily"}),(0,N.jsx)("button",{onClick:()=>t("weekly"),className:"bg-yellow-500 text-white px-2 py-1 rounded text-xs hover:bg-yellow-600 transition-colors flex items-center justify-center",children:"\ud83d\udcc5 Weekly"}),(0,N.jsx)("button",{onClick:()=>t("monthly"),className:"bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 transition-colors flex items-center justify-center",children:"\ud83d\udce6 Monthly"})]}),(0,N.jsxs)("div",{className:"flex space-x-2",children:[(0,N.jsx)("button",{onClick:r,className:"flex-1 bg-gray-500 text-white px-3 py-2 rounded text-sm hover:bg-gray-600 transition-colors",children:"Clear"}),(0,N.jsx)("button",{onClick:n,className:"flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 transition-colors",children:"Delete"})]})]}),(0,N.jsxs)("div",{className:"hidden md:flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,N.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[s.size," items selected"]}),(0,N.jsx)("div",{className:"h-4 w-px bg-gray-300"}),(0,N.jsxs)("div",{className:"flex space-x-2",children:[(0,N.jsx)("button",{onClick:()=>t("daily"),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"\ud83d\udd25 Daily"}),(0,N.jsx)("button",{onClick:()=>t("weekly"),className:"bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors",children:"\ud83d\udcc5 Weekly"}),(0,N.jsx)("button",{onClick:()=>t("monthly"),className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors",children:"\ud83d\udce6 Monthly"})]})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("button",{onClick:r,className:"bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors",children:"Clear"}),(0,N.jsx)("button",{onClick:n,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Delete"})]})]})]})})},lt=t=>{let{item:n,onClose:s,onSave:r,onUnassign:a}=t;const{customCategories:i}=Ze(),[o,l]=(0,e.useState)(n.assignedTo||"daily"),[c,d]=(0,e.useState)(n.assignedCategory||"produce"),[u,h]=(0,e.useState)(5),[m,p]=(0,e.useState)(0),f=Ge(i);return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Edit Item Assignment"}),(0,N.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-2xl mr-3",children:Ve(n.type||"supplies")}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-gray-800",children:n.name}),(0,N.jsxs)("p",{className:"text-sm text-gray-600",children:[n.ean||"No EAN"," \u2022 ",n.unit||"pieces"]}),n.isAssigned&&(0,N.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["Currently assigned to ",n.assignedTo," - ",n.assignedCategory]})]})]})}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),(0,N.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"daily",children:"\ud83d\udd25 Daily Items"}),(0,N.jsx)("option",{value:"weekly",children:"\ud83d\udcc5 Weekly Items"}),(0,N.jsx)("option",{value:"monthly",children:"\ud83d\udce6 Monthly Items"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,N.jsx)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:f.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Level"}),(0,N.jsx)("input",{type:"number",min:"0",value:u,onChange:e=>h(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Stock"}),(0,N.jsx)("input",{type:"number",min:"0",value:m,onChange:e=>p(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,N.jsxs)("div",{className:"flex gap-3 mt-6",children:[n.isAssigned&&(0,N.jsx)("button",{onClick:()=>{a(),s()},className:"flex-1 bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Unassign"}),(0,N.jsx)("button",{onClick:()=>{r(o,c,u,m),s()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:n.isAssigned?"Update Assignment":"Assign to Inventory"}),(0,N.jsx)("button",{onClick:s,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},ct=()=>{const{databaseItems:t,selectedItems:n,toggleItemSelection:s,selectMultipleItems:r,clearSelection:a,deleteItems:i,assignToCategory:o,unassignFromCategory:l,cleanupDuplicates:c,customCategories:d}=Ze(),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[x,y]=(0,e.useState)(!1),[v,b]=(0,e.useState)(void 0),[w,j]=(0,e.useState)(!1),[k,_]=(0,e.useState)(null),[C,S]=(0,e.useState)("all"),[I,T]=(0,e.useState)(""),[E,A]=(0,e.useState)(!1),D=Ge(d),P=t.filter((e=>{const t="all"===C||"assigned"===C&&e.isAssigned||"unassigned"===C&&!e.isAssigned||"uncategorized"===C&&(!e.type||""===e.type)||e.type===C,n=!I||e.name.toLowerCase().includes(I.toLowerCase())||e.ean&&e.ean.toLowerCase().includes(I.toLowerCase());return t&&n}));(0,e.useEffect)((()=>{a(),A(!1)}),[C,I,a]),(0,e.useEffect)((()=>{if(0===P.length)return void A(!1);const e=P.every((e=>n.has(e.id))),t=P.some((e=>n.has(e.id)));A(e&&t)}),[n,P]);const R=t.filter((e=>e.isAssigned)).length,M=t.filter((e=>!e.isAssigned)).length;return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)("span",{className:"mr-2",children:"\ud83d\udcbe"}),"Items Database Management"]}),(0,N.jsx)("p",{className:"text-gray-600 mb-4",children:"Import items from Excel and assign them to inventory categories"}),(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,N.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:t.length}),(0,N.jsx)("div",{className:"text-sm text-blue-600",children:"Total Items"})]}),(0,N.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-green-700",children:R}),(0,N.jsx)("div",{className:"text-sm text-green-600",children:"Assigned"})]}),(0,N.jsxs)("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[(0,N.jsx)("div",{className:"text-2xl font-bold text-orange-700",children:M}),(0,N.jsx)("div",{className:"text-sm text-orange-600",children:"Unassigned"})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,N.jsxs)("button",{onClick:()=>h(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(et,{className:"w-5 h-5 mr-2"}),"Import from Excel"]}),(0,N.jsxs)("button",{onClick:()=>p(!0),className:"bg-green-500 text-white px-4 py-3 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(H,{className:"w-5 h-5 mr-2"}),"Add Manual Item"]}),(0,N.jsxs)("button",{onClick:()=>y(!0),className:"bg-indigo-500 text-white px-4 py-3 rounded-lg hover:bg-indigo-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(tt,{className:"w-5 h-5 mr-2"}),"Manage Categories"]}),(0,N.jsxs)("button",{onClick:()=>{if(0===t.length)return void alert("No items in database to export");const e=[["Name","EAN","Unit","Price (excl. tax)","Price (incl. tax)","Type","Assigned To","Category"].join(","),...t.map((e=>['"'.concat(e.name||"",'"'),e.ean||"",e.unit||"",e.cost||0,e.costWithTax||0,e.type||"",e.assignedTo||"",e.assignedCategory||""].join(",")))].join("\n"),n=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=window.URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download="database_items_".concat((new Date).toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(s)},className:"bg-purple-500 text-white px-4 py-3 rounded-lg hover:bg-purple-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(fe,{className:"w-5 h-5 mr-2"}),"Export Database"]}),(0,N.jsxs)("button",{onClick:c,className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(K,{className:"w-5 h-5 mr-2"}),"Clean Duplicates"]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsxs)("div",{className:"p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Database Items"}),(0,N.jsx)("div",{className:"text-sm text-gray-500",children:"Click on items to edit individually, or use checkboxes for bulk actions"})]}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("input",{type:"checkbox",checked:E,onChange:()=>{if(E)a(),A(!1);else{const e=P.map((e=>e.id));a(),r(e),A(!0)}},className:"rounded"}),(0,N.jsx)("label",{className:"text-sm text-gray-600",children:(()=>{const e="all"!==C,n=t.length,s=P.length;return e?"Select All Visible (".concat(s," of ").concat(n,")"):"Select All (".concat(n,")")})()})]}),(0,N.jsxs)("select",{value:C,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[(0,N.jsx)("option",{value:"all",children:"All Items"}),(0,N.jsx)("option",{value:"assigned",children:"\u2705 Assigned Items"}),(0,N.jsx)("option",{value:"unassigned",children:"\u23f3 Unassigned Items"}),D.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value))),(0,N.jsx)("option",{value:"uncategorized",children:"\u2753 Uncategorized"})]}),(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search database...",value:I,onChange:e=>T(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,N.jsx)("div",{className:"p-6",children:0===P.length?(0,N.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,N.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcc2"}),(0,N.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No items found"}),(0,N.jsx)("p",{className:"text-sm",children:I||"all"!==C?"Try adjusting your search or filter":"Import items from Excel or add them manually to get started"})]}):(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map((e=>(0,N.jsxs)("div",{onClick:t=>((e,t)=>{const n=t.target;"INPUT"===n.tagName&&"checkbox"===n.type||_(e)})(e,t),className:"cursor-pointer bg-white border rounded-xl p-4 transition-all hover:shadow-md ".concat(n.has(e.id)?"border-blue-500 bg-blue-50":e.isAssigned?"border-green-300 bg-green-50":"border-gray-200 hover:border-gray-300"),children:[(0,N.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("input",{type:"checkbox",checked:n.has(e.id),onChange:()=>s(e.id),className:"mr-3 rounded",onClick:e=>e.stopPropagation()}),(0,N.jsx)("span",{className:"text-2xl mr-3",children:Ve(e.type||"supplies")}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,N.jsx)("p",{className:"text-sm text-gray-600",children:e.ean||"No EAN"})]})]}),(0,N.jsx)("div",{className:"flex items-center space-x-1",children:e.isAssigned?(0,N.jsxs)("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:["\u2705 ",e.assignedTo]}):(0,N.jsx)("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u23f3 Unassigned"})})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"font-medium",children:"Unit:"})," ",e.unit||"pieces"]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"font-medium",children:"Cost:"})," \u20ac",(e.cost||0).toFixed(2)]})]}),e.isAssigned&&(0,N.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,N.jsxs)("div",{children:["Category: ",(0,N.jsx)("span",{className:"font-medium capitalize",children:e.assignedCategory})]}),(0,N.jsxs)("div",{children:["Assigned: ",e.assignedDate]})]}),(0,N.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:["Click to ",e.isAssigned?"edit assignment":"assign to inventory"]}),(0,N.jsx)($,{className:"w-4 h-4 text-gray-400"})]})]},e.id)))})})]}),(0,N.jsx)(ot,{onAssignCategory:e=>{b(e),g(!0)},onDelete:()=>{0!==n.size&&j(!0)}}),w&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center mb-4",children:[(0,N.jsx)("div",{className:"p-3 bg-red-100 rounded-lg mr-4",children:(0,N.jsx)(ze,{className:"w-6 h-6 text-red-600"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Confirm Deletion"}),(0,N.jsx)("p",{className:"text-gray-600",children:"This action cannot be undone."})]})]}),(0,N.jsxs)("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete ",(0,N.jsx)("span",{className:"font-semibold",children:n.size})," selected items? This will permanently remove them from the database and any assigned inventory lists."]}),(0,N.jsxs)("div",{className:"flex gap-3",children:[(0,N.jsx)("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,N.jsx)("button",{onClick:()=>{i(Array.from(n)),j(!1),A(!1)},className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Delete Items"})]})]})}),u&&(0,N.jsx)(st,{onClose:()=>h(!1)}),m&&(0,N.jsx)(rt,{onClose:()=>p(!1)}),f&&(0,N.jsx)(at,{onClose:()=>{g(!1),b(void 0)},preSelectedFrequency:v}),x&&(0,N.jsx)(it,{onClose:()=>y(!1)}),k&&(0,N.jsx)(lt,{item:k,onClose:()=>_(null),onSave:(e,t,n,s)=>{k&&o([k.id],e,t,n,s)},onUnassign:()=>{k&&l(k.id)}})]})},dt=e=>{let{item:t,onUpdateCount:n,onReportWaste:s,showQuickActions:r=!0}=e;const a=He(t).status;return(0,N.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm transition-all hover:shadow-md hover:-translate-y-1 ".concat((()=>{switch(a){case"critical":return"bg-gradient-to-br from-red-50 to-red-100 border-l-4 border-red-500";case"low":return"bg-gradient-to-br from-yellow-50 to-yellow-100 border-l-4 border-yellow-500";default:return"bg-gradient-to-br from-green-50 to-green-100 border-l-4 border-green-500"}})()),children:[(0,N.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-2xl mr-3",children:Ve(t.category)}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-semibold text-gray-800",children:t.name}),(0,N.jsx)("p",{className:"text-sm text-gray-600 capitalize",children:t.category})]})]}),(()=>{switch(a){case"critical":return(0,N.jsx)("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs font-medium animate-pulse",children:"\ud83d\udea8 Critical"});case"low":return(0,N.jsx)("span",{className:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u26a0\ufe0f Low Stock"});default:return(0,N.jsx)("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:"\u2705 Good Stock"})}})()]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Current Count"}),(0,N.jsxs)("div",{className:"text-lg font-bold ".concat((()=>{switch(a){case"critical":return"text-red-600";case"low":return"text-yellow-600";default:return"text-green-600"}})()),children:[t.currentStock," ",t.unit]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Min Level"}),(0,N.jsxs)("div",{className:"text-lg font-medium text-gray-700",children:[t.minLevel," ",t.unit]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs text-gray-600",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"font-medium",children:"Cost:"})," \u20ac",t.cost.toFixed(2)]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"font-medium",children:"Last Used:"})," ",t.lastUsed]})]}),t.ean&&(0,N.jsxs)("div",{className:"mb-4 text-xs text-gray-500",children:[(0,N.jsx)("span",{className:"font-medium",children:"EAN:"})," ",t.ean]}),r&&(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsxs)("button",{onClick:()=>n(t.id),className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[(0,N.jsx)($,{className:"w-4 h-4 mr-1"}),"Update Count"]}),(0,N.jsxs)("button",{onClick:()=>s(t.id),className:"flex-1 flex items-center justify-center px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm",children:[(0,N.jsx)(K,{className:"w-4 h-4 mr-1"}),"Report Waste"]})]})]})},ut=t=>{let{value:n,onChange:s,min:r=0,max:a=100,step:i=1}=t;const o=(0,e.useRef)(null),l=(0,e.useRef)(null),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(0),[m,p]=(0,e.useState)(0),[f,g]=(0,e.useState)(!1),[x,y]=(0,e.useState)(""),[v,b]=(0,e.useState)(0),w=(0,e.useRef)(null),j=[];for(let e=r;e<=a;e+=i)j.push(e);const k=48,_=192,C=(0,e.useCallback)((e=>{const t=j.indexOf(e);if(-1===t)return 0;return 72-t*k}),[j,_,k]),S=(0,e.useCallback)((e=>{const t=Math.round((72-e)/k);return j[Math.max(0,Math.min(t,j.length-1))]}),[j,_,k]),I=(0,e.useCallback)((e=>{const t=72-k*(j.length-1);return Math.max(t,Math.min(72,e))}),[j.length,_,k]);(0,e.useEffect)((()=>{f&&w.current&&(w.current.focus(),w.current.select())}),[f]),(0,e.useEffect)((()=>{if(l.current&&!c){const e=C(n);l.current.style.transform="translateY(".concat(e,"px)")}}),[n,c,C]);const T=(0,e.useCallback)(((e,t)=>{if(t&&(t.preventDefault(),t.stopPropagation()),d(!0),h(e),l.current){const e=window.getComputedStyle(l.current),t=new DOMMatrix(e.transform);p(t.m42),l.current.style.transition="none"}}),[]),E=(0,e.useCallback)(((e,t)=>{if(!c||!l.current)return;t&&(t.preventDefault(),t.stopPropagation());const n=I(m+(e-u));l.current.style.transform="translateY(".concat(n,"px)")}),[c,u,m,I]),A=(0,e.useCallback)((e=>{if(!c||!l.current)return;e&&(e.preventDefault(),e.stopPropagation()),d(!1),l.current.style.transition="transform 0.3s ease-in-out";const t=window.getComputedStyle(l.current),n=new DOMMatrix(t.transform).m42,r=S(n),a=C(r);l.current.style.transform="translateY(".concat(a,"px)"),s(r)}),[c,S,C,s]),D=(0,e.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),y(n.toString()),g(!0)}),[n]),P=(0,e.useCallback)((e=>{const t=Date.now(),s=t-v;s<300&&s>0&&(e.preventDefault(),e.stopPropagation(),y(n.toString()),g(!0)),b(t)}),[v,n]),R=(0,e.useCallback)((e=>{const t=parseFloat(e);if(isNaN(t))return!1;const n=Math.max(r,Math.min(a,t)),o=Math.round((n-r)/i),l=r+o*i;return!!j.includes(l)&&(s(l),!0)}),[r,a,i,j,s]),M=(0,e.useCallback)((()=>{R(x)&&g(!1)}),[x,R]),L=(0,e.useCallback)((()=>{g(!1),y("")}),[]),O=(0,e.useCallback)((e=>{"Enter"===e.key?(e.preventDefault(),M()):"Escape"===e.key&&(e.preventDefault(),L())}),[M,L]),F=(0,e.useCallback)((()=>{M()}),[M]),U=(0,e.useCallback)((e=>{f||(e.preventDefault(),e.stopPropagation(),T(e.clientY,e.nativeEvent))}),[T,f]);(0,e.useEffect)((()=>{const e=e=>{E(e.clientY,e)},t=e=>{A(e)};return c&&(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",t,{passive:!1})),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}),[c,E,A]);const z=(0,e.useCallback)((e=>{f||(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&(P(e),T(e.touches[0].clientY,e.nativeEvent)))}),[T,P,f]),q=(0,e.useCallback)((e=>{f||(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&c&&E(e.touches[0].clientY,e.nativeEvent))}),[c,E,f]),W=(0,e.useCallback)((e=>{f||(e.preventDefault(),e.stopPropagation(),A(e.nativeEvent))}),[A,f]),B=(0,e.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]);return(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsxs)("div",{ref:o,className:"relative h-48 overflow-hidden bg-white border-2 border-gray-200 rounded-xl touch-none select-none",style:{height:"".concat(_,"px"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onMouseDown:U,onDoubleClick:D,onTouchStart:z,onTouchMove:q,onTouchEnd:W,onContextMenu:B,children:[(0,N.jsx)("div",{className:"absolute top-0 left-0 right-0 h-16 bg-gradient-to-b from-white to-transparent pointer-events-none z-10"}),(0,N.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-white to-transparent pointer-events-none z-10"}),(0,N.jsx)("div",{className:"absolute left-0 right-0 border-t border-b border-gray-300 pointer-events-none z-10",style:{top:"".concat(72,"px"),height:"".concat(k,"px")}}),f&&(0,N.jsx)("div",{className:"absolute left-0 right-0 z-20 flex items-center justify-center",style:{top:"".concat(72,"px"),height:"".concat(k,"px")},children:(0,N.jsx)("input",{ref:w,type:"number",value:x,onChange:e=>y(e.target.value),onKeyDown:O,onBlur:F,min:r,max:a,step:i,className:"w-20 h-8 text-center text-lg font-semibold border-2 border-blue-500 rounded bg-white text-black focus:outline-none focus:ring-2 focus:ring-blue-300"})}),(0,N.jsx)("div",{ref:l,className:"absolute left-0 right-0 transition-transform duration-300 ease-in-out touch-none select-none",style:{transform:"translateY(".concat(C(n),"px)"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},children:j.map(((e,t)=>{const s=e===n;return(0,N.jsx)("div",{className:"flex items-center justify-center transition-all duration-200 touch-none select-none ".concat(s?"text-black font-semibold text-xl":"text-gray-400 text-lg"),style:{height:"".concat(k,"px"),touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},children:e},e)}))})]}),(0,N.jsxs)("div",{className:"mt-2 text-center",children:[(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Selected: "}),(0,N.jsx)("span",{className:"font-semibold text-gray-800",children:n}),(0,N.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Double-click or double-tap to enter value manually"})]})]})},ht=t=>{let{frequency:n,selectedItemId:s,onClose:r}=t;const{dailyItems:a,weeklyItems:i,monthlyItems:o,updateItemStock:l}=Ze(),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(0),[m,p]=(0,e.useState)("1"),[f,g]=(0,e.useState)(""),x=(()=>{switch(n){case"daily":return a;case"weekly":return i;case"monthly":return o;default:return[]}})();(0,e.useEffect)((()=>{if(s){const e=x.find((e=>e.id===s));e&&(d(s.toString()),h(e.currentStock))}}),[s,x]);const y=x.find((e=>e.id.toString()===c));return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Update Current Count"}),(0,N.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Item"}),(0,N.jsxs)("select",{value:c,onChange:e=>{d(e.target.value);const t=x.find((t=>t.id.toString()===e.target.value));t&&h(t.currentStock)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"",children:"Choose an item..."}),x.map((e=>(0,N.jsxs)("option",{value:e.id,children:[e.name," (Currently: ",e.currentStock," ",e.unit,")"]},e.id)))]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Count"}),(0,N.jsx)(ut,{value:u,onChange:h,min:0,max:Math.max(100,((null===y||void 0===y?void 0:y.currentStock)||0)+20)})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),(0,N.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"1",children:"John Smith - Kitchen"}),(0,N.jsx)("option",{value:"2",children:"Sarah Johnson - Prep"}),(0,N.jsx)("option",{value:"3",children:"Mike Wilson - Grill"}),(0,N.jsx)("option",{value:"4",children:"Emily Davis - Pantry"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,N.jsx)("textarea",{rows:2,placeholder:"Any notes about the count...",value:f,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,N.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,N.jsx)("button",{onClick:()=>{if(!c||u<0)return void alert("Please select an item and enter a valid count!");l(c,u,n,{1:"John Smith",2:"Sarah Johnson",3:"Mike Wilson",4:"Emily Davis"}[m],f),r()},className:"flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Update Count"}),(0,N.jsx)("button",{onClick:r,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},mt=t=>{let{frequency:n,selectedItemId:s,onClose:r}=t;const{dailyItems:a,weeklyItems:i,monthlyItems:o,reportWaste:l}=Ze(),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(""),[m,p]=(0,e.useState)("expired"),[f,g]=(0,e.useState)("1"),[x,y]=(0,e.useState)(""),b=(()=>{switch(n){case"daily":return a;case"weekly":return i;case"monthly":return o;default:return[]}})();(0,e.useEffect)((()=>{s&&d(s.toString())}),[s]);return(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Report Waste"}),(0,N.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Item"}),(0,N.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"",children:"Choose an item..."}),b.map((e=>(0,N.jsxs)("option",{value:e.id,children:[e.name," (Available: ",e.currentStock," ",e.unit,")"]},e.id)))]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Amount"}),(0,N.jsx)("input",{type:"number",min:"0",step:"0.1",placeholder:"Enter waste amount",value:u,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Reason"}),(0,N.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"expired",children:"Expired/Spoiled"}),(0,N.jsx)("option",{value:"overcooked",children:"Overcooked"}),(0,N.jsx)("option",{value:"dropped",children:"Dropped/Contaminated"}),(0,N.jsx)("option",{value:"overordered",children:"Over-ordered"}),(0,N.jsx)("option",{value:"customer-return",children:"Customer Return"}),(0,N.jsx)("option",{value:"other",children:"Other"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),(0,N.jsxs)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"1",children:"John Smith - Kitchen"}),(0,N.jsx)("option",{value:"2",children:"Sarah Johnson - Prep"}),(0,N.jsx)("option",{value:"3",children:"Mike Wilson - Grill"}),(0,N.jsx)("option",{value:"4",children:"Emily Davis - Pantry"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,N.jsx)("textarea",{rows:2,placeholder:"Details about the waste...",value:x,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,N.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,N.jsx)("button",{onClick:()=>{const e=parseFloat(u);if(!c||!u||e<=0)return void alert("Please select an item and enter a valid waste amount!");const t=b.find((e=>e.id.toString()===c));if(!t)return void alert("Item not found!");if(e>t.currentStock)return void alert("Waste amount cannot exceed current stock!");l(c,e,m,n,{1:"John Smith",2:"Sarah Johnson",3:"Mike Wilson",4:"Emily Davis"}[f],x),r()},className:"flex-1 bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Report Waste"}),(0,N.jsx)("button",{onClick:r,className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},pt=()=>{const{dailyItems:t,activityLog:n,customCategories:s}=Ze(),[r,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)("all"),[h,m]=(0,e.useState)(""),p=Ge(s),f=t.filter((e=>{const t="all"===d||e.category===d,n=!h||e.name.toLowerCase().includes(h.toLowerCase());return t&&n})),g=e=>{c(e),a(!0)},x=e=>{c(e),o(!0)},y=n.filter((e=>new Date(e.timestamp).toDateString()===(new Date).toDateString())).slice(0,10);return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,N.jsx)("span",{className:"mr-2",children:"\ud83d\udd25"}),"Daily High-Usage Items - ",(0,N.jsx)("span",{className:"text-red-600",children:(v=new Date,new Date(v).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]}),(0,N.jsx)("p",{className:"text-gray-600 mb-4",children:"At the end of each day, count and update current quantities for high-usage items"}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("button",{onClick:()=>a(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)($,{className:"w-5 h-5 mr-2"}),"Update Current Count"]}),(0,N.jsxs)("button",{onClick:()=>o(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(K,{className:"w-5 h-5 mr-2"}),"Report Waste"]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsxs)("div",{className:"p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Daily Usage Items"}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,N.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"all",children:"All Types"}),p.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search daily items...",value:h,onChange:e=>m(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(h||"all"!==d)&&(0,N.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",f.length," of ",t.length," daily items",h&&' matching "'.concat(h,'"'),"all"!==d&&" in ".concat(d," category")]})]}),(0,N.jsx)("div",{className:"p-6",children:(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map((e=>(0,N.jsx)(dt,{item:e,onUpdateCount:g,onReportWaste:x},e.id)))})})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsx)("div",{className:"p-6 border-b",children:(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Today's Activity"})}),(0,N.jsx)("div",{className:"p-6",children:(0,N.jsx)("div",{className:"space-y-3",children:0===y.length?(0,N.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,N.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\udccb"}),(0,N.jsx)("p",{children:"No activity recorded for today"})]}):y.map((e=>{let t,n,s;switch(e.type){case"count_update":t="\ud83d\udcdd",n="blue",s="Count Updated";break;case"waste":t="\ud83d\uddd1\ufe0f",n="red",s="Waste";break;default:t="\ud83d\udce6",n="gray",s="Activity"}return(0,N.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"bg-".concat(n,"-100 p-2 rounded-lg mr-3"),children:(0,N.jsx)("span",{className:"text-".concat(n,"-600"),children:t})}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"font-medium text-gray-800",children:[s,": ",e.item]}),(0,N.jsxs)("div",{className:"text-sm text-gray-600",children:[e.employee," \u2022 ",e.timestamp,e.notes&&" \u2022 ".concat(e.notes),e.reason&&" (".concat(e.reason,")")]})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsxs)("div",{className:"font-bold text-gray-700",children:[e.quantity," ",e.unit]}),(0,N.jsx)("div",{className:"text-xs text-gray-500",children:e.type})]})]},e.id)}))})})]}),r&&(0,N.jsx)(ht,{frequency:"daily",selectedItemId:l,onClose:()=>{a(!1),c(null)}}),i&&(0,N.jsx)(mt,{frequency:"daily",selectedItemId:l,onClose:()=>{o(!1),c(null)}})]});var v},ft=()=>{const{weeklyItems:t}=Ze(),[n,s]=(0,e.useState)(!1),[r,a]=(0,e.useState)(!1),[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)("all"),m=t.filter((e=>{const t=!l||e.name.toLowerCase().includes(l.toLowerCase()),n="all"===d||e.category===d;return t&&n})),p=[...new Set(t.map((e=>e.category)))],f=e=>{o(e),s(!0)},g=e=>{o(e),a(!0)},x=t.length,y=t.filter((e=>0===e.currentStock)).length,v=t.filter((e=>e.currentStock>0&&e.currentStock<=e.minLevel)).length,b=t.reduce(((e,t)=>e+t.cost*t.currentStock),0),w=new Date,j=(8-w.getDay())%7,k=new Date(w);return k.setDate(w.getDate()+j),(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,N.jsx)(pe,{className:"w-6 h-6 mr-2 text-yellow-600"}),"Weekly Reorder Items"]}),(0,N.jsx)("p",{className:"text-gray-600",children:"Items counted and updated weekly for regular restocking"})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,N.jsx)(O,{className:"w-4 h-4"}),(0,N.jsxs)("span",{children:["Next count: ",k.toLocaleDateString()]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,N.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-yellow-600 font-medium",children:"Total Items"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:x})]}),(0,N.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-red-600 font-medium",children:"Critical"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-red-800",children:y})]}),(0,N.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Low Stock"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-orange-800",children:v})]}),(0,N.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Total Value"}),(0,N.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["\u20ac",b.toFixed(2)]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("button",{onClick:()=>s(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)($,{className:"w-5 h-5 mr-2"}),"Weekly Count Update"]}),(0,N.jsxs)("button",{onClick:()=>a(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(K,{className:"w-5 h-5 mr-2"}),"Report Waste"]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsxs)("div",{className:"p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Weekly Items Status"}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,N.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"all",children:"All Categories"}),p.map((e=>(0,N.jsx)("option",{value:e,className:"capitalize",children:e},e)))]}),(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search weekly items...",value:l,onChange:e=>c(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(l||"all"!==d)&&(0,N.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",m.length," of ",x," weekly items",l&&' matching "'.concat(l,'"'),"all"!==d&&" in ".concat(d," category")]})]}),(0,N.jsx)("div",{className:"p-6",children:0===m.length?(0,N.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,N.jsx)(pe,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,N.jsx)("h3",{className:"text-lg font-medium mb-2",children:l||"all"!==d?"No items match your filters":"No weekly items yet"}),(0,N.jsx)("p",{className:"text-sm",children:l||"all"!==d?"Try adjusting your search or filter criteria":"Add items from the database to start tracking weekly inventory"})]}):(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((e=>(0,N.jsx)(dt,{item:e,onUpdateCount:f,onReportWaste:g},e.id)))})})]}),(0,N.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[(0,N.jsx)(h,{className:"w-5 h-5 mr-2 text-yellow-600"}),"Weekly Inventory Insights"]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Weekly Patterns"}),(0,N.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,N.jsx)("li",{children:"\u2022 Monitor weekend vs weekday usage"}),(0,N.jsx)("li",{children:"\u2022 Track seasonal demand changes"}),(0,N.jsx)("li",{children:"\u2022 Identify peak consumption days"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udd04 Reorder Strategy"}),(0,N.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,N.jsx)("li",{children:"\u2022 Set reorder points based on lead times"}),(0,N.jsx)("li",{children:"\u2022 Consider supplier delivery schedules"}),(0,N.jsx)("li",{children:"\u2022 Account for weekend availability"})]})]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"This Week's Turnover"}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Fast Moving:"}),(0,N.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock<.5*e.minLevel)).length})]}),(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Normal:"}),(0,N.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock>=.5*e.minLevel&&e.currentStock<=e.minLevel)).length})]}),(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Slow Moving:"}),(0,N.jsx)("span",{className:"font-medium",children:t.filter((e=>e.currentStock>e.minLevel)).length})]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Reorder Recommendations"}),(0,N.jsxs)("div",{className:"space-y-2",children:[t.filter((e=>e.currentStock<=e.minLevel)).slice(0,3).map((e=>(0,N.jsxs)("div",{className:"text-sm",children:[(0,N.jsx)("div",{className:"font-medium text-gray-700",children:e.name}),(0,N.jsxs)("div",{className:"text-gray-500",children:["Order: ",2*e.minLevel," ",e.unit]})]},e.id))),0===t.filter((e=>e.currentStock<=e.minLevel)).length&&(0,N.jsx)("p",{className:"text-gray-500 text-sm",children:"All items adequately stocked"})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cost Analysis"}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Avg. Cost/Item:"}),(0,N.jsxs)("span",{className:"font-medium",children:["\u20ac",x>0?(b/x).toFixed(2):"0.00"]})]}),(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Weekly Budget:"}),(0,N.jsxs)("span",{className:"font-medium",children:["\u20ac",(.25*b).toFixed(2)]})]}),(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-gray-600",children:"Reorder Value:"}),(0,N.jsxs)("span",{className:"font-medium text-orange-600",children:["\u20ac",t.filter((e=>e.currentStock<=e.minLevel)).reduce(((e,t)=>e+t.cost*t.minLevel),0).toFixed(2)]})]})]})]})]}),n&&(0,N.jsx)(ht,{frequency:"weekly",selectedItemId:i,onClose:()=>{s(!1),o(null)}}),r&&(0,N.jsx)(mt,{frequency:"weekly",selectedItemId:i,onClose:()=>{a(!1),o(null)}})]})},gt=()=>{const{monthlyItems:t,customCategories:n}=Ze(),[s,r]=(0,e.useState)(!1),[a,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)("all"),m=Ge(n),p=t.filter((e=>{const t=!c||e.name.toLowerCase().includes(c.toLowerCase()),n="all"===u||e.category===u;return t&&n})),f=(new Set(t.map((e=>e.category))),e=>{l(e),r(!0)}),g=e=>{l(e),i(!0)},x=t.length,y=t.filter((e=>0===e.currentStock)).length,v=t.filter((e=>e.currentStock>0&&e.currentStock<=e.minLevel)).length,b=t.reduce(((e,t)=>e+t.cost*t.currentStock),0);return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,N.jsx)(Y,{className:"w-6 h-6 mr-2 text-green-600"}),"Monthly Bulk Items"]}),(0,N.jsx)("p",{className:"text-gray-600",children:"Items counted and updated monthly for bulk ordering and storage"})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,N.jsx)(pe,{className:"w-4 h-4"}),(0,N.jsxs)("span",{children:["Last monthly count: ",(new Date).toLocaleDateString()]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,N.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-green-600 font-medium",children:"Total Items"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-green-800",children:x})]}),(0,N.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-red-600 font-medium",children:"Critical"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-red-800",children:y})]}),(0,N.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-yellow-600 font-medium",children:"Low Stock"}),(0,N.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:v})]}),(0,N.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,N.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Total Value"}),(0,N.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["\u20ac",b.toFixed(2)]})]})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("button",{onClick:()=>r(!0),className:"bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)($,{className:"w-5 h-5 mr-2"}),"Monthly Count Update"]}),(0,N.jsxs)("button",{onClick:()=>i(!0),className:"bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center",children:[(0,N.jsx)(K,{className:"w-5 h-5 mr-2"}),"Report Waste/Damage"]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsxs)("div",{className:"p-6 border-b",children:[(0,N.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Monthly Items Inventory"}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,N.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,N.jsx)("option",{value:"all",children:"All Categories"}),m.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(xe,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search monthly items...",value:c,onChange:e=>d(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-48 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(c||"all"!==u)&&(0,N.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",p.length," of ",x," monthly items",c&&' matching "'.concat(c,'"'),"all"!==u&&" in ".concat(u," category")]})]}),(0,N.jsx)("div",{className:"p-6",children:0===p.length?(0,N.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,N.jsx)(Y,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,N.jsx)("h3",{className:"text-lg font-medium mb-2",children:c||"all"!==u?"No items match your filters":"No monthly items yet"}),(0,N.jsx)("p",{className:"text-sm",children:c||"all"!==u?"Try adjusting your search or filter criteria":"Add items from the database to start tracking monthly inventory"})]}):(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((e=>(0,N.jsx)(dt,{item:e,onUpdateCount:f,onReportWaste:g},e.id)))})})]}),(0,N.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[(0,N.jsx)(Y,{className:"w-5 h-5 mr-2 text-green-600"}),"Monthly Inventory Tips"]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udce6 Bulk Items Management"}),(0,N.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,N.jsx)("li",{children:"\u2022 Review monthly consumption patterns"}),(0,N.jsx)("li",{children:"\u2022 Check expiration dates on bulk items"}),(0,N.jsx)("li",{children:"\u2022 Plan storage space for large orders"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"\ud83d\udcca Cost Optimization"}),(0,N.jsxs)("ul",{className:"text-gray-600 space-y-1",children:[(0,N.jsx)("li",{children:"\u2022 Compare supplier prices monthly"}),(0,N.jsx)("li",{children:"\u2022 Track seasonal price variations"}),(0,N.jsx)("li",{children:"\u2022 Identify bulk discount opportunities"})]})]})]})]}),y>0&&(0,N.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[(0,N.jsxs)("div",{className:"flex items-center mb-3",children:[(0,N.jsx)("div",{className:"p-2 bg-red-100 rounded-lg mr-3",children:(0,N.jsx)(K,{className:"w-5 h-5 text-red-600"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Monthly Items Need Attention"}),(0,N.jsxs)("p",{className:"text-red-600 text-sm",children:[y," monthly items are out of stock and may need immediate ordering"]})]})]}),(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.filter((e=>0===e.currentStock)).map((e=>(0,N.jsxs)("div",{className:"bg-white p-3 rounded-lg border-l-4 border-red-500",children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsxs)("div",{className:"text-sm text-red-600",children:["Out of stock - Min required: ",e.minLevel," ",e.unit]}),(0,N.jsx)("div",{className:"text-xs text-gray-500 capitalize",children:e.category})]},e.id)))})]}),s&&(0,N.jsx)(ht,{frequency:"monthly",selectedItemId:o,onClose:()=>{r(!1),l(null)}}),a&&(0,N.jsx)(mt,{frequency:"monthly",selectedItemId:o,onClose:()=>{i(!1),l(null)}})]})},xt=o("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),yt=()=>{const{dailyItems:e,weeklyItems:t,monthlyItems:n,activityLog:s}=Ze(),r=[...e,...t,...n],a=r.filter((e=>"critical"===He(e).status)),i=r.filter((e=>"low"===He(e).status)),o=r.reduce(((e,t)=>e+t.cost*t.currentStock),0),l=s.filter((e=>new Date(e.timestamp).toDateString()===(new Date).toDateString())),c=l.filter((e=>"waste"===e.type)).reduce(((e,t)=>e+t.quantity),0),d=l.filter((e=>"waste"===e.type)).reduce(((e,t)=>{const n=r.find((e=>e.name===t.item));return e+t.quantity*((null===n||void 0===n?void 0:n.cost)||0)}),0);return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center",children:[(0,N.jsx)(Re,{className:"w-6 h-6 mr-2 text-purple-600"}),"Inventory Analytics Dashboard"]}),(0,N.jsx)("p",{className:"text-gray-600",children:"Overview of inventory status, trends, and performance metrics"})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Items"}),(0,N.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:r.length}),(0,N.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Daily: ",e.length," | Weekly: ",t.length," | Monthly: ",n.length]})]}),(0,N.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,N.jsx)(Re,{className:"w-6 h-6 text-blue-600"})})]})}),(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Critical Items"}),(0,N.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a.length}),(0,N.jsx)("p",{className:"text-xs text-red-500 mt-1",children:a.length>0?"Immediate attention required":"All items properly stocked"})]}),(0,N.jsx)("div",{className:"p-3 bg-red-100 rounded-lg",children:(0,N.jsx)(ze,{className:"w-6 h-6 text-red-600"})})]})}),(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Inventory Value"}),(0,N.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["\u20ac",o.toFixed(2)]}),(0,N.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Current stock value"})]}),(0,N.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,N.jsx)(xt,{className:"w-6 h-6 text-green-600"})})]})}),(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Waste"}),(0,N.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:c}),(0,N.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Items wasted today"})]}),(0,N.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg",children:(0,N.jsx)(h,{className:"w-6 h-6 text-orange-600"})})]})})]}),(0,N.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Stock Status Distribution"}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Normal Stock"})]}),(0,N.jsx)("span",{className:"font-semibold text-green-600",children:r.filter((e=>"normal"===He(e).status)).length})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Low Stock"})]}),(0,N.jsx)("span",{className:"font-semibold text-yellow-600",children:i.length})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Critical Stock"})]}),(0,N.jsx)("span",{className:"font-semibold text-red-600",children:a.length})]})]})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Today's Activity Summary"}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udcdd"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Count Updates"})]}),(0,N.jsx)("span",{className:"font-semibold text-blue-600",children:l.filter((e=>"count_update"===e.type)).length})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\uddd1\ufe0f"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Waste Reports"})]}),(0,N.jsx)("span",{className:"font-semibold text-orange-600",children:l.filter((e=>"waste"===e.type)).length})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udcb0"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Waste Value"})]}),(0,N.jsxs)("span",{className:"font-semibold text-red-600",children:["\u20ac",d.toFixed(2)]})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-2",children:"\ud83d\udce5"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:"Manual Adds"})]}),(0,N.jsx)("span",{className:"font-semibold text-green-600",children:l.filter((e=>"manual_add"===e.type)).length})]})]})]})]}),a.length>0&&(0,N.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[(0,N.jsxs)("div",{className:"flex items-center mb-4",children:[(0,N.jsx)(ze,{className:"w-6 h-6 text-red-600 mr-2"}),(0,N.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"\ud83d\udea8 Critical Stock Alert"})]}),(0,N.jsx)("p",{className:"text-red-700 mb-4",children:"The following items are critically low and require immediate restocking:"}),(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map((e=>(0,N.jsxs)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-red-500",children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsxs)("div",{className:"text-sm text-red-600",children:["Current: ",(0,N.jsxs)("span",{className:"font-bold",children:[e.currentStock," ",e.unit]})," | Min Required: ",(0,N.jsxs)("span",{className:"font-bold",children:[e.minLevel," ",e.unit]})]}),(0,N.jsx)("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:e.category}),(0,N.jsxs)("div",{className:"text-xs text-red-500 mt-1",children:["Shortage: ",e.minLevel-e.currentStock," ",e.unit]})]},e.id)))})]}),(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,N.jsxs)("div",{className:"p-6 border-b",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Recent Activity Log"}),(0,N.jsx)("p",{className:"text-gray-600 text-sm",children:"Latest inventory transactions and updates"})]}),(0,N.jsx)("div",{className:"p-6",children:0===s.length?(0,N.jsxs)("div",{className:"text-center py-8",children:[(0,N.jsx)("div",{className:"text-gray-400 text-4xl mb-2",children:"\ud83d\udccb"}),(0,N.jsx)("p",{className:"text-gray-500",children:"No activity recorded yet"}),(0,N.jsx)("p",{className:"text-sm text-gray-400",children:"Start by updating item counts or reporting waste"})]}):(0,N.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:s.slice(0,20).map((e=>(0,N.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("span",{className:"text-lg mr-3",children:"count_update"===e.type?"\ud83d\udcdd":"waste"===e.type?"\ud83d\uddd1\ufe0f":"import"===e.type?"\ud83d\udce5":"\u2795"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.item}),(0,N.jsxs)("div",{className:"text-sm text-gray-600",children:["count_update"===e.type&&"Updated count to ".concat(e.quantity," ").concat(e.unit),"waste"===e.type&&"Wasted ".concat(e.quantity," ").concat(e.unit," - ").concat(e.reason),"import"===e.type&&"Imported ".concat(e.quantity," ").concat(e.unit),"manual_add"===e.type&&"Added to database"]})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsx)("div",{className:"text-sm text-gray-500",children:e.employee}),(0,N.jsx)("div",{className:"text-xs text-gray-400",children:e.timestamp})]})]},e.id)))})})]})]})},vt=()=>((0,e.useEffect)((()=>{let e=document.getElementById("toastContainer");return e||(e=document.createElement("div"),e.id="toastContainer",e.className="fixed top-4 right-4 z-50 space-y-2 pointer-events-none",document.body.appendChild(e)),()=>{const e=document.getElementById("toastContainer");e&&0===e.children.length&&e.remove()}}),[]),(0,N.jsx)("div",{id:"toastContainer",className:"fixed top-4 right-4 z-50 space-y-2 pointer-events-none",style:{zIndex:9999}})),bt=()=>{const{dailyItems:e,weeklyItems:t,monthlyItems:n,databaseItems:s}=Ze(),r=[...e,...t,...n],a=r.filter((e=>"critical"===He(e).status)).length,i=r.filter((e=>"low"===He(e).status)).length,o=r.filter((e=>"normal"===He(e).status)).length,l=s.length;return(0,N.jsxs)("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 md:p-6",children:[(0,N.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4",children:(0,N.jsxs)("div",{className:"flex items-center mb-4 sm:mb-0",children:[(0,N.jsx)("div",{className:"bg-orange-500 p-2 md:p-3 rounded-lg mr-3 md:mr-4",children:(0,N.jsx)(p,{className:"text-white w-6 h-6 md:w-8 md:h-8"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:"Restaurant Inventory"}),(0,N.jsx)("p",{className:"text-sm md:text-base text-gray-600",children:"Track usage, waste, and consumption patterns"})]})]})}),(0,N.jsxs)("div",{className:"space-y-3",children:[a>0&&(0,N.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 rounded-lg",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(ze,{className:"w-5 h-5 text-red-600 mr-2"}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("div",{className:"text-sm font-medium text-red-800",children:[a," Critical Item",a>1?"s":""," Need Attention"]}),(0,N.jsx)("div",{className:"text-xs text-red-600",children:"Immediate restocking required"})]}),(0,N.jsx)("div",{className:"text-2xl font-bold text-red-700",children:a})]})}),(0,N.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,N.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs font-medium text-yellow-600",children:"Low Stock"}),(0,N.jsx)("div",{className:"text-lg font-bold text-yellow-800",children:i})]}),(0,N.jsx)(qe,{className:"w-4 h-4 text-yellow-600"})]})}),(0,N.jsx)("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs font-medium text-green-600",children:"Good Stock"}),(0,N.jsx)("div",{className:"text-lg font-bold text-green-800",children:o})]}),(0,N.jsx)(We,{className:"w-4 h-4 text-green-600"})]})}),(0,N.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs font-medium text-blue-600",children:"Database"}),(0,N.jsx)("div",{className:"text-lg font-bold text-blue-800",children:l})]}),(0,N.jsx)(x,{className:"w-4 h-4 text-blue-600"})]})}),(0,N.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-xs font-medium text-gray-600",children:"Total Items"}),(0,N.jsx)("div",{className:"text-lg font-bold text-gray-800",children:r.length})]}),(0,N.jsx)(Y,{className:"w-4 h-4 text-gray-600"})]})})]})]})]})},wt=()=>{const{currentTab:e,switchTab:t,dailyItems:n,weeklyItems:s,monthlyItems:r,databaseItems:a}=Ze(),i=[{id:"daily",label:"Daily",icon:Be,count:n.length,color:"red"},{id:"weekly",label:"Weekly",icon:pe,count:s.length,color:"yellow"},{id:"monthly",label:"Monthly",icon:Y,count:r.length,color:"green"},{id:"database",label:"Database",icon:x,count:a.length,color:"blue"},{id:"reports",label:"Analytics",icon:Re,count:0,color:"purple"}];return(0,N.jsx)("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-2",children:(0,N.jsx)("div",{className:"flex space-x-2 overflow-x-auto scrollbar-hide pb-2",children:i.map((n=>{const s=n.icon,r=e===n.id;return(0,N.jsxs)("button",{onClick:()=>t(n.id),className:"flex-shrink-0 flex items-center justify-center px-3 py-2 md:px-4 md:py-3 rounded-lg transition-all font-medium min-w-max ".concat(r?"bg-".concat(n.color,"-500 text-white"):"text-gray-600 hover:bg-gray-100"),children:[(0,N.jsx)(s,{className:"w-4 h-4 md:w-5 md:h-5 mr-1 md:mr-2"}),(0,N.jsx)("span",{className:"text-sm md:text-base",children:n.label}),(0,N.jsx)("span",{className:"ml-1 md:ml-2 px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs ".concat(r?"bg-".concat(n.color,"-600"):"bg-gray-300 text-gray-700"),children:n.count})]},n.id)}))})})},jt=()=>{const{currentTab:e}=Ze();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(vt,{}),(0,N.jsx)(bt,{}),(0,N.jsx)(wt,{}),(()=>{switch(e){case"daily":default:return(0,N.jsx)(pt,{});case"weekly":return(0,N.jsx)(ft,{});case"monthly":return(0,N.jsx)(gt,{});case"database":return(0,N.jsx)(ct,{});case"reports":return(0,N.jsx)(yt,{})}})()]})},Nt=e=>{let{currentUser:t,connectionStatus:n,inventoryDailyItems:s,inventoryWeeklyItems:r,inventoryMonthlyItems:a,inventoryDatabaseItems:i,inventoryActivityLog:o,inventoryCustomCategories:l,setInventoryDailyItems:c,setInventoryWeeklyItems:d,setInventoryMonthlyItems:u,setInventoryDatabaseItems:h,setInventoryActivityLog:m,setInventoryCustomCategories:p,quickSave:f}=e;return(0,N.jsx)(Xe,{inventoryDailyItems:s,inventoryWeeklyItems:r,inventoryMonthlyItems:a,inventoryDatabaseItems:i,inventoryActivityLog:o,inventoryCustomCategories:l,setInventoryDailyItems:c,setInventoryWeeklyItems:d,setInventoryMonthlyItems:u,setInventoryDatabaseItems:h,setInventoryActivityLog:m,setInventoryCustomCategories:p,quickSave:f,children:(0,N.jsx)(jt,{})})},kt=o("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),_t=o("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),Ct=o("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),St=o("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),It=o("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Tt=o("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Et=o("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),At=o("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Dt=o("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Pt=t=>{let{isLoading:n,lastSync:r,connectionStatus:a,loadFromFirebase:i,activeDevices:o=[],syncEvents:l=[],deviceCount:c=1,isMultiDeviceEnabled:d=!0,toggleMultiDeviceSync:u=()=>{},refreshFromAllDevices:h=()=>{},conflictCount:m=0}=t;const[p,f]=(0,e.useState)(!1),[g,x]=(0,e.useState)(!1),[y,v]=(0,e.useState)(null),[w,j]=(0,e.useState)({x:"right",y:window.innerHeight-100}),[k,_]=(0,e.useState)(!1),[C,S]=(0,e.useState)({x:0,y:0}),[I,T]=(0,e.useState)({x:0,y:0,startY:0,startSide:"right"}),E=(0,e.useRef)(null);(0,e.useEffect)((()=>{const e=()=>{j((e=>(0,s.A)((0,s.A)({},e),{},{y:Math.min(e.y,window.innerHeight-100)})))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,e.useEffect)((()=>{if(l.length>0){const e=l.filter((e=>Date.now()-e.timestamp<3e3));if(e.length>0){const t=e[0];v(t),f(!0);const n=setTimeout((()=>{f(!1),v(null)}),2e3);return()=>clearTimeout(n)}}}),[l]);const A=e=>{const t=Date.now()-e;return t<6e4?"Just now":t<36e5?"".concat(Math.floor(t/6e4),"m ago"):t<864e5?"".concat(Math.floor(t/36e5),"h ago"):"".concat(Math.floor(t/864e5),"d ago")};(0,e.useEffect)((()=>{const e=e=>{if(!k)return;const t=e.clientX-I.x,n=e.clientY-I.y,s=Math.max(16,Math.min(window.innerWidth-56,("left"===I.startSide?16:window.innerWidth-56)+t)),r=Math.max(24,Math.min(window.innerHeight-64,I.startY+n));S({x:s,y:r})},t=e=>{if(!k)return;e.preventDefault();const t=e.touches[0],n=t.clientX-I.x,s=t.clientY-I.y,r=Math.max(16,Math.min(window.innerWidth-56,("left"===I.startSide?16:window.innerWidth-56)+n)),a=Math.max(24,Math.min(window.innerHeight-64,I.startY+s));S({x:r,y:a})},n=e=>{if(!k)return;const t=e.clientX-I.x,n=e.clientY-I.y,s=("left"===I.startSide?16:window.innerWidth-56)+t>window.innerWidth/2?"right":"left",r=Math.max(24,Math.min(window.innerHeight-64,I.startY+n));j({x:s,y:r}),_(!1)},s=e=>{if(!k)return;const t=e.changedTouches[0],n=t.clientX-I.x,s=t.clientY-I.y,r=("left"===I.startSide?16:window.innerWidth-56)+n>window.innerWidth/2?"right":"left",a=Math.max(24,Math.min(window.innerHeight-64,I.startY+s));j({x:r,y:a}),_(!1)};return k&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",s)),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",s)}}),[k,I]);const D=n?{icon:(0,N.jsx)(St,{className:"w-3 h-3 animate-spin"}),text:y?"Syncing ".concat(y.field||"data"):"Syncing",bgColor:"bg-blue-500/90",pulseColor:"bg-blue-400"}:"connected"===a&&r?{icon:p?(0,N.jsx)(St,{className:"w-3 h-3 animate-spin"}):c>1?(0,N.jsx)(b,{className:"w-3 h-3"}):(0,N.jsx)(It,{className:"w-3 h-3"}),text:p?y?"Syncing ".concat(y.field||"data"):"Syncing":c>1?"".concat(c," devices"):"Synced",bgColor:"bg-emerald-500/90",pulseColor:"bg-emerald-400"}:"error"===a?{icon:(0,N.jsx)(Tt,{className:"w-3 h-3"}),text:"Offline",bgColor:"bg-red-500/90",pulseColor:"bg-red-400"}:{icon:(0,N.jsx)(Et,{className:"w-3 h-3"}),text:"Connecting",bgColor:"bg-amber-500/90",pulseColor:"bg-amber-400"},P=(()=>{const e=window.innerHeight,t=window.innerWidth,n=w.y+450+8>e-20;let s="0px";"left"===w.x?(s="".concat(48,"px"),384>t&&(s="-".concat(272,"px"))):(s="-".concat(328,"px"),328>t-64&&(s="".concat(48,"px")));let r="0px";return r=n?"-".concat(458,"px"):"".concat(48,"px"),{translateX:s,translateY:r,isAbove:n}})();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{ref:E,className:"\n          fixed z-50 transition-all duration-300 ease-out\n          ".concat(k?"transition-none":"","\n          ").concat(k?"scale-110 cursor-grabbing":"cursor-grab hover:scale-105","\n        "),style:{left:k?"".concat(C.x,"px"):"left"===w.x?"16px":void 0,right:k?void 0:"right"===w.x?"16px":void 0,top:"".concat(k?C.y:w.y,"px")},onMouseDown:e=>{var t;e.preventDefault(),_(!0);const n=null===(t=E.current)||void 0===t?void 0:t.getBoundingClientRect();n&&(S({x:n.left,y:n.top}),T({x:e.clientX,y:e.clientY,startY:w.y,startSide:w.x}))},onTouchStart:e=>{var t;e.preventDefault(),_(!0);const n=e.touches[0],s=null===(t=E.current)||void 0===t?void 0:t.getBoundingClientRect();s&&(S({x:s.left,y:s.top}),T({x:n.clientX,y:n.clientY,startY:w.y,startSide:w.x}))},children:[(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)("div",{className:"absolute inset-0 rounded-full bg-black/10 blur-md scale-110"}),(0,N.jsxs)("div",{className:"\n              relative w-10 h-10 rounded-full transform transition-all duration-300\n              ".concat(p?"animate-pulse":"","\n            "),onClick:e=>{k||(e.stopPropagation(),"error"===a?i():x(!g))},title:"".concat(D.text).concat(r?" - Last sync: ".concat(r):""),children:[(0,N.jsx)("div",{className:"\n              absolute inset-0 rounded-full backdrop-blur-xl ".concat(D.bgColor,"\n              border border-white/40 shadow-lg\n            ")}),(0,N.jsx)("div",{className:"absolute inset-0.5 rounded-full bg-gradient-to-tr from-white/25 to-transparent"}),(0,N.jsx)("div",{className:"relative flex items-center justify-center w-full h-full text-white",children:D.icon}),"connected"===a&&c>1?(0,N.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full backdrop-blur-xl bg-blue-500/95  border border-white/60 shadow-md flex items-center justify-center text-xs font-bold text-white",children:c}):null,p&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"absolute inset-0 rounded-full animate-ping",children:(0,N.jsx)("div",{className:"w-full h-full rounded-full ".concat(D.pulseColor,"/50 border border-current")})}),(0,N.jsx)("div",{className:"absolute inset-0 rounded-full animate-ping",style:{animationDelay:"150ms"},children:(0,N.jsx)("div",{className:"w-full h-full rounded-full ".concat(D.pulseColor,"/30 border border-current scale-125")})})]}),m&&m>0?(0,N.jsxs)("div",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs px-2 py-0.5 rounded-full animate-pulse z-50",children:[m," conflict",m>1?"s":""]}):null]})]}),g&&!k&&(0,N.jsxs)("div",{className:"absolute z-40 w-80",style:{transform:"translate(".concat(P.translateX,", ").concat(P.translateY,")"),transformOrigin:P.isAbove?"bottom center":"top center"},children:[(0,N.jsx)("div",{className:"absolute w-0.5 bg-gradient-to-b from-blue-500/30 to-purple-500/30 ".concat(P.isAbove?"bottom-0 h-2 translate-y-full":"top-0 h-2 -translate-y-full"),style:{left:"left"===w.x?"-9px":"calc(100% + 8px)"}}),(0,N.jsxs)("div",{className:"relative bg-white/95 backdrop-blur-xl rounded-xl shadow-xl border border-white/50 overflow-hidden",children:[(0,N.jsx)("div",{className:"bg-gradient-to-r from-emerald-500/15 to-blue-500/15 px-4 py-3 border-b border-white/30",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-emerald-500 to-blue-500 flex items-center justify-center",children:(0,N.jsx)(b,{className:"w-3 h-3 text-white"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{className:"text-sm font-semibold text-gray-800",children:"Multi-Device Sync"}),(0,N.jsxs)("div",{className:"text-xs text-gray-600",children:[c," device",1!==c?"s":""," connected"]})]})]}),(0,N.jsx)("button",{onClick:e=>{e.stopPropagation(),x(!1)},className:"w-6 h-6 rounded-full bg-white/30 backdrop-blur-sm border border-white/40  text-gray-600 hover:text-gray-800 hover:bg-white/50 transition-all duration-200 flex items-center justify-center text-xs",children:"\u2715"})]})}),(0,N.jsxs)("div",{className:"p-4 space-y-4 max-h-80 overflow-y-auto",children:[(0,N.jsxs)("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Real-time Sync"}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===a?"bg-green-500":"bg-red-500")}),(0,N.jsx)("span",{className:"text-xs font-medium ".concat("connected"===a?"text-green-600":"text-red-600"),children:"connected"===a?"Active":"Offline"})]})]}),(0,N.jsx)("div",{className:"text-xs text-gray-600",children:"connected"===a?"All changes sync automatically across devices":"connecting"===a?"Connecting to sync service...":"Connection failed - working offline"}),r&&(0,N.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Last sync: ",r]})]}),(0,N.jsxs)("div",{className:"bg-white/30 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,N.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Connected Devices (",o.length,")"]}),(0,N.jsx)("button",{onClick:e=>{e.stopPropagation(),h()},className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full hover:bg-blue-200 transition-colors",children:"Refresh"})]}),o.length>0?(0,N.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:o.map(((e,t)=>{return(0,N.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white/40 rounded-lg",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.isActive?"bg-green-500":"bg-gray-400")}),(0,N.jsx)("div",{className:"text-blue-600",children:(n=e,"mobile"===n.platform?(0,N.jsx)(kt,{className:"w-3 h-3"}):"tablet"===n.platform?(0,N.jsx)(_t,{className:"w-3 h-3"}):(0,N.jsx)(Ct,{className:"w-3 h-3"}))}),(0,N.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,N.jsx)("div",{className:"text-xs font-medium text-gray-700 truncate",children:e.name}),(0,N.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:[e.user," \u2022 ",e.browserInfo]})]})]}),(0,N.jsx)("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:A(e.lastSeen)})]},e.id);var n}))}):(0,N.jsx)("div",{className:"text-center py-4 text-xs text-gray-500",children:"No other devices connected"})]}),l.length>0&&(0,N.jsxs)("div",{className:"bg-white/30 backdrop-blur-sm rounded-lg p-3 border border-white/30",children:[(0,N.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Activity"}),(0,N.jsx)("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:l.slice(0,5).map(((e,t)=>(0,N.jsxs)("div",{className:"text-xs text-gray-600 flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[(0,N.jsx)("div",{className:"w-1.5 h-1.5 rounded-full flex-shrink-0 ".concat("data_update"===e.type?"bg-blue-500":"device_join"===e.type?"bg-green-500":"device_leave"===e.type?"bg-red-500":"bg-purple-500")}),(0,N.jsx)("span",{className:"truncate",children:e.description||"".concat(e.field||"Data"," ").concat("data_update"===e.type?"updated":e.type.replace("_"," "))})]}),(0,N.jsx)("span",{className:"text-gray-400 whitespace-nowrap ml-2",children:A(e.timestamp)})]},t)))})]}),(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsx)("button",{onClick:e=>{e.stopPropagation(),"error"===a?i():h()},className:"flex-1 py-2 px-3 bg-gradient-to-r from-emerald-500 to-blue-500  text-white rounded-lg hover:from-emerald-600 hover:to-blue-600  transition-all duration-300 text-xs font-semibold shadow-md transform hover:scale-105",children:"error"===a?"Reconnect":"Refresh All"}),(0,N.jsx)("button",{onClick:e=>{e.stopPropagation(),u()},className:"py-2 px-3 bg-white/20 backdrop-blur-sm border border-white/30  text-gray-700 rounded-lg hover:bg-white/30  transition-all duration-300 text-xs font-semibold",title:d?"Disable sync":"Enable sync",children:d?(0,N.jsx)(At,{className:"w-3 h-3"}):(0,N.jsx)(Dt,{className:"w-3 h-3"})})]})]})]})]})]}),g&&(0,N.jsx)("div",{className:"fixed inset-0 z-30",onClick:()=>x(!1)})]})};var Rt=n(277),Mt=n(291),Lt=n(578),Ot=n(815);const Ft=e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||Date.now()+Math.random(),prepId:e.prepId||0,name:e.name||"Unknown Prep",category:e.category||"muut",estimatedTime:e.estimatedTime||"30 min",isCustom:e.isCustom||!1,hasRecipe:e.hasRecipe||!1,recipe:e.recipe||null,scheduledDate:e.scheduledDate||(0,j.po)(new Date),priority:e.priority||"medium",timeSlot:e.timeSlot||"",completed:"boolean"===typeof e.completed&&e.completed,assignedTo:e.assignedTo||null,notes:e.notes||""}))):[],Ut=()=>{const[t,n]=(0,e.useState)(!1),[r,a]=(0,e.useState)(null),[i,o]=(0,e.useState)("connecting"),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)([]),[h,m]=(0,e.useState)({}),[p,f]=(0,e.useState)(new Set),[g,x]=(0,e.useState)({}),[y,v]=(0,e.useState)(["Cleaner","Manager","Supervisor"]),[b,N]=(0,e.useState)([]),[k,_]=(0,e.useState)([]),[C,S]=(0,e.useState)({}),[I,T]=(0,e.useState)([]),[E,A]=(0,e.useState)([]),[D,P]=(0,e.useState)([]),[R,M]=(0,e.useState)([]),[L,O]=(0,e.useState)([]),[F,U]=(0,e.useState)([]),[z,q]=(0,e.useState)([]),W=new Rt.f,B=(0,e.useRef)(null),V=(0,e.useRef)(""),H=(0,e.useRef)(!1),K=(0,e.useRef)(!1),Y=(0,e.useCallback)((async(e,t)=>{console.log("\ud83d\udd25 QuickSave: ".concat(e));try{const n="https://hamptown-panel-default-rtdb.firebaseio.com";let r=t instanceof Set?Array.from(t):t;if("scheduledPreps"===e){const e=(0,j.po)(new Date),t=r.filter((t=>t.scheduledDate===e)),n=t.filter((e=>!0===e.completed));console.log("\ud83d\udd0d Saving scheduledPreps to Firebase:",{totalCount:r.length,todayCount:t.length,todayCompletedCount:n.length,completionPercentage:t.length>0?Math.round(n.length/t.length*100):0,sampleTodayPreps:t.slice(0,3).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate})))}),r=r.map((e=>(0,s.A)((0,s.A)({},e),{},{completed:Boolean(e.completed)})))}if(["scheduledPreps","completedTasks","taskAssignments","dailyData"].includes(e)){console.log("\ud83d\udd12 Critical save - waiting for confirmation:",e);const t=await fetch("".concat(n,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok)throw new Error("Critical save failed: ".concat(t.status));a((new Date).toLocaleTimeString()),o("connected"),console.log("\u2705 Critical QuickSave completed:",e),"scheduledPreps"===e&&setTimeout((async()=>{try{const t=await fetch("".concat(n,"/").concat(e,".json")),s=await t.json();if(s){const e=(0,j.po)(new Date),t=s.filter((t=>t.scheduledDate===e)),n=t.filter((e=>!0===e.completed));console.log("\ud83d\udd0d Verified scheduledPreps in Firebase after save:",{totalCount:s.length,todayCount:t.length,todayCompletedCount:n.length,completionPercentage:t.length>0?Math.round(n.length/t.length*100):0});const a=r.filter((t=>t.scheduledDate===e&&!0===t.completed)).length;n.length!==a?console.warn("\u26a0\ufe0f Completion count mismatch after save!",{sent:a,verified:n.length}):console.log("\u2705 Completion status successfully verified")}else console.warn("\u26a0\ufe0f No data returned from verification")}catch(t){console.warn("\u26a0\ufe0f Failed to verify save:",t)}}),500)}else fetch("".concat(n,"/").concat(e,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((t=>{if(!t.ok)throw new Error("Save failed: ".concat(t.status));a((new Date).toLocaleTimeString()),o("connected"),console.log("\u2705 QuickSave completed:",e)})).catch((e=>{console.warn("\u26a0\ufe0f QuickSave failed (non-blocking):",e),o("error")}));return!0}catch(n){return console.error("\u274c QuickSave error:",n),o("error"),!1}}),[]),Q=((0,e.useCallback)((async()=>{}),[]),(0,e.useCallback)((async()=>{}),[l,d,h,p,g,y,b,k,C,I])),$=(0,e.useCallback)((async()=>{if(K.current||"error"===i)return void console.log("\u23ed\ufe0f Skipping save (already saving or offline)");const e=JSON.stringify({employees:l.length,tasks:d.length,dailyDataKeys:Object.keys(h).length,completedTasksSize:p.size,taskAssignmentsKeys:Object.keys(g).length,customRolesLength:y.length,prepItemsLength:b.length,scheduledPrepsLength:k.length,prepSelectionsKeys:Object.keys(C).length,storeItemsLength:I.length,inventoryDailyItemsLength:E.length,inventoryWeeklyItemsLength:D.length,inventoryMonthlyItemsLength:R.length,inventoryDatabaseItemsLength:L.length,inventoryActivityLogLength:F.length});if(e!==V.current){K.current=!0,console.log("\ud83d\udcbe Saving data (non-blocking)...");try{await W.saveData({employees:l,tasks:d,dailyData:h,completedTasks:p,taskAssignments:g,customRoles:y,prepItems:b,scheduledPreps:k,prepSelections:C,storeItems:I,inventoryDailyItems:E,inventoryWeeklyItems:D,inventoryMonthlyItems:R,inventoryDatabaseItems:L,inventoryActivityLog:F}),a((new Date).toLocaleTimeString()),V.current=e,o("connected")}catch(t){console.error("\u274c Save failed:",t),o("error")}finally{K.current=!1}}}),[l,d,h,p,g,y,b,k,C,I,E,D,R,L,F,i,Q]),G=(0,e.useCallback)((()=>{"connected"===i?(B.current&&clearTimeout(B.current),B.current=setTimeout((()=>{$()}),2e3)):console.warn("\u26d4 Not saving to Firebase: offline or error connection")}),[$,i]),J=(0,e.useCallback)((async()=>{if(!t){n(!0),o("connecting");try{console.log("\ud83d\udce1 Loading data (fast mode)...");const e=W.loadData(),t=new Promise(((e,t)=>setTimeout((()=>t(new Error("Load timeout"))),1e4))),n=await Promise.race([e,t]),s=(e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||0,name:e.name||"Unknown",mood:e.mood||3,lastUpdated:e.lastUpdated||"Not updated",role:e.role||"Cleaner",lastMoodDate:e.lastMoodDate||null,points:"number"===typeof e.points?e.points:0}))):(0,Mt.PR)())(n.employees),r=(e=>e&&Array.isArray(e)?e.map((e=>({id:e.id||0,task:e.task||"Unknown Task",location:e.location||"Unknown Location",priority:e.priority||"medium",estimatedTime:e.estimatedTime||"30 min",points:"number"===typeof e.points?e.points:5}))):(0,Mt.w4)())(n.tasks),i=Ft(n.scheduledPreps||[]);console.log("\ud83d\udd0d Loading scheduledPreps from Firebase:",{count:i.length,todayPreps:i.filter((e=>e.scheduledDate===(0,j.po)(new Date))).length,todayCompleted:i.filter((e=>e.scheduledDate===(0,j.po)(new Date)&&!0===e.completed)).length,sampleData:i.slice(0,5).map((e=>({id:e.id,name:e.name,completed:e.completed,scheduledDate:e.scheduledDate}))),rawDataSample:n.scheduledPreps?n.scheduledPreps.slice(0,3):"No raw data"}),c(s),u(r),m(n.dailyData),f(new Set(n.completedTasks)),x(n.taskAssignments),v(n.customRoles),N(n.prepItems||[]),_(i),S(n.prepSelections||{}),T(n.storeItems||(0,Mt.h3)()),A(n.inventoryDailyItems||[]),P(n.inventoryWeeklyItems||[]),M(n.inventoryMonthlyItems||[]),O(n.inventoryDatabaseItems||[]),U(n.inventoryActivityLog||[]),q(n.inventoryCustomCategories||[]);const l=(0,j.po)(new Date),d=i.filter((e=>e.scheduledDate===l)),h=d.filter((e=>!0===e.completed));console.log("\u2705 Set scheduledPreps state:",{count:i.length,todayCount:d.length,todayCompletedCount:h.length,completionPercentage:d.length>0?Math.round(h.length/d.length*100):0}),o("connected"),a((new Date).toLocaleTimeString()),V.current=JSON.stringify({loaded:!0}),H.current=!0,console.log("\u2705 Data loaded successfully")}catch(e){console.error("\u274c Load failed:",e),o("error"),H.current||(console.log("\u26a0\ufe0f Setting defaults due to load failure - sync disabled until manual load succeeds"),c((0,Mt.PR)()),u((0,Mt.w4)()),m((0,Mt.tU)()),N([]),_([]),S({}),T((0,Mt.h3)()))}finally{n(!1)}}}),[t]);(0,e.useEffect)((()=>{if(H.current&&!K.current){const e=setTimeout((()=>{G()}),1e3);return()=>clearTimeout(e)}}),[l,d,h,p,g,y,k]),(0,e.useEffect)((()=>{if(H.current){const e=setTimeout((()=>{G()}),3e3);return()=>clearTimeout(e)}}),[b,C,I]);const Z=(0,e.useRef)(null),X=(0,e.useRef)(null);Z.current||(Z.current=(0,Ot.Wp)(w.Nd),X.current=(0,Lt.C3)(Z.current)),(0,e.useEffect)((()=>{const e=X.current;if(!e)return;const t=(0,Lt.KR)(e,"employees"),n=e=>{const t=e.val()||[];c(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(t,n);const s=(0,Lt.KR)(e,"tasks"),r=e=>{const t=e.val()||[];u(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(s,r);const a=(0,Lt.KR)(e,"dailyData"),i=e=>{m(e.val()||{})};(0,Lt.Zy)(a,i);const o=(0,Lt.KR)(e,"completedTasks"),l=e=>{f(new Set(e.val()||[]))};(0,Lt.Zy)(o,l);const d=(0,Lt.KR)(e,"taskAssignments"),h=e=>{x(e.val()||{})};(0,Lt.Zy)(d,h);const p=(0,Lt.KR)(e,"customRoles"),g=e=>{v(Array.isArray(e.val())?e.val():[])};(0,Lt.Zy)(p,g);const y=(0,Lt.KR)(e,"prepItems"),b=e=>{const t=e.val()||[];N(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(y,b);const w=(0,Lt.KR)(e,"scheduledPreps"),j=e=>{const t=e.val()||[],n=Ft(Array.isArray(t)?t:Object.values(t));_(n)};(0,Lt.Zy)(w,j);const k=(0,Lt.KR)(e,"prepSelections"),C=e=>{S(e.val()||{})};(0,Lt.Zy)(k,C);const I=(0,Lt.KR)(e,"storeItems"),E=e=>{const t=e.val()||[];T(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(I,E);const D=(0,Lt.KR)(e,"inventoryDailyItems"),R=e=>{const t=e.val()||[];A(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(D,R);const L=(0,Lt.KR)(e,"inventoryWeeklyItems"),F=e=>{const t=e.val()||[];P(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(L,F);const z=(0,Lt.KR)(e,"inventoryMonthlyItems"),W=e=>{const t=e.val()||[];M(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(z,W);const B=(0,Lt.KR)(e,"inventoryDatabaseItems"),V=e=>{const t=e.val()||[];O(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(B,V);const H=(0,Lt.KR)(e,"inventoryActivityLog"),K=e=>{const t=e.val()||[];U(Array.isArray(t)?t:Object.values(t))};(0,Lt.Zy)(H,K);const Y=(0,Lt.KR)(e,"inventoryCustomCategories");return(0,Lt.Zy)(Y,(e=>{const t=e.val()||[];q(Array.isArray(t)?t:Object.values(t))})),()=>{(0,Lt.AU)(t,"value",n),(0,Lt.AU)(s,"value",r),(0,Lt.AU)(a,"value",i),(0,Lt.AU)(o,"value",l),(0,Lt.AU)(d,"value",h),(0,Lt.AU)(p,"value",g),(0,Lt.AU)(y,"value",b),(0,Lt.AU)(w,"value",j),(0,Lt.AU)(k,"value",C),(0,Lt.AU)(I,"value",E),(0,Lt.AU)(D,"value",R),(0,Lt.AU)(L,"value",F),(0,Lt.AU)(z,"value",W),(0,Lt.AU)(B,"value",V),(0,Lt.AU)(H,"value",K)}}),[]);return{isLoading:t,lastSync:r,connectionStatus:i,employees:l,tasks:d,dailyData:h,completedTasks:p,taskAssignments:g,customRoles:y,prepItems:b,scheduledPreps:k,prepSelections:C,storeItems:I,inventoryDailyItems:E,inventoryWeeklyItems:D,inventoryMonthlyItems:R,inventoryDatabaseItems:L,inventoryActivityLog:F,inventoryCustomCategories:z,setEmployees:c,setTasks:u,setDailyData:m,setCompletedTasks:f,setTaskAssignments:x,setCustomRoles:v,setPrepItems:N,setScheduledPreps:_,setPrepSelections:S,setStoreItems:T,setInventoryDailyItems:A,setInventoryWeeklyItems:P,setInventoryMonthlyItems:M,setInventoryDatabaseItems:O,setInventoryActivityLog:U,setInventoryCustomCategories:q,loadFromFirebase:J,saveToFirebase:G,quickSave:Y,applyTaskSyncOperation:e=>{u((t=>te(t,e)))}}};class zt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown User";this.baseUrl=w.Nd.databaseURL,this.deviceId=void 0,this.deviceInfo=void 0,this.presenceRef=void 0,this.syncCallbacks=new Map,this.isConnected=!1,this.heartbeatInterval=null,this.onDeviceCountChange=void 0,this.onSyncEvent=void 0,this.lastDataTimestamp=new Map,this.eventSource=null,this.connectionRetryCount=0,this.maxRetries=3,this.retryTimeout=null,this.syncQueue=new Map,this.syncTimer=null,this.isSyncing=!1,this.ourOperations=new Set,this.operationTimeout=3e4,this.deviceCountTimeout=null,this.deviceCache=null,this.DEVICE_CACHE_TTL=3e4,this.lastKnownData=new Map,this.deviceId=this.generateDeviceId(),this.deviceInfo=this.createDeviceInfo(e),this.presenceRef="presence/".concat(this.deviceId),console.log("\ud83d\udd04 Sync service initialized:",{deviceId:this.deviceId.substring(0,8)+"...",user:e}),window.addEventListener("beforeunload",(()=>{this.disconnect()})),document.addEventListener("visibilitychange",(()=>{document.hidden?this.updatePresence(!1):this.updatePresence(!0)}))}generateDeviceId(){let e=localStorage.getItem("workVibe_deviceId");if(!e){const t=Date.now().toString(36),n=Math.random().toString(36).substr(2,6);e="device_".concat(t,"_").concat(n),localStorage.setItem("workVibe_deviceId",e)}return e}createDeviceInfo(e){const t=navigator.userAgent;let n="Desktop",s="Browser";return/Mobile|Android|iPhone|iPod/.test(t)?n="Mobile":/iPad|Tablet/.test(t)&&(n="Tablet"),t.includes("Chrome")?s="Chrome":t.includes("Firefox")?s="Firefox":t.includes("Safari")&&(s="Safari"),{id:this.deviceId,name:"".concat(n," \u2022 ").concat(s),lastSeen:Date.now(),user:e,platform:n.toLowerCase(),isActive:!0,browserInfo:"".concat(s," on ").concat(navigator.platform||"Unknown")}}async connect(){if(this.isConnected)console.log("\u2705 Already connected");else try{console.log("\ud83d\udd17 Connecting sync service..."),this.updatePresence(!0).catch(console.warn),this.startListening(),this.startHeartbeat(),this.isConnected=!0,this.connectionRetryCount=0,this.emitSyncEvent({type:"device_join",timestamp:Date.now(),deviceId:this.deviceId,deviceName:this.deviceInfo.name,description:"".concat(this.deviceInfo.name," connected")}),console.log("\u2705 Sync service connected")}catch(e){console.error("\u274c Connection failed:",e),this.scheduleReconnect()}}async disconnect(){if(this.isConnected)try{console.log("\ud83d\udd0c Disconnecting..."),this.isConnected=!1,this.stopListening(),this.stopHeartbeat(),this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.syncTimer&&(clearTimeout(this.syncTimer),this.syncTimer=null),this.removePresence().catch(console.warn),console.log("\u2705 Disconnected")}catch(e){console.error("\u274c Disconnect error:",e)}}async updatePresence(e){this.deviceInfo=(0,s.A)((0,s.A)({},this.deviceInfo),{},{lastSeen:Date.now(),isActive:e});try{fetch("".concat(this.baseUrl,"/").concat(this.presenceRef,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.deviceInfo)}).then((e=>{e.ok&&(this.deviceCountTimeout&&clearTimeout(this.deviceCountTimeout),this.deviceCountTimeout=setTimeout((()=>{this.getActiveDevices().then((e=>{this.onDeviceCountChange&&(console.log("\ud83d\udcf1 Device count updated: ".concat(e.length," devices connected")),this.onDeviceCountChange(e.length,e))})).catch(console.warn)}),1e3))})).catch(console.warn)}catch(t){console.warn("\u26a0\ufe0f Presence update failed:",t)}}async removePresence(){try{await fetch("".concat(this.baseUrl,"/").concat(this.presenceRef,".json"),{method:"DELETE"})}catch(e){console.warn("\u26a0\ufe0f Failed to remove presence:",e)}}async getActiveDevices(){try{const e=Date.now();if(this.deviceCache&&e-this.deviceCache.timestamp<this.DEVICE_CACHE_TTL)return this.deviceCache.devices;const t=await fetch("".concat(this.baseUrl,"/presence.json")),n=await t.json();if(!n)return this.deviceCache={devices:[],timestamp:e},[];const s=Object.values(n).filter((t=>t.isActive&&e-t.lastSeen<3e5)).slice(0,10);return this.deviceCache={devices:s,timestamp:e},s}catch(e){return console.warn("\u26a0\ufe0f Failed to get devices:",e),[]}}startListening(){if(this.eventSource)return void console.log("\ud83d\udc42 Already listening");console.log("\ud83d\udc42 Starting single EventSource listener...");const e="".concat(this.baseUrl,"/.json");this.eventSource=new EventSource(e),this.eventSource.onmessage=e=>{try{const t=JSON.parse(e.data);if(null===t)return;console.log("\ud83d\udce5 Received data update"),this.processDataUpdate(t)}catch(t){console.warn("\u26a0\ufe0f Error processing data update:",t)}},this.eventSource.onerror=e=>{console.warn("\u26a0\ufe0f EventSource error:",e),this.handleConnectionError()}}processDataUpdate(e){const t=["employees","tasks","dailyData","completedTasks","taskAssignments","customRoles","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"];for(const n of t)if(e[n]&&this.syncCallbacks.has(n)){const t=this.syncCallbacks.get(n),s=Date.now();if(s-(this.lastDataTimestamp.get(n)||0)>3e3){const r="".concat(n,"_").concat(JSON.stringify(e[n]).slice(0,100));if(this.ourOperations.has(r)){console.log("\ud83d\udd04 [SYNC] ".concat(n," update ignored - this was our own operation"));continue}this.lastDataTimestamp.set(n,s);let a=e[n];"completedTasks"===n&&Array.isArray(a)&&(a=new Set(a)),console.log("\ud83d\udd04 [SYNC] Received ".concat(n," update from Firebase:"),Array.isArray(e[n])?e[n]:Object.keys(e[n]||{}).length);const i=this.hasDataChanged(n,a);i?(console.log("\ud83d\udd04 [SYNC] ".concat(n.charAt(0).toUpperCase()+n.slice(1)," actually changed, updating state")),t(a)):console.log("\ud83d\udd04 [SYNC] ".concat(n.charAt(0).toUpperCase()+n.slice(1)," unchanged, keeping current state")),i&&this.emitSyncEvent({type:"data_update",timestamp:s,deviceId:"remote",deviceName:"Remote Device",field:n,description:"".concat(n," updated")})}}}hasDataChanged(e,t){const n=this.lastKnownData.get(e);return JSON.stringify(t)!==JSON.stringify(n)&&(this.lastKnownData.set(e,t),!0)}stopListening(){this.eventSource&&(console.log("\ud83d\udd07 Stopping listener"),this.eventSource.close(),this.eventSource=null)}handleConnectionError(){this.stopListening(),this.connectionRetryCount<this.maxRetries?this.scheduleReconnect():(console.warn("\u26a0\ufe0f Max reconnection attempts reached"),this.isConnected=!1)}scheduleReconnect(){if(this.retryTimeout)return;this.connectionRetryCount++;const e=Math.min(1e3*Math.pow(2,this.connectionRetryCount),3e4);console.log("\ud83d\udd04 Reconnecting in ".concat(e/1e3,"s (attempt ").concat(this.connectionRetryCount,")")),this.retryTimeout=setTimeout((()=>{this.retryTimeout=null,this.isConnected||this.startListening()}),e)}async syncData(e,t){const n="".concat(e,"_").concat(JSON.stringify(t).slice(0,100));this.ourOperations.add(n),setTimeout((()=>{this.ourOperations.delete(n)}),this.operationTimeout),this.syncQueue.set(e,t),this.syncTimer&&clearTimeout(this.syncTimer),this.syncTimer=setTimeout((()=>{this.processSyncQueue()}),1500)}async processSyncQueue(){if(this.isSyncing||0===this.syncQueue.size)return;this.isSyncing=!0;const e=new Map(this.syncQueue);this.syncQueue.clear();try{console.log("\ud83d\udce4 Processing sync queue:",Array.from(e.keys()));const t=Array.from(e.entries()).map((async e=>{let[t,n]=e;try{let e=n instanceof Set?Array.from(n):n;const s=await fetch("".concat(this.baseUrl,"/").concat(t,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error("Sync failed for ".concat(t,": ").concat(s.status));console.log("\u2705 Synced ".concat(t)),this.emitSyncEvent({type:"data_update",timestamp:Date.now(),deviceId:this.deviceId,deviceName:this.deviceInfo.name,field:t,description:"".concat(t," synced")})}catch(s){console.warn("\u26a0\ufe0f Failed to sync ".concat(t,":"),s),this.syncQueue.set(t,n)}}));await Promise.allSettled(t)}catch(t){console.error("\u274c Sync queue processing failed:",t)}finally{this.isSyncing=!1,this.syncQueue.size>0&&setTimeout((()=>this.processSyncQueue()),2e3)}}startHeartbeat(){this.heartbeatInterval=setInterval((()=>{this.isConnected&&this.updatePresence(!0).catch(console.warn)}),9e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}onFieldChange(e,t){this.syncCallbacks.set(e,t)}offFieldChange(e){this.syncCallbacks.delete(e)}onDeviceCountChanged(e){this.onDeviceCountChange=e}onSyncEventReceived(e){this.onSyncEvent=e}emitSyncEvent(e){this.onSyncEvent&&this.onSyncEvent(e)}async refreshDataFromAllDevices(){try{console.log("\ud83d\udd04 Fast refresh...");const e=new AbortController,t=setTimeout((()=>e.abort()),8e3),n=["employees","tasks","dailyData","completedTasks","taskAssignments","prepItems","scheduledPreps","prepSelections","storeItems","inventoryDailyItems","inventoryWeeklyItems","inventoryMonthlyItems","inventoryDatabaseItems","inventoryActivityLog"],s=n.map((t=>fetch("".concat(this.baseUrl,"/").concat(t,".json"),{signal:e.signal}).then((e=>e.json())).then((e=>({[t]:e}))))),r=await Promise.allSettled(s);clearTimeout(t);const a={};return r.forEach(((e,t)=>{"fulfilled"===e.status?Object.assign(a,e.value):console.warn("\u26a0\ufe0f Failed to fetch ".concat(n[t],":"),e.reason)})),console.log("\u2705 Fast refresh completed"),a}catch(e){throw console.error("\u274c Fast refresh failed:",e),e}}getDeviceInfo(){return(0,s.A)((0,s.A)({},this.deviceInfo),{},{lastSeen:Date.now()})}updateCurrentUser(e){this.deviceInfo.user=e,this.updatePresence(!0).catch(console.warn)}getSyncStats(){var e;return{isConnected:this.isConnected,deviceCount:(null===(e=this.deviceCache)||void 0===e?void 0:e.devices.length)||0,lastSync:Math.max(...Array.from(this.lastDataTimestamp.values()),0),isListening:null!==this.eventSource,queueSize:this.syncQueue.size}}}const qt=()=>{const t=e.useRef(null);t.current||(t.current=new(n(277).f));const{isLoading:r,lastSync:a,connectionStatus:i,employees:o,tasks:b,dailyData:_,completedTasks:C,taskAssignments:S,customRoles:I,prepItems:T,scheduledPreps:E,prepSelections:A,storeItems:D,inventoryDailyItems:P,inventoryWeeklyItems:R,inventoryMonthlyItems:L,inventoryDatabaseItems:O,inventoryActivityLog:F,inventoryCustomCategories:U,setEmployees:z,setTasks:q,setDailyData:W,setCompletedTasks:V,setTaskAssignments:H,setCustomRoles:K,setPrepItems:Y,setScheduledPreps:Q,setPrepSelections:$,setStoreItems:G,setInventoryDailyItems:J,setInventoryWeeklyItems:Z,setInventoryMonthlyItems:te,setInventoryDatabaseItems:re,setInventoryActivityLog:ae,setInventoryCustomCategories:ie,loadFromFirebase:oe,saveToFirebase:le,quickSave:ce,applyTaskSyncOperation:de}=Ut();(0,e.useEffect)((()=>{if(!t.current)return;let e,n;const s=t.current.onCompletedTasksChange((t=>{clearTimeout(e),e=setTimeout((()=>{console.log("\ud83d\udd04 [SYNC] Received completedTasks update from Firebase:",t);const e=new Set(Array.isArray(t)?t:Array.from(t));V((t=>{const n=Array.from(t),s=Array.from(e);return n.length===s.length&&n.every((t=>e.has(t)))?(console.log("\ud83d\udd04 [SYNC] CompletedTasks unchanged, keeping current state"),t):(console.log("\ud83d\udd04 [SYNC] CompletedTasks actually changed, updating state"),e)}))}),150)})),r=t.current.onTaskAssignmentsChange((e=>{clearTimeout(n),n=setTimeout((()=>{console.log("\ud83d\udd04 [SYNC] Received taskAssignments update from Firebase:",e),H((t=>JSON.stringify(t)!==JSON.stringify(e||{})?(console.log("\ud83d\udd04 [SYNC] TaskAssignments actually changed, updating state"),e||{}):(console.log("\ud83d\udd04 [SYNC] TaskAssignments unchanged, keeping current state"),t)))}),150)}));return()=>{clearTimeout(e),clearTimeout(n),s&&s(),r&&r()}}),[V,H]);const{currentUser:ue,isAdmin:he,setIsAdmin:pe,switchUser:fe,logoutAdmin:xe}=(()=>{const[t,n]=(0,e.useState)({id:1,name:"Luka"}),[s,r]=(0,e.useState)(!1),a=(0,e.useCallback)((e=>{n({id:e.id,name:e.name}),localStorage.setItem("currentUserName",e.name)}),[]),i=(0,e.useCallback)((()=>{r(!1)}),[]);return(0,e.useEffect)((()=>{t.name&&localStorage.setItem("currentUserName",t.name)}),[t.name]),{currentUser:t,isAdmin:s,setCurrentUser:n,setIsAdmin:r,switchUser:a,logoutAdmin:i}})(),[ye,ve]=(0,e.useState)(3),[be,we]=(0,e.useState)("mood"),[je,Ne]=(0,e.useState)(!1),[ke,_e]=(0,e.useState)(!1),[Ce,Se]=(0,e.useState)(""),[Ie,Te]=(0,e.useState)((0,j.po)(new Date)),[Ee,Ae]=(0,e.useState)((0,Mt.h3)()),[De,Pe]=(0,e.useState)(!1),[Re,Me]=(0,e.useState)(0),[Le,Oe]=(0,e.useState)([]),[Fe,ze]=(0,e.useState)([]),[qe,We]=(0,e.useState)(1),[Be,Ve]=(0,e.useState)(!0),He=(0,e.useRef)(null),[Ke,Ye]=(0,e.useState)([]),[Qe,$e]=(0,e.useState)([]);(0,e.useEffect)((()=>{let e=!0;return(async()=>{e&&0===o.length&&(console.log("\ud83d\ude80 Initializing app..."),await oe())})(),()=>{e=!1}}),[]),(0,e.useEffect)((()=>(!He.current&&ue&&(console.log("\ud83d\udd04 Initializing Multi-Device Sync Service..."),He.current=new zt(ue.name),He.current.onDeviceCountChanged(((e,t)=>{We(e),Oe(t)})),He.current.onSyncEventReceived((e=>{ze((t=>[e,...t.slice(0,9)]))})),He.current.onFieldChange("completedTasks",(e=>{e instanceof Set?V(e):Array.isArray(e)&&V(new Set(e))})),He.current.onFieldChange("taskAssignments",H),He.current.onFieldChange("employees",z),He.current.onFieldChange("tasks",q),He.current.onFieldChange("dailyData",W),He.current.connect().catch(console.error)),()=>{He.current&&(He.current.disconnect(),He.current=null)})),[ue]),(0,e.useEffect)((()=>{const e=setInterval((async()=>{if("connected"===i&&!r){console.log("\ud83e\uddf9 [AUTO-SAVE] Cleaning tasks: Initiating periodic auto-save...");try{await le();(async()=>{var e,n;const s=await(null===(e=(n=t.current).getCleaningTasksData)||void 0===e?void 0:e.call(n));if(s){const e=Array.from(C).every((e=>{var t,n;return null===(t=s.completedTasks)||void 0===t||null===(n=t.includes)||void 0===n?void 0:n.call(t,e)})),t=JSON.stringify(S)===JSON.stringify(s.taskAssignments);e&&t?console.log("\u2705 [AUTO-SAVE] Cleaning tasks verified after save."):console.warn("\u26a0\ufe0f [AUTO-SAVE] Cleaning tasks verification failed.",{completedMatch:e,assignmentsMatch:t,data:s})}else console.warn("\u26a0\ufe0f [AUTO-SAVE] Cleaning tasks verification: No data returned.")})()}catch(e){console.error("\u274c [AUTO-SAVE] Cleaning tasks save failed:",e)}}}),3e5);return()=>clearInterval(e)}),[i,r,le,C,S]),(0,e.useEffect)((()=>{const e=()=>{const e=localStorage.getItem("lastDailyResetNotification"),t=localStorage.getItem("lastTaskResetDate"),n=(0,j.po)(new Date);console.log("\ud83d\udd0d Checking notification:",{lastNotificationDate:e,lastResetDate:t,today:n,completedTasksSize:C.size,taskAssignmentsCount:Object.keys(S).length,shouldShow:t===n&&e!==n&&0===C.size&&0===Object.keys(S).length}),t===n&&e!==n&&0===C.size&&0===Object.keys(S).length&&(console.log("\ud83d\udce2 Showing daily reset notification"),Pe(!0),localStorage.setItem("lastDailyResetNotification",n),setTimeout((()=>{Pe(!1)}),8e3))};if(!r&&"connected"===i){const t=setTimeout(e,2e3);return()=>clearTimeout(t)}}),[C.size,S,r,i]),(0,e.useEffect)((()=>{const e=o.find((e=>e.id===ue.id));e&&ve(e.mood)}),[ue.id,o]),(0,e.useEffect)((()=>{D&&D.length>0&&Ae(D)}),[D]),(0,e.useEffect)((()=>{const e=Ke.length-(t=Ke,X.resolveConflicts(t)).length;var t;Me(e)}),[Ke]),(0,e.useEffect)((()=>{const e=Qe.length-(t=Qe,ne.resolveConflicts(t)).length;var t;Me((t=>t+e))}),[Qe]);(0,e.useCallback)((e=>{Ye((t=>[...t,e])),de(e)}),[de]),(0,e.useCallback)((e=>{$e((t=>[...t,e])),se(o,e)}),[o]);(0,e.useEffect)((()=>{const e=()=>{ee.processQueue((async e=>{}))};return window.addEventListener("online",e),()=>{window.removeEventListener("online",e)}}),[]);const Ge=(0,e.useCallback)((()=>{"connected"===i&&le()}),[i,le]),Je=(0,e.useCallback)((e=>{z(e),Ge()}),[z,Ge]),Ze=(0,e.useCallback)((e=>{q(e),Ge()}),[q,Ge]),Xe=(0,e.useCallback)((e=>{W(e),Ge()}),[W,Ge]),et=(0,e.useCallback)((async e=>{console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save completedTasks:",Array.from(e));try{const r=await ce("completedTasks",Array.from(e));if(!0===r){var n,s;console.log("\ud83d\udd12 [CRITICAL-SAVE] CompletedTasks QuickSave confirmed by Firebase."),V(e);const r=await(null===(n=(s=t.current).getCleaningTasksData)||void 0===n?void 0:n.call(s));if(r){Array.from(e).every((e=>{var t,n;return null===(t=r.completedTasks)||void 0===t||null===(n=t.includes)||void 0===n?void 0:n.call(t,e)}))?console.log("\u2705 [CRITICAL-SAVE] Completed tasks successfully verified in Firebase."):console.warn("\u26a0\ufe0f [CRITICAL-SAVE] Completed tasks verification failed.",{tasks:e,data:r})}}else console.error("\u274c [CRITICAL-SAVE] CompletedTasks QuickSave failed:",r)}catch(r){console.error("\u274c [CRITICAL-SAVE] CompletedTasks QuickSave error:",r)}}),[ce,V]),tt=(0,e.useCallback)((async e=>{const n="function"===typeof e?e((0,s.A)({},S)):e;console.log("\ud83d\udd25 [CRITICAL-SAVE] Cleaning tasks: About to save taskAssignments:",n);try{const e=await ce("taskAssignments",n);if(!0===e){var r,a;console.log("\ud83d\udd12 [CRITICAL-SAVE] TaskAssignments QuickSave confirmed by Firebase."),H((()=>n));const e=await(null===(r=(a=t.current).getCleaningTasksData)||void 0===r?void 0:r.call(a));if(e){JSON.stringify(n)===JSON.stringify(e.taskAssignments)?console.log("\u2705 [CRITICAL-SAVE] Task assignments successfully verified in Firebase."):console.warn("\u26a0\ufe0f [CRITICAL-SAVE] Task assignments verification failed.",{newAssignments:n,data:e})}}else console.error("\u274c [CRITICAL-SAVE] TaskAssignments QuickSave failed:",e)}catch(i){console.error("\u274c [CRITICAL-SAVE] TaskAssignments QuickSave error:",i)}}),[ce,H,S]),nt=(0,e.useCallback)((e=>{K(e),Ge()}),[K,Ge]),st=(0,e.useCallback)((e=>{const t="function"===typeof e?e(Ee):e;Ae(t),G((()=>t)),Ge()}),[Ee,G,Ge]),rt=(0,e.useCallback)((()=>{if(!he)return;console.log("\ud83e\uddea MANUAL RESET: Triggered by admin"),console.log("\ud83d\udccb Before manual reset:",{completedTasksCount:C.size,taskAssignmentsCount:Object.keys(S).length,taskAssignments:S});const e=(0,j.po)(new Date);localStorage.removeItem("resetInProgress"),localStorage.removeItem("lastDailyResetNotification"),localStorage.removeItem("resetCheckedToday"),V(new Set),H((()=>({}))),localStorage.setItem("lastTaskResetDate",e),console.log("\u2705 MANUAL RESET: Cleared both completed tasks AND task assignments"),Pe(!0),setTimeout((()=>{Pe(!1)}),8e3),setTimeout((()=>{Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})]).then((()=>{console.log("\u2705 MANUAL RESET: Both completedTasks=[] and taskAssignments={} saved to Firebase")})).catch((e=>{console.error("\u274c MANUAL RESET: Failed to save to Firebase:",e)}))}),500)}),[he,V,H,ce,C,S]),at=(0,e.useCallback)((()=>{((e,t,n,s)=>{e===w.qw?(t(!0),n("admin"),s("")):alert("Invalid password!")})(Ce,pe,we,Se),_e(!1)}),[Ce,pe,we,Se]),it=o.find((e=>e.id===ue.id)),ot=(0,e.useCallback)((()=>{Ve((e=>!e)),He.current&&(Be?He.current.disconnect():He.current.connect())}),[Be]),lt=(0,e.useCallback)((async()=>{if(He.current)try{console.log("\ud83d\udd04 Refreshing data from all devices...");const e=await He.current.refreshDataFromAllDevices();e.employees&&z(e.employees),e.tasks&&q(e.tasks),e.dailyData&&W(e.dailyData),e.completedTasks&&Array.isArray(e.completedTasks)&&V(new Set(e.completedTasks)),e.taskAssignments&&H(e.taskAssignments),console.log("\u2705 Data refreshed from all devices")}catch(e){console.error("\u274c Failed to refresh from all devices:",e)}else await oe()}),[oe,z,q,W,V,H]);return(0,e.useEffect)((()=>{if(!r&&"connected"===i&&o.length>0){const e=setTimeout((()=>{(async()=>{const e=(0,j.po)(new Date),n=await t.current.getLastTaskResetDate();if(console.log("\ud83d\udd0d [CROSS-DEVICE] Checking for automatic daily reset:",{today:e,lastResetDate:n,needsReset:n!==e,completedTasksCount:C.size,taskAssignmentsCount:Object.keys(S).length}),n!==e&&(C.size>0||Object.keys(S).length>0)){console.log("\ud83c\udf05 [CROSS-DEVICE] NEW DAY DETECTED: Attempting synchronized daily reset");const n="daily_reset_lock_".concat(e),u=localStorage.getItem("deviceId")||"device-".concat(Date.now()),h=Date.now()+3e4;try{var s,r,a,i;if(!0===await(null===(s=(r=t.current).acquireResetLock)||void 0===s?void 0:s.call(r,n,u,h)))console.log("\ud83d\udd12 [CROSS-DEVICE] Reset lock acquired, performing reset"),(await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})])).every((e=>!0===e))?(await t.current.setLastTaskResetDate(e),console.log("\u2705 [CROSS-DEVICE] Daily reset completed successfully"),Pe(!0),setTimeout((()=>{Pe(!1)}),8e3)):console.error("\u274c [CROSS-DEVICE] AUTOMATIC RESET: Failed to save to Firebase"),await(null===(a=(i=t.current).releaseResetLock)||void 0===a?void 0:a.call(i,n,u)),console.log("\ud83d\udd13 [CROSS-DEVICE] Reset lock released");else console.log("\u23f3 [CROSS-DEVICE] Another device is handling the daily reset, skipping")}catch(c){console.error("\u274c [CROSS-DEVICE] AUTOMATIC RESET: Error during reset:",c);try{var o,l;await(null===(o=(l=t.current).releaseResetLock)||void 0===o?void 0:o.call(l,n,u))}catch(d){console.error("\u274c [CROSS-DEVICE] Failed to release lock after error:",d)}}}})()}),2e3);return()=>clearTimeout(e)}}),[r,i,o.length,C.size,Object.keys(S).length,ce]),(0,e.useEffect)((()=>{const e=async()=>{if(!document.hidden&&!r&&"connected"===i){const e=(0,j.po)(new Date),n=await t.current.getLastTaskResetDate();console.log("\ud83d\udc41\ufe0f [CROSS-DEVICE] App became visible, checking for daily reset:",{today:e,lastResetDate:n,needsReset:n!==e}),n!==e&&(C.size>0||Object.keys(S).length>0)&&setTimeout((async()=>{try{(await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})])).every((e=>!0===e))&&(await t.current.setLastTaskResetDate(e),Pe(!0),setTimeout((()=>Pe(!1)),8e3))}catch(n){console.error("\u274c [CROSS-DEVICE] VISIBILITY RESET: Failed:",n)}}),1e3)}};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}),[r,i,C.size,Object.keys(S).length,ce]),(0,e.useEffect)((()=>{r||"connected"!==i||console.log("\ud83d\udcca DAILY RESET DEBUG:",{currentDate:(0,j.po)(new Date),lastResetDate:localStorage.getItem("lastTaskResetDate"),completedTasksCount:C.size,taskAssignmentsCount:Object.keys(S).length,isLoading:r,connectionStatus:i,employeeCount:o.length})}),[C.size,Object.keys(S).length,r,i]),(0,e.useEffect)((()=>(window.triggerDailyReset=async()=>{console.log("\ud83e\uddea MANUAL TRIGGER: Forcing daily reset from console");const e=(0,j.po)(new Date);localStorage.setItem("lastTaskResetDate",e);try{const e=await Promise.all([ce("completedTasks",[]),ce("taskAssignments",{})]);return console.log("\u2705 Manual trigger results:",e),e}catch(t){return console.error("\u274c Manual trigger failed:",t),!1}},()=>{delete window.triggerDailyReset})),[ce]),(0,N.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,N.jsxs)("div",{className:"bg-white shadow-sm border-b",children:[(0,N.jsxs)("div",{className:"px-4 py-3 flex justify-between items-center",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"WorkVibe"}),(0,N.jsxs)("button",{onClick:()=>Ne(!je),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 mt-1",children:["Hello, ",ue.name,"!",(0,N.jsxs)("span",{className:"ml-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs font-medium",children:[(null===it||void 0===it?void 0:it.points)||0," pts"]}),(0,N.jsx)(l,{className:"w-4 h-4 ml-1"})]})]}),he&&(0,N.jsx)("div",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full",children:"Admin Mode"})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[he&&(0,N.jsx)("button",{onClick:()=>{xe(),we("mood")},className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg",title:"Logout Admin",children:(0,N.jsx)(c,{className:"w-5 h-5"})}),(0,N.jsx)("button",{onClick:()=>_e(!0),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",title:"Admin Login",children:(0,N.jsx)(d,{className:"w-5 h-5"})})]})]}),je&&(0,N.jsxs)("div",{className:"absolute top-16 left-4 bg-white border rounded-lg shadow-lg z-40 w-64",children:[(0,N.jsx)("div",{className:"p-3 border-b bg-gray-50",children:(0,N.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Switch Employee"})}),(0,N.jsx)("div",{className:"max-h-64 overflow-y-auto",children:o.map((e=>(0,N.jsxs)("button",{onClick:()=>(fe(e),Ne(!1),void we("mood")),className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center justify-between ".concat(ue.id===e.id?"bg-blue-50 border-r-2 border-blue-500":""),children:[(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat(1===e.mood?"bg-red-500":2===e.mood?"bg-orange-500":3===e.mood?"bg-yellow-500":4===e.mood?"bg-green-500":"bg-blue-500")}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,N.jsxs)("div",{className:"text-xs text-gray-500",children:[e.role," \u2022 ",e.points," pts"]})]})]}),ue.id===e.id&&(0,N.jsx)(u,{className:"w-4 h-4 text-blue-500"})]},e.id)))})]})]}),(0,N.jsx)("div",{className:"bg-white border-b",children:(0,N.jsxs)("div",{className:"flex overflow-x-auto",children:[(0,N.jsxs)("button",{onClick:()=>we("mood"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("mood"===be?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(h,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Mood Tracker"})]}),(0,N.jsxs)("button",{onClick:()=>we("tasks"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("tasks"===be?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(m,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Cleaning Tasks"})]}),(0,N.jsxs)("button",{onClick:()=>we("prep"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("prep"===be?"border-b-2 border-green-500 text-green-600 bg-green-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(p,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Prep List"})]}),(0,N.jsxs)("button",{onClick:()=>we("inventory"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("inventory"===be?"border-b-2 border-orange-500 text-orange-600 bg-orange-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(f,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Restaurant Inventory"})]}),(0,N.jsxs)("button",{onClick:()=>we("store"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("store"===be?"border-b-2 border-purple-500 text-purple-600 bg-purple-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(g,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Store"})]}),he&&(0,N.jsxs)("button",{onClick:()=>we("admin"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("admin"===be?"border-b-2 border-red-500 text-red-600 bg-red-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(d,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Admin Panel"})]}),he&&(0,N.jsxs)("button",{onClick:()=>we("reports"),className:"flex-shrink-0 py-3 px-4 text-center ".concat("reports"===be?"border-b-2 border-orange-500 text-orange-600 bg-orange-50":"text-gray-600 hover:text-gray-800"),children:[(0,N.jsx)(x,{className:"w-5 h-5 mx-auto mb-1"}),(0,N.jsx)("span",{className:"text-sm",children:"Daily Reports"})]})]})}),(0,N.jsxs)("div",{className:"p-4 space-y-6",children:[De&&(0,N.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-full mx-4",children:(0,N.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow-lg backdrop-blur-sm",children:(0,N.jsxs)("div",{className:"flex items-start",children:[(0,N.jsx)("div",{className:"flex-shrink-0",children:(0,N.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,N.jsxs)("div",{className:"ml-3 flex-1",children:[(0,N.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"\ud83c\udf05 New Day, Fresh Start!"}),(0,N.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"All cleaning tasks and assignments have been reset for today. Time to start fresh and earn those points!"})]})]})})}),he&&(0,N.jsx)("div",{className:"fixed bottom-20 right-4 z-50",children:(0,N.jsx)("button",{onClick:rt,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full shadow-lg transition-colors text-sm font-medium",title:"Test Daily Reset - Clears both tasks AND assignments (Admin Only)",children:"\ud83e\uddea Test Reset"})}),(0,N.jsx)(Pt,{isLoading:r,lastSync:a,connectionStatus:i,loadFromFirebase:oe,conflictCount:Re,activeDevices:Le,syncEvents:Fe,deviceCount:qe,isMultiDeviceEnabled:Be,toggleMultiDeviceSync:ot,refreshFromAllDevices:lt}),"mood"===be&&(0,N.jsx)(k,{currentUser:ue,employees:o,userMood:ye,setUserMood:ve,setEmployees:Je,setDailyData:Xe}),"tasks"===be&&(0,N.jsx)(M,{currentUser:ue,tasks:b,employees:o,completedTasks:C,taskAssignments:S,dailyData:_,setCompletedTasks:et,setTaskAssignments:tt,setDailyData:Xe,setEmployees:Je,saveToFirebase:le}),"prep"===be&&(0,N.jsx)(Ue,{currentUser:ue,connectionStatus:i,prepItems:T,scheduledPreps:E,prepSelections:A,setPrepItems:Y,setScheduledPreps:Q,setPrepSelections:$,quickSave:ce}),"inventory"===be&&(0,N.jsx)(Nt,{currentUser:ue,connectionStatus:i,inventoryDailyItems:P,inventoryWeeklyItems:R,inventoryMonthlyItems:L,inventoryDatabaseItems:O,inventoryActivityLog:F,inventoryCustomCategories:U,setInventoryDailyItems:J,setInventoryWeeklyItems:Z,setInventoryMonthlyItems:te,setInventoryDatabaseItems:re,setInventoryActivityLog:ae,setInventoryCustomCategories:ie,quickSave:ce}),"store"===be&&(0,N.jsx)(B,{currentUser:ue,employees:o,storeItems:Ee,dailyData:_,setEmployees:Je,setDailyData:Xe,saveToFirebase:le}),"admin"===be&&he&&(0,N.jsx)(me,{employees:o,tasks:b,customRoles:I,storeItems:Ee,prepItems:T,setEmployees:Je,setTasks:Ze,setCustomRoles:nt,setStoreItems:st,setPrepItems:Y,quickSave:ce}),"reports"===be&&he&&(0,N.jsx)(ge,{selectedDate:Ie,setSelectedDate:Te,dailyData:_,employees:o,connectionStatus:i})]}),ke&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsxs)("div",{className:"bg-white rounded-xl p-6 w-80 mx-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,N.jsx)(y,{className:"w-5 h-5 mr-2"}),"Admin Access"]}),(0,N.jsx)("button",{onClick:()=>{_e(!1),Se("")},className:"text-gray-500 hover:text-gray-700",children:(0,N.jsx)(v,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)("input",{type:"password",placeholder:"Enter admin password",value:Ce,onChange:e=>Se(e.target.value),onKeyPress:e=>"Enter"===e.key&&at(),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0}),(0,N.jsx)("button",{onClick:at,className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Login"})]})]})}),(je||ke)&&(0,N.jsx)("div",{className:"fixed inset-0 z-30",onClick:()=>{Ne(!1),ke||_e(!1)}})]})},Wt=e=>{let{children:t}=e;return console.log("\ud83e\uddea OfflineDetector bypassed for testing environment"),(0,N.jsx)(N.Fragment,{children:t})};const Bt=function(){return(0,N.jsx)("div",{className:"App",children:(0,N.jsx)(Wt,{children:(0,N.jsx)(qt,{})})})};let Vt;function Ht(){const e=document.getElementById("pwa-install-btn");e&&(e.style.display="none")}t.createRoot(document.getElementById("root")).render((0,N.jsx)(e.StrictMode,{children:(0,N.jsx)(Bt,{})})),"serviceWorker"in navigator&&(window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((e=>{console.log("\u2705 PWA Service Worker registered successfully:",e.scope),e.addEventListener("updatefound",(()=>{const t=e.installing;t&&t.addEventListener("statechange",(()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("\ud83d\udd04 New version of WorkVibe available!"),window.confirm("New version of WorkVibe is available! Would you like to update?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload()))}))}))})).catch((e=>{console.warn("\u26a0\ufe0f PWA Service Worker not available (development mode or missing sw.js):",e.message)})),navigator.serviceWorker.addEventListener("message",(e=>{e.data&&"BACKGROUND_SYNC"===e.data.type&&console.log("\ud83d\udd04 Background sync completed")}))})),navigator.serviceWorker.addEventListener("controllerchange",(()=>{console.log("\ud83d\udd04 Service Worker controller changed"),window.location.reload()}))),window.addEventListener("beforeinstallprompt",(e=>{console.log("\ud83d\udcf1 PWA install prompt triggered"),e.preventDefault(),Vt=e,function(){const e=document.getElementById("pwa-install-btn");e&&(e.style.display="block",e.onclick=async()=>{if(Vt){Vt.prompt();const{outcome:e}=await Vt.userChoice;console.log("PWA install prompt: ".concat(e)),Vt=null,Ht()}})}()})),window.addEventListener("appinstalled",(()=>{console.log("\ud83c\udf89 WorkVibe PWA was installed successfully!"),Vt=null,Ht(),window.gtag&&window.gtag("event","pwa_install",{event_category:"engagement",event_label:"WorkVibe PWA Install"})})),window.addEventListener("online",(()=>{console.log("\ud83c\udf10 Back online!")})),window.addEventListener("offline",(()=>{console.log("\ud83d\udcf5 Gone offline")})),document.addEventListener("touchstart",(e=>{e.touches.length>1&&e.preventDefault()}));let Kt=0;function Yt(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}document.addEventListener("touchend",(e=>{const t=(new Date).getTime();t-Kt<=300&&e.preventDefault(),Kt=t}),!1),Yt(),window.addEventListener("resize",Yt),window.addEventListener("orientationchange",(()=>{setTimeout(Yt,100)}))})()})();